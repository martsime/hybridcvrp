{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/internal/index.mjs","../../node_modules/svelte/store/index.mjs","../../src/stores.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/env-utils/assert.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/env-utils/globals.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/assert.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/globals.js","../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-job.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-utils/get-loadable-worker-url.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-utils/get-transfer-list.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-thread.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-pool.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-farm/worker-farm.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/worker-loader-utils/parse-with-worker.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/get-worker-url.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/binary-utils/array-buffer-utils.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/iterators/async-iteration.js","../../node_modules/@probe.gl/stats/dist/esm/utils/hi-res-timestamp.js","../../node_modules/@probe.gl/stats/dist/esm/lib/stat.js","../../node_modules/@probe.gl/stats/dist/esm/lib/stats.js","../../node_modules/@loaders.gl/loader-utils/dist/esm/lib/path-utils/file-aliases.js","../../node_modules/@loaders.gl/core/dist/esm/javascript-utils/is-type.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/mime-type-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/resource-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/utils/response-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/fetch/fetch-file.js","../../node_modules/probe.gl/dist/esm/env/is-electron.js","../../node_modules/probe.gl/dist/esm/env/is-browser.js","../../node_modules/probe.gl/dist/esm/env/globals.js","../../node_modules/probe.gl/dist/esm/utils/globals.js","../../node_modules/probe.gl/dist/esm/utils/local-storage.js","../../node_modules/probe.gl/dist/esm/utils/formatters.js","../../node_modules/probe.gl/dist/esm/utils/color.js","../../node_modules/probe.gl/dist/esm/utils/assert.js","../../node_modules/probe.gl/dist/esm/utils/hi-res-timestamp.js","../../node_modules/probe.gl/dist/esm/lib/log.js","../../node_modules/probe.gl/dist/esm/utils/autobind.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/loggers.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/option-defaults.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/option-utils.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/normalize-loader.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/register-loaders.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/select-loader.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-array-buffer-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-stream-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-string-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/iterators/make-iterator/make-blob-iterator.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/get-data.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/parse.js","../../node_modules/@loaders.gl/core/dist/esm/lib/loader-utils/loader-context.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/worker-api/validate-worker-version.js","../../node_modules/@loaders.gl/worker-utils/dist/esm/lib/env-utils/version.js","../../node_modules/@loaders.gl/core/dist/esm/lib/api/load.js","../../node_modules/@loaders.gl/images/dist/esm/lib/utils/assert.js","../../node_modules/@loaders.gl/images/dist/esm/lib/utils/globals.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/image-type.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/parsed-image-api.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/svg-utils.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-image.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-image-bitmap.js","../../node_modules/@loaders.gl/images/dist/esm/lib/category-api/binary-image-api.js","../../node_modules/@loaders.gl/images/dist/esm/image-loader.js","../../node_modules/@loaders.gl/images/dist/esm/lib/utils/version.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-image.js","../../node_modules/@loaders.gl/images/dist/esm/lib/parsers/parse-to-node-image.js","../../node_modules/@babel/runtime/helpers/interopRequireDefault.js","../../node_modules/@babel/runtime/helpers/typeof.js","../../node_modules/probe.gl/dist/es5/env/globals.js","../../node_modules/probe.gl/dist/es5/env/is-electron.js","../../node_modules/probe.gl/dist/es5/env/is-browser.js","../../node_modules/probe.gl/dist/es5/env/get-browser.js","../../node_modules/probe.gl/dist/es5/env/index.js","../../node_modules/@deck.gl/core/dist/esm/utils/log.js","../../node_modules/@deck.gl/core/dist/esm/debug/index.js","../../node_modules/@deck.gl/core/dist/esm/utils/json-loader.js","../../node_modules/@deck.gl/core/dist/esm/lib/init.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/log.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/assert.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/webgl-checks.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/polyfill-vertex-array-object.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/get-parameter-polyfill.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/polyfill-table.js","../../node_modules/@luma.gl/gltools/dist/esm/polyfill/polyfill-context.js","../../node_modules/@luma.gl/gltools/dist/esm/state-tracker/webgl-parameter-tables.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/utils.js","../../node_modules/@luma.gl/gltools/dist/esm/state-tracker/track-context-state.js","../../node_modules/@luma.gl/gltools/dist/esm/state-tracker/unified-parameter-api.js","../../node_modules/@luma.gl/gltools/dist/esm/utils/device-pixels.js","../../node_modules/@luma.gl/gltools/dist/esm/context/context.js","../../node_modules/@luma.gl/webgl/dist/esm/init.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/request-animation-frame.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/typed-array-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/assert.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/utils.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/format-value.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/stub-methods.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/check-props.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/constants-to-keys.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/resource.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/accessor.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/buffer.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-formats.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-2d.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/load-file.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-cube.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/texture-3d.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/renderbuffer-formats.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/renderbuffer.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/clear.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/copy-and-blit.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/format-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/features/webgl-features-table.js","../../node_modules/@luma.gl/webgl/dist/esm/features/features.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/framebuffer.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/texture-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/get-shader-name.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/format-glsl-error.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/get-shader-type-name.js","../../node_modules/@luma.gl/webgl/dist/esm/glsl-utils/get-shader-version.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/shader.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/uniforms.js","../../node_modules/@luma.gl/webgl/dist/esm/webgl-utils/attribute-utils.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/program-configuration.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/program.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/query.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/transform-feedback.js","../../node_modules/@luma.gl/webgl/dist/esm/utils/array-utils-flat.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/vertex-array-object.js","../../node_modules/probe.gl/dist/esm/env/get-browser.js","../../node_modules/@luma.gl/webgl/dist/esm/classes/vertex-array.js","../../node_modules/@luma.gl/webgl/dist/esm/debug/debug-uniforms.js","../../node_modules/@luma.gl/webgl/dist/esm/debug/debug-vertex-array.js","../../node_modules/@luma.gl/webgl/dist/esm/debug/debug-program-configuration.js","../../node_modules/@luma.gl/engine/dist/esm/lib/animation-loop.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/constants.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/assert.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/filters/prop-types.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/shader-module.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/resolve-modules.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/webgl-info.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/is-old-ie.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/module-injectors.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/inject-shader.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/transpile-shader.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/assemble-shaders.js","../../node_modules/@luma.gl/shadertools/dist/esm/lib/platform-defines.js","../../node_modules/@luma.gl/shadertools/dist/esm/utils/shader-utils.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/fp32/fp32.js","../../node_modules/@math.gl/core/dist/esm/lib/assert.js","../../node_modules/@math.gl/core/dist/esm/lib/common.js","../../node_modules/@math.gl/core/dist/esm/classes/base/math-array.js","../../node_modules/@math.gl/core/dist/esm/lib/validators.js","../../node_modules/@math.gl/core/dist/esm/classes/base/vector.js","../../node_modules/gl-matrix/esm/common.js","../../node_modules/gl-matrix/esm/vec2.js","../../node_modules/@math.gl/core/dist/esm/lib/gl-matrix-extras.js","../../node_modules/gl-matrix/esm/vec3.js","../../node_modules/@math.gl/core/dist/esm/classes/vector3.js","../../node_modules/@math.gl/core/dist/esm/classes/base/matrix.js","../../node_modules/gl-matrix/esm/mat4.js","../../node_modules/gl-matrix/esm/vec4.js","../../node_modules/@math.gl/core/dist/esm/classes/matrix4.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/picking/picking.js","../../node_modules/@luma.gl/shadertools/dist/esm/modules/transform/transform.js","../../node_modules/@luma.gl/engine/dist/esm/lib/program-manager.js","../../node_modules/@luma.gl/engine/dist/esm/lib/model-utils.js","../../node_modules/@luma.gl/engine/dist/esm/lib/model.js","../../node_modules/@luma.gl/engine/dist/esm/transform/buffer-transform.js","../../node_modules/@luma.gl/engine/dist/esm/transform/transform-shader-utils.js","../../node_modules/@luma.gl/engine/dist/esm/transform/texture-transform.js","../../node_modules/@luma.gl/engine/dist/esm/transform/transform.js","../../node_modules/@luma.gl/engine/dist/esm/geometry/geometry.js","../../node_modules/@luma.gl/engine/dist/esm/animation/timeline.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/misc/geometry.js","../../node_modules/@deck.gl/core/dist/esm/lib/constants.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/project.glsl.js","../../node_modules/@deck.gl/core/dist/esm/utils/memoize.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/viewport-uniforms.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/project.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project32/project32.js","../../node_modules/@math.gl/web-mercator/dist/esm/math-utils.js","../../node_modules/@math.gl/web-mercator/dist/esm/assert.js","../../node_modules/@math.gl/web-mercator/dist/esm/web-mercator-utils.js","../../node_modules/@math.gl/web-mercator/dist/esm/fit-bounds.js","../../node_modules/@math.gl/web-mercator/dist/esm/get-bounds.js","../../node_modules/@math.gl/web-mercator/dist/esm/web-mercator-viewport.js","../../node_modules/@math.gl/web-mercator/dist/esm/normalize-viewport-props.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/shadow/shadow.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/picking/picking.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/index.js","../../node_modules/@deck.gl/core/dist/esm/effects/lighting/ambient-light.js","../../node_modules/@deck.gl/core/dist/esm/effects/lighting/directional-light.js","../../node_modules/@deck.gl/core/dist/esm/lib/effect.js","../../node_modules/@deck.gl/core/dist/esm/passes/layers-pass.js","../../node_modules/@deck.gl/core/dist/esm/passes/pass.js","../../node_modules/@deck.gl/core/dist/esm/passes/shadow-pass.js","../../node_modules/@deck.gl/core/dist/esm/effects/lighting/lighting-effect.js","../../node_modules/@deck.gl/core/dist/esm/utils/typed-array-manager.js","../../node_modules/@deck.gl/core/dist/esm/utils/math-utils.js","../../node_modules/@deck.gl/core/dist/esm/viewports/viewport.js","../../node_modules/@deck.gl/core/dist/esm/viewports/web-mercator-viewport.js","../../node_modules/@deck.gl/core/dist/esm/shaderlib/project/project-functions.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/constants.js","../../node_modules/@deck.gl/core/dist/esm/utils/flatten.js","../../node_modules/@deck.gl/core/dist/esm/lib/resource/resource.js","../../node_modules/@deck.gl/core/dist/esm/lib/resource/resource-manager.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer-manager.js","../../node_modules/@deck.gl/core/dist/esm/utils/deep-equal.js","../../node_modules/@deck.gl/core/dist/esm/lib/view-manager.js","../../node_modules/@deck.gl/core/dist/esm/utils/positions.js","../../node_modules/@deck.gl/core/dist/esm/utils/assert.js","../../node_modules/@deck.gl/core/dist/esm/views/view.js","../../node_modules/@deck.gl/core/dist/esm/transitions/transition.js","../../node_modules/@deck.gl/core/dist/esm/controllers/transition-manager.js","../../node_modules/@deck.gl/core/dist/esm/transitions/linear-interpolator.js","../../node_modules/@deck.gl/core/dist/esm/transitions/transition-interpolator.js","../../node_modules/@deck.gl/core/dist/esm/controllers/controller.js","../../node_modules/@deck.gl/core/dist/esm/controllers/view-state.js","../../node_modules/@deck.gl/core/dist/esm/controllers/map-controller.js","../../node_modules/@deck.gl/core/dist/esm/views/map-view.js","../../node_modules/@deck.gl/core/dist/esm/lib/effect-manager.js","../../node_modules/@deck.gl/core/dist/esm/passes/draw-layers-pass.js","../../node_modules/@deck.gl/core/dist/esm/passes/pick-layers-pass.js","../../node_modules/@deck.gl/core/dist/esm/lib/deck-renderer.js","../../node_modules/@deck.gl/core/dist/esm/lib/picking/query-object.js","../../node_modules/@deck.gl/core/dist/esm/lib/picking/pick-info.js","../../node_modules/@deck.gl/core/dist/esm/lib/deck-picker.js","../../node_modules/@deck.gl/core/dist/esm/lib/tooltip.js","../../node_modules/hammerjs/hammer.js","../../node_modules/mjolnir.js/dist/esm/utils/hammer-overrides.js","../../node_modules/mjolnir.js/dist/esm/utils/hammer.browser.js","../../node_modules/mjolnir.js/dist/esm/constants.js","../../node_modules/mjolnir.js/dist/esm/utils/globals.js","../../node_modules/mjolnir.js/dist/esm/inputs/wheel-input.js","../../node_modules/mjolnir.js/dist/esm/inputs/move-input.js","../../node_modules/mjolnir.js/dist/esm/inputs/key-input.js","../../node_modules/mjolnir.js/dist/esm/inputs/contextmenu-input.js","../../node_modules/mjolnir.js/dist/esm/utils/event-utils.js","../../node_modules/mjolnir.js/dist/esm/utils/event-registrar.js","../../node_modules/mjolnir.js/dist/esm/event-manager.js","../../node_modules/@deck.gl/core/dist/esm/lib/deck.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/shader-attribute.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/data-column.js","../../node_modules/@deck.gl/core/dist/esm/utils/iterable-utils.js","../../node_modules/@deck.gl/core/dist/esm/utils/range.js","../../node_modules/@deck.gl/core/dist/esm/utils/array-utils.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute-transition-utils.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/gl-utils.js","../../node_modules/@deck.gl/core/dist/esm/transitions/gpu-interpolation-transition.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute-transition-manager.js","../../node_modules/@deck.gl/core/dist/esm/transitions/gpu-spring-transition.js","../../node_modules/@deck.gl/core/dist/esm/lib/attribute/attribute-manager.js","../../node_modules/@deck.gl/core/dist/esm/transitions/cpu-spring-transition.js","../../node_modules/@deck.gl/core/dist/esm/lib/uniform-transition-manager.js","../../node_modules/@deck.gl/core/dist/esm/transitions/cpu-interpolation-transition.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/props.js","../../node_modules/@deck.gl/core/dist/esm/utils/count.js","../../node_modules/@deck.gl/core/dist/esm/utils/shader.js","../../node_modules/@deck.gl/core/dist/esm/utils/texture.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/prop-types.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/create-props.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/component-state.js","../../node_modules/@deck.gl/core/dist/esm/lifecycle/component.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer-state.js","../../node_modules/@deck.gl/core/dist/esm/lib/layer.js","../../node_modules/@deck.gl/core/dist/esm/controllers/orbit-controller.js","../../node_modules/@deck.gl/core/dist/esm/controllers/orthographic-controller.js","../../node_modules/@deck.gl/core/dist/esm/views/orthographic-view.js","../../node_modules/@deck.gl/layers/dist/esm/scatterplot-layer/scatterplot-layer.js","../../node_modules/@deck.gl/layers/dist/esm/scatterplot-layer/scatterplot-layer-vertex.glsl.js","../../node_modules/@deck.gl/layers/dist/esm/scatterplot-layer/scatterplot-layer-fragment.glsl.js","../../node_modules/@math.gl/polygon/dist/esm/utils.js","../../node_modules/@math.gl/polygon/dist/esm/lineclip.js","../../node_modules/@math.gl/polygon/dist/esm/cut-by-grid.js","../../node_modules/@math.gl/polygon/dist/esm/cut-by-mercator-bounds.js","../../node_modules/@deck.gl/layers/dist/esm/path-layer/path-tesselator.js","../../node_modules/@deck.gl/core/dist/esm/utils/tesselator.js","../../node_modules/@deck.gl/layers/dist/esm/path-layer/path.js","../../node_modules/@deck.gl/layers/dist/esm/path-layer/path-layer.js","../../node_modules/@deck.gl/layers/dist/esm/path-layer/path-layer-vertex.glsl.js","../../node_modules/@deck.gl/layers/dist/esm/path-layer/path-layer-fragment.glsl.js","../../src/components/icons/ResetZoomIcon.svelte","../../src/components/icons/StartIcon.svelte","../../src/components/icons/ResetIcon.svelte","../../src/components/icons/PauseIcon.svelte","../../src/components/map/MapPanel.svelte","../../src/components/map/Map.svelte","../../src/components/Navbar.svelte","../../src/components/icons/GearIcon.svelte","../../src/instances.js","../../src/components/InstanceSelector.svelte","../../src/components/ConfigForm.svelte","../../src/pages/MainPage.svelte","../../src/main.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root.host) {\n        return root;\n    }\n    return document;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentElement !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => svg ? svg_element(name) : element(name));\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration();\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, bubbles = false) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor() {\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes) {\n        super();\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = append_empty_stylesheet(node).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction escape_attribute_value(value) {\n    return typeof value === 'string' ? escape(value) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : context || []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = on_mount.map(run).filter(is_function);\n            if (on_destroy) {\n                on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : options.context || []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.42.1' }, detail), true));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_html_tag, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, src_url_equal, start_hydrating, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","import { writable } from \"svelte/store\";\nexport const instance = writable({\n  nodes: [],\n  property: {},\n});\nexport const solution = writable({\n  routes: [],\n  cost: null,\n});\n\nexport const config = writable({\n  initialIndividuals: 100,\n  minimumPopulationSize: 25,\n  generationSize: 40,\n  localSearchGranularity: 20,\n  numberOfElites: 4,\n  feasibilityProportionTarget: 0.2,\n  RRGamma: 1.0,\n  RRStartTemp: 10.0,\n  eliteStartTemp: 50.0,\n  eliteGamma: 500,\n  eliteEducation: true,\n});\n\nexport const time = writable(0.0);\nexport const state = writable({\n  loaded: false,\n  running: false,\n  reset: false,\n  updateConfig: false,\n});\n","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'loader assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\nexport const isBrowser = typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\nexport const isWorker = typeof importScripts === 'function';\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'loaders.gl assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global || {};\nconst window_ = globals.window || globals.self || globals.global || {};\nconst global_ = globals.global || globals.self || globals.window || {};\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\nexport const isBrowser = typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\nexport const isWorker = typeof importScripts === 'function';\nexport const isMobile = typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { assert } from '../env-utils/assert';\nexport default class WorkerJob {\n  constructor(jobName, workerThread) {\n    _defineProperty(this, \"name\", void 0);\n\n    _defineProperty(this, \"workerThread\", void 0);\n\n    _defineProperty(this, \"isRunning\", void 0);\n\n    _defineProperty(this, \"result\", void 0);\n\n    _defineProperty(this, \"_resolve\", void 0);\n\n    _defineProperty(this, \"_reject\", void 0);\n\n    this.name = jobName;\n    this.workerThread = workerThread;\n    this.isRunning = true;\n\n    this._resolve = () => {};\n\n    this._reject = () => {};\n\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  postMessage(type, payload) {\n    this.workerThread.postMessage({\n      source: 'loaders.gl',\n      type,\n      payload\n    });\n  }\n\n  done(value) {\n    assert(this.isRunning);\n    this.isRunning = false;\n\n    this._resolve(value);\n  }\n\n  error(error) {\n    assert(this.isRunning);\n    this.isRunning = false;\n\n    this._reject(error);\n  }\n\n}\n//# sourceMappingURL=worker-job.js.map","import { assert } from '../env-utils/assert';\nconst workerURLCache = new Map();\nexport function getLoadableWorkerURL(props) {\n  assert(props.source && !props.url || !props.source && props.url);\n  let workerURL = workerURLCache.get(props.source || props.url);\n\n  if (!workerURL) {\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n\n  assert(workerURL);\n  return workerURL;\n}\n\nfunction getLoadableWorkerURLFromURL(url) {\n  if (!url.startsWith('http')) {\n    return url;\n  }\n\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\n\nfunction getLoadableWorkerURLFromSource(workerSource) {\n  const blob = new Blob([workerSource], {\n    type: 'application/javascript'\n  });\n  return URL.createObjectURL(blob);\n}\n\nfunction buildScriptSource(workerUrl) {\n  return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}\n//# sourceMappingURL=get-loadable-worker-url.js.map","export function getTransferList(object, recursive = true, transfers) {\n  const transfersSet = transfers || new Set();\n\n  if (!object) {} else if (isTransferable(object)) {\n    transfersSet.add(object);\n  } else if (isTransferable(object.buffer)) {\n    transfersSet.add(object.buffer);\n  } else if (ArrayBuffer.isView(object)) {} else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n\n  return transfers === undefined ? Array.from(transfersSet) : [];\n}\n\nfunction isTransferable(object) {\n  if (!object) {\n    return false;\n  }\n\n  if (object instanceof ArrayBuffer) {\n    return true;\n  }\n\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n\n  if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n    return true;\n  }\n\n  if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=get-transfer-list.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { assert } from '../env-utils/assert';\nimport { getLoadableWorkerURL } from '../worker-utils/get-loadable-worker-url';\nimport { getTransferList } from '../worker-utils/get-transfer-list';\n\nconst NOOP = () => {};\n\nexport default class WorkerThread {\n  static isSupported() {\n    return typeof Worker !== 'undefined';\n  }\n\n  constructor(props) {\n    _defineProperty(this, \"name\", void 0);\n\n    _defineProperty(this, \"source\", void 0);\n\n    _defineProperty(this, \"url\", void 0);\n\n    _defineProperty(this, \"terminated\", false);\n\n    _defineProperty(this, \"worker\", void 0);\n\n    _defineProperty(this, \"onMessage\", void 0);\n\n    _defineProperty(this, \"onError\", void 0);\n\n    _defineProperty(this, \"_loadableURL\", '');\n\n    const {\n      name,\n      source,\n      url\n    } = props;\n    assert(source || url);\n    this.name = name;\n    this.source = source;\n    this.url = url;\n    this.onMessage = NOOP;\n\n    this.onError = error => console.log(error);\n\n    this.worker = this._createBrowserWorker();\n  }\n\n  destroy() {\n    this.onMessage = NOOP;\n    this.onError = NOOP;\n    this.worker.terminate();\n    this.terminated = true;\n  }\n\n  get isRunning() {\n    return Boolean(this.onMessage);\n  }\n\n  postMessage(data, transferList) {\n    transferList = transferList || getTransferList(data);\n    this.worker.postMessage(data, transferList);\n  }\n\n  _getErrorFromErrorEvent(event) {\n    let message = 'Failed to load ';\n    message += `worker ${this.name}. `;\n\n    if (event.message) {\n      message += `${event.message} in `;\n    }\n\n    if (event.lineno) {\n      message += `:${event.lineno}:${event.colno}`;\n    }\n\n    return new Error(message);\n  }\n\n  _createBrowserWorker() {\n    this._loadableURL = getLoadableWorkerURL({\n      source: this.source,\n      url: this.url\n    });\n    const worker = new Worker(this._loadableURL, {\n      name: this.name\n    });\n\n    worker.onmessage = event => {\n      if (!event.data) {\n        this.onError(new Error('No data received'));\n      } else {\n        this.onMessage(event.data);\n      }\n    };\n\n    worker.onerror = error => {\n      this.onError(this._getErrorFromErrorEvent(error));\n      this.terminated = true;\n    };\n\n    worker.onmessageerror = event => console.error(event);\n\n    return worker;\n  }\n\n}\n//# sourceMappingURL=worker-thread.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { isMobile } from '../env-utils/globals';\nimport WorkerThread from './worker-thread';\nimport WorkerJob from './worker-job';\nexport default class WorkerPool {\n  constructor(props) {\n    _defineProperty(this, \"name\", 'unnamed');\n\n    _defineProperty(this, \"source\", void 0);\n\n    _defineProperty(this, \"url\", void 0);\n\n    _defineProperty(this, \"maxConcurrency\", 1);\n\n    _defineProperty(this, \"maxMobileConcurrency\", 1);\n\n    _defineProperty(this, \"onDebug\", () => {});\n\n    _defineProperty(this, \"reuseWorkers\", true);\n\n    _defineProperty(this, \"props\", {});\n\n    _defineProperty(this, \"jobQueue\", []);\n\n    _defineProperty(this, \"idleQueue\", []);\n\n    _defineProperty(this, \"count\", 0);\n\n    _defineProperty(this, \"isDestroyed\", false);\n\n    this.source = props.source;\n    this.url = props.url;\n    this.setProps(props);\n  }\n\n  destroy() {\n    this.idleQueue.forEach(worker => worker.destroy());\n    this.isDestroyed = true;\n  }\n\n  setProps(props) {\n    this.props = { ...this.props,\n      ...props\n    };\n\n    if (props.name !== undefined) {\n      this.name = props.name;\n    }\n\n    if (props.maxConcurrency !== undefined) {\n      this.maxConcurrency = props.maxConcurrency;\n    }\n\n    if (props.maxMobileConcurrency !== undefined) {\n      this.maxMobileConcurrency = props.maxMobileConcurrency;\n    }\n\n    if (props.reuseWorkers !== undefined) {\n      this.reuseWorkers = props.reuseWorkers;\n    }\n\n    if (props.onDebug !== undefined) {\n      this.onDebug = props.onDebug;\n    }\n  }\n\n  async startJob(name, onMessage = (job, type, data) => job.done(data), onError = (job, error) => job.error(error)) {\n    const startPromise = new Promise(onStart => {\n      this.jobQueue.push({\n        name,\n        onMessage,\n        onError,\n        onStart\n      });\n      return this;\n    });\n\n    this._startQueuedJob();\n\n    return await startPromise;\n  }\n\n  async _startQueuedJob() {\n    if (!this.jobQueue.length) {\n      return;\n    }\n\n    const workerThread = this._getAvailableWorker();\n\n    if (!workerThread) {\n      return;\n    }\n\n    const queuedJob = this.jobQueue.shift();\n\n    if (queuedJob) {\n      this.onDebug({\n        message: 'Starting job',\n        name: queuedJob.name,\n        workerThread,\n        backlog: this.jobQueue.length\n      });\n      const job = new WorkerJob(queuedJob.name, workerThread);\n\n      workerThread.onMessage = data => queuedJob.onMessage(job, data.type, data.payload);\n\n      workerThread.onError = error => queuedJob.onError(job, error);\n\n      queuedJob.onStart(job);\n\n      try {\n        await job.result;\n      } finally {\n        this.returnWorkerToQueue(workerThread);\n      }\n    }\n  }\n\n  returnWorkerToQueue(worker) {\n    const shouldDestroyWorker = this.isDestroyed || !this.reuseWorkers || this.count > this._getMaxConcurrency();\n\n    if (shouldDestroyWorker) {\n      worker.destroy();\n      this.count--;\n    } else {\n      this.idleQueue.push(worker);\n    }\n\n    if (!this.isDestroyed) {\n      this._startQueuedJob();\n    }\n  }\n\n  _getAvailableWorker() {\n    if (this.idleQueue.length > 0) {\n      return this.idleQueue.shift() || null;\n    }\n\n    if (this.count < this._getMaxConcurrency()) {\n      this.count++;\n      const name = `${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;\n      return new WorkerThread({\n        name,\n        source: this.source,\n        url: this.url\n      });\n    }\n\n    return null;\n  }\n\n  _getMaxConcurrency() {\n    return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n  }\n\n}\n//# sourceMappingURL=worker-pool.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport WorkerPool from './worker-pool';\nimport WorkerThread from './worker-thread';\nconst DEFAULT_PROPS = {\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  onDebug: () => {},\n  reuseWorkers: true\n};\nexport default class WorkerFarm {\n  static isSupported() {\n    return WorkerThread.isSupported();\n  }\n\n  static getWorkerFarm(props = {}) {\n    WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n\n    WorkerFarm._workerFarm.setProps(props);\n\n    return WorkerFarm._workerFarm;\n  }\n\n  constructor(props) {\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"workerPools\", new Map());\n\n    this.props = { ...DEFAULT_PROPS\n    };\n    this.setProps(props);\n    this.workerPools = new Map();\n  }\n\n  destroy() {\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.destroy();\n    }\n  }\n\n  setProps(props) {\n    this.props = { ...this.props,\n      ...props\n    };\n\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.setProps(this._getWorkerPoolProps());\n    }\n  }\n\n  getWorkerPool(options) {\n    const {\n      name,\n      source,\n      url\n    } = options;\n    let workerPool = this.workerPools.get(name);\n\n    if (!workerPool) {\n      workerPool = new WorkerPool({\n        name,\n        source,\n        url\n      });\n      workerPool.setProps(this._getWorkerPoolProps());\n      this.workerPools.set(name, workerPool);\n    }\n\n    return workerPool;\n  }\n\n  _getWorkerPoolProps() {\n    return {\n      maxConcurrency: this.props.maxConcurrency,\n      maxMobileConcurrency: this.props.maxMobileConcurrency,\n      reuseWorkers: this.props.reuseWorkers,\n      onDebug: this.props.onDebug\n    };\n  }\n\n}\n\n_defineProperty(WorkerFarm, \"_workerFarm\", void 0);\n//# sourceMappingURL=worker-farm.js.map","import { WorkerFarm, getWorkerURL } from '@loaders.gl/worker-utils';\nexport function canParseWithWorker(loader, options) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  return loader.worker && (options === null || options === void 0 ? void 0 : options.worker);\n}\nexport async function parseWithWorker(loader, data, options, context, parseOnMainThread) {\n  const name = loader.id;\n  const url = getWorkerURL(loader, options);\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({\n    name,\n    url\n  });\n  options = JSON.parse(JSON.stringify(options));\n  const job = await workerPool.startJob('process-on-worker', onMessage.bind(null, parseOnMainThread));\n  job.postMessage('process', {\n    input: data,\n    options\n  });\n  const result = await job.result;\n  return await result.result;\n}\n\nasync function onMessage(parseOnMainThread, job, type, payload) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n\n    case 'error':\n      job.error(payload.error);\n      break;\n\n    case 'process':\n      const {\n        id,\n        input,\n        options\n      } = payload;\n\n      try {\n        const result = await parseOnMainThread(input, options);\n        job.postMessage('done', {\n          id,\n          result\n        });\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {\n          id,\n          error: message\n        });\n      }\n\n      break;\n\n    default:\n      console.warn(`parse-with-worker unknown message ${type}`);\n  }\n}\n//# sourceMappingURL=parse-with-worker.js.map","import { assert } from '../env-utils/assert';\nimport { VERSION as __VERSION__ } from '../env-utils/version';\nconst NPM_TAG = 'latest';\nconst VERSION = typeof \"3.0.9\" !== 'undefined' ? \"3.0.9\" : NPM_TAG;\nexport function getWorkerName(worker) {\n  const warning = worker.version !== VERSION ? ` (worker-utils@${VERSION})` : '';\n  return `${worker.name}@${worker.version}${warning}`;\n}\nexport function getWorkerURL(worker, options = {}) {\n  const workerOptions = options[worker.id] || {};\n  const workerFile = `${worker.id}-worker.js`;\n  let url = workerOptions.workerUrl;\n\n  if (options._workerType === 'test') {\n    url = `modules/${worker.module}/dist/${workerFile}`;\n  }\n\n  if (!url) {\n    let version = worker.version;\n\n    if (version === 'latest') {\n      version = NPM_TAG;\n    }\n\n    const versionTag = version ? `@${version}` : '';\n    url = `https://unpkg.com/@loaders.gl/${worker.module}${versionTag}/dist/${workerFile}`;\n  }\n\n  assert(url);\n  return url;\n}\n//# sourceMappingURL=get-worker-url.js.map","import * as node from '../node/buffer-utils.node';\nexport function toArrayBuffer(data) {\n  if (node.toArrayBuffer) {\n    data = node.toArrayBuffer(data);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return data;\n  }\n\n  if (ArrayBuffer.isView(data)) {\n    return data.buffer;\n  }\n\n  if (typeof data === 'string') {\n    const text = data;\n    const uint8Array = new TextEncoder().encode(text);\n    return uint8Array.buffer;\n  }\n\n  if (data && typeof data === 'object' && data._toArrayBuffer) {\n    return data._toArrayBuffer();\n  }\n\n  throw new Error('toArrayBuffer');\n}\nexport function compareArrayBuffers(arrayBuffer1, arrayBuffer2, byteLength) {\n  byteLength = byteLength || arrayBuffer1.byteLength;\n\n  if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n    return false;\n  }\n\n  const array1 = new Uint8Array(arrayBuffer1);\n  const array2 = new Uint8Array(arrayBuffer2);\n\n  for (let i = 0; i < array1.length; ++i) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\nexport function concatenateArrayBuffers(...sources) {\n  const sourceArrays = sources.map(source2 => source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2);\n  const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n  const result = new Uint8Array(byteLength);\n  let offset = 0;\n\n  for (const sourceArray of sourceArrays) {\n    result.set(sourceArray, offset);\n    offset += sourceArray.byteLength;\n  }\n\n  return result.buffer;\n}\nexport function concatenateTypedArrays(...typedArrays) {\n  const arrays = typedArrays;\n  const TypedArrayConstructor = arrays && arrays.length > 1 && arrays[0].constructor || null;\n\n  if (!TypedArrayConstructor) {\n    throw new Error('\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types');\n  }\n\n  const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n  const result = new TypedArrayConstructor(sumLength);\n  let offset = 0;\n\n  for (const array of arrays) {\n    result.set(array, offset);\n    offset += array.length;\n  }\n\n  return result;\n}\nexport function sliceArrayBuffer(arrayBuffer, byteOffset, byteLength) {\n  const subArray = byteLength !== undefined ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength) : new Uint8Array(arrayBuffer).subarray(byteOffset);\n  const arrayCopy = new Uint8Array(subArray);\n  return arrayCopy.buffer;\n}\n//# sourceMappingURL=array-buffer-utils.js.map","import { concatenateArrayBuffers } from '../binary-utils/array-buffer-utils';\nexport async function forEach(iterator, visitor) {\n  while (true) {\n    const {\n      done,\n      value\n    } = await iterator.next();\n\n    if (done) {\n      iterator.return();\n      return;\n    }\n\n    const cancel = visitor(value);\n\n    if (cancel) {\n      return;\n    }\n  }\n}\nexport async function concatenateArrayBuffersAsync(asyncIterator) {\n  const arrayBuffers = [];\n\n  for await (const chunk of asyncIterator) {\n    arrayBuffers.push(chunk);\n  }\n\n  return concatenateArrayBuffers(...arrayBuffers);\n}\nexport async function concatenateStringsAsync(asyncIterator) {\n  const strings = [];\n\n  for await (const chunk of asyncIterator) {\n    strings.push(chunk);\n  }\n\n  return strings.join('');\n}\n//# sourceMappingURL=async-iteration.js.map","export default function getHiResTimestamp() {\n  let timestamp;\n\n  if (typeof window !== 'undefined' && window.performance) {\n    timestamp = window.performance.now();\n  } else if (typeof process !== 'undefined' && process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import getHiResTimestamp from '../utils/hi-res-timestamp';\nexport default class Stat {\n  constructor(name, type) {\n    this.name = name;\n    this.type = type;\n    this.sampleSize = 1;\n    this.reset();\n  }\n\n  setSampleSize(samples) {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  incrementCount() {\n    this.addCount(1);\n    return this;\n  }\n\n  decrementCount() {\n    this.subtractCount(1);\n    return this;\n  }\n\n  addCount(value) {\n    this._count += value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  subtractCount(value) {\n    this._count -= value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  addTime(time) {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  timeStart() {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n    return this;\n  }\n\n  timeEnd() {\n    if (!this._timerPending) {\n      return this;\n    }\n\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount() {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  getSampleAverageTime() {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  getSampleHz() {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount() {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  getAverageTime() {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  getHz() {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  reset() {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n    return this;\n  }\n\n  _checkSampling() {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n\n}\n//# sourceMappingURL=stat.js.map","import Stat from './stat';\nexport default class Stats {\n  constructor({\n    id,\n    stats\n  }) {\n    this.id = id;\n    this.stats = {};\n\n    this._initializeStats(stats);\n\n    Object.seal(this);\n  }\n\n  get(name, type = 'count') {\n    return this._getOrCreate({\n      name,\n      type\n    });\n  }\n\n  get size() {\n    return Object.keys(this.stats).length;\n  }\n\n  reset() {\n    for (const key in this.stats) {\n      this.stats[key].reset();\n    }\n\n    return this;\n  }\n\n  forEach(fn) {\n    for (const key in this.stats) {\n      fn(this.stats[key]);\n    }\n  }\n\n  getTable() {\n    const table = {};\n    this.forEach(stat => {\n      table[stat.name] = {\n        time: stat.time || 0,\n        count: stat.count || 0,\n        average: stat.getAverageTime() || 0,\n        hz: stat.getHz() || 0\n      };\n    });\n    return table;\n  }\n\n  _initializeStats(stats = []) {\n    stats.forEach(stat => this._getOrCreate(stat));\n  }\n\n  _getOrCreate(stat) {\n    if (!stat || !stat.name) {\n      return null;\n    }\n\n    const {\n      name,\n      type\n    } = stat;\n\n    if (!this.stats[name]) {\n      if (stat instanceof Stat) {\n        this.stats[name] = stat;\n      } else {\n        this.stats[name] = new Stat(name, type);\n      }\n    }\n\n    return this.stats[name];\n  }\n\n}\n//# sourceMappingURL=stats.js.map","let pathPrefix = '';\nconst fileAliases = {};\nexport function setPathPrefix(prefix) {\n  pathPrefix = prefix;\n}\nexport function getPathPrefix() {\n  return pathPrefix;\n}\nexport function addAliases(aliases) {\n  Object.assign(fileAliases, aliases);\n}\nexport function resolvePath(filename) {\n  for (const alias in fileAliases) {\n    if (filename.startsWith(alias)) {\n      const replacement = fileAliases[alias];\n      filename = filename.replace(alias, replacement);\n    }\n  }\n\n  if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n    filename = `${pathPrefix}${filename}`;\n  }\n\n  return filename;\n}\n//# sourceMappingURL=file-aliases.js.map","const isBoolean = x => typeof x === 'boolean';\n\nconst isFunction = x => typeof x === 'function';\n\nexport const isObject = x => x !== null && typeof x === 'object';\nexport const isPureObject = x => isObject(x) && x.constructor === {}.constructor;\nexport const isPromise = x => isObject(x) && isFunction(x.then);\nexport const isIterable = x => x && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable = x => x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator = x => x && isFunction(x.next);\nexport const isResponse = x => typeof Response !== 'undefined' && x instanceof Response || x && x.arrayBuffer && x.text && x.json;\nexport const isFile = x => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob = x => typeof Blob !== 'undefined' && x instanceof Blob;\nexport const isWritableDOMStream = x => isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\nexport const isReadableDOMStream = x => typeof ReadableStream !== 'undefined' && x instanceof ReadableStream || isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader);\nexport const isBuffer = x => x && typeof x === 'object' && x.isBuffer;\nexport const isWritableNodeStream = x => isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream = x => isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream = x => isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream = x => isWritableDOMStream(x) || isWritableNodeStream(x);\n//# sourceMappingURL=is-type.js.map","const DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\nexport function parseMIMEType(mimeString) {\n  const matches = MIME_TYPE_PATTERN.exec(mimeString);\n\n  if (matches) {\n    return matches[1];\n  }\n\n  return mimeString;\n}\nexport function parseMIMETypeFromURL(url) {\n  const matches = DATA_URL_PATTERN.exec(url);\n\n  if (matches) {\n    return matches[1];\n  }\n\n  return '';\n}\n//# sourceMappingURL=mime-type-utils.js.map","import { isResponse, isBlob } from '../../javascript-utils/is-type';\nimport { parseMIMEType, parseMIMETypeFromURL } from './mime-type-utils';\nconst QUERY_STRING_PATTERN = /\\?.*/;\nexport function getResourceUrlAndType(resource) {\n  if (isResponse(resource)) {\n    const url = stripQueryString(resource.url || '');\n    const contentTypeHeader = resource.headers.get('content-type') || '';\n    return {\n      url,\n      type: parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(url)\n    };\n  }\n\n  if (isBlob(resource)) {\n    return {\n      url: stripQueryString(resource.name || ''),\n      type: resource.type || ''\n    };\n  }\n\n  if (typeof resource === 'string') {\n    return {\n      url: stripQueryString(resource),\n      type: parseMIMETypeFromURL(resource)\n    };\n  }\n\n  return {\n    url: '',\n    type: ''\n  };\n}\nexport function getResourceContentLength(resource) {\n  if (isResponse(resource)) {\n    return resource.headers['content-length'] || -1;\n  }\n\n  if (isBlob(resource)) {\n    return resource.size;\n  }\n\n  if (typeof resource === 'string') {\n    return resource.length;\n  }\n\n  if (resource instanceof ArrayBuffer) {\n    return resource.byteLength;\n  }\n\n  if (ArrayBuffer.isView(resource)) {\n    return resource.byteLength;\n  }\n\n  return -1;\n}\n\nfunction stripQueryString(url) {\n  return url.replace(QUERY_STRING_PATTERN, '');\n}\n//# sourceMappingURL=resource-utils.js.map","import { isResponse } from '../../javascript-utils/is-type';\nimport { getResourceContentLength, getResourceUrlAndType } from './resource-utils';\nexport async function makeResponse(resource) {\n  if (isResponse(resource)) {\n    return resource;\n  }\n\n  const headers = {};\n  const contentLength = getResourceContentLength(resource);\n\n  if (contentLength >= 0) {\n    headers['content-length'] = String(contentLength);\n  }\n\n  const {\n    url,\n    type\n  } = getResourceUrlAndType(resource);\n\n  if (type) {\n    headers['content-type'] = type;\n  }\n\n  const initialDataUrl = await getInitialDataUrl(resource);\n\n  if (initialDataUrl) {\n    headers['x-first-bytes'] = initialDataUrl;\n  }\n\n  if (typeof resource === 'string') {\n    resource = new TextEncoder().encode(resource);\n  }\n\n  const response = new Response(resource, {\n    headers\n  });\n  Object.defineProperty(response, 'url', {\n    value: url\n  });\n  return response;\n}\nexport async function checkResponse(response) {\n  if (!response.ok) {\n    const message = await getResponseError(response);\n    throw new Error(message);\n  }\n}\nexport function checkResponseSync(response) {\n  if (!response.ok) {\n    let message = `${response.status} ${response.statusText}`;\n    message = message.length > 60 ? `${message.slice(60)}...` : message;\n    throw new Error(message);\n  }\n}\n\nasync function getResponseError(response) {\n  let message = `Failed to fetch resource ${response.url} (${response.status}): `;\n\n  try {\n    const contentType = response.headers.get('Content-Type');\n    let text = response.statusText;\n\n    if (contentType.includes('application/json')) {\n      text += ` ${await response.text()}`;\n    }\n\n    message += text;\n    message = message.length > 60 ? `${message.slice(60)}...` : message;\n  } catch (error) {}\n\n  return message;\n}\n\nasync function getInitialDataUrl(resource) {\n  const INITIAL_DATA_LENGTH = 5;\n\n  if (typeof resource === 'string') {\n    return `data:,${resource.slice(0, INITIAL_DATA_LENGTH)}`;\n  }\n\n  if (resource instanceof Blob) {\n    const blobSlice = resource.slice(0, 5);\n    return await new Promise(resolve => {\n      const reader = new FileReader();\n\n      reader.onload = event => {\n        var _event$target;\n\n        return resolve(event === null || event === void 0 ? void 0 : (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.result);\n      };\n\n      reader.readAsDataURL(blobSlice);\n    });\n  }\n\n  if (resource instanceof ArrayBuffer) {\n    const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n    const base64 = arrayBufferToBase64(slice);\n    return `data:base64,${base64}`;\n  }\n\n  return null;\n}\n\nfunction arrayBufferToBase64(buffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n\n  return btoa(binary);\n}\n//# sourceMappingURL=response-utils.js.map","import { resolvePath } from '@loaders.gl/loader-utils';\nimport { makeResponse } from '../utils/response-utils';\nexport async function fetchFile(url, options) {\n  if (typeof url === 'string') {\n    url = resolvePath(url);\n    let fetchOptions = options;\n\n    if (options !== null && options !== void 0 && options.fetch && typeof (options === null || options === void 0 ? void 0 : options.fetch) !== 'function') {\n      fetchOptions = options.fetch;\n    }\n\n    return await fetch(url, fetchOptions);\n  }\n\n  return await makeResponse(url);\n}\n//# sourceMappingURL=fetch-file.js.map","export default function isElectron(mockUserAgent) {\n  if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n    return true;\n  }\n\n  if (typeof process !== 'undefined' && typeof process.versions === 'object' && Boolean(process.versions.electron)) {\n    return true;\n  }\n\n  const realUserAgent = typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=is-electron.js.map","import isElectron from './is-electron';\nexport default function isBrowser() {\n  const isNode = typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n  return !isNode || isElectron();\n}\nexport function isBrowserMainThread() {\n  return isBrowser() && typeof document !== 'undefined';\n}\n//# sourceMappingURL=is-browser.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document,\n  process: typeof process === 'object' && process\n};\nconst self_ = globals.self || globals.window || globals.global;\nconst window_ = globals.window || globals.self || globals.global;\nconst global_ = globals.global || globals.self || globals.window;\nconst document_ = globals.document || {};\nconst process_ = globals.process || {};\nconst console_ = console;\nexport { self_ as self, window_ as window, global_ as global, document_ as document, process_ as process, console_ as console };\n//# sourceMappingURL=globals.js.map","import checkIfBrowser from '../env/is-browser';\nexport { self, window, global, document, process, console } from '../env/globals';\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\nexport const isBrowser = checkIfBrowser();\n//# sourceMappingURL=globals.js.map","function getStorage(type) {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport default class LocalStorage {\n  constructor(id, defaultSettings, type = 'sessionStorage') {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = {};\n    Object.assign(this.config, defaultSettings);\n\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    this.config = {};\n    return this.updateConfiguration(configuration);\n  }\n\n  updateConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n\n    return this;\n  }\n\n  _loadConfiguration() {\n    let configuration = {};\n\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n\n    Object.assign(this.config, configuration);\n    return this;\n  }\n\n}\n//# sourceMappingURL=local-storage.js.map","export function formatTime(ms) {\n  let formatted;\n\n  if (ms < 10) {\n    formatted = \"\".concat(ms.toFixed(2), \"ms\");\n  } else if (ms < 100) {\n    formatted = \"\".concat(ms.toFixed(1), \"ms\");\n  } else if (ms < 1000) {\n    formatted = \"\".concat(ms.toFixed(0), \"ms\");\n  } else {\n    formatted = \"\".concat((ms / 1000).toFixed(2), \"s\");\n  }\n\n  return formatted;\n}\nexport function leftPad(string, length = 8) {\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(' '.repeat(padLength)).concat(string);\n}\nexport function rightPad(string, length = 8) {\n  const padLength = Math.max(length - string.length, 0);\n  return \"\".concat(string).concat(' '.repeat(padLength));\n}\nexport function formatValue(v, opts = {}) {\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = opts;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\nfunction formatArrayValue(v, opts) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = opts;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], opts);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatImage(image, message, scale, maxWidth = 600) {\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n  const style = ['font-size:1px;', \"padding:\".concat(Math.floor(height / 2), \"px \").concat(Math.floor(width / 2), \"px;\"), \"line-height:\".concat(height, \"px;\"), \"background:url(\".concat(imageUrl, \");\"), \"background-size:\".concat(width, \"px \").concat(height, \"px;\"), 'color:transparent;'].join('');\n  return [\"\".concat(message, \" %c+\"), style];\n}\n//# sourceMappingURL=formatters.js.map","import { isBrowser } from './globals';\nexport const COLOR = {\n  BLACK: 30,\n  RED: 31,\n  GREEN: 32,\n  YELLOW: 33,\n  BLUE: 34,\n  MAGENTA: 35,\n  CYAN: 36,\n  WHITE: 37,\n  BRIGHT_BLACK: 90,\n  BRIGHT_RED: 91,\n  BRIGHT_GREEN: 92,\n  BRIGHT_YELLOW: 93,\n  BRIGHT_BLUE: 94,\n  BRIGHT_MAGENTA: 95,\n  BRIGHT_CYAN: 96,\n  BRIGHT_WHITE: 97\n};\n\nfunction getColor(color) {\n  return typeof color === 'string' ? COLOR[color.toUpperCase()] || COLOR.WHITE : color;\n}\n\nexport function addColor(string, color, background) {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      color = getColor(color);\n      string = \"\\x1B[\".concat(color, \"m\").concat(string, \"\\x1B[39m\");\n    }\n\n    if (background) {\n      color = getColor(background);\n      string = \"\\x1B[\".concat(background + 10, \"m\").concat(string, \"\\x1B[49m\");\n    }\n  }\n\n  return string;\n}\n//# sourceMappingURL=color.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { window, process, isBrowser } from './globals';\nexport default function getHiResTimestamp() {\n  let timestamp;\n\n  if (isBrowser && window.performance) {\n    timestamp = window.performance.now();\n  } else if (process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n//# sourceMappingURL=hi-res-timestamp.js.map","import { VERSION, isBrowser } from '../utils/globals';\nimport LocalStorage from '../utils/local-storage';\nimport { formatImage, formatTime, leftPad } from '../utils/formatters';\nimport { addColor } from '../utils/color';\nimport { autobind } from '../utils/autobind';\nimport assert from '../utils/assert';\nimport getHiResTimestamp from '../utils/hi-res-timestamp';\nconst originalConsole = {\n  debug: isBrowser ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\nconst DEFAULT_SETTINGS = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {}\n\nconst cache = {};\nconst ONCE = {\n  once: true\n};\n\nfunction getTableHeader(table) {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n\n  return 'empty';\n}\n\nexport default class Log {\n  constructor({\n    id\n  } = {\n    id: ''\n  }) {\n    this.id = id;\n    this.VERSION = VERSION;\n    this._startTs = getHiResTimestamp();\n    this._deltaTs = getHiResTimestamp();\n    this.LOG_THROTTLE_TIMEOUT = 0;\n    this._storage = new LocalStorage(\"__probe-\".concat(this.id, \"__\"), DEFAULT_SETTINGS);\n    this.userData = {};\n    this.timeStamp(\"\".concat(this.id, \" started\"));\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel) {\n    this.setLevel(newLevel);\n  }\n\n  get level() {\n    return this.getLevel();\n  }\n\n  isEnabled() {\n    return this._storage.config.enabled;\n  }\n\n  getLevel() {\n    return this._storage.config.level;\n  }\n\n  getTotal() {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  getDelta() {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  set priority(newPriority) {\n    this.level = newPriority;\n  }\n\n  get priority() {\n    return this.level;\n  }\n\n  getPriority() {\n    return this.level;\n  }\n\n  enable(enabled = true) {\n    this._storage.updateConfiguration({\n      enabled\n    });\n\n    return this;\n  }\n\n  setLevel(level) {\n    this._storage.updateConfiguration({\n      level\n    });\n\n    return this;\n  }\n\n  assert(condition, message) {\n    assert(condition, message);\n  }\n\n  warn(message) {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  error(message) {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  deprecated(oldUsage, newUsage) {\n    return this.warn(\"`\".concat(oldUsage, \"` is deprecated and will be removed in a later version. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  removed(oldUsage, newUsage) {\n    return this.error(\"`\".concat(oldUsage, \"` has been removed. Use `\").concat(newUsage, \"` instead\"));\n  }\n\n  probe(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  log(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  info(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  once(logLevel, message) {\n    return this._getLogFunction(logLevel, message, originalConsole.debug || originalConsole.info, arguments, ONCE);\n  }\n\n  table(logLevel, table, columns) {\n    if (table) {\n      return this._getLogFunction(logLevel, table, console.table || noop, columns && [columns], {\n        tag: getTableHeader(table)\n      });\n    }\n\n    return noop;\n  }\n\n  image({\n    logLevel,\n    priority,\n    image,\n    message = '',\n    scale = 1\n  }) {\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n\n    return isBrowser ? logImageInBrowser({\n      image,\n      message,\n      scale\n    }) : logImageInNode({\n      image,\n      message,\n      scale\n    });\n  }\n\n  settings() {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  get(setting) {\n    return this._storage.config[setting];\n  }\n\n  set(setting, value) {\n    this._storage.updateConfiguration({\n      [setting]: value\n    });\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeEnd ? console.timeEnd : console.info);\n  }\n\n  timeStamp(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message, opts = {\n    collapsed: false\n  }) {\n    opts = normalizeArguments({\n      logLevel,\n      message,\n      opts\n    });\n    const {\n      collapsed\n    } = opts;\n    opts.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n    return this._getLogFunction(opts);\n  }\n\n  groupCollapsed(logLevel, message, opts = {}) {\n    return this.group(logLevel, message, Object.assign({}, opts, {\n      collapsed: true\n    }));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  withGroup(logLevel, message, func) {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace() {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  _shouldLog(logLevel) {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(logLevel, message, method, args = [], opts) {\n    if (this._shouldLog(logLevel)) {\n      opts = normalizeArguments({\n        logLevel,\n        message,\n        args,\n        opts\n      });\n      method = method || opts.method;\n      assert(method);\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      this._deltaTs = getHiResTimestamp();\n      const tag = opts.tag || opts.message;\n\n      if (opts.once) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      message = decorateMessage(this.id, opts.message, opts);\n      return method.bind(console, message, ...opts.args);\n    }\n\n    return noop;\n  }\n\n}\nLog.VERSION = VERSION;\n\nfunction normalizeLogLevel(logLevel) {\n  if (!logLevel) {\n    return 0;\n  }\n\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n  return resolvedLevel;\n}\n\nexport function normalizeArguments(opts) {\n  const {\n    logLevel,\n    message\n  } = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n  const args = opts.args ? Array.from(opts.args) : [];\n\n  while (args.length && args.shift() !== message) {}\n\n  opts.args = args;\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n\n  const messageType = typeof opts.message;\n  assert(messageType === 'string' || messageType === 'object');\n  return Object.assign(opts, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? \"\".concat(id, \": \").concat(time, \"  \").concat(message) : \"\".concat(id, \": \").concat(message);\n    message = addColor(message, opts.color, opts.background);\n  }\n\n  return message;\n}\n\nfunction logImageInNode({\n  image,\n  message = '',\n  scale = 1\n}) {\n  let asciify = null;\n\n  try {\n    asciify = module.require('asciify-image');\n  } catch (error) {}\n\n  if (asciify) {\n    return () => asciify(image, {\n      fit: 'box',\n      width: \"\".concat(Math.round(80 * scale), \"%\")\n    }).then(data => console.log(data));\n  }\n\n  return noop;\n}\n\nfunction logImageInBrowser({\n  image,\n  message = '',\n  scale = 1\n}) {\n  if (typeof image === 'string') {\n    const img = new Image();\n\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n\n    img.src = image;\n    return noop;\n  }\n\n  const element = image.nodeName || '';\n\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n\n    img.onload = () => console.log(...formatImage(img, message, scale));\n\n    img.src = image.toDataURL();\n    return noop;\n  }\n\n  return noop;\n}\n//# sourceMappingURL=log.js.map","export function autobind(obj, predefined = ['constructor']) {\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  for (const key of propNames) {\n    if (typeof obj[key] === 'function') {\n      if (!predefined.find(name => key === name)) {\n        obj[key] = obj[key].bind(obj);\n      }\n    }\n  }\n}\n//# sourceMappingURL=autobind.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Log } from 'probe.gl';\nexport const probeLog = new Log({\n  id: 'loaders.gl'\n});\nexport class NullLog {\n  log() {\n    return () => {};\n  }\n\n  info() {\n    return () => {};\n  }\n\n  warn() {\n    return () => {};\n  }\n\n  error() {\n    return () => {};\n  }\n\n}\nexport class ConsoleLog {\n  constructor() {\n    _defineProperty(this, \"console\", void 0);\n\n    this.console = console;\n  }\n\n  log(...args) {\n    return this.console.log.bind(this.console, ...args);\n  }\n\n  info(...args) {\n    return this.console.info.bind(this.console, ...args);\n  }\n\n  warn(...args) {\n    return this.console.warn.bind(this.console, ...args);\n  }\n\n  error(...args) {\n    return this.console.error.bind(this.console, ...args);\n  }\n\n}\n//# sourceMappingURL=loggers.js.map","import { ConsoleLog } from './loggers';\nexport const DEFAULT_LOADER_OPTIONS = {\n  fetch: null,\n  mimeType: undefined,\n  nothrow: false,\n  log: new ConsoleLog(),\n  CDN: 'https://unpkg.com/@loaders.gl',\n  worker: true,\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: true,\n  _workerType: '',\n  limit: 0,\n  _limitMB: 0,\n  batchSize: 'auto',\n  batchDebounceMs: 0,\n  metadata: false,\n  transforms: []\n};\nexport const REMOVED_LOADER_OPTIONS = {\n  throws: 'nothrow',\n  dataType: '(no longer used)',\n  uri: 'baseUri',\n  method: 'fetch.method',\n  headers: 'fetch.headers',\n  body: 'fetch.body',\n  mode: 'fetch.mode',\n  credentials: 'fetch.credentials',\n  cache: 'fetch.cache',\n  redirect: 'fetch.redirect',\n  referrer: 'fetch.referrer',\n  referrerPolicy: 'fetch.referrerPolicy',\n  integrity: 'fetch.integrity',\n  keepalive: 'fetch.keepalive',\n  signal: 'fetch.signal'\n};\n//# sourceMappingURL=option-defaults.js.map","import { global } from '@loaders.gl/loader-utils';\nimport { isPureObject, isObject } from '../../javascript-utils/is-type';\nimport { fetchFile } from '../fetch/fetch-file';\nimport { probeLog, NullLog } from './loggers';\nimport { DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS } from './option-defaults';\nexport function getGlobalLoaderState() {\n  global.loaders = global.loaders || {};\n  const {\n    loaders\n  } = global;\n  loaders._state = loaders._state || {};\n  return loaders._state;\n}\n\nconst getGlobalLoaderOptions = () => {\n  const state = getGlobalLoaderState();\n  state.globalOptions = state.globalOptions || { ...DEFAULT_LOADER_OPTIONS\n  };\n  return state.globalOptions;\n};\n\nexport function setGlobalOptions(options) {\n  const state = getGlobalLoaderState();\n  const globalOptions = getGlobalLoaderOptions();\n  state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n}\nexport function normalizeOptions(options, loader, loaders, url) {\n  loaders = loaders || [];\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n  validateOptions(options, loaders);\n  return normalizeOptionsInternal(loader, options, url);\n}\nexport function getFetchFunction(options, context) {\n  const globalOptions = getGlobalLoaderOptions();\n  const fetchOptions = options || globalOptions;\n\n  if (typeof fetchOptions.fetch === 'function') {\n    return fetchOptions.fetch;\n  }\n\n  if (isObject(fetchOptions.fetch)) {\n    return url => fetchFile(url, fetchOptions);\n  }\n\n  if (context !== null && context !== void 0 && context.fetch) {\n    return context === null || context === void 0 ? void 0 : context.fetch;\n  }\n\n  return fetchFile;\n}\n\nfunction validateOptions(options, loaders) {\n  validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n\n  for (const loader of loaders) {\n    const idOptions = options && options[loader.id] || {};\n    const loaderOptions = loader.options && loader.options[loader.id] || {};\n    const deprecatedOptions = loader.deprecatedOptions && loader.deprecatedOptions[loader.id] || {};\n    validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n  }\n}\n\nfunction validateOptionsObject(options, id, defaultOptions, deprecatedOptions, loaders) {\n  const loaderName = id || 'Top level';\n  const prefix = id ? `${id}.` : '';\n\n  for (const key in options) {\n    const isSubOptions = !id && isObject(options[key]);\n    const isBaseUriOption = key === 'baseUri' && !id;\n    const isWorkerUrlOption = key === 'workerUrl' && id;\n\n    if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n      if (key in deprecatedOptions) {\n        probeLog.warn(`${loaderName} loader option \\'${prefix}${key}\\' no longer supported, use \\'${deprecatedOptions[key]}\\'`)();\n      } else if (!isSubOptions) {\n        const suggestion = findSimilarOption(key, loaders);\n        probeLog.warn(`${loaderName} loader option \\'${prefix}${key}\\' not recognized. ${suggestion}`)();\n      }\n    }\n  }\n}\n\nfunction findSimilarOption(optionKey, loaders) {\n  const lowerCaseOptionKey = optionKey.toLowerCase();\n  let bestSuggestion = '';\n\n  for (const loader of loaders) {\n    for (const key in loader.options) {\n      if (optionKey === key) {\n        return `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n\n      const lowerCaseKey = key.toLowerCase();\n      const isPartialMatch = lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n\n      if (isPartialMatch) {\n        bestSuggestion = bestSuggestion || `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n    }\n  }\n\n  return bestSuggestion;\n}\n\nfunction normalizeOptionsInternal(loader, options, url) {\n  const loaderDefaultOptions = loader.options || {};\n  const mergedOptions = { ...loaderDefaultOptions\n  };\n  addUrlOptions(mergedOptions, url);\n\n  if (mergedOptions.log === null) {\n    mergedOptions.log = new NullLog();\n  }\n\n  mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n  mergeNestedFields(mergedOptions, options);\n  return mergedOptions;\n}\n\nfunction mergeNestedFields(mergedOptions, options) {\n  for (const key in options) {\n    if (key in options) {\n      const value = options[key];\n\n      if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n        mergedOptions[key] = { ...mergedOptions[key],\n          ...options[key]\n        };\n      } else {\n        mergedOptions[key] = options[key];\n      }\n    }\n  }\n}\n\nfunction addUrlOptions(options, url) {\n  if (url && !('baseUri' in options)) {\n    options.baseUri = url;\n  }\n}\n//# sourceMappingURL=option-utils.js.map","import { assert } from '@loaders.gl/loader-utils';\nexport function isLoaderObject(loader) {\n  var _loader;\n\n  if (!loader) {\n    return false;\n  }\n\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n\n  const hasExtensions = Array.isArray((_loader = loader) === null || _loader === void 0 ? void 0 : _loader.extensions);\n  return hasExtensions;\n}\nexport function normalizeLoader(loader) {\n  var _loader2, _loader3;\n\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n  let options;\n\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = { ...loader,\n      options: { ...loader.options,\n        ...options\n      }\n    };\n  }\n\n  if ((_loader2 = loader) !== null && _loader2 !== void 0 && _loader2.parseTextSync || (_loader3 = loader) !== null && _loader3 !== void 0 && _loader3.parseText) {\n    loader.text = true;\n  }\n\n  if (!loader.text) {\n    loader.binary = true;\n  }\n\n  return loader;\n}\n//# sourceMappingURL=normalize-loader.js.map","import { normalizeLoader } from '../loader-utils/normalize-loader';\nimport { getGlobalLoaderState } from '../loader-utils/option-utils';\n\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\n\nexport function registerLoaders(loaders) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n\n    if (!loaderRegistry.find(registeredLoader => normalizedLoader === registeredLoader)) {\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\nexport function getRegisteredLoaders() {\n  return getGlobalLoaderRegistry();\n}\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n//# sourceMappingURL=register-loaders.js.map","import { compareArrayBuffers } from '@loaders.gl/loader-utils';\nimport { normalizeLoader } from '../loader-utils/normalize-loader';\nimport { getResourceUrlAndType } from '../utils/resource-utils';\nimport { getRegisteredLoaders } from './register-loaders';\nimport { isBlob } from '../../javascript-utils/is-type';\nconst EXT_PATTERN = /\\.([^.]+)$/;\nexport async function selectLoader(data, loaders = [], options, context) {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  let loader = selectLoaderSync(data, loaders, { ...options,\n    nothrow: true\n  }, context);\n\n  if (loader) {\n    return loader;\n  }\n\n  if (isBlob(data)) {\n    data = await data.slice(0, 10).arrayBuffer();\n    loader = selectLoaderSync(data, loaders, options, context);\n  }\n\n  if (!loader && !(options !== null && options !== void 0 && options.nothrow)) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\nexport function selectLoaderSync(data, loaders = [], options, context) {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  if (loaders && !Array.isArray(loaders)) {\n    return normalizeLoader(loaders);\n  }\n\n  let candidateLoaders = [];\n\n  if (loaders) {\n    candidateLoaders = candidateLoaders.concat(loaders);\n  }\n\n  if (!(options !== null && options !== void 0 && options.ignoreRegisteredLoaders)) {\n    candidateLoaders.push(...getRegisteredLoaders());\n  }\n\n  normalizeLoaders(candidateLoaders);\n  const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n\n  if (!loader && !(options !== null && options !== void 0 && options.nothrow)) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\nfunction selectLoaderInternal(data, loaders, options, context) {\n  const {\n    url,\n    type\n  } = getResourceUrlAndType(data);\n  const testUrl = url || (context === null || context === void 0 ? void 0 : context.url);\n  let loader = null;\n\n  if (options !== null && options !== void 0 && options.mimeType) {\n    loader = findLoaderByMIMEType(loaders, options === null || options === void 0 ? void 0 : options.mimeType);\n  }\n\n  loader = loader || findLoaderByUrl(loaders, testUrl);\n  loader = loader || findLoaderByMIMEType(loaders, type);\n  loader = loader || findLoaderByInitialBytes(loaders, data);\n  loader = loader || findLoaderByMIMEType(loaders, options === null || options === void 0 ? void 0 : options.fallbackMimeType);\n  return loader;\n}\n\nfunction validHTTPResponse(data) {\n  if (data instanceof Response) {\n    if (data.status === 204) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getNoValidLoaderMessage(data) {\n  const {\n    url,\n    type\n  } = getResourceUrlAndType(data);\n  let message = 'No valid loader found';\n\n  if (data) {\n    message += ` data: \"${getFirstCharacters(data)}\", contentType: \"${type}\"`;\n  }\n\n  if (url) {\n    message += ` url: ${url}`;\n  }\n\n  return message;\n}\n\nfunction normalizeLoaders(loaders) {\n  for (const loader of loaders) {\n    normalizeLoader(loader);\n  }\n}\n\nfunction findLoaderByUrl(loaders, url) {\n  const match = url && EXT_PATTERN.exec(url);\n  const extension = match && match[1];\n  return extension ? findLoaderByExtension(loaders, extension) : null;\n}\n\nfunction findLoaderByExtension(loaders, extension) {\n  extension = extension.toLowerCase();\n\n  for (const loader of loaders) {\n    for (const loaderExtension of loader.extensions) {\n      if (loaderExtension.toLowerCase() === extension) {\n        return loader;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction findLoaderByMIMEType(loaders, mimeType) {\n  for (const loader of loaders) {\n    if (loader.mimeTypes && loader.mimeTypes.includes(mimeType)) {\n      return loader;\n    }\n\n    if (mimeType === `application/x.${loader.id}`) {\n      return loader;\n    }\n  }\n\n  return null;\n}\n\nfunction findLoaderByInitialBytes(loaders, data) {\n  if (!data) {\n    return null;\n  }\n\n  for (const loader of loaders) {\n    if (typeof data === 'string') {\n      if (testDataAgainstText(data, loader)) {\n        return loader;\n      }\n    } else if (ArrayBuffer.isView(data)) {\n      if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n        return loader;\n      }\n    } else if (data instanceof ArrayBuffer) {\n      const byteOffset = 0;\n\n      if (testDataAgainstBinary(data, byteOffset, loader)) {\n        return loader;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction testDataAgainstText(data, loader) {\n  if (loader.testText) {\n    return loader.testText(data);\n  }\n\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some(test => data.startsWith(test));\n}\n\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some(test => testBinary(data, byteOffset, loader, test));\n}\n\nfunction testBinary(data, byteOffset, loader, test) {\n  if (test instanceof ArrayBuffer) {\n    return compareArrayBuffers(test, data, test.byteLength);\n  }\n\n  switch (typeof test) {\n    case 'function':\n      return test(data, loader);\n\n    case 'string':\n      const magic = getMagicString(data, byteOffset, test.length);\n      return test === magic;\n\n    default:\n      return false;\n  }\n}\n\nfunction getFirstCharacters(data, length = 5) {\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n\n  return '';\n}\n\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n  if (arrayBuffer.byteLength < byteOffset + length) {\n    return '';\n  }\n\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n\n  return magic;\n}\n//# sourceMappingURL=select-loader.js.map","const DEFAULT_CHUNK_SIZE = 256 * 1024;\nexport function* makeArrayBufferIterator(arrayBuffer, options = {}) {\n  const {\n    chunkSize = DEFAULT_CHUNK_SIZE\n  } = options;\n  let byteOffset = 0;\n\n  while (byteOffset < arrayBuffer.byteLength) {\n    const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n    const chunk = new ArrayBuffer(chunkByteLength);\n    const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n    const chunkArray = new Uint8Array(chunk);\n    chunkArray.set(sourceArray);\n    byteOffset += chunkByteLength;\n    yield chunk;\n  }\n}\n//# sourceMappingURL=make-array-buffer-iterator.js.map","import { isBrowser, toArrayBuffer } from '@loaders.gl/loader-utils';\nexport function makeStreamIterator(stream, options) {\n  return isBrowser ? makeBrowserStreamIterator(stream, options) : makeNodeStreamIterator(stream, options);\n}\n\nasync function* makeBrowserStreamIterator(stream, options) {\n  const reader = stream.getReader();\n  let nextBatchPromise;\n\n  try {\n    while (true) {\n      const currentBatchPromise = nextBatchPromise || reader.read();\n\n      if (options !== null && options !== void 0 && options._streamReadAhead) {\n        nextBatchPromise = reader.read();\n      }\n\n      const {\n        done,\n        value\n      } = await currentBatchPromise;\n\n      if (done) {\n        return;\n      }\n\n      yield toArrayBuffer(value);\n    }\n  } catch (error) {\n    reader.releaseLock();\n  }\n}\n\nasync function* makeNodeStreamIterator(stream, options) {\n  for await (const chunk of stream) {\n    yield toArrayBuffer(chunk);\n  }\n}\n//# sourceMappingURL=make-stream-iterator.js.map","import { makeStringIterator } from './make-string-iterator';\nimport { makeArrayBufferIterator } from './make-array-buffer-iterator';\nimport { makeBlobIterator } from './make-blob-iterator';\nimport { makeStreamIterator } from './make-stream-iterator';\nimport { isBlob, isReadableStream, isResponse } from '../../javascript-utils/is-type';\nexport function makeIterator(data, options) {\n  if (typeof data === 'string') {\n    return makeStringIterator(data, options);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return makeArrayBufferIterator(data, options);\n  }\n\n  if (isBlob(data)) {\n    return makeBlobIterator(data, options);\n  }\n\n  if (isReadableStream(data)) {\n    return makeStreamIterator(data, options);\n  }\n\n  if (isResponse(data)) {\n    const response = data;\n    return makeStreamIterator(response.body, options);\n  }\n\n  throw new Error('makeIterator');\n}\n//# sourceMappingURL=make-iterator.js.map","const DEFAULT_CHUNK_SIZE = 256 * 1024;\nexport function* makeStringIterator(string, options) {\n  const chunkSize = (options === null || options === void 0 ? void 0 : options.chunkSize) || DEFAULT_CHUNK_SIZE;\n  let offset = 0;\n  const textEncoder = new TextEncoder();\n\n  while (offset < string.length) {\n    const chunkLength = Math.min(string.length - offset, chunkSize);\n    const chunk = string.slice(offset, offset + chunkLength);\n    offset += chunkLength;\n    yield textEncoder.encode(chunk);\n  }\n}\n//# sourceMappingURL=make-string-iterator.js.map","const DEFAULT_CHUNK_SIZE = 1024 * 1024;\nexport async function* makeBlobIterator(blob, options) {\n  const chunkSize = (options === null || options === void 0 ? void 0 : options.chunkSize) || DEFAULT_CHUNK_SIZE;\n  let offset = 0;\n\n  while (offset < blob.size) {\n    const end = offset + chunkSize;\n    const chunk = await blob.slice(offset, end).arrayBuffer();\n    offset = end;\n    yield chunk;\n  }\n}\n//# sourceMappingURL=make-blob-iterator.js.map","import { concatenateArrayBuffersAsync } from '@loaders.gl/loader-utils';\nimport { isResponse, isReadableStream, isAsyncIterable, isIterable, isIterator, isBlob, isBuffer } from '../../javascript-utils/is-type';\nimport { makeIterator } from '../../iterators/make-iterator/make-iterator';\nimport { checkResponse, makeResponse } from '../utils/response-utils';\nconst ERR_DATA = 'Cannot convert supplied data type';\nexport function getArrayBufferOrStringFromDataSync(data, loader, options) {\n  if (loader.text && typeof data === 'string') {\n    return data;\n  }\n\n  if (isBuffer(data)) {\n    data = data.buffer;\n  }\n\n  if (data instanceof ArrayBuffer) {\n    const arrayBuffer = data;\n\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(arrayBuffer);\n    }\n\n    return arrayBuffer;\n  }\n\n  if (ArrayBuffer.isView(data)) {\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(data);\n    }\n\n    let arrayBuffer = data.buffer;\n    const byteLength = data.byteLength || data.length;\n\n    if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n      arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n    }\n\n    return arrayBuffer;\n  }\n\n  throw new Error(ERR_DATA);\n}\nexport async function getArrayBufferOrStringFromData(data, loader, options) {\n  const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n\n  if (typeof data === 'string' || isArrayBuffer) {\n    return getArrayBufferOrStringFromDataSync(data, loader, options);\n  }\n\n  if (isBlob(data)) {\n    data = await makeResponse(data);\n  }\n\n  if (isResponse(data)) {\n    const response = data;\n    await checkResponse(response);\n    return loader.binary ? await response.arrayBuffer() : await response.text();\n  }\n\n  if (isReadableStream(data)) {\n    data = makeIterator(data, options);\n  }\n\n  if (isIterable(data) || isAsyncIterable(data)) {\n    return concatenateArrayBuffersAsync(data);\n  }\n\n  throw new Error(ERR_DATA);\n}\nexport async function getAsyncIterableFromData(data, options) {\n  if (isIterator(data)) {\n    return data;\n  }\n\n  if (isResponse(data)) {\n    const response = data;\n    await checkResponse(response);\n    const body = await response.body;\n    return makeIterator(body, options);\n  }\n\n  if (isBlob(data) || isReadableStream(data)) {\n    return makeIterator(data, options);\n  }\n\n  if (isAsyncIterable(data)) {\n    return data[Symbol.asyncIterator]();\n  }\n\n  return getIterableFromData(data);\n}\nexport async function getReadableStream(data) {\n  if (isReadableStream(data)) {\n    return data;\n  }\n\n  if (isResponse(data)) {\n    return data.body;\n  }\n\n  const response = await makeResponse(data);\n  return response.body;\n}\n\nfunction getIterableFromData(data) {\n  if (ArrayBuffer.isView(data)) {\n    return function* oneChunk() {\n      yield data.buffer;\n    }();\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return function* oneChunk() {\n      yield data;\n    }();\n  }\n\n  if (isIterator(data)) {\n    return data;\n  }\n\n  if (isIterable(data)) {\n    return data[Symbol.iterator]();\n  }\n\n  throw new Error(ERR_DATA);\n}\n//# sourceMappingURL=get-data.js.map","import { assert, validateWorkerVersion } from '@loaders.gl/worker-utils';\nimport { parseWithWorker, canParseWithWorker } from '@loaders.gl/loader-utils';\nimport { isLoaderObject } from '../loader-utils/normalize-loader';\nimport { normalizeOptions } from '../loader-utils/option-utils';\nimport { getArrayBufferOrStringFromData } from '../loader-utils/get-data';\nimport { getLoaderContext, getLoadersFromContext } from '../loader-utils/loader-context';\nimport { getResourceUrlAndType } from '../utils/resource-utils';\nimport { selectLoader } from './select-loader';\nexport async function parse(data, loaders, options, context) {\n  assert(!context || typeof context === 'object');\n\n  if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined;\n    options = loaders;\n    loaders = undefined;\n  }\n\n  data = await data;\n  options = options || {};\n  const {\n    url\n  } = getResourceUrlAndType(data);\n  const typedLoaders = loaders;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  const loader = await selectLoader(data, candidateLoaders, options);\n\n  if (!loader) {\n    return null;\n  }\n\n  options = normalizeOptions(options, loader, candidateLoaders, url);\n  context = getLoaderContext({\n    url,\n    parse,\n    loaders: candidateLoaders\n  }, options, context);\n  return await parseWithLoader(loader, data, options, context);\n}\n\nasync function parseWithLoader(loader, data, options, context) {\n  validateWorkerVersion(loader);\n  data = await getArrayBufferOrStringFromData(data, loader, options);\n\n  if (loader.parseTextSync && typeof data === 'string') {\n    options.dataType = 'text';\n    return loader.parseTextSync(data, options, context, loader);\n  }\n\n  if (canParseWithWorker(loader, options)) {\n    return await parseWithWorker(loader, data, options, context, parse);\n  }\n\n  if (loader.parseText && typeof data === 'string') {\n    return await loader.parseText(data, options, context, loader);\n  }\n\n  if (loader.parse) {\n    return await loader.parse(data, options, context, loader);\n  }\n\n  assert(!loader.parseSync);\n  throw new Error(`${loader.id} loader - no parser found and worker is disabled`);\n}\n//# sourceMappingURL=parse.js.map","import { getFetchFunction } from './option-utils';\nexport function getLoaderContext(context, options, previousContext = null) {\n  if (previousContext) {\n    return previousContext;\n  }\n\n  const resolvedContext = {\n    fetch: getFetchFunction(options, context),\n    ...context\n  };\n\n  if (!Array.isArray(resolvedContext.loaders)) {\n    resolvedContext.loaders = null;\n  }\n\n  return resolvedContext;\n}\nexport function getLoadersFromContext(loaders, context) {\n  if (!context && loaders && !Array.isArray(loaders)) {\n    return loaders;\n  }\n\n  let candidateLoaders;\n\n  if (loaders) {\n    candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n  }\n\n  if (context && context.loaders) {\n    const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n    candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n  }\n\n  return candidateLoaders && candidateLoaders.length ? candidateLoaders : null;\n}\n//# sourceMappingURL=loader-context.js.map","import { assert } from '../env-utils/assert';\nimport { VERSION } from '../env-utils/version';\nexport function validateWorkerVersion(worker, coreVersion = VERSION) {\n  assert(worker, 'no worker provided');\n  const workerVersion = worker.version;\n\n  if (!coreVersion || !workerVersion) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction parseVersion(version) {\n  const parts = version.split('.').map(Number);\n  return {\n    major: parts[0],\n    minor: parts[1]\n  };\n}\n//# sourceMappingURL=validate-worker-version.js.map","const DEFAULT_VERSION = 'beta';\nexport const VERSION = typeof \"3.0.9\" !== 'undefined' ? \"3.0.9\" : DEFAULT_VERSION;\n\nif (typeof \"3.0.9\" === 'undefined') {\n  console.error('loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN.');\n}\n//# sourceMappingURL=version.js.map","import { isBlob } from '../../javascript-utils/is-type';\nimport { isLoaderObject } from '../loader-utils/normalize-loader';\nimport { getFetchFunction } from '../loader-utils/option-utils';\nimport { parse } from './parse';\nexport async function load(url, loaders, options, context) {\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined;\n    options = loaders;\n    loaders = undefined;\n  }\n\n  const fetch = getFetchFunction(options);\n  let data = url;\n\n  if (typeof url === 'string') {\n    data = await fetch(url);\n  }\n\n  if (isBlob(url)) {\n    data = await fetch(url);\n  }\n\n  return await parse(data, loaders, options);\n}\n//# sourceMappingURL=load.js.map","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message);\n  }\n}\n//# sourceMappingURL=assert.js.map","const globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\nconst self_ = globals.self || globals.window || globals.global;\nconst window_ = globals.window || globals.self || globals.global;\nconst global_ = globals.global || globals.self || globals.window;\nconst document_ = globals.document || {};\nexport { self_ as self, window_ as window, global_ as global, document_ as document };\nexport const isBrowser = typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\nexport const isWorker = typeof importScripts === 'function';\nconst matches = typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\nexport const nodeVersion = matches && parseFloat(matches[1]) || 0;\n//# sourceMappingURL=globals.js.map","import { global, isBrowser } from '../utils/globals';\nconst {\n  _parseImageNode\n} = global;\nconst IMAGE_SUPPORTED = typeof Image !== 'undefined';\nconst IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nconst NODE_IMAGE_SUPPORTED = Boolean(_parseImageNode);\nconst DATA_SUPPORTED = isBrowser ? true : NODE_IMAGE_SUPPORTED;\nexport function isImageTypeSupported(type) {\n  switch (type) {\n    case 'auto':\n      return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || DATA_SUPPORTED;\n\n    case 'imagebitmap':\n      return IMAGE_BITMAP_SUPPORTED;\n\n    case 'image':\n      return IMAGE_SUPPORTED;\n\n    case 'data':\n      return DATA_SUPPORTED;\n\n    default:\n      throw new Error(`@loaders.gl/images: image ${type} not supported in this environment`);\n  }\n}\nexport function getDefaultImageType() {\n  if (IMAGE_BITMAP_SUPPORTED) {\n    return 'imagebitmap';\n  }\n\n  if (IMAGE_SUPPORTED) {\n    return 'image';\n  }\n\n  if (DATA_SUPPORTED) {\n    return 'data';\n  }\n\n  throw new Error('Install \\'@loaders.gl/polyfills\\' to parse images under Node.js');\n}\n//# sourceMappingURL=image-type.js.map","export function isImage(image) {\n  return Boolean(getImageTypeOrNull(image));\n}\nexport function deleteImage(image) {\n  switch (getImageType(image)) {\n    case 'imagebitmap':\n      image.close();\n      break;\n\n    default:\n  }\n}\nexport function getImageType(image) {\n  const format = getImageTypeOrNull(image);\n\n  if (!format) {\n    throw new Error('Not an image');\n  }\n\n  return format;\n}\nexport function getImageSize(image) {\n  return getImageData(image);\n}\nexport function getImageData(image) {\n  switch (getImageType(image)) {\n    case 'data':\n      return image;\n\n    case 'image':\n    case 'imagebitmap':\n      const canvas = document.createElement('canvas');\n      const context = canvas.getContext('2d');\n\n      if (!context) {\n        throw new Error('getImageData');\n      }\n\n      canvas.width = image.width;\n      canvas.height = image.height;\n      context.drawImage(image, 0, 0);\n      return context.getImageData(0, 0, image.width, image.height);\n\n    default:\n      throw new Error('getImageData');\n  }\n}\n\nfunction getImageTypeOrNull(image) {\n  if (typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap) {\n    return 'imagebitmap';\n  }\n\n  if (typeof Image !== 'undefined' && image instanceof Image) {\n    return 'image';\n  }\n\n  if (image && typeof image === 'object' && image.data && image.width && image.height) {\n    return 'data';\n  }\n\n  return null;\n}\n//# sourceMappingURL=parsed-image-api.js.map","const SVG_DATA_URL_PATTERN = /^data:image\\/svg\\+xml/;\nconst SVG_URL_PATTERN = /\\.svg((\\?|#).*)?$/;\nexport function isSVG(url) {\n  return url && (SVG_DATA_URL_PATTERN.test(url) || SVG_URL_PATTERN.test(url));\n}\nexport function getBlobOrSVGDataUrl(arrayBuffer, url) {\n  if (isSVG(url)) {\n    const textDecoder = new TextDecoder();\n    const xmlText = textDecoder.decode(arrayBuffer);\n    const src = `data:image/svg+xml;base64,${btoa(xmlText)}`;\n    return src;\n  }\n\n  return getBlob(arrayBuffer, url);\n}\nexport function getBlob(arrayBuffer, url) {\n  if (isSVG(url)) {\n    throw new Error('SVG cannot be parsed directly to imagebitmap');\n  }\n\n  return new Blob([new Uint8Array(arrayBuffer)]);\n}\n//# sourceMappingURL=svg-utils.js.map","import { getBlobOrSVGDataUrl } from './svg-utils';\nexport default async function parseToImage(arrayBuffer, options, url) {\n  const blobOrDataUrl = getBlobOrSVGDataUrl(arrayBuffer, url);\n  const URL = self.URL || self.webkitURL;\n  const objectUrl = typeof blobOrDataUrl !== 'string' && URL.createObjectURL(blobOrDataUrl);\n\n  try {\n    return await loadToImage(objectUrl || blobOrDataUrl, options);\n  } finally {\n    if (objectUrl) {\n      URL.revokeObjectURL(objectUrl);\n    }\n  }\n}\nexport async function loadToImage(url, options) {\n  const image = new Image();\n  image.src = url;\n\n  if (options.image && options.image.decode && image.decode) {\n    await image.decode();\n    return image;\n  }\n\n  return await new Promise((resolve, reject) => {\n    try {\n      image.onload = () => resolve(image);\n\n      image.onerror = err => reject(new Error(`Could not load image ${url}: ${err}`));\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n//# sourceMappingURL=parse-to-image.js.map","import { isSVG, getBlob } from './svg-utils';\nimport parseToImage from './parse-to-image';\nconst EMPTY_OBJECT = {};\nlet imagebitmapOptionsSupported = true;\nexport default async function parseToImageBitmap(arrayBuffer, options, url) {\n  let blob;\n\n  if (isSVG(url)) {\n    const image = await parseToImage(arrayBuffer, options, url);\n    blob = image;\n  } else {\n    blob = getBlob(arrayBuffer, url);\n  }\n\n  const imagebitmapOptions = options && options.imagebitmap;\n  return await safeCreateImageBitmap(blob, imagebitmapOptions);\n}\n\nasync function safeCreateImageBitmap(blob, imagebitmapOptions = null) {\n  if (isEmptyObject(imagebitmapOptions) || !imagebitmapOptionsSupported) {\n    imagebitmapOptions = null;\n  }\n\n  if (imagebitmapOptions) {\n    try {\n      return await createImageBitmap(blob, imagebitmapOptions);\n    } catch (error) {\n      console.warn(error);\n      imagebitmapOptionsSupported = false;\n    }\n  }\n\n  return await createImageBitmap(blob);\n}\n\nfunction isEmptyObject(object) {\n  for (const key in object || EMPTY_OBJECT) {\n    return false;\n  }\n\n  return true;\n}\n//# sourceMappingURL=parse-to-image-bitmap.js.map","const BIG_ENDIAN = false;\nconst LITTLE_ENDIAN = true;\nexport function getBinaryImageMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  return getPngMetadata(dataView) || getJpegMetadata(dataView) || getGifMetadata(dataView) || getBmpMetadata(dataView);\n}\n\nfunction getPngMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isPng = dataView.byteLength >= 24 && dataView.getUint32(0, BIG_ENDIAN) === 0x89504e47;\n\n  if (!isPng) {\n    return null;\n  }\n\n  return {\n    mimeType: 'image/png',\n    width: dataView.getUint32(16, BIG_ENDIAN),\n    height: dataView.getUint32(20, BIG_ENDIAN)\n  };\n}\n\nfunction getGifMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isGif = dataView.byteLength >= 10 && dataView.getUint32(0, BIG_ENDIAN) === 0x47494638;\n\n  if (!isGif) {\n    return null;\n  }\n\n  return {\n    mimeType: 'image/gif',\n    width: dataView.getUint16(6, LITTLE_ENDIAN),\n    height: dataView.getUint16(8, LITTLE_ENDIAN)\n  };\n}\n\nexport function getBmpMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isBmp = dataView.byteLength >= 14 && dataView.getUint16(0, BIG_ENDIAN) === 0x424d && dataView.getUint32(2, LITTLE_ENDIAN) === dataView.byteLength;\n\n  if (!isBmp) {\n    return null;\n  }\n\n  return {\n    mimeType: 'image/bmp',\n    width: dataView.getUint32(18, LITTLE_ENDIAN),\n    height: dataView.getUint32(22, LITTLE_ENDIAN)\n  };\n}\n\nfunction getJpegMetadata(binaryData) {\n  const dataView = toDataView(binaryData);\n  const isJpeg = dataView.byteLength >= 3 && dataView.getUint16(0, BIG_ENDIAN) === 0xffd8 && dataView.getUint8(2) === 0xff;\n\n  if (!isJpeg) {\n    return null;\n  }\n\n  const {\n    tableMarkers,\n    sofMarkers\n  } = getJpegMarkers();\n  let i = 2;\n\n  while (i + 9 < dataView.byteLength) {\n    const marker = dataView.getUint16(i, BIG_ENDIAN);\n\n    if (sofMarkers.has(marker)) {\n      return {\n        mimeType: 'image/jpeg',\n        height: dataView.getUint16(i + 5, BIG_ENDIAN),\n        width: dataView.getUint16(i + 7, BIG_ENDIAN)\n      };\n    }\n\n    if (!tableMarkers.has(marker)) {\n      return null;\n    }\n\n    i += 2;\n    i += dataView.getUint16(i, BIG_ENDIAN);\n  }\n\n  return null;\n}\n\nfunction getJpegMarkers() {\n  const tableMarkers = new Set([0xffdb, 0xffc4, 0xffcc, 0xffdd, 0xfffe]);\n\n  for (let i = 0xffe0; i < 0xfff0; ++i) {\n    tableMarkers.add(i);\n  }\n\n  const sofMarkers = new Set([0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc9, 0xffca, 0xffcb, 0xffcd, 0xffce, 0xffcf, 0xffde]);\n  return {\n    tableMarkers,\n    sofMarkers\n  };\n}\n\nfunction toDataView(data) {\n  if (data instanceof DataView) {\n    return data;\n  }\n\n  if (ArrayBuffer.isView(data)) {\n    return new DataView(data.buffer);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return new DataView(data);\n  }\n\n  throw new Error('toDataView');\n}\n//# sourceMappingURL=binary-image-api.js.map","import { VERSION } from './lib/utils/version';\nimport parseImage from './lib/parsers/parse-image';\nimport { getBinaryImageMetadata } from './lib/category-api/binary-image-api';\nconst EXTENSIONS = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp', 'ico', 'svg'];\nconst MIME_TYPES = ['image/png', 'image/jpeg', 'image/gif', 'image/webp', 'image/bmp', 'image/vnd.microsoft.icon', 'image/svg+xml'];\nexport const ImageLoader = {\n  id: 'image',\n  module: 'images',\n  name: 'Images',\n  version: VERSION,\n  mimeTypes: MIME_TYPES,\n  extensions: EXTENSIONS,\n  parse: parseImage,\n  tests: [arrayBuffer => Boolean(getBinaryImageMetadata(new DataView(arrayBuffer)))],\n  options: {\n    image: {\n      type: 'auto',\n      decode: true\n    }\n  }\n};\nexport const _typecheckImageLoader = ImageLoader;\n//# sourceMappingURL=image-loader.js.map","export const VERSION = typeof \"3.0.9\" !== 'undefined' ? \"3.0.9\" : 'latest';\n//# sourceMappingURL=version.js.map","import { assert } from '../utils/assert';\nimport { isImageTypeSupported, getDefaultImageType } from '../category-api/image-type';\nimport { getImageData } from '../category-api/parsed-image-api';\nimport parseToImage from './parse-to-image';\nimport parseToImageBitmap from './parse-to-image-bitmap';\nimport parseToNodeImage from './parse-to-node-image';\nexport default async function parseImage(arrayBuffer, options, context) {\n  options = options || {};\n  const imageOptions = options.image || {};\n  const imageType = imageOptions.type || 'auto';\n  const {\n    url\n  } = context || {};\n  const loadType = getLoadableImageType(imageType);\n  let image;\n\n  switch (loadType) {\n    case 'imagebitmap':\n      image = await parseToImageBitmap(arrayBuffer, options, url);\n      break;\n\n    case 'image':\n      image = await parseToImage(arrayBuffer, options, url);\n      break;\n\n    case 'data':\n      image = await parseToNodeImage(arrayBuffer, options);\n      break;\n\n    default:\n      assert(false);\n  }\n\n  if (imageType === 'data') {\n    image = getImageData(image);\n  }\n\n  return image;\n}\n\nfunction getLoadableImageType(type) {\n  switch (type) {\n    case 'auto':\n    case 'data':\n      return getDefaultImageType();\n\n    default:\n      isImageTypeSupported(type);\n      return type;\n  }\n}\n//# sourceMappingURL=parse-image.js.map","import { global } from '../utils/globals';\nimport { assert } from '../utils/assert';\nimport { getBinaryImageMetadata } from '../category-api/binary-image-api';\nexport default function parseToNodeImage(arrayBuffer, options) {\n  const {\n    mimeType\n  } = getBinaryImageMetadata(arrayBuffer) || {};\n  const {\n    _parseImageNode\n  } = global;\n  assert(_parseImageNode);\n  return _parseImageNode(arrayBuffer, mimeType, options);\n}\n//# sourceMappingURL=parse-to-node-image.js.map","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.console = exports.process = exports.document = exports.global = exports.window = exports.self = void 0;\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document,\n  process: (typeof process === \"undefined\" ? \"undefined\" : (0, _typeof2.default)(process)) === 'object' && process\n};\nvar self_ = globals.self || globals.window || globals.global;\nexports.self = self_;\nvar window_ = globals.window || globals.self || globals.global;\nexports.window = window_;\nvar global_ = globals.global || globals.self || globals.window;\nexports.global = global_;\nvar document_ = globals.document || {};\nexports.document = document_;\nvar process_ = globals.process || {};\nexports.process = process_;\nvar console_ = console;\nexports.console = console_;\n//# sourceMappingURL=globals.js.map","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isElectron;\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nfunction isElectron(mockUserAgent) {\n  if (typeof window !== 'undefined' && (0, _typeof2.default)(window.process) === 'object' && window.process.type === 'renderer') {\n    return true;\n  }\n\n  if (typeof process !== 'undefined' && (0, _typeof2.default)(process.versions) === 'object' && Boolean(process.versions.electron)) {\n    return true;\n  }\n\n  var realUserAgent = (typeof navigator === \"undefined\" ? \"undefined\" : (0, _typeof2.default)(navigator)) === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  var userAgent = mockUserAgent || realUserAgent;\n\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=is-electron.js.map","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isBrowser;\nexports.isBrowserMainThread = isBrowserMainThread;\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _isElectron = _interopRequireDefault(require(\"./is-electron\"));\n\nfunction isBrowser() {\n  var isNode = (typeof process === \"undefined\" ? \"undefined\" : (0, _typeof2.default)(process)) === 'object' && String(process) === '[object process]' && !process.browser;\n  return !isNode || (0, _isElectron.default)();\n}\n\nfunction isBrowserMainThread() {\n  return isBrowser() && typeof document !== 'undefined';\n}\n//# sourceMappingURL=is-browser.js.map","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isMobile = isMobile;\nexports.default = getBrowser;\n\nvar _globals = require(\"./globals\");\n\nvar _isBrowser = _interopRequireDefault(require(\"./is-browser\"));\n\nvar _isElectron = _interopRequireDefault(require(\"./is-electron\"));\n\nfunction isMobile() {\n  return typeof _globals.window.orientation !== 'undefined';\n}\n\nfunction getBrowser(mockUserAgent) {\n  if (!mockUserAgent && !(0, _isBrowser.default)()) {\n    return 'Node';\n  }\n\n  if ((0, _isElectron.default)(mockUserAgent)) {\n    return 'Electron';\n  }\n\n  var navigator_ = typeof navigator !== 'undefined' ? navigator : {};\n  var userAgent = mockUserAgent || navigator_.userAgent || '';\n\n  if (userAgent.indexOf('Edge') > -1) {\n    return 'Edge';\n  }\n\n  var isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  var isTrident = userAgent.indexOf('Trident/') !== -1;\n\n  if (isMSIE || isTrident) {\n    return 'IE';\n  }\n\n  if (_globals.window.chrome) {\n    return 'Chrome';\n  }\n\n  if (_globals.window.safari) {\n    return 'Safari';\n  }\n\n  if (_globals.window.mozInnerScreenX) {\n    return 'Firefox';\n  }\n\n  return 'Unknown';\n}\n//# sourceMappingURL=get-browser.js.map","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"self\", {\n  enumerable: true,\n  get: function get() {\n    return _globals.self;\n  }\n});\nObject.defineProperty(exports, \"window\", {\n  enumerable: true,\n  get: function get() {\n    return _globals.window;\n  }\n});\nObject.defineProperty(exports, \"global\", {\n  enumerable: true,\n  get: function get() {\n    return _globals.global;\n  }\n});\nObject.defineProperty(exports, \"document\", {\n  enumerable: true,\n  get: function get() {\n    return _globals.document;\n  }\n});\nObject.defineProperty(exports, \"process\", {\n  enumerable: true,\n  get: function get() {\n    return _globals.process;\n  }\n});\nObject.defineProperty(exports, \"console\", {\n  enumerable: true,\n  get: function get() {\n    return _globals.console;\n  }\n});\nObject.defineProperty(exports, \"isBrowser\", {\n  enumerable: true,\n  get: function get() {\n    return _isBrowser.default;\n  }\n});\nObject.defineProperty(exports, \"isBrowserMainThread\", {\n  enumerable: true,\n  get: function get() {\n    return _isBrowser.isBrowserMainThread;\n  }\n});\nObject.defineProperty(exports, \"getBrowser\", {\n  enumerable: true,\n  get: function get() {\n    return _getBrowser.default;\n  }\n});\nObject.defineProperty(exports, \"isMobile\", {\n  enumerable: true,\n  get: function get() {\n    return _getBrowser.isMobile;\n  }\n});\nObject.defineProperty(exports, \"isElectron\", {\n  enumerable: true,\n  get: function get() {\n    return _isElectron.default;\n  }\n});\n\nvar _globals = require(\"./globals\");\n\nvar _isBrowser = _interopRequireWildcard(require(\"./is-browser\"));\n\nvar _getBrowser = _interopRequireWildcard(require(\"./get-browser\"));\n\nvar _isElectron = _interopRequireDefault(require(\"./is-electron\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n//# sourceMappingURL=index.js.map","import { Log } from 'probe.gl';\nexport default new Log({\n  id: 'deck'\n});\n//# sourceMappingURL=log.js.map","import deckLog from '../utils/log';\nimport { getLoggers } from './loggers';\nlet loggers = {};\n\nif (process.env.NODE_ENV !== 'production') {\n  loggers = getLoggers(deckLog);\n}\n\nexport function register(handlers) {\n  loggers = handlers;\n}\nexport default function debug(eventType) {\n  if (deckLog.level > 0 && loggers[eventType]) {\n    loggers[eventType].call(...arguments);\n  }\n}\n//# sourceMappingURL=index.js.map","function isJSON(text) {\n  const firstChar = text[0];\n  const lastChar = text[text.length - 1];\n  return firstChar === '{' && lastChar === '}' || firstChar === '[' && lastChar === ']';\n}\n\nexport default {\n  name: 'JSON',\n  extensions: ['json', 'geojson'],\n  mimeTypes: ['application/json', 'application/geo+json'],\n  testText: isJSON,\n  parseTextSync: JSON.parse\n};\n//# sourceMappingURL=json-loader.js.map","import { registerLoaders } from '@loaders.gl/core';\nimport { ImageLoader } from '@loaders.gl/images';\nimport { global } from 'probe.gl/env';\nimport log from '../utils/log';\nimport { register } from '../debug';\nimport jsonLoader from '../utils/json-loader';\nconst version = typeof \"8.5.4\" !== 'undefined' ? \"8.5.4\" : global.DECK_VERSION || 'untranspiled source';\nconst existingVersion = global.deck && global.deck.VERSION;\n\nif (existingVersion && existingVersion !== version) {\n  throw new Error(\"deck.gl - multiple versions detected: \".concat(existingVersion, \" vs \").concat(version));\n}\n\nif (!existingVersion) {\n  log.log(1, \"deck.gl \".concat(version))();\n  global.deck = Object.assign(global.deck || {}, {\n    VERSION: version,\n    version,\n    log,\n    _registerLoggers: register\n  });\n  registerLoaders([jsonLoader, [ImageLoader, {\n    imagebitmap: {\n      premultiplyAlpha: 'none'\n    }\n  }]]);\n}\n\nexport default global.deck;\n//# sourceMappingURL=init.js.map","import { Log } from 'probe.gl';\nexport const log = new Log({\n  id: 'luma.gl'\n});\n//# sourceMappingURL=log.js.map","export function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'luma.gl: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { assert } from './assert';\nconst ERR_CONTEXT = 'Invalid WebGLRenderingContext';\nexport const ERR_WEBGL = ERR_CONTEXT;\nexport const ERR_WEBGL2 = 'Requires WebGL2';\nexport function isWebGL(gl) {\n  if (typeof WebGLRenderingContext !== 'undefined' && gl instanceof WebGLRenderingContext) {\n    return true;\n  }\n\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n\n  return Boolean(gl && Number.isFinite(gl._version));\n}\nexport function isWebGL2(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n\n  return Boolean(gl && gl._version === 2);\n}\nexport function getWebGL2Context(gl) {\n  return isWebGL2(gl) ? gl : null;\n}\nexport function assertWebGLContext(gl) {\n  assert(isWebGL(gl), ERR_CONTEXT);\n  return gl;\n}\nexport function assertWebGL2Context(gl) {\n  assert(isWebGL2(gl), ERR_WEBGL2);\n  return gl;\n}\n//# sourceMappingURL=webgl-checks.js.map","import { global } from 'probe.gl/env';\nconst glErrorShadow = {};\n\nfunction error(msg) {\n  if (global.console && global.console.error) {\n    global.console.error(msg);\n  }\n}\n\nfunction log(msg) {\n  if (global.console && global.console.log) {\n    global.console.log(msg);\n  }\n}\n\nfunction synthesizeGLError(err, opt_msg) {\n  glErrorShadow[err] = true;\n\n  if (opt_msg !== undefined) {\n    error(opt_msg);\n  }\n}\n\nfunction wrapGLError(gl) {\n  const f = gl.getError;\n\n  gl.getError = function getError() {\n    let err;\n\n    do {\n      err = f.apply(gl);\n\n      if (err !== 0) {\n        glErrorShadow[err] = true;\n      }\n    } while (err !== 0);\n\n    for (err in glErrorShadow) {\n      if (glErrorShadow[err]) {\n        delete glErrorShadow[err];\n        return parseInt(err, 10);\n      }\n    }\n\n    return 0;\n  };\n}\n\nconst WebGLVertexArrayObjectOES = function WebGLVertexArrayObjectOES(ext) {\n  const gl = ext.gl;\n  this.ext = ext;\n  this.isAlive = true;\n  this.hasBeenBound = false;\n  this.elementArrayBuffer = null;\n  this.attribs = new Array(ext.maxVertexAttribs);\n\n  for (let n = 0; n < this.attribs.length; n++) {\n    const attrib = new WebGLVertexArrayObjectOES.VertexAttrib(gl);\n    this.attribs[n] = attrib;\n  }\n\n  this.maxAttrib = 0;\n};\n\nWebGLVertexArrayObjectOES.VertexAttrib = function VertexAttrib(gl) {\n  this.enabled = false;\n  this.buffer = null;\n  this.size = 4;\n  this.type = 5126;\n  this.normalized = false;\n  this.stride = 16;\n  this.offset = 0;\n  this.cached = '';\n  this.recache();\n};\n\nWebGLVertexArrayObjectOES.VertexAttrib.prototype.recache = function recache() {\n  this.cached = [this.size, this.type, this.normalized, this.stride, this.offset].join(':');\n};\n\nconst OESVertexArrayObject = function OESVertexArrayObject(gl) {\n  const self = this;\n  this.gl = gl;\n  wrapGLError(gl);\n  const original = this.original = {\n    getParameter: gl.getParameter,\n    enableVertexAttribArray: gl.enableVertexAttribArray,\n    disableVertexAttribArray: gl.disableVertexAttribArray,\n    bindBuffer: gl.bindBuffer,\n    getVertexAttrib: gl.getVertexAttrib,\n    vertexAttribPointer: gl.vertexAttribPointer\n  };\n\n  gl.getParameter = function getParameter(pname) {\n    if (pname === self.VERTEX_ARRAY_BINDING_OES) {\n      if (self.currentVertexArrayObject === self.defaultVertexArrayObject) {\n        return null;\n      }\n\n      return self.currentVertexArrayObject;\n    }\n\n    return original.getParameter.apply(this, arguments);\n  };\n\n  gl.enableVertexAttribArray = function enableVertexAttribArray(index) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, index);\n    const attrib = vao.attribs[index];\n    attrib.enabled = true;\n    return original.enableVertexAttribArray.apply(this, arguments);\n  };\n\n  gl.disableVertexAttribArray = function disableVertexAttribArray(index) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, index);\n    const attrib = vao.attribs[index];\n    attrib.enabled = false;\n    return original.disableVertexAttribArray.apply(this, arguments);\n  };\n\n  gl.bindBuffer = function bindBuffer(target, buffer) {\n    switch (target) {\n      case 34962:\n        self.currentArrayBuffer = buffer;\n        break;\n\n      case 34963:\n        self.currentVertexArrayObject.elementArrayBuffer = buffer;\n        break;\n\n      default:\n    }\n\n    return original.bindBuffer.apply(this, arguments);\n  };\n\n  gl.getVertexAttrib = function getVertexAttrib(index, pname) {\n    const vao = self.currentVertexArrayObject;\n    const attrib = vao.attribs[index];\n\n    switch (pname) {\n      case 34975:\n        return attrib.buffer;\n\n      case 34338:\n        return attrib.enabled;\n\n      case 34339:\n        return attrib.size;\n\n      case 34340:\n        return attrib.stride;\n\n      case 34341:\n        return attrib.type;\n\n      case 34922:\n        return attrib.normalized;\n\n      default:\n        return original.getVertexAttrib.apply(this, arguments);\n    }\n  };\n\n  gl.vertexAttribPointer = function vertexAttribPointer(indx, size, type, normalized, stride, offset) {\n    const vao = self.currentVertexArrayObject;\n    vao.maxAttrib = Math.max(vao.maxAttrib, indx);\n    const attrib = vao.attribs[indx];\n    attrib.buffer = self.currentArrayBuffer;\n    attrib.size = size;\n    attrib.type = type;\n    attrib.normalized = normalized;\n    attrib.stride = stride;\n    attrib.offset = offset;\n    attrib.recache();\n    return original.vertexAttribPointer.apply(this, arguments);\n  };\n\n  if (gl.instrumentExtension) {\n    gl.instrumentExtension(this, 'OES_vertex_array_object');\n  }\n\n  if (gl.canvas) {\n    gl.canvas.addEventListener('webglcontextrestored', () => {\n      log('OESVertexArrayObject emulation library context restored');\n      self.reset_();\n    }, true);\n  }\n\n  this.reset_();\n};\n\nOESVertexArrayObject.prototype.VERTEX_ARRAY_BINDING_OES = 0x85b5;\n\nOESVertexArrayObject.prototype.reset_ = function reset_() {\n  const contextWasLost = this.vertexArrayObjects !== undefined;\n\n  if (contextWasLost) {\n    for (let ii = 0; ii < this.vertexArrayObjects.length; ++ii) {\n      this.vertexArrayObjects.isAlive = false;\n    }\n  }\n\n  const gl = this.gl;\n  this.maxVertexAttribs = gl.getParameter(34921);\n  this.defaultVertexArrayObject = new WebGLVertexArrayObjectOES(this);\n  this.currentVertexArrayObject = null;\n  this.currentArrayBuffer = null;\n  this.vertexArrayObjects = [this.defaultVertexArrayObject];\n  this.bindVertexArrayOES(null);\n};\n\nOESVertexArrayObject.prototype.createVertexArrayOES = function createVertexArrayOES() {\n  const arrayObject = new WebGLVertexArrayObjectOES(this);\n  this.vertexArrayObjects.push(arrayObject);\n  return arrayObject;\n};\n\nOESVertexArrayObject.prototype.deleteVertexArrayOES = function deleteVertexArrayOES(arrayObject) {\n  arrayObject.isAlive = false;\n  this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(arrayObject), 1);\n\n  if (this.currentVertexArrayObject === arrayObject) {\n    this.bindVertexArrayOES(null);\n  }\n};\n\nOESVertexArrayObject.prototype.isVertexArrayOES = function isVertexArrayOES(arrayObject) {\n  if (arrayObject && arrayObject instanceof WebGLVertexArrayObjectOES) {\n    if (arrayObject.hasBeenBound && arrayObject.ext === this) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nOESVertexArrayObject.prototype.bindVertexArrayOES = function bindVertexArrayOES(arrayObject) {\n  const gl = this.gl;\n\n  if (arrayObject && !arrayObject.isAlive) {\n    synthesizeGLError(1282, 'bindVertexArrayOES: attempt to bind deleted arrayObject');\n    return;\n  }\n\n  const original = this.original;\n  const oldVAO = this.currentVertexArrayObject;\n  this.currentVertexArrayObject = arrayObject || this.defaultVertexArrayObject;\n  this.currentVertexArrayObject.hasBeenBound = true;\n  const newVAO = this.currentVertexArrayObject;\n\n  if (oldVAO === newVAO) {\n    return;\n  }\n\n  if (!oldVAO || newVAO.elementArrayBuffer !== oldVAO.elementArrayBuffer) {\n    original.bindBuffer.call(gl, 34963, newVAO.elementArrayBuffer);\n  }\n\n  let currentBinding = this.currentArrayBuffer;\n  const maxAttrib = Math.max(oldVAO ? oldVAO.maxAttrib : 0, newVAO.maxAttrib);\n\n  for (let n = 0; n <= maxAttrib; n++) {\n    const attrib = newVAO.attribs[n];\n    const oldAttrib = oldVAO ? oldVAO.attribs[n] : null;\n\n    if (!oldVAO || attrib.enabled !== oldAttrib.enabled) {\n      if (attrib.enabled) {\n        original.enableVertexAttribArray.call(gl, n);\n      } else {\n        original.disableVertexAttribArray.call(gl, n);\n      }\n    }\n\n    if (attrib.enabled) {\n      let bufferChanged = false;\n\n      if (!oldVAO || attrib.buffer !== oldAttrib.buffer) {\n        if (currentBinding !== attrib.buffer) {\n          original.bindBuffer.call(gl, 34962, attrib.buffer);\n          currentBinding = attrib.buffer;\n        }\n\n        bufferChanged = true;\n      }\n\n      if (bufferChanged || attrib.cached !== oldAttrib.cached) {\n        original.vertexAttribPointer.call(gl, n, attrib.size, attrib.type, attrib.normalized, attrib.stride, attrib.offset);\n      }\n    }\n  }\n\n  if (this.currentArrayBuffer !== currentBinding) {\n    original.bindBuffer.call(gl, 34962, this.currentArrayBuffer);\n  }\n};\n\nexport function polyfillVertexArrayObject(gl) {\n  if (typeof gl.createVertexArray === 'function') {\n    return;\n  }\n\n  const original_getSupportedExtensions = gl.getSupportedExtensions;\n\n  gl.getSupportedExtensions = function getSupportedExtensions() {\n    const list = original_getSupportedExtensions.call(this) || [];\n\n    if (list.indexOf('OES_vertex_array_object') < 0) {\n      list.push('OES_vertex_array_object');\n    }\n\n    return list;\n  };\n\n  const original_getExtension = gl.getExtension;\n\n  gl.getExtension = function getExtension(name) {\n    const ext = original_getExtension.call(this, name);\n\n    if (ext) {\n      return ext;\n    }\n\n    if (name !== 'OES_vertex_array_object') {\n      return null;\n    }\n\n    if (!gl.__OESVertexArrayObject) {\n      this.__OESVertexArrayObject = new OESVertexArrayObject(this);\n    }\n\n    return this.__OESVertexArrayObject;\n  };\n}\n//# sourceMappingURL=polyfill-vertex-array-object.js.map","import { isWebGL2 } from '../utils/webgl-checks';\nconst OES_element_index = 'OES_element_index';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_disjoint_timer_query_webgl2 = 'EXT_disjoint_timer_query_webgl2';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\nconst WEBGL_debug_renderer_info = 'WEBGL_debug_renderer_info';\nconst GL_FRAGMENT_SHADER_DERIVATIVE_HINT = 0x8b8b;\nconst GL_DONT_CARE = 0x1100;\nconst GL_GPU_DISJOINT_EXT = 0x8fbb;\nconst GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84ff;\nconst GL_UNMASKED_VENDOR_WEBGL = 0x9245;\nconst GL_UNMASKED_RENDERER_WEBGL = 0x9246;\n\nconst getWebGL2ValueOrZero = gl => !isWebGL2(gl) ? 0 : undefined;\n\nconst WEBGL_PARAMETERS = {\n  [3074]: gl => !isWebGL2(gl) ? 36064 : undefined,\n  [GL_FRAGMENT_SHADER_DERIVATIVE_HINT]: gl => !isWebGL2(gl) ? GL_DONT_CARE : undefined,\n  [35977]: getWebGL2ValueOrZero,\n  [32937]: getWebGL2ValueOrZero,\n  [GL_GPU_DISJOINT_EXT]: (gl, getParameter) => {\n    const ext = isWebGL2(gl) ? gl.getExtension(EXT_disjoint_timer_query_webgl2) : gl.getExtension(EXT_disjoint_timer_query);\n    return ext && ext.GPU_DISJOINT_EXT ? getParameter(ext.GPU_DISJOINT_EXT) : 0;\n  },\n  [GL_UNMASKED_VENDOR_WEBGL]: (gl, getParameter) => {\n    const ext = gl.getExtension(WEBGL_debug_renderer_info);\n    return getParameter(ext && ext.UNMASKED_VENDOR_WEBGL || 7936);\n  },\n  [GL_UNMASKED_RENDERER_WEBGL]: (gl, getParameter) => {\n    const ext = gl.getExtension(WEBGL_debug_renderer_info);\n    return getParameter(ext && ext.UNMASKED_RENDERER_WEBGL || 7937);\n  },\n  [GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT]: (gl, getParameter) => {\n    const ext = gl.luma.extensions[EXT_texture_filter_anisotropic];\n    return ext ? getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 1.0;\n  },\n  [32883]: getWebGL2ValueOrZero,\n  [35071]: getWebGL2ValueOrZero,\n  [37447]: getWebGL2ValueOrZero,\n  [36063]: (gl, getParameter) => {\n    if (!isWebGL2(gl)) {\n      const ext = gl.getExtension(WEBGL_draw_buffers);\n      return ext ? getParameter(ext.MAX_COLOR_ATTACHMENTS_WEBGL) : 0;\n    }\n\n    return undefined;\n  },\n  [35379]: getWebGL2ValueOrZero,\n  [35374]: getWebGL2ValueOrZero,\n  [35377]: getWebGL2ValueOrZero,\n  [34852]: gl => {\n    if (!isWebGL2(gl)) {\n      const ext = gl.getExtension(WEBGL_draw_buffers);\n      return ext ? ext.MAX_DRAW_BUFFERS_WEBGL : 0;\n    }\n\n    return undefined;\n  },\n  [36203]: gl => gl.getExtension(OES_element_index) ? 2147483647 : 65535,\n  [33001]: gl => gl.getExtension(OES_element_index) ? 16777216 : 65535,\n  [33000]: gl => 16777216,\n  [37157]: getWebGL2ValueOrZero,\n  [35373]: getWebGL2ValueOrZero,\n  [35657]: getWebGL2ValueOrZero,\n  [36183]: getWebGL2ValueOrZero,\n  [37137]: getWebGL2ValueOrZero,\n  [34045]: getWebGL2ValueOrZero,\n  [35978]: getWebGL2ValueOrZero,\n  [35979]: getWebGL2ValueOrZero,\n  [35968]: getWebGL2ValueOrZero,\n  [35376]: getWebGL2ValueOrZero,\n  [35375]: getWebGL2ValueOrZero,\n  [35659]: getWebGL2ValueOrZero,\n  [37154]: getWebGL2ValueOrZero,\n  [35371]: getWebGL2ValueOrZero,\n  [35658]: getWebGL2ValueOrZero,\n  [35076]: getWebGL2ValueOrZero,\n  [35077]: getWebGL2ValueOrZero,\n  [35380]: getWebGL2ValueOrZero\n};\nexport function getParameterPolyfill(gl, originalGetParameter, pname) {\n  const limit = WEBGL_PARAMETERS[pname];\n  const value = typeof limit === 'function' ? limit(gl, originalGetParameter, pname) : limit;\n  const result = value !== undefined ? value : originalGetParameter(pname);\n  return result;\n}\n//# sourceMappingURL=get-parameter-polyfill.js.map","import { assert } from '../utils/assert';\nimport { isWebGL2 } from '../utils/webgl-checks';\nimport { getParameterPolyfill } from './get-parameter-polyfill';\nconst OES_vertex_array_object = 'OES_vertex_array_object';\nconst ANGLE_instanced_arrays = 'ANGLE_instanced_arrays';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\nconst ERR_VAO_NOT_SUPPORTED = 'VertexArray requires WebGL2 or OES_vertex_array_object extension';\n\nfunction getExtensionData(gl, extension) {\n  return {\n    webgl2: isWebGL2(gl),\n    ext: gl.getExtension(extension)\n  };\n}\n\nexport const WEBGL2_CONTEXT_POLYFILLS = {\n  [OES_vertex_array_object]: {\n    meta: {\n      suffix: 'OES'\n    },\n    createVertexArray: () => {\n      assert(false, ERR_VAO_NOT_SUPPORTED);\n    },\n    deleteVertexArray: () => {},\n    bindVertexArray: () => {},\n    isVertexArray: () => false\n  },\n  [ANGLE_instanced_arrays]: {\n    meta: {\n      suffix: 'ANGLE'\n    },\n\n    vertexAttribDivisor(location, divisor) {\n      assert(divisor === 0, 'WebGL instanced rendering not supported');\n    },\n\n    drawElementsInstanced: () => {},\n    drawArraysInstanced: () => {}\n  },\n  [WEBGL_draw_buffers]: {\n    meta: {\n      suffix: 'WEBGL'\n    },\n    drawBuffers: () => {\n      assert(false);\n    }\n  },\n  [EXT_disjoint_timer_query]: {\n    meta: {\n      suffix: 'EXT'\n    },\n    createQuery: () => {\n      assert(false);\n    },\n    deleteQuery: () => {\n      assert(false);\n    },\n    beginQuery: () => {\n      assert(false);\n    },\n    endQuery: () => {},\n\n    getQuery(handle, pname) {\n      return this.getQueryObject(handle, pname);\n    },\n\n    getQueryParameter(handle, pname) {\n      return this.getQueryObject(handle, pname);\n    },\n\n    getQueryObject: () => {}\n  }\n};\nexport const WEBGL2_CONTEXT_OVERRIDES = {\n  readBuffer: (gl, originalFunc, attachment) => {\n    if (isWebGL2(gl)) {\n      originalFunc(attachment);\n    } else {}\n  },\n  getVertexAttrib: (gl, originalFunc, location, pname) => {\n    const {\n      webgl2,\n      ext\n    } = getExtensionData(gl, ANGLE_instanced_arrays);\n    let result;\n\n    switch (pname) {\n      case 35069:\n        result = !webgl2 ? false : undefined;\n        break;\n\n      case 35070:\n        result = !webgl2 && !ext ? 0 : undefined;\n        break;\n\n      default:\n    }\n\n    return result !== undefined ? result : originalFunc(location, pname);\n  },\n  getProgramParameter: (gl, originalFunc, program, pname) => {\n    if (!isWebGL2(gl)) {\n      switch (pname) {\n        case 35967:\n          return 35981;\n\n        case 35971:\n          return 0;\n\n        case 35382:\n          return 0;\n\n        default:\n      }\n    }\n\n    return originalFunc(program, pname);\n  },\n  getInternalformatParameter: (gl, originalFunc, target, format, pname) => {\n    if (!isWebGL2(gl)) {\n      switch (pname) {\n        case 32937:\n          return new Int32Array([0]);\n\n        default:\n      }\n    }\n\n    return gl.getInternalformatParameter(target, format, pname);\n  },\n\n  getTexParameter(gl, originalFunc, target, pname) {\n    switch (pname) {\n      case 34046:\n        const {\n          extensions\n        } = gl.luma;\n        const ext = extensions[EXT_texture_filter_anisotropic];\n        pname = ext && ext.TEXTURE_MAX_ANISOTROPY_EXT || 34046;\n        break;\n\n      default:\n    }\n\n    return originalFunc(target, pname);\n  },\n\n  getParameter: getParameterPolyfill,\n\n  hint(gl, originalFunc, pname, value) {\n    return originalFunc(pname, value);\n  }\n\n};\n//# sourceMappingURL=polyfill-table.js.map","import { polyfillVertexArrayObject } from './polyfill-vertex-array-object';\nimport { assert } from '../utils/assert';\nimport { WEBGL2_CONTEXT_POLYFILLS, WEBGL2_CONTEXT_OVERRIDES } from './polyfill-table';\nexport function polyfillContext(gl) {\n  gl.luma = gl.luma || {};\n  const {\n    luma\n  } = gl;\n\n  if (!luma.polyfilled) {\n    polyfillVertexArrayObject(gl);\n    initializeExtensions(gl);\n    installPolyfills(gl, WEBGL2_CONTEXT_POLYFILLS);\n    installOverrides(gl, {\n      target: luma,\n      target2: gl\n    });\n    luma.polyfilled = true;\n  }\n\n  return gl;\n}\nconst global_ = typeof global !== 'undefined' ? global : window;\nglobal_.polyfillContext = polyfillContext;\n\nfunction initializeExtensions(gl) {\n  gl.luma.extensions = {};\n  const EXTENSIONS = gl.getSupportedExtensions() || [];\n\n  for (const extension of EXTENSIONS) {\n    gl.luma[extension] = gl.getExtension(extension);\n  }\n}\n\nfunction installOverrides(gl, {\n  target,\n  target2\n}) {\n  Object.keys(WEBGL2_CONTEXT_OVERRIDES).forEach(key => {\n    if (typeof WEBGL2_CONTEXT_OVERRIDES[key] === 'function') {\n      const originalFunc = gl[key] ? gl[key].bind(gl) : () => {};\n      const polyfill = WEBGL2_CONTEXT_OVERRIDES[key].bind(null, gl, originalFunc);\n      target[key] = polyfill;\n      target2[key] = polyfill;\n    }\n  });\n}\n\nfunction installPolyfills(gl, polyfills) {\n  for (const extension of Object.getOwnPropertyNames(polyfills)) {\n    if (extension !== 'overrides') {\n      polyfillExtension(gl, {\n        extension,\n        target: gl.luma,\n        target2: gl\n      });\n    }\n  }\n}\n\nfunction polyfillExtension(gl, {\n  extension,\n  target,\n  target2\n}) {\n  const defaults = WEBGL2_CONTEXT_POLYFILLS[extension];\n  assert(defaults);\n  const {\n    meta = {}\n  } = defaults;\n  const {\n    suffix = ''\n  } = meta;\n  const ext = gl.getExtension(extension);\n\n  for (const key of Object.keys(defaults)) {\n    const extKey = \"\".concat(key).concat(suffix);\n    let polyfill = null;\n\n    if (key === 'meta') {} else if (typeof gl[key] === 'function') {} else if (ext && typeof ext[extKey] === 'function') {\n      polyfill = (...args) => ext[extKey](...args);\n    } else if (typeof defaults[key] === 'function') {\n      polyfill = defaults[key].bind(target);\n    }\n\n    if (polyfill) {\n      target[key] = polyfill;\n      target2[key] = polyfill;\n    }\n  }\n}\n//# sourceMappingURL=polyfill-context.js.map","import { isWebGL2 } from '../utils/webgl-checks';\nexport const GL_PARAMETER_DEFAULTS = {\n  [3042]: false,\n  [32773]: new Float32Array([0, 0, 0, 0]),\n  [32777]: 32774,\n  [34877]: 32774,\n  [32969]: 1,\n  [32968]: 0,\n  [32971]: 1,\n  [32970]: 0,\n  [3106]: new Float32Array([0, 0, 0, 0]),\n  [3107]: [true, true, true, true],\n  [2884]: false,\n  [2885]: 1029,\n  [2929]: false,\n  [2931]: 1,\n  [2932]: 513,\n  [2928]: new Float32Array([0, 1]),\n  [2930]: true,\n  [3024]: true,\n  [36006]: null,\n  [2886]: 2305,\n  [33170]: 4352,\n  [2849]: 1,\n  [32823]: false,\n  [32824]: 0,\n  [10752]: 0,\n  [32938]: 1.0,\n  [32939]: false,\n  [3089]: false,\n  [3088]: new Int32Array([0, 0, 1024, 1024]),\n  [2960]: false,\n  [2961]: 0,\n  [2968]: 0xffffffff,\n  [36005]: 0xffffffff,\n  [2962]: 519,\n  [2967]: 0,\n  [2963]: 0xffffffff,\n  [34816]: 519,\n  [36003]: 0,\n  [36004]: 0xffffffff,\n  [2964]: 7680,\n  [2965]: 7680,\n  [2966]: 7680,\n  [34817]: 7680,\n  [34818]: 7680,\n  [34819]: 7680,\n  [2978]: [0, 0, 1024, 1024],\n  [3333]: 4,\n  [3317]: 4,\n  [37440]: false,\n  [37441]: false,\n  [37443]: 37444,\n  [35723]: 4352,\n  [36010]: null,\n  [35977]: false,\n  [3330]: 0,\n  [3332]: 0,\n  [3331]: 0,\n  [3314]: 0,\n  [32878]: 0,\n  [3316]: 0,\n  [3315]: 0,\n  [32877]: 0\n};\n\nconst enable = (gl, value, key) => value ? gl.enable(key) : gl.disable(key);\n\nconst hint = (gl, value, key) => gl.hint(key, value);\n\nconst pixelStorei = (gl, value, key) => gl.pixelStorei(key, value);\n\nconst drawFramebuffer = (gl, value) => {\n  const target = isWebGL2(gl) ? 36009 : 36160;\n  return gl.bindFramebuffer(target, value);\n};\n\nconst readFramebuffer = (gl, value) => {\n  return gl.bindFramebuffer(36008, value);\n};\n\nfunction isArray(array) {\n  return Array.isArray(array) || ArrayBuffer.isView(array);\n}\n\nexport const GL_PARAMETER_SETTERS = {\n  [3042]: enable,\n  [32773]: (gl, value) => gl.blendColor(...value),\n  [32777]: 'blendEquation',\n  [34877]: 'blendEquation',\n  [32969]: 'blendFunc',\n  [32968]: 'blendFunc',\n  [32971]: 'blendFunc',\n  [32970]: 'blendFunc',\n  [3106]: (gl, value) => gl.clearColor(...value),\n  [3107]: (gl, value) => gl.colorMask(...value),\n  [2884]: enable,\n  [2885]: (gl, value) => gl.cullFace(value),\n  [2929]: enable,\n  [2931]: (gl, value) => gl.clearDepth(value),\n  [2932]: (gl, value) => gl.depthFunc(value),\n  [2928]: (gl, value) => gl.depthRange(...value),\n  [2930]: (gl, value) => gl.depthMask(value),\n  [3024]: enable,\n  [35723]: hint,\n  [36006]: drawFramebuffer,\n  [2886]: (gl, value) => gl.frontFace(value),\n  [33170]: hint,\n  [2849]: (gl, value) => gl.lineWidth(value),\n  [32823]: enable,\n  [32824]: 'polygonOffset',\n  [10752]: 'polygonOffset',\n  [35977]: enable,\n  [32938]: 'sampleCoverage',\n  [32939]: 'sampleCoverage',\n  [3089]: enable,\n  [3088]: (gl, value) => gl.scissor(...value),\n  [2960]: enable,\n  [2961]: (gl, value) => gl.clearStencil(value),\n  [2968]: (gl, value) => gl.stencilMaskSeparate(1028, value),\n  [36005]: (gl, value) => gl.stencilMaskSeparate(1029, value),\n  [2962]: 'stencilFuncFront',\n  [2967]: 'stencilFuncFront',\n  [2963]: 'stencilFuncFront',\n  [34816]: 'stencilFuncBack',\n  [36003]: 'stencilFuncBack',\n  [36004]: 'stencilFuncBack',\n  [2964]: 'stencilOpFront',\n  [2965]: 'stencilOpFront',\n  [2966]: 'stencilOpFront',\n  [34817]: 'stencilOpBack',\n  [34818]: 'stencilOpBack',\n  [34819]: 'stencilOpBack',\n  [2978]: (gl, value) => gl.viewport(...value),\n  [3333]: pixelStorei,\n  [3317]: pixelStorei,\n  [37440]: pixelStorei,\n  [37441]: pixelStorei,\n  [37443]: pixelStorei,\n  [3330]: pixelStorei,\n  [3332]: pixelStorei,\n  [3331]: pixelStorei,\n  [36010]: readFramebuffer,\n  [3314]: pixelStorei,\n  [32878]: pixelStorei,\n  [3316]: pixelStorei,\n  [3315]: pixelStorei,\n  [32877]: pixelStorei,\n  framebuffer: (gl, framebuffer) => {\n    const handle = framebuffer && 'handle' in framebuffer ? framebuffer.handle : framebuffer;\n    return gl.bindFramebuffer(36160, handle);\n  },\n  blend: (gl, value) => value ? gl.enable(3042) : gl.disable(3042),\n  blendColor: (gl, value) => gl.blendColor(...value),\n  blendEquation: (gl, args) => {\n    args = isArray(args) ? args : [args, args];\n    gl.blendEquationSeparate(...args);\n  },\n  blendFunc: (gl, args) => {\n    args = isArray(args) && args.length === 2 ? [...args, ...args] : args;\n    gl.blendFuncSeparate(...args);\n  },\n  clearColor: (gl, value) => gl.clearColor(...value),\n  clearDepth: (gl, value) => gl.clearDepth(value),\n  clearStencil: (gl, value) => gl.clearStencil(value),\n  colorMask: (gl, value) => gl.colorMask(...value),\n  cull: (gl, value) => value ? gl.enable(2884) : gl.disable(2884),\n  cullFace: (gl, value) => gl.cullFace(value),\n  depthTest: (gl, value) => value ? gl.enable(2929) : gl.disable(2929),\n  depthFunc: (gl, value) => gl.depthFunc(value),\n  depthMask: (gl, value) => gl.depthMask(value),\n  depthRange: (gl, value) => gl.depthRange(...value),\n  dither: (gl, value) => value ? gl.enable(3024) : gl.disable(3024),\n  derivativeHint: (gl, value) => {\n    gl.hint(35723, value);\n  },\n  frontFace: (gl, value) => gl.frontFace(value),\n  mipmapHint: (gl, value) => gl.hint(33170, value),\n  lineWidth: (gl, value) => gl.lineWidth(value),\n  polygonOffsetFill: (gl, value) => value ? gl.enable(32823) : gl.disable(32823),\n  polygonOffset: (gl, value) => gl.polygonOffset(...value),\n  sampleCoverage: (gl, value) => gl.sampleCoverage(...value),\n  scissorTest: (gl, value) => value ? gl.enable(3089) : gl.disable(3089),\n  scissor: (gl, value) => gl.scissor(...value),\n  stencilTest: (gl, value) => value ? gl.enable(2960) : gl.disable(2960),\n  stencilMask: (gl, value) => {\n    value = isArray(value) ? value : [value, value];\n    const [mask, backMask] = value;\n    gl.stencilMaskSeparate(1028, mask);\n    gl.stencilMaskSeparate(1029, backMask);\n  },\n  stencilFunc: (gl, args) => {\n    args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n    const [func, ref, mask, backFunc, backRef, backMask] = args;\n    gl.stencilFuncSeparate(1028, func, ref, mask);\n    gl.stencilFuncSeparate(1029, backFunc, backRef, backMask);\n  },\n  stencilOp: (gl, args) => {\n    args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n    const [sfail, dpfail, dppass, backSfail, backDpfail, backDppass] = args;\n    gl.stencilOpSeparate(1028, sfail, dpfail, dppass);\n    gl.stencilOpSeparate(1029, backSfail, backDpfail, backDppass);\n  },\n  viewport: (gl, value) => gl.viewport(...value)\n};\n\nfunction getValue(glEnum, values, cache) {\n  return values[glEnum] !== undefined ? values[glEnum] : cache[glEnum];\n}\n\nexport const GL_COMPOSITE_PARAMETER_SETTERS = {\n  blendEquation: (gl, values, cache) => gl.blendEquationSeparate(getValue(32777, values, cache), getValue(34877, values, cache)),\n  blendFunc: (gl, values, cache) => gl.blendFuncSeparate(getValue(32969, values, cache), getValue(32968, values, cache), getValue(32971, values, cache), getValue(32970, values, cache)),\n  polygonOffset: (gl, values, cache) => gl.polygonOffset(getValue(32824, values, cache), getValue(10752, values, cache)),\n  sampleCoverage: (gl, values, cache) => gl.sampleCoverage(getValue(32938, values, cache), getValue(32939, values, cache)),\n  stencilFuncFront: (gl, values, cache) => gl.stencilFuncSeparate(1028, getValue(2962, values, cache), getValue(2967, values, cache), getValue(2963, values, cache)),\n  stencilFuncBack: (gl, values, cache) => gl.stencilFuncSeparate(1029, getValue(34816, values, cache), getValue(36003, values, cache), getValue(36004, values, cache)),\n  stencilOpFront: (gl, values, cache) => gl.stencilOpSeparate(1028, getValue(2964, values, cache), getValue(2965, values, cache), getValue(2966, values, cache)),\n  stencilOpBack: (gl, values, cache) => gl.stencilOpSeparate(1029, getValue(34817, values, cache), getValue(34818, values, cache), getValue(34819, values, cache))\n};\nexport const GL_HOOKED_SETTERS = {\n  enable: (update, capability) => update({\n    [capability]: true\n  }),\n  disable: (update, capability) => update({\n    [capability]: false\n  }),\n  pixelStorei: (update, pname, value) => update({\n    [pname]: value\n  }),\n  hint: (update, pname, hint) => update({\n    [pname]: hint\n  }),\n  bindFramebuffer: (update, target, framebuffer) => {\n    switch (target) {\n      case 36160:\n        return update({\n          [36006]: framebuffer,\n          [36010]: framebuffer\n        });\n\n      case 36009:\n        return update({\n          [36006]: framebuffer\n        });\n\n      case 36008:\n        return update({\n          [36010]: framebuffer\n        });\n\n      default:\n        return null;\n    }\n  },\n  blendColor: (update, r, g, b, a) => update({\n    [32773]: new Float32Array([r, g, b, a])\n  }),\n  blendEquation: (update, mode) => update({\n    [32777]: mode,\n    [34877]: mode\n  }),\n  blendEquationSeparate: (update, modeRGB, modeAlpha) => update({\n    [32777]: modeRGB,\n    [34877]: modeAlpha\n  }),\n  blendFunc: (update, src, dst) => update({\n    [32969]: src,\n    [32968]: dst,\n    [32971]: src,\n    [32970]: dst\n  }),\n  blendFuncSeparate: (update, srcRGB, dstRGB, srcAlpha, dstAlpha) => update({\n    [32969]: srcRGB,\n    [32968]: dstRGB,\n    [32971]: srcAlpha,\n    [32970]: dstAlpha\n  }),\n  clearColor: (update, r, g, b, a) => update({\n    [3106]: new Float32Array([r, g, b, a])\n  }),\n  clearDepth: (update, depth) => update({\n    [2931]: depth\n  }),\n  clearStencil: (update, s) => update({\n    [2961]: s\n  }),\n  colorMask: (update, r, g, b, a) => update({\n    [3107]: [r, g, b, a]\n  }),\n  cullFace: (update, mode) => update({\n    [2885]: mode\n  }),\n  depthFunc: (update, func) => update({\n    [2932]: func\n  }),\n  depthRange: (update, zNear, zFar) => update({\n    [2928]: new Float32Array([zNear, zFar])\n  }),\n  depthMask: (update, mask) => update({\n    [2930]: mask\n  }),\n  frontFace: (update, face) => update({\n    [2886]: face\n  }),\n  lineWidth: (update, width) => update({\n    [2849]: width\n  }),\n  polygonOffset: (update, factor, units) => update({\n    [32824]: factor,\n    [10752]: units\n  }),\n  sampleCoverage: (update, value, invert) => update({\n    [32938]: value,\n    [32939]: invert\n  }),\n  scissor: (update, x, y, width, height) => update({\n    [3088]: new Int32Array([x, y, width, height])\n  }),\n  stencilMask: (update, mask) => update({\n    [2968]: mask,\n    [36005]: mask\n  }),\n  stencilMaskSeparate: (update, face, mask) => update({\n    [face === 1028 ? 2968 : 36005]: mask\n  }),\n  stencilFunc: (update, func, ref, mask) => update({\n    [2962]: func,\n    [2967]: ref,\n    [2963]: mask,\n    [34816]: func,\n    [36003]: ref,\n    [36004]: mask\n  }),\n  stencilFuncSeparate: (update, face, func, ref, mask) => update({\n    [face === 1028 ? 2962 : 34816]: func,\n    [face === 1028 ? 2967 : 36003]: ref,\n    [face === 1028 ? 2963 : 36004]: mask\n  }),\n  stencilOp: (update, fail, zfail, zpass) => update({\n    [2964]: fail,\n    [2965]: zfail,\n    [2966]: zpass,\n    [34817]: fail,\n    [34818]: zfail,\n    [34819]: zpass\n  }),\n  stencilOpSeparate: (update, face, fail, zfail, zpass) => update({\n    [face === 1028 ? 2964 : 34817]: fail,\n    [face === 1028 ? 2965 : 34818]: zfail,\n    [face === 1028 ? 2966 : 34819]: zpass\n  }),\n  viewport: (update, x, y, width, height) => update({\n    [2978]: [x, y, width, height]\n  })\n};\n\nconst isEnabled = (gl, key) => gl.isEnabled(key);\n\nexport const GL_PARAMETER_GETTERS = {\n  [3042]: isEnabled,\n  [2884]: isEnabled,\n  [2929]: isEnabled,\n  [3024]: isEnabled,\n  [32823]: isEnabled,\n  [32926]: isEnabled,\n  [32928]: isEnabled,\n  [3089]: isEnabled,\n  [2960]: isEnabled,\n  [35977]: isEnabled\n};\n//# sourceMappingURL=webgl-parameter-tables.js.map","export function isObjectEmpty(object) {\n  for (const key in object) {\n    return false;\n  }\n\n  return true;\n}\nexport function deepArrayEqual(x, y) {\n  if (x === y) {\n    return true;\n  }\n\n  const isArrayX = Array.isArray(x) || ArrayBuffer.isView(x);\n  const isArrayY = Array.isArray(y) || ArrayBuffer.isView(y);\n\n  if (isArrayX && isArrayY && x.length === y.length) {\n    for (let i = 0; i < x.length; ++i) {\n      if (x[i] !== y[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=utils.js.map","import { GL_PARAMETER_DEFAULTS, GL_HOOKED_SETTERS } from './webgl-parameter-tables';\nimport { setParameters, getParameters } from './unified-parameter-api';\nimport { assert } from '../utils/assert';\nimport { deepArrayEqual } from '../utils/utils';\n\nfunction installGetterOverride(gl, functionName) {\n  const originalGetterFunc = gl[functionName].bind(gl);\n\n  gl[functionName] = function get(...params) {\n    const pname = params[0];\n\n    if (!(pname in gl.state.cache)) {\n      gl.state.cache[pname] = originalGetterFunc(...params);\n    }\n\n    return gl.state.enable ? gl.state.cache[pname] : originalGetterFunc(...params);\n  };\n\n  Object.defineProperty(gl[functionName], 'name', {\n    value: \"\".concat(functionName, \"-from-cache\"),\n    configurable: false\n  });\n}\n\nfunction installSetterSpy(gl, functionName, setter) {\n  const originalSetterFunc = gl[functionName].bind(gl);\n\n  gl[functionName] = function set(...params) {\n    const {\n      valueChanged,\n      oldValue\n    } = setter(gl.state._updateCache, ...params);\n\n    if (valueChanged) {\n      originalSetterFunc(...params);\n    }\n\n    return oldValue;\n  };\n\n  Object.defineProperty(gl[functionName], 'name', {\n    value: \"\".concat(functionName, \"-to-cache\"),\n    configurable: false\n  });\n}\n\nfunction installProgramSpy(gl) {\n  const originalUseProgram = gl.useProgram.bind(gl);\n\n  gl.useProgram = function useProgramLuma(handle) {\n    if (gl.state.program !== handle) {\n      originalUseProgram(handle);\n      gl.state.program = handle;\n    }\n  };\n}\n\nclass GLState {\n  constructor(gl, {\n    copyState = false,\n    log = () => {}\n  } = {}) {\n    this.gl = gl;\n    this.program = null;\n    this.stateStack = [];\n    this.enable = true;\n    this.cache = copyState ? getParameters(gl) : Object.assign({}, GL_PARAMETER_DEFAULTS);\n    this.log = log;\n    this._updateCache = this._updateCache.bind(this);\n    Object.seal(this);\n  }\n\n  push(values = {}) {\n    this.stateStack.push({});\n  }\n\n  pop() {\n    assert(this.stateStack.length > 0);\n    const oldValues = this.stateStack[this.stateStack.length - 1];\n    setParameters(this.gl, oldValues);\n    this.stateStack.pop();\n  }\n\n  _updateCache(values) {\n    let valueChanged = false;\n    let oldValue;\n    const oldValues = this.stateStack.length > 0 && this.stateStack[this.stateStack.length - 1];\n\n    for (const key in values) {\n      assert(key !== undefined);\n      const value = values[key];\n      const cached = this.cache[key];\n\n      if (!deepArrayEqual(value, cached)) {\n        valueChanged = true;\n        oldValue = cached;\n\n        if (oldValues && !(key in oldValues)) {\n          oldValues[key] = cached;\n        }\n\n        this.cache[key] = value;\n      }\n    }\n\n    return {\n      valueChanged,\n      oldValue\n    };\n  }\n\n}\n\nexport function trackContextState(gl, options = {}) {\n  const {\n    enable = true,\n    copyState\n  } = options;\n  assert(copyState !== undefined);\n\n  if (!gl.state) {\n    const global_ = typeof global !== 'undefined' ? global : window;\n    const {\n      polyfillContext\n    } = global_;\n\n    if (polyfillContext) {\n      polyfillContext(gl);\n    }\n\n    gl.state = new GLState(gl, {\n      copyState\n    });\n    installProgramSpy(gl);\n\n    for (const key in GL_HOOKED_SETTERS) {\n      const setter = GL_HOOKED_SETTERS[key];\n      installSetterSpy(gl, key, setter);\n    }\n\n    installGetterOverride(gl, 'getParameter');\n    installGetterOverride(gl, 'isEnabled');\n  }\n\n  gl.state.enable = enable;\n  return gl;\n}\nexport function pushContextState(gl) {\n  if (!gl.state) {\n    trackContextState(gl, {\n      copyState: false\n    });\n  }\n\n  gl.state.push();\n}\nexport function popContextState(gl) {\n  assert(gl.state);\n  gl.state.pop();\n}\n//# sourceMappingURL=track-context-state.js.map","import { GL_PARAMETER_DEFAULTS, GL_PARAMETER_SETTERS, GL_COMPOSITE_PARAMETER_SETTERS, GL_PARAMETER_GETTERS } from './webgl-parameter-tables';\nimport { pushContextState, popContextState } from './track-context-state';\nimport { assert } from '../utils/assert';\nimport { isWebGL } from '../utils/webgl-checks';\nimport { isObjectEmpty } from '../utils/utils';\nexport function setParameters(gl, values) {\n  assert(isWebGL(gl), 'setParameters requires a WebGL context');\n\n  if (isObjectEmpty(values)) {\n    return;\n  }\n\n  const compositeSetters = {};\n\n  for (const key in values) {\n    const glConstant = Number(key);\n    const setter = GL_PARAMETER_SETTERS[key];\n\n    if (setter) {\n      if (typeof setter === 'string') {\n        compositeSetters[setter] = true;\n      } else {\n        setter(gl, values[key], glConstant);\n      }\n    }\n  }\n\n  const cache = gl.state && gl.state.cache;\n\n  if (cache) {\n    for (const key in compositeSetters) {\n      const compositeSetter = GL_COMPOSITE_PARAMETER_SETTERS[key];\n      compositeSetter(gl, values, cache);\n    }\n  }\n}\nexport function getParameters(gl, parameters) {\n  parameters = parameters || GL_PARAMETER_DEFAULTS;\n\n  if (typeof parameters === 'number') {\n    const key = parameters;\n    const getter = GL_PARAMETER_GETTERS[key];\n    return getter ? getter(gl, key) : gl.getParameter(key);\n  }\n\n  const parameterKeys = Array.isArray(parameters) ? parameters : Object.keys(parameters);\n  const state = {};\n\n  for (const key of parameterKeys) {\n    const getter = GL_PARAMETER_GETTERS[key];\n    state[key] = getter ? getter(gl, Number(key)) : gl.getParameter(Number(key));\n  }\n\n  return state;\n}\nexport function resetParameters(gl) {\n  setParameters(gl, GL_PARAMETER_DEFAULTS);\n}\nexport function withParameters(gl, parameters, func) {\n  if (isObjectEmpty(parameters)) {\n    return func(gl);\n  }\n\n  const {\n    nocatch = true\n  } = parameters;\n  pushContextState(gl);\n  setParameters(gl, parameters);\n  let value;\n\n  if (nocatch) {\n    value = func(gl);\n    popContextState(gl);\n  } else {\n    try {\n      value = func(gl);\n    } finally {\n      popContextState(gl);\n    }\n  }\n\n  return value;\n}\n//# sourceMappingURL=unified-parameter-api.js.map","export function cssToDeviceRatio(gl) {\n  const {\n    luma\n  } = gl;\n\n  if (gl.canvas && luma) {\n    const {\n      clientWidth\n    } = luma.canvasSizeInfo;\n    return clientWidth ? gl.drawingBufferWidth / clientWidth : 1;\n  }\n\n  return 1;\n}\nexport function cssToDevicePixels(gl, cssPixel, yInvert = true) {\n  const ratio = cssToDeviceRatio(gl);\n  const width = gl.drawingBufferWidth;\n  const height = gl.drawingBufferHeight;\n  return scalePixels(cssPixel, ratio, width, height, yInvert);\n}\nexport function getDevicePixelRatio(useDevicePixels) {\n  const windowRatio = typeof window === 'undefined' ? 1 : window.devicePixelRatio || 1;\n\n  if (Number.isFinite(useDevicePixels)) {\n    return useDevicePixels <= 0 ? 1 : useDevicePixels;\n  }\n\n  return useDevicePixels ? windowRatio : 1;\n}\n\nfunction scalePixels(pixel, ratio, width, height, yInvert) {\n  const x = scaleX(pixel[0], ratio, width);\n  let y = scaleY(pixel[1], ratio, height, yInvert);\n  let t = scaleX(pixel[0] + 1, ratio, width);\n  const xHigh = t === width - 1 ? t : t - 1;\n  t = scaleY(pixel[1] + 1, ratio, height, yInvert);\n  let yHigh;\n\n  if (yInvert) {\n    t = t === 0 ? t : t + 1;\n    yHigh = y;\n    y = t;\n  } else {\n    yHigh = t === height - 1 ? t : t - 1;\n  }\n\n  return {\n    x,\n    y,\n    width: Math.max(xHigh - x + 1, 1),\n    height: Math.max(yHigh - y + 1, 1)\n  };\n}\n\nfunction scaleX(x, ratio, width) {\n  const r = Math.min(Math.round(x * ratio), width - 1);\n  return r;\n}\n\nfunction scaleY(y, ratio, height, yInvert) {\n  return yInvert ? Math.max(0, height - 1 - Math.round(y * ratio)) : Math.min(Math.round(y * ratio), height - 1);\n}\n//# sourceMappingURL=device-pixels.js.map","import { global, isBrowser as getIsBrowser } from 'probe.gl/env';\nimport { trackContextState } from '../state-tracker/track-context-state';\nimport { log } from '../utils/log';\nimport { assert } from '../utils/assert';\nimport { getDevicePixelRatio } from '../utils/device-pixels';\nimport { isWebGL2 } from '../utils/webgl-checks';\nconst isBrowser = getIsBrowser();\nconst isPage = isBrowser && typeof document !== 'undefined';\nconst CONTEXT_DEFAULTS = {\n  webgl2: true,\n  webgl1: true,\n  throwOnError: true,\n  manageState: true,\n  canvas: null,\n  debug: false,\n  width: 800,\n  height: 600\n};\nexport function createGLContext(options = {}) {\n  assert(isBrowser, \"createGLContext only available in the browser.\\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils\");\n  options = Object.assign({}, CONTEXT_DEFAULTS, options);\n  const {\n    width,\n    height\n  } = options;\n\n  function onError(message) {\n    if (options.throwOnError) {\n      throw new Error(message);\n    }\n\n    console.error(message);\n    return null;\n  }\n\n  options.onError = onError;\n  let gl;\n  const {\n    canvas\n  } = options;\n  const targetCanvas = getCanvas({\n    canvas,\n    width,\n    height,\n    onError\n  });\n  gl = createBrowserContext(targetCanvas, options);\n\n  if (!gl) {\n    return null;\n  }\n\n  gl = instrumentGLContext(gl, options);\n  logInfo(gl);\n  return gl;\n}\nexport function instrumentGLContext(gl, options = {}) {\n  if (!gl || gl._instrumented) {\n    return gl;\n  }\n\n  gl._version = gl._version || getVersion(gl);\n  gl.luma = gl.luma || {};\n  gl.luma.canvasSizeInfo = gl.luma.canvasSizeInfo || {};\n  options = Object.assign({}, CONTEXT_DEFAULTS, options);\n  const {\n    manageState,\n    debug\n  } = options;\n\n  if (manageState) {\n    trackContextState(gl, {\n      copyState: false,\n      log: (...args) => log.log(1, ...args)()\n    });\n  }\n\n  if (isBrowser && debug) {\n    if (!global.makeDebugContext) {\n      log.warn('WebGL debug mode not activated. import \"@luma.gl/debug\" to enable.')();\n    } else {\n      gl = global.makeDebugContext(gl, options);\n      log.level = Math.max(log.level, 1);\n    }\n  }\n\n  gl._instrumented = true;\n  return gl;\n}\nexport function getContextDebugInfo(gl) {\n  const vendorMasked = gl.getParameter(7936);\n  const rendererMasked = gl.getParameter(7937);\n  const ext = gl.getExtension('WEBGL_debug_renderer_info');\n  const vendorUnmasked = ext && gl.getParameter(ext.UNMASKED_VENDOR_WEBGL || 7936);\n  const rendererUnmasked = ext && gl.getParameter(ext.UNMASKED_RENDERER_WEBGL || 7937);\n  return {\n    vendor: vendorUnmasked || vendorMasked,\n    renderer: rendererUnmasked || rendererMasked,\n    vendorMasked,\n    rendererMasked,\n    version: gl.getParameter(7938),\n    shadingLanguageVersion: gl.getParameter(35724)\n  };\n}\nexport function resizeGLContext(gl, options = {}) {\n  if (gl.canvas) {\n    const devicePixelRatio = getDevicePixelRatio(options.useDevicePixels);\n    setDevicePixelRatio(gl, devicePixelRatio, options);\n    return;\n  }\n\n  const ext = gl.getExtension('STACKGL_resize_drawingbuffer');\n\n  if (ext && \"width\" in options && \"height\" in options) {\n    ext.resize(options.width, options.height);\n  }\n}\n\nfunction createBrowserContext(canvas, options) {\n  const {\n    onError\n  } = options;\n  let errorMessage = null;\n\n  const onCreateError = error => errorMessage = error.statusMessage || errorMessage;\n\n  canvas.addEventListener('webglcontextcreationerror', onCreateError, false);\n  const {\n    webgl1 = true,\n    webgl2 = true\n  } = options;\n  let gl = null;\n\n  if (webgl2) {\n    gl = gl || canvas.getContext('webgl2', options);\n    gl = gl || canvas.getContext('experimental-webgl2', options);\n  }\n\n  if (webgl1) {\n    gl = gl || canvas.getContext('webgl', options);\n    gl = gl || canvas.getContext('experimental-webgl', options);\n  }\n\n  canvas.removeEventListener('webglcontextcreationerror', onCreateError, false);\n\n  if (!gl) {\n    return onError(\"Failed to create \".concat(webgl2 && !webgl1 ? 'WebGL2' : 'WebGL', \" context: \").concat(errorMessage || 'Unknown error'));\n  }\n\n  if (options.onContextLost) {\n    canvas.addEventListener('webglcontextlost', options.onContextLost, false);\n  }\n\n  if (options.onContextRestored) {\n    canvas.addEventListener('webglcontextrestored', options.onContextRestored, false);\n  }\n\n  return gl;\n}\n\nfunction getCanvas({\n  canvas,\n  width = 800,\n  height = 600,\n  onError\n}) {\n  let targetCanvas;\n\n  if (typeof canvas === 'string') {\n    const isPageLoaded = isPage && document.readyState === 'complete';\n\n    if (!isPageLoaded) {\n      onError(\"createGLContext called on canvas '\".concat(canvas, \"' before page was loaded\"));\n    }\n\n    targetCanvas = document.getElementById(canvas);\n  } else if (canvas) {\n    targetCanvas = canvas;\n  } else {\n    targetCanvas = document.createElement('canvas');\n    targetCanvas.id = 'lumagl-canvas';\n    targetCanvas.style.width = Number.isFinite(width) ? \"\".concat(width, \"px\") : '100%';\n    targetCanvas.style.height = Number.isFinite(height) ? \"\".concat(height, \"px\") : '100%';\n    document.body.insertBefore(targetCanvas, document.body.firstChild);\n  }\n\n  return targetCanvas;\n}\n\nfunction logInfo(gl) {\n  const webGL = isWebGL2(gl) ? 'WebGL2' : 'WebGL1';\n  const info = getContextDebugInfo(gl);\n  const driver = info ? \"(\".concat(info.vendor, \",\").concat(info.renderer, \")\") : '';\n  const debug = gl.debug ? ' debug' : '';\n  log.info(1, \"\".concat(webGL).concat(debug, \" context \").concat(driver))();\n}\n\nfunction getVersion(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return 2;\n  }\n\n  return 1;\n}\n\nfunction setDevicePixelRatio(gl, devicePixelRatio, options) {\n  let clientWidth = 'width' in options ? options.width : gl.canvas.clientWidth;\n  let clientHeight = 'height' in options ? options.height : gl.canvas.clientHeight;\n\n  if (!clientWidth || !clientHeight) {\n    log.log(1, 'Canvas clientWidth/clientHeight is 0')();\n    devicePixelRatio = 1;\n    clientWidth = gl.canvas.width || 1;\n    clientHeight = gl.canvas.height || 1;\n  }\n\n  gl.luma = gl.luma || {};\n  gl.luma.canvasSizeInfo = gl.luma.canvasSizeInfo || {};\n  const cachedSize = gl.luma.canvasSizeInfo;\n\n  if (cachedSize.clientWidth !== clientWidth || cachedSize.clientHeight !== clientHeight || cachedSize.devicePixelRatio !== devicePixelRatio) {\n    let clampedPixelRatio = devicePixelRatio;\n    const canvasWidth = Math.floor(clientWidth * clampedPixelRatio);\n    const canvasHeight = Math.floor(clientHeight * clampedPixelRatio);\n    gl.canvas.width = canvasWidth;\n    gl.canvas.height = canvasHeight;\n\n    if (gl.drawingBufferWidth !== canvasWidth || gl.drawingBufferHeight !== canvasHeight) {\n      log.warn(\"Device pixel ratio clamped\")();\n      clampedPixelRatio = Math.min(gl.drawingBufferWidth / clientWidth, gl.drawingBufferHeight / clientHeight);\n      gl.canvas.width = Math.floor(clientWidth * clampedPixelRatio);\n      gl.canvas.height = Math.floor(clientHeight * clampedPixelRatio);\n    }\n\n    Object.assign(gl.luma.canvasSizeInfo, {\n      clientWidth,\n      clientHeight,\n      devicePixelRatio\n    });\n  }\n}\n//# sourceMappingURL=context.js.map","import { log } from '@luma.gl/gltools';\nimport { Stats } from 'probe.gl';\nimport { isBrowser, global } from 'probe.gl/env';\nconst VERSION = typeof \"8.5.4\" !== 'undefined' ? \"8.5.4\" : 'untranspiled source';\nconst STARTUP_MESSAGE = 'set luma.log.level=1 (or higher) to trace rendering';\n\nclass StatsManager {\n  constructor() {\n    this.stats = new Map();\n  }\n\n  get(name) {\n    if (!this.stats.has(name)) {\n      this.stats.set(name, new Stats({\n        id: name\n      }));\n    }\n\n    return this.stats.get(name);\n  }\n\n}\n\nconst lumaStats = new StatsManager();\n\nif (global.luma && global.luma.VERSION !== VERSION) {\n  throw new Error(\"luma.gl - multiple VERSIONs detected: \".concat(global.luma.VERSION, \" vs \").concat(VERSION));\n}\n\nif (!global.luma) {\n  if (isBrowser()) {\n    log.log(1, \"luma.gl \".concat(VERSION, \" - \").concat(STARTUP_MESSAGE))();\n  }\n\n  global.luma = global.luma || {\n    VERSION,\n    version: VERSION,\n    log,\n    stats: lumaStats,\n    globals: {\n      modules: {},\n      nodeIO: {}\n    }\n  };\n}\n\nexport { lumaStats };\nexport default global.luma;\n//# sourceMappingURL=init.js.map","export function requestAnimationFrame(callback) {\n  return typeof window !== 'undefined' && window.requestAnimationFrame ? window.requestAnimationFrame(callback) : setTimeout(callback, 1000 / 60);\n}\nexport function cancelAnimationFrame(timerId) {\n  return typeof window !== 'undefined' && window.cancelAnimationFrame ? window.cancelAnimationFrame(timerId) : clearTimeout(timerId);\n}\n//# sourceMappingURL=request-animation-frame.js.map","const ERR_TYPE_DEDUCTION = 'Failed to deduce GL constant from typed array';\nexport function getGLTypeFromTypedArray(arrayOrType) {\n  const type = ArrayBuffer.isView(arrayOrType) ? arrayOrType.constructor : arrayOrType;\n\n  switch (type) {\n    case Float32Array:\n      return 5126;\n\n    case Uint16Array:\n      return 5123;\n\n    case Uint32Array:\n      return 5125;\n\n    case Uint8Array:\n      return 5121;\n\n    case Uint8ClampedArray:\n      return 5121;\n\n    case Int8Array:\n      return 5120;\n\n    case Int16Array:\n      return 5122;\n\n    case Int32Array:\n      return 5124;\n\n    default:\n      throw new Error(ERR_TYPE_DEDUCTION);\n  }\n}\nexport function getTypedArrayFromGLType(glType, {\n  clamped = true\n} = {}) {\n  switch (glType) {\n    case 5126:\n      return Float32Array;\n\n    case 5123:\n    case 33635:\n    case 32819:\n    case 32820:\n      return Uint16Array;\n\n    case 5125:\n      return Uint32Array;\n\n    case 5121:\n      return clamped ? Uint8ClampedArray : Uint8Array;\n\n    case 5120:\n      return Int8Array;\n\n    case 5122:\n      return Int16Array;\n\n    case 5124:\n      return Int32Array;\n\n    default:\n      throw new Error('Failed to deduce typed array type from GL constant');\n  }\n}\nexport function flipRows({\n  data,\n  width,\n  height,\n  bytesPerPixel = 4,\n  temp\n}) {\n  const bytesPerRow = width * bytesPerPixel;\n  temp = temp || new Uint8Array(bytesPerRow);\n\n  for (let y = 0; y < height / 2; ++y) {\n    const topOffset = y * bytesPerRow;\n    const bottomOffset = (height - y - 1) * bytesPerRow;\n    temp.set(data.subarray(topOffset, topOffset + bytesPerRow));\n    data.copyWithin(topOffset, bottomOffset, bottomOffset + bytesPerRow);\n    data.set(temp, bottomOffset);\n  }\n}\nexport function scalePixels({\n  data,\n  width,\n  height\n}) {\n  const newWidth = Math.round(width / 2);\n  const newHeight = Math.round(height / 2);\n  const newData = new Uint8Array(newWidth * newHeight * 4);\n\n  for (let y = 0; y < newHeight; y++) {\n    for (let x = 0; x < newWidth; x++) {\n      for (let c = 0; c < 4; c++) {\n        newData[(y * newWidth + x) * 4 + c] = data[(y * 2 * width + x * 2) * 4 + c];\n      }\n    }\n  }\n\n  return {\n    data: newData,\n    width: newWidth,\n    height: newHeight\n  };\n}\n//# sourceMappingURL=typed-array-utils.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'luma.gl: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import assert from './assert';\nconst uidCounters = {};\nexport function uid(id = 'id') {\n  uidCounters[id] = uidCounters[id] || 1;\n  const count = uidCounters[id]++;\n  return \"\".concat(id, \"-\").concat(count);\n}\nexport function isPowerOfTwo(n) {\n  assert(typeof n === 'number', 'Input must be a number');\n  return n && (n & n - 1) === 0;\n}\nexport function isObjectEmpty(obj) {\n  let isEmpty = true;\n\n  for (const key in obj) {\n    isEmpty = false;\n    break;\n  }\n\n  return isEmpty;\n}\n//# sourceMappingURL=utils.js.map","function formatArrayValue(v, opts) {\n  const {\n    maxElts = 16,\n    size = 1\n  } = opts;\n  let string = '[';\n\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += \",\".concat(i % size === 0 ? ' ' : '');\n    }\n\n    string += formatValue(v[i], opts);\n  }\n\n  const terminator = v.length > maxElts ? '...' : ']';\n  return \"\".concat(string).concat(terminator);\n}\n\nexport function formatValue(v, opts = {}) {\n  const EPSILON = 1e-16;\n  const {\n    isInteger = false\n  } = opts;\n\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, opts);\n  }\n\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n\n  if (isInteger) {\n    return v.toFixed(0);\n  }\n\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    return v.toFixed(0);\n  }\n\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n//# sourceMappingURL=format-value.js.map","import { log } from '@luma.gl/gltools';\nexport function stubRemovedMethods(instance, className, version, methodNames) {\n  const upgradeMessage = \"See luma.gl \".concat(version, \" Upgrade Guide at https://luma.gl/docs/upgrade-guide\");\n  const prototype = Object.getPrototypeOf(instance);\n  methodNames.forEach(methodName => {\n    if (prototype.methodName) {\n      return;\n    }\n\n    prototype[methodName] = () => {\n      log.removed(\"Calling removed method \".concat(className, \".\").concat(methodName, \": \"), upgradeMessage)();\n      throw new Error(methodName);\n    };\n  });\n}\n//# sourceMappingURL=stub-methods.js.map","import { log } from '@luma.gl/gltools';\nexport function checkProps(className, props, propChecks) {\n  const {\n    removedProps = {},\n    deprecatedProps = {},\n    replacedProps = {}\n  } = propChecks;\n\n  for (const propName in removedProps) {\n    if (propName in props) {\n      const replacementProp = removedProps[propName];\n      const replacement = replacementProp ? \"\".concat(className, \".\").concat(removedProps[propName]) : 'N/A';\n      log.removed(\"\".concat(className, \".\").concat(propName), replacement)();\n    }\n  }\n\n  for (const propName in deprecatedProps) {\n    if (propName in props) {\n      const replacementProp = deprecatedProps[propName];\n      log.deprecated(\"\".concat(className, \".\").concat(propName), \"\".concat(className, \".\").concat(replacementProp))();\n    }\n  }\n\n  let newProps = null;\n\n  for (const propName in replacedProps) {\n    if (propName in props) {\n      const replacementProp = replacedProps[propName];\n      log.deprecated(\"\".concat(className, \".\").concat(propName), \"\".concat(className, \".\").concat(replacementProp))();\n      newProps = newProps || Object.assign({}, props);\n      newProps[replacementProp] = props[propName];\n      delete newProps[propName];\n    }\n  }\n\n  return newProps || props;\n}\n//# sourceMappingURL=check-props.js.map","import { assert } from '../utils';\nexport function getKeyValue(gl, name) {\n  if (typeof name !== 'string') {\n    return name;\n  }\n\n  const number = Number(name);\n\n  if (!isNaN(number)) {\n    return number;\n  }\n\n  name = name.replace(/^.*\\./, '');\n  const value = gl[name];\n  assert(value !== undefined, \"Accessing undefined constant GL.\".concat(name));\n  return value;\n}\nexport function getKey(gl, value) {\n  value = Number(value);\n\n  for (const key in gl) {\n    if (gl[key] === value) {\n      return \"GL.\".concat(key);\n    }\n  }\n\n  return String(value);\n}\nexport function getKeyType(gl, value) {\n  assert(value !== undefined, 'undefined key');\n  value = Number(value);\n\n  for (const key in gl) {\n    if (gl[key] === value) {\n      return \"GL.\".concat(key);\n    }\n  }\n\n  return String(value);\n}\n//# sourceMappingURL=constants-to-keys.js.map","import { isWebGL2, assertWebGLContext } from '@luma.gl/gltools';\nimport { lumaStats } from '../init';\nimport { getKey, getKeyValue } from '../webgl-utils';\nimport { uid, assert, stubRemovedMethods } from '../utils';\nconst ERR_RESOURCE_METHOD_UNDEFINED = 'Resource subclass must define virtual methods';\nexport default class Resource {\n  constructor(gl, opts = {}) {\n    assertWebGLContext(gl);\n    const {\n      id,\n      userData = {}\n    } = opts;\n    this.gl = gl;\n    this.gl2 = gl;\n    this.id = id || uid(this.constructor.name);\n    this.userData = userData;\n    this._bound = false;\n    this._handle = opts.handle;\n\n    if (this._handle === undefined) {\n      this._handle = this._createHandle();\n    }\n\n    this.byteLength = 0;\n\n    this._addStats();\n  }\n\n  toString() {\n    return \"\".concat(this.constructor.name, \"(\").concat(this.id, \")\");\n  }\n\n  get handle() {\n    return this._handle;\n  }\n\n  delete({\n    deleteChildren = false\n  } = {}) {\n    const children = this._handle && this._deleteHandle(this._handle);\n\n    if (this._handle) {\n      this._removeStats();\n    }\n\n    this._handle = null;\n\n    if (children && deleteChildren) {\n      children.filter(Boolean).forEach(child => child.delete());\n    }\n\n    return this;\n  }\n\n  bind(funcOrHandle = this.handle) {\n    if (typeof funcOrHandle !== 'function') {\n      this._bindHandle(funcOrHandle);\n\n      return this;\n    }\n\n    let value;\n\n    if (!this._bound) {\n      this._bindHandle(this.handle);\n\n      this._bound = true;\n      value = funcOrHandle();\n      this._bound = false;\n\n      this._bindHandle(null);\n    } else {\n      value = funcOrHandle();\n    }\n\n    return value;\n  }\n\n  unbind() {\n    this.bind(null);\n  }\n\n  getParameter(pname, opts = {}) {\n    pname = getKeyValue(this.gl, pname);\n    assert(pname);\n    const parameters = this.constructor.PARAMETERS || {};\n    const parameter = parameters[pname];\n\n    if (parameter) {\n      const isWebgl2 = isWebGL2(this.gl);\n      const parameterAvailable = (!('webgl2' in parameter) || isWebgl2) && (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (!parameterAvailable) {\n        const webgl1Default = parameter.webgl1;\n        const webgl2Default = 'webgl2' in parameter ? parameter.webgl2 : parameter.webgl1;\n        const defaultValue = isWebgl2 ? webgl2Default : webgl1Default;\n        return defaultValue;\n      }\n    }\n\n    return this._getParameter(pname, opts);\n  }\n\n  getParameters(options = {}) {\n    const {\n      parameters,\n      keys\n    } = options;\n    const PARAMETERS = this.constructor.PARAMETERS || {};\n    const isWebgl2 = isWebGL2(this.gl);\n    const values = {};\n    const parameterKeys = parameters || Object.keys(PARAMETERS);\n\n    for (const pname of parameterKeys) {\n      const parameter = PARAMETERS[pname];\n      const parameterAvailable = parameter && (!('webgl2' in parameter) || isWebgl2) && (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (parameterAvailable) {\n        const key = keys ? getKey(this.gl, pname) : pname;\n        values[key] = this.getParameter(pname, options);\n\n        if (keys && parameter.type === 'GLenum') {\n          values[key] = getKey(this.gl, values[key]);\n        }\n      }\n    }\n\n    return values;\n  }\n\n  setParameter(pname, value) {\n    pname = getKeyValue(this.gl, pname);\n    assert(pname);\n    const parameters = this.constructor.PARAMETERS || {};\n    const parameter = parameters[pname];\n\n    if (parameter) {\n      const isWebgl2 = isWebGL2(this.gl);\n      const parameterAvailable = (!('webgl2' in parameter) || isWebgl2) && (!('extension' in parameter) || this.gl.getExtension(parameter.extension));\n\n      if (!parameterAvailable) {\n        throw new Error('Parameter not available on this platform');\n      }\n\n      if (parameter.type === 'GLenum') {\n        value = getKeyValue(value);\n      }\n    }\n\n    this._setParameter(pname, value);\n\n    return this;\n  }\n\n  setParameters(parameters) {\n    for (const pname in parameters) {\n      this.setParameter(pname, parameters[pname]);\n    }\n\n    return this;\n  }\n\n  stubRemovedMethods(className, version, methodNames) {\n    return stubRemovedMethods(this, className, version, methodNames);\n  }\n\n  initialize(opts) {}\n\n  _createHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _deleteHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _bindHandle(handle) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _getOptsFromHandle() {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _getParameter(pname, opts) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _setParameter(pname, value) {\n    throw new Error(ERR_RESOURCE_METHOD_UNDEFINED);\n  }\n\n  _context() {\n    this.gl.luma = this.gl.luma || {};\n    return this.gl.luma;\n  }\n\n  _addStats() {\n    const name = this.constructor.name;\n    const stats = lumaStats.get('Resource Counts');\n    stats.get('Resources Created').incrementCount();\n    stats.get(\"\".concat(name, \"s Created\")).incrementCount();\n    stats.get(\"\".concat(name, \"s Active\")).incrementCount();\n  }\n\n  _removeStats() {\n    const name = this.constructor.name;\n    const stats = lumaStats.get('Resource Counts');\n    stats.get(\"\".concat(name, \"s Active\")).decrementCount();\n  }\n\n  _trackAllocatedMemory(bytes, name = this.constructor.name) {\n    const stats = lumaStats.get('Memory Usage');\n    stats.get('GPU Memory').addCount(bytes);\n    stats.get(\"\".concat(name, \" Memory\")).addCount(bytes);\n    this.byteLength = bytes;\n  }\n\n  _trackDeallocatedMemory(name = this.constructor.name) {\n    const stats = lumaStats.get('Memory Usage');\n    stats.get('GPU Memory').subtractCount(this.byteLength);\n    stats.get(\"\".concat(name, \" Memory\")).subtractCount(this.byteLength);\n    this.byteLength = 0;\n  }\n\n}\n//# sourceMappingURL=resource.js.map","import { getTypedArrayFromGLType } from '../webgl-utils';\nimport { checkProps, assert } from '../utils';\nconst DEFAULT_ACCESSOR_VALUES = {\n  offset: 0,\n  stride: 0,\n  type: 5126,\n  size: 1,\n  divisor: 0,\n  normalized: false,\n  integer: false\n};\nconst PROP_CHECKS = {\n  deprecatedProps: {\n    instanced: 'divisor',\n    isInstanced: 'divisor'\n  }\n};\nexport default class Accessor {\n  static getBytesPerElement(accessor) {\n    const ArrayType = getTypedArrayFromGLType(accessor.type || 5126);\n    return ArrayType.BYTES_PER_ELEMENT;\n  }\n\n  static getBytesPerVertex(accessor) {\n    assert(accessor.size);\n    const ArrayType = getTypedArrayFromGLType(accessor.type || 5126);\n    return ArrayType.BYTES_PER_ELEMENT * accessor.size;\n  }\n\n  static resolve(...accessors) {\n    return new Accessor(...[DEFAULT_ACCESSOR_VALUES, ...accessors]);\n  }\n\n  constructor(...accessors) {\n    accessors.forEach(accessor => this._assign(accessor));\n    Object.freeze(this);\n  }\n\n  toString() {\n    return JSON.stringify(this);\n  }\n\n  get BYTES_PER_ELEMENT() {\n    return Accessor.getBytesPerElement(this);\n  }\n\n  get BYTES_PER_VERTEX() {\n    return Accessor.getBytesPerVertex(this);\n  }\n\n  _assign(props = {}) {\n    props = checkProps('Accessor', props, PROP_CHECKS);\n\n    if (props.type !== undefined) {\n      this.type = props.type;\n\n      if (props.type === 5124 || props.type === 5125) {\n        this.integer = true;\n      }\n    }\n\n    if (props.size !== undefined) {\n      this.size = props.size;\n    }\n\n    if (props.offset !== undefined) {\n      this.offset = props.offset;\n    }\n\n    if (props.stride !== undefined) {\n      this.stride = props.stride;\n    }\n\n    if (props.normalized !== undefined) {\n      this.normalized = props.normalized;\n    }\n\n    if (props.integer !== undefined) {\n      this.integer = props.integer;\n    }\n\n    if (props.divisor !== undefined) {\n      this.divisor = props.divisor;\n    }\n\n    if (props.buffer !== undefined) {\n      this.buffer = props.buffer;\n    }\n\n    if (props.index !== undefined) {\n      if (typeof props.index === 'boolean') {\n        this.index = props.index ? 1 : 0;\n      } else {\n        this.index = props.index;\n      }\n    }\n\n    if (props.instanced !== undefined) {\n      this.divisor = props.instanced ? 1 : 0;\n    }\n\n    if (props.isInstanced !== undefined) {\n      this.divisor = props.isInstanced ? 1 : 0;\n    }\n\n    return this;\n  }\n\n}\nexport { DEFAULT_ACCESSOR_VALUES };\n//# sourceMappingURL=accessor.js.map","import Resource from './resource';\nimport Accessor from './accessor';\nimport { getGLTypeFromTypedArray, getTypedArrayFromGLType } from '../webgl-utils';\nimport { assertWebGL2Context, log } from '@luma.gl/gltools';\nimport { assert, checkProps } from '../utils';\nconst DEBUG_DATA_LENGTH = 10;\nconst DEPRECATED_PROPS = {\n  offset: 'accessor.offset',\n  stride: 'accessor.stride',\n  type: 'accessor.type',\n  size: 'accessor.size',\n  divisor: 'accessor.divisor',\n  normalized: 'accessor.normalized',\n  integer: 'accessor.integer',\n  instanced: 'accessor.divisor',\n  isInstanced: 'accessor.divisor'\n};\nconst PROP_CHECKS_INITIALIZE = {\n  removedProps: {},\n  replacedProps: {\n    bytes: 'byteLength'\n  },\n  deprecatedProps: DEPRECATED_PROPS\n};\nconst PROP_CHECKS_SET_PROPS = {\n  removedProps: DEPRECATED_PROPS\n};\nexport default class Buffer extends Resource {\n  constructor(gl, props = {}) {\n    super(gl, props);\n    this.stubRemovedMethods('Buffer', 'v6.0', ['layout', 'setLayout', 'getIndexedParameter']);\n    this.target = props.target || (this.gl.webgl2 ? 36662 : 34962);\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n  getElementCount(accessor = this.accessor) {\n    return Math.round(this.byteLength / Accessor.getBytesPerElement(accessor));\n  }\n\n  getVertexCount(accessor = this.accessor) {\n    return Math.round(this.byteLength / Accessor.getBytesPerVertex(accessor));\n  }\n\n  initialize(props = {}) {\n    if (ArrayBuffer.isView(props)) {\n      props = {\n        data: props\n      };\n    }\n\n    if (Number.isFinite(props)) {\n      props = {\n        byteLength: props\n      };\n    }\n\n    props = checkProps('Buffer', props, PROP_CHECKS_INITIALIZE);\n    this.usage = props.usage || 35044;\n    this.debugData = null;\n    this.setAccessor(Object.assign({}, props, props.accessor));\n\n    if (props.data) {\n      this._setData(props.data, props.offset, props.byteLength);\n    } else {\n      this._setByteLength(props.byteLength || 0);\n    }\n\n    return this;\n  }\n\n  setProps(props) {\n    props = checkProps('Buffer', props, PROP_CHECKS_SET_PROPS);\n\n    if ('accessor' in props) {\n      this.setAccessor(props.accessor);\n    }\n\n    return this;\n  }\n\n  setAccessor(accessor) {\n    accessor = Object.assign({}, accessor);\n    delete accessor.buffer;\n    this.accessor = new Accessor(accessor);\n    return this;\n  }\n\n  reallocate(byteLength) {\n    if (byteLength > this.byteLength) {\n      this._setByteLength(byteLength);\n\n      return true;\n    }\n\n    this.bytesUsed = byteLength;\n    return false;\n  }\n\n  setData(props) {\n    return this.initialize(props);\n  }\n\n  subData(props) {\n    if (ArrayBuffer.isView(props)) {\n      props = {\n        data: props\n      };\n    }\n\n    const {\n      data,\n      offset = 0,\n      srcOffset = 0\n    } = props;\n    const byteLength = props.byteLength || props.length;\n    assert(data);\n    const target = this.gl.webgl2 ? 36663 : this.target;\n    this.gl.bindBuffer(target, this.handle);\n\n    if (srcOffset !== 0 || byteLength !== undefined) {\n      assertWebGL2Context(this.gl);\n      this.gl.bufferSubData(this.target, offset, data, srcOffset, byteLength);\n    } else {\n      this.gl.bufferSubData(target, offset, data);\n    }\n\n    this.gl.bindBuffer(target, null);\n    this.debugData = null;\n\n    this._inferType(data);\n\n    return this;\n  }\n\n  copyData({\n    sourceBuffer,\n    readOffset = 0,\n    writeOffset = 0,\n    size\n  }) {\n    const {\n      gl\n    } = this;\n    assertWebGL2Context(gl);\n    gl.bindBuffer(36662, sourceBuffer.handle);\n    gl.bindBuffer(36663, this.handle);\n    gl.copyBufferSubData(36662, 36663, readOffset, writeOffset, size);\n    gl.bindBuffer(36662, null);\n    gl.bindBuffer(36663, null);\n    this.debugData = null;\n    return this;\n  }\n\n  getData({\n    dstData = null,\n    srcByteOffset = 0,\n    dstOffset = 0,\n    length = 0\n  } = {}) {\n    assertWebGL2Context(this.gl);\n    const ArrayType = getTypedArrayFromGLType(this.accessor.type || 5126, {\n      clamped: false\n    });\n\n    const sourceAvailableElementCount = this._getAvailableElementCount(srcByteOffset);\n\n    const dstElementOffset = dstOffset;\n    let dstAvailableElementCount;\n    let dstElementCount;\n\n    if (dstData) {\n      dstElementCount = dstData.length;\n      dstAvailableElementCount = dstElementCount - dstElementOffset;\n    } else {\n      dstAvailableElementCount = Math.min(sourceAvailableElementCount, length || sourceAvailableElementCount);\n      dstElementCount = dstElementOffset + dstAvailableElementCount;\n    }\n\n    const copyElementCount = Math.min(sourceAvailableElementCount, dstAvailableElementCount);\n    length = length || copyElementCount;\n    assert(length <= copyElementCount);\n    dstData = dstData || new ArrayType(dstElementCount);\n    this.gl.bindBuffer(36662, this.handle);\n    this.gl.getBufferSubData(36662, srcByteOffset, dstData, dstOffset, length);\n    this.gl.bindBuffer(36662, null);\n    return dstData;\n  }\n\n  bind({\n    target = this.target,\n    index = this.accessor && this.accessor.index,\n    offset = 0,\n    size\n  } = {}) {\n    if (target === 35345 || target === 35982) {\n      if (size !== undefined) {\n        this.gl.bindBufferRange(target, index, this.handle, offset, size);\n      } else {\n        assert(offset === 0);\n        this.gl.bindBufferBase(target, index, this.handle);\n      }\n    } else {\n      this.gl.bindBuffer(target, this.handle);\n    }\n\n    return this;\n  }\n\n  unbind({\n    target = this.target,\n    index = this.accessor && this.accessor.index\n  } = {}) {\n    const isIndexedBuffer = target === 35345 || target === 35982;\n\n    if (isIndexedBuffer) {\n      this.gl.bindBufferBase(target, index, null);\n    } else {\n      this.gl.bindBuffer(target, null);\n    }\n\n    return this;\n  }\n\n  getDebugData() {\n    if (!this.debugData) {\n      this.debugData = this.getData({\n        length: Math.min(DEBUG_DATA_LENGTH, this.byteLength)\n      });\n      return {\n        data: this.debugData,\n        changed: true\n      };\n    }\n\n    return {\n      data: this.debugData,\n      changed: false\n    };\n  }\n\n  invalidateDebugData() {\n    this.debugData = null;\n  }\n\n  _setData(data, offset = 0, byteLength = data.byteLength + offset) {\n    assert(ArrayBuffer.isView(data));\n\n    this._trackDeallocatedMemory();\n\n    const target = this._getTarget();\n\n    this.gl.bindBuffer(target, this.handle);\n    this.gl.bufferData(target, byteLength, this.usage);\n    this.gl.bufferSubData(target, offset, data);\n    this.gl.bindBuffer(target, null);\n    this.debugData = data.slice(0, DEBUG_DATA_LENGTH);\n    this.bytesUsed = byteLength;\n\n    this._trackAllocatedMemory(byteLength);\n\n    const type = getGLTypeFromTypedArray(data);\n    assert(type);\n    this.setAccessor(new Accessor(this.accessor, {\n      type\n    }));\n    return this;\n  }\n\n  _setByteLength(byteLength, usage = this.usage) {\n    assert(byteLength >= 0);\n\n    this._trackDeallocatedMemory();\n\n    let data = byteLength;\n\n    if (byteLength === 0) {\n      data = new Float32Array(0);\n    }\n\n    const target = this._getTarget();\n\n    this.gl.bindBuffer(target, this.handle);\n    this.gl.bufferData(target, data, usage);\n    this.gl.bindBuffer(target, null);\n    this.usage = usage;\n    this.debugData = null;\n    this.bytesUsed = byteLength;\n\n    this._trackAllocatedMemory(byteLength);\n\n    return this;\n  }\n\n  _getTarget() {\n    return this.gl.webgl2 ? 36663 : this.target;\n  }\n\n  _getAvailableElementCount(srcByteOffset) {\n    const ArrayType = getTypedArrayFromGLType(this.accessor.type || 5126, {\n      clamped: false\n    });\n    const sourceElementOffset = srcByteOffset / ArrayType.BYTES_PER_ELEMENT;\n    return this.getElementCount() - sourceElementOffset;\n  }\n\n  _inferType(data) {\n    if (!this.accessor.type) {\n      this.setAccessor(new Accessor(this.accessor, {\n        type: getGLTypeFromTypedArray(data)\n      }));\n    }\n  }\n\n  _createHandle() {\n    return this.gl.createBuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteBuffer(this.handle);\n\n    this._trackDeallocatedMemory();\n  }\n\n  _getParameter(pname) {\n    this.gl.bindBuffer(this.target, this.handle);\n    const value = this.gl.getBufferParameter(this.target, pname);\n    this.gl.bindBuffer(this.target, null);\n    return value;\n  }\n\n  get type() {\n    log.deprecated('Buffer.type', 'Buffer.accessor.type')();\n    return this.accessor.type;\n  }\n\n  get bytes() {\n    log.deprecated('Buffer.bytes', 'Buffer.byteLength')();\n    return this.byteLength;\n  }\n\n  setByteLength(byteLength) {\n    log.deprecated('setByteLength', 'reallocate')();\n    return this.reallocate(byteLength);\n  }\n\n  updateAccessor(opts) {\n    log.deprecated('updateAccessor(...)', 'setAccessor(new Accessor(buffer.accessor, ...)')();\n    this.accessor = new Accessor(this.accessor, opts);\n    return this;\n  }\n\n}\n//# sourceMappingURL=buffer.js.map","import { isWebGL2 } from '@luma.gl/gltools';\nexport const TEXTURE_FORMATS = {\n  [6407]: {\n    dataFormat: 6407,\n    types: [5121, 33635]\n  },\n  [6408]: {\n    dataFormat: 6408,\n    types: [5121, 32819, 32820]\n  },\n  [6406]: {\n    dataFormat: 6406,\n    types: [5121]\n  },\n  [6409]: {\n    dataFormat: 6409,\n    types: [5121]\n  },\n  [6410]: {\n    dataFormat: 6410,\n    types: [5121]\n  },\n  [33326]: {\n    dataFormat: 6403,\n    types: [5126],\n    gl2: true\n  },\n  [33328]: {\n    dataFormat: 33319,\n    types: [5126],\n    gl2: true\n  },\n  [34837]: {\n    dataFormat: 6407,\n    types: [5126],\n    gl2: true\n  },\n  [34836]: {\n    dataFormat: 6408,\n    types: [5126],\n    gl2: true\n  }\n};\nexport const DATA_FORMAT_CHANNELS = {\n  [6403]: 1,\n  [36244]: 1,\n  [33319]: 2,\n  [33320]: 2,\n  [6407]: 3,\n  [36248]: 3,\n  [6408]: 4,\n  [36249]: 4,\n  [6402]: 1,\n  [34041]: 1,\n  [6406]: 1,\n  [6409]: 1,\n  [6410]: 2\n};\nexport const TYPE_SIZES = {\n  [5126]: 4,\n  [5125]: 4,\n  [5124]: 4,\n  [5123]: 2,\n  [5122]: 2,\n  [5131]: 2,\n  [5120]: 1,\n  [5121]: 1\n};\nexport function isFormatSupported(gl, format) {\n  const info = TEXTURE_FORMATS[format];\n\n  if (!info) {\n    return false;\n  }\n\n  if (info.gl1 === undefined && info.gl2 === undefined) {\n    return true;\n  }\n\n  const value = isWebGL2(gl) ? info.gl2 || info.gl1 : info.gl1;\n  return typeof value === 'string' ? gl.getExtension(value) : value;\n}\nexport function isLinearFilteringSupported(gl, format) {\n  const info = TEXTURE_FORMATS[format];\n\n  switch (info && info.types[0]) {\n    case 5126:\n      return gl.getExtension('OES_texture_float_linear');\n\n    case 5131:\n      return gl.getExtension('OES_texture_half_float_linear');\n\n    default:\n      return true;\n  }\n}\n//# sourceMappingURL=texture-formats.js.map","import { isWebGL2, assertWebGL2Context, withParameters, log } from '@luma.gl/gltools';\nimport { global } from 'probe.gl/env';\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport { TEXTURE_FORMATS, DATA_FORMAT_CHANNELS, TYPE_SIZES, isFormatSupported, isLinearFilteringSupported } from './texture-formats';\nimport { uid, isPowerOfTwo, assert } from '../utils';\nconst NPOT_MIN_FILTERS = [9729, 9728];\n\nconst WebGLBuffer = global.WebGLBuffer || function WebGLBuffer() {};\n\nexport default class Texture extends Resource {\n  static isSupported(gl, opts = {}) {\n    const {\n      format,\n      linearFiltering\n    } = opts;\n    let supported = true;\n\n    if (format) {\n      supported = supported && isFormatSupported(gl, format);\n      supported = supported && (!linearFiltering || isLinearFilteringSupported(gl, format));\n    }\n\n    return supported;\n  }\n\n  constructor(gl, props) {\n    const {\n      id = uid('texture'),\n      handle,\n      target\n    } = props;\n    super(gl, {\n      id,\n      handle\n    });\n    this.target = target;\n    this.textureUnit = undefined;\n    this.loaded = false;\n    this.width = undefined;\n    this.height = undefined;\n    this.depth = undefined;\n    this.format = undefined;\n    this.type = undefined;\n    this.dataFormat = undefined;\n    this.border = undefined;\n    this.textureUnit = undefined;\n    this.mipmaps = undefined;\n  }\n\n  toString() {\n    return \"Texture(\".concat(this.id, \",\").concat(this.width, \"x\").concat(this.height, \")\");\n  }\n\n  initialize(props = {}) {\n    let data = props.data;\n\n    if (data instanceof Promise) {\n      data.then(resolvedImageData => this.initialize(Object.assign({}, props, {\n        pixels: resolvedImageData,\n        data: resolvedImageData\n      })));\n      return this;\n    }\n\n    const isVideo = typeof HTMLVideoElement !== 'undefined' && data instanceof HTMLVideoElement;\n\n    if (isVideo && data.readyState < HTMLVideoElement.HAVE_METADATA) {\n      this._video = null;\n      data.addEventListener('loadeddata', () => this.initialize(props));\n      return this;\n    }\n\n    const {\n      pixels = null,\n      format = 6408,\n      border = 0,\n      recreate = false,\n      parameters = {},\n      pixelStore = {},\n      textureUnit = undefined\n    } = props;\n\n    if (!data) {\n      data = pixels;\n    }\n\n    let {\n      width,\n      height,\n      dataFormat,\n      type,\n      compressed = false,\n      mipmaps = true\n    } = props;\n    const {\n      depth = 0\n    } = props;\n    ({\n      width,\n      height,\n      compressed,\n      dataFormat,\n      type\n    } = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n    this.width = width;\n    this.height = height;\n    this.depth = depth;\n    this.format = format;\n    this.type = type;\n    this.dataFormat = dataFormat;\n    this.border = border;\n    this.textureUnit = textureUnit;\n\n    if (Number.isFinite(this.textureUnit)) {\n      this.gl.activeTexture(33984 + this.textureUnit);\n      this.gl.bindTexture(this.target, this.handle);\n    }\n\n    if (mipmaps && this._isNPOT()) {\n      log.warn(\"texture: \".concat(this, \" is Non-Power-Of-Two, disabling mipmaping\"))();\n      mipmaps = false;\n\n      this._updateForNPOT(parameters);\n    }\n\n    this.mipmaps = mipmaps;\n    this.setImageData({\n      data,\n      width,\n      height,\n      depth,\n      format,\n      type,\n      dataFormat,\n      border,\n      mipmaps,\n      parameters: pixelStore,\n      compressed\n    });\n\n    if (mipmaps) {\n      this.generateMipmap();\n    }\n\n    this.setParameters(parameters);\n\n    if (recreate) {\n      this.data = data;\n    }\n\n    if (isVideo) {\n      this._video = {\n        video: data,\n        parameters,\n        lastTime: data.readyState >= HTMLVideoElement.HAVE_CURRENT_DATA ? data.currentTime : -1\n      };\n    }\n\n    return this;\n  }\n\n  update() {\n    if (this._video) {\n      const {\n        video,\n        parameters,\n        lastTime\n      } = this._video;\n\n      if (lastTime === video.currentTime || video.readyState < HTMLVideoElement.HAVE_CURRENT_DATA) {\n        return;\n      }\n\n      this.setSubImageData({\n        data: video,\n        parameters\n      });\n\n      if (this.mipmaps) {\n        this.generateMipmap();\n      }\n\n      this._video.lastTime = video.currentTime;\n    }\n  }\n\n  resize({\n    height,\n    width,\n    mipmaps = false\n  }) {\n    if (width !== this.width || height !== this.height) {\n      return this.initialize({\n        width,\n        height,\n        format: this.format,\n        type: this.type,\n        dataFormat: this.dataFormat,\n        border: this.border,\n        mipmaps\n      });\n    }\n\n    return this;\n  }\n\n  generateMipmap(params = {}) {\n    if (this._isNPOT()) {\n      log.warn(\"texture: \".concat(this, \" is Non-Power-Of-Two, disabling mipmaping\"))();\n      return this;\n    }\n\n    this.mipmaps = true;\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, params, () => {\n      this.gl.generateMipmap(this.target);\n    });\n    this.gl.bindTexture(this.target, null);\n    return this;\n  }\n\n  setImageData(options) {\n    this._trackDeallocatedMemory('Texture');\n\n    const {\n      target = this.target,\n      pixels = null,\n      level = 0,\n      format = this.format,\n      border = this.border,\n      offset = 0,\n      parameters = {}\n    } = options;\n    let {\n      data = null,\n      type = this.type,\n      width = this.width,\n      height = this.height,\n      dataFormat = this.dataFormat,\n      compressed = false\n    } = options;\n\n    if (!data) {\n      data = pixels;\n    }\n\n    ({\n      type,\n      dataFormat,\n      compressed,\n      width,\n      height\n    } = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n    const {\n      gl\n    } = this;\n    gl.bindTexture(this.target, this.handle);\n    let dataType = null;\n    ({\n      data,\n      dataType\n    } = this._getDataType({\n      data,\n      compressed\n    }));\n    let gl2;\n    withParameters(this.gl, parameters, () => {\n      switch (dataType) {\n        case 'null':\n          gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data);\n          break;\n\n        case 'typed-array':\n          gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data, offset);\n          break;\n\n        case 'buffer':\n          gl2 = assertWebGL2Context(gl);\n          gl2.bindBuffer(35052, data.handle || data);\n          gl2.texImage2D(target, level, format, width, height, border, dataFormat, type, offset);\n          gl2.bindBuffer(35052, null);\n          break;\n\n        case 'browser-object':\n          if (isWebGL2(gl)) {\n            gl.texImage2D(target, level, format, width, height, border, dataFormat, type, data);\n          } else {\n            gl.texImage2D(target, level, format, dataFormat, type, data);\n          }\n\n          break;\n\n        case 'compressed':\n          for (const [levelIndex, levelData] of data.entries()) {\n            gl.compressedTexImage2D(target, levelIndex, levelData.format, levelData.width, levelData.height, border, levelData.data);\n          }\n\n          break;\n\n        default:\n          assert(false, 'Unknown image data type');\n      }\n    });\n\n    if (data && data.byteLength) {\n      this._trackAllocatedMemory(data.byteLength, 'Texture');\n    } else {\n      const channels = DATA_FORMAT_CHANNELS[this.dataFormat] || 4;\n      const channelSize = TYPE_SIZES[this.type] || 1;\n\n      this._trackAllocatedMemory(this.width * this.height * channels * channelSize, 'Texture');\n    }\n\n    this.loaded = true;\n    return this;\n  }\n\n  setSubImageData({\n    target = this.target,\n    pixels = null,\n    data = null,\n    x = 0,\n    y = 0,\n    width = this.width,\n    height = this.height,\n    level = 0,\n    format = this.format,\n    type = this.type,\n    dataFormat = this.dataFormat,\n    compressed = false,\n    offset = 0,\n    border = this.border,\n    parameters = {}\n  }) {\n    ({\n      type,\n      dataFormat,\n      compressed,\n      width,\n      height\n    } = this._deduceParameters({\n      format,\n      type,\n      dataFormat,\n      compressed,\n      data,\n      width,\n      height\n    }));\n    assert(this.depth === 0, 'texSubImage not supported for 3D textures');\n\n    if (!data) {\n      data = pixels;\n    }\n\n    if (data && data.data) {\n      const ndarray = data;\n      data = ndarray.data;\n      width = ndarray.shape[0];\n      height = ndarray.shape[1];\n    }\n\n    if (data instanceof Buffer) {\n      data = data.handle;\n    }\n\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, parameters, () => {\n      if (compressed) {\n        this.gl.compressedTexSubImage2D(target, level, x, y, width, height, format, data);\n      } else if (data === null) {\n        this.gl.texSubImage2D(target, level, x, y, width, height, dataFormat, type, null);\n      } else if (ArrayBuffer.isView(data)) {\n        this.gl.texSubImage2D(target, level, x, y, width, height, dataFormat, type, data, offset);\n      } else if (data instanceof WebGLBuffer) {\n        const gl2 = assertWebGL2Context(this.gl);\n        gl2.bindBuffer(35052, data);\n        gl2.texSubImage2D(target, level, x, y, width, height, dataFormat, type, offset);\n        gl2.bindBuffer(35052, null);\n      } else if (isWebGL2(this.gl)) {\n        const gl2 = assertWebGL2Context(this.gl);\n        gl2.texSubImage2D(target, level, x, y, width, height, dataFormat, type, data);\n      } else {\n        this.gl.texSubImage2D(target, level, x, y, dataFormat, type, data);\n      }\n    });\n    this.gl.bindTexture(this.target, null);\n  }\n\n  copyFramebuffer(opts = {}) {\n    log.error('Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})')();\n    return null;\n  }\n\n  getActiveUnit() {\n    return this.gl.getParameter(34016) - 33984;\n  }\n\n  bind(textureUnit = this.textureUnit) {\n    const {\n      gl\n    } = this;\n\n    if (textureUnit !== undefined) {\n      this.textureUnit = textureUnit;\n      gl.activeTexture(33984 + textureUnit);\n    }\n\n    gl.bindTexture(this.target, this.handle);\n    return textureUnit;\n  }\n\n  unbind(textureUnit = this.textureUnit) {\n    const {\n      gl\n    } = this;\n\n    if (textureUnit !== undefined) {\n      this.textureUnit = textureUnit;\n      gl.activeTexture(33984 + textureUnit);\n    }\n\n    gl.bindTexture(this.target, null);\n    return textureUnit;\n  }\n\n  _getDataType({\n    data,\n    compressed = false\n  }) {\n    if (compressed) {\n      return {\n        data,\n        dataType: 'compressed'\n      };\n    }\n\n    if (data === null) {\n      return {\n        data,\n        dataType: 'null'\n      };\n    }\n\n    if (ArrayBuffer.isView(data)) {\n      return {\n        data,\n        dataType: 'typed-array'\n      };\n    }\n\n    if (data instanceof Buffer) {\n      return {\n        data: data.handle,\n        dataType: 'buffer'\n      };\n    }\n\n    if (data instanceof WebGLBuffer) {\n      return {\n        data,\n        dataType: 'buffer'\n      };\n    }\n\n    return {\n      data,\n      dataType: 'browser-object'\n    };\n  }\n\n  _deduceParameters(opts) {\n    const {\n      format,\n      data\n    } = opts;\n    let {\n      width,\n      height,\n      dataFormat,\n      type,\n      compressed\n    } = opts;\n    const textureFormat = TEXTURE_FORMATS[format];\n    dataFormat = dataFormat || textureFormat && textureFormat.dataFormat;\n    type = type || textureFormat && textureFormat.types[0];\n    compressed = compressed || textureFormat && textureFormat.compressed;\n    ({\n      width,\n      height\n    } = this._deduceImageSize(data, width, height));\n    return {\n      dataFormat,\n      type,\n      compressed,\n      width,\n      height,\n      format,\n      data\n    };\n  }\n\n  _deduceImageSize(data, width, height) {\n    let size;\n\n    if (typeof ImageData !== 'undefined' && data instanceof ImageData) {\n      size = {\n        width: data.width,\n        height: data.height\n      };\n    } else if (typeof HTMLImageElement !== 'undefined' && data instanceof HTMLImageElement) {\n      size = {\n        width: data.naturalWidth,\n        height: data.naturalHeight\n      };\n    } else if (typeof HTMLCanvasElement !== 'undefined' && data instanceof HTMLCanvasElement) {\n      size = {\n        width: data.width,\n        height: data.height\n      };\n    } else if (typeof ImageBitmap !== 'undefined' && data instanceof ImageBitmap) {\n      size = {\n        width: data.width,\n        height: data.height\n      };\n    } else if (typeof HTMLVideoElement !== 'undefined' && data instanceof HTMLVideoElement) {\n      size = {\n        width: data.videoWidth,\n        height: data.videoHeight\n      };\n    } else if (!data) {\n      size = {\n        width: width >= 0 ? width : 1,\n        height: height >= 0 ? height : 1\n      };\n    } else {\n      size = {\n        width,\n        height\n      };\n    }\n\n    assert(size, 'Could not deduced texture size');\n    assert(width === undefined || size.width === width, 'Deduced texture width does not match supplied width');\n    assert(height === undefined || size.height === height, 'Deduced texture height does not match supplied height');\n    return size;\n  }\n\n  _createHandle() {\n    return this.gl.createTexture();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteTexture(this.handle);\n\n    this._trackDeallocatedMemory('Texture');\n  }\n\n  _getParameter(pname) {\n    switch (pname) {\n      case 4096:\n        return this.width;\n\n      case 4097:\n        return this.height;\n\n      default:\n        this.gl.bindTexture(this.target, this.handle);\n        const value = this.gl.getTexParameter(this.target, pname);\n        this.gl.bindTexture(this.target, null);\n        return value;\n    }\n  }\n\n  _setParameter(pname, param) {\n    this.gl.bindTexture(this.target, this.handle);\n    param = this._getNPOTParam(pname, param);\n\n    switch (pname) {\n      case 33082:\n      case 33083:\n        this.gl.texParameterf(this.handle, pname, param);\n        break;\n\n      case 4096:\n      case 4097:\n        assert(false);\n        break;\n\n      default:\n        this.gl.texParameteri(this.target, pname, param);\n        break;\n    }\n\n    this.gl.bindTexture(this.target, null);\n    return this;\n  }\n\n  _isNPOT() {\n    if (isWebGL2(this.gl)) {\n      return false;\n    }\n\n    if (!this.width || !this.height) {\n      return false;\n    }\n\n    return !isPowerOfTwo(this.width) || !isPowerOfTwo(this.height);\n  }\n\n  _updateForNPOT(parameters) {\n    if (parameters[this.gl.TEXTURE_MIN_FILTER] === undefined) {\n      parameters[this.gl.TEXTURE_MIN_FILTER] = this.gl.LINEAR;\n    }\n\n    if (parameters[this.gl.TEXTURE_WRAP_S] === undefined) {\n      parameters[this.gl.TEXTURE_WRAP_S] = this.gl.CLAMP_TO_EDGE;\n    }\n\n    if (parameters[this.gl.TEXTURE_WRAP_T] === undefined) {\n      parameters[this.gl.TEXTURE_WRAP_T] = this.gl.CLAMP_TO_EDGE;\n    }\n  }\n\n  _getNPOTParam(pname, param) {\n    if (this._isNPOT()) {\n      switch (pname) {\n        case 10241:\n          if (NPOT_MIN_FILTERS.indexOf(param) === -1) {\n            param = 9729;\n          }\n\n          break;\n\n        case 10242:\n        case 10243:\n          if (param !== 33071) {\n            param = 33071;\n          }\n\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    return param;\n  }\n\n}\n//# sourceMappingURL=texture.js.map","import { assertWebGLContext } from '@luma.gl/gltools';\nimport Texture from './texture';\nimport { loadImage } from '../utils/load-file';\nexport default class Texture2D extends Texture {\n  static isSupported(gl, opts) {\n    return Texture.isSupported(gl, opts);\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGLContext(gl);\n\n    if (props instanceof Promise || typeof props === 'string') {\n      props = {\n        data: props\n      };\n    }\n\n    if (typeof props.data === 'string') {\n      props = Object.assign({}, props, {\n        data: loadImage(props.data)\n      });\n    }\n\n    super(gl, Object.assign({}, props, {\n      target: 3553\n    }));\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n}\n//# sourceMappingURL=texture-2d.js.map","import { assert } from '../utils';\nlet pathPrefix = '';\nexport function setPathPrefix(prefix) {\n  pathPrefix = prefix;\n}\nexport function loadFile(url, options = {}) {\n  assert(typeof url === 'string');\n  url = pathPrefix + url;\n  const dataType = options.dataType || 'text';\n  return fetch(url, options).then(res => res[dataType]());\n}\nexport function loadImage(url, opts) {\n  assert(typeof url === 'string');\n  url = pathPrefix + url;\n  return new Promise((resolve, reject) => {\n    try {\n      const image = new Image();\n\n      image.onload = () => resolve(image);\n\n      image.onerror = () => reject(new Error(\"Could not load image \".concat(url, \".\")));\n\n      image.crossOrigin = opts && opts.crossOrigin || 'anonymous';\n      image.src = url;\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n//# sourceMappingURL=load-file.js.map","import { log, assertWebGLContext } from '@luma.gl/gltools';\nimport Texture from './texture';\nconst FACES = [34069, 34070, 34071, 34072, 34073, 34074];\nexport default class TextureCube extends Texture {\n  constructor(gl, props = {}) {\n    assertWebGLContext(gl);\n    super(gl, Object.assign({}, props, {\n      target: 34067\n    }));\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n  initialize(props = {}) {\n    const {\n      mipmaps = true,\n      parameters = {}\n    } = props;\n    this.opts = props;\n    this.setCubeMapImageData(props).then(() => {\n      this.loaded = true;\n\n      if (mipmaps) {\n        this.generateMipmap(props);\n      }\n\n      this.setParameters(parameters);\n    });\n    return this;\n  }\n\n  subImage({\n    face,\n    data,\n    x = 0,\n    y = 0,\n    mipmapLevel = 0\n  }) {\n    return this._subImage({\n      target: face,\n      data,\n      x,\n      y,\n      mipmapLevel\n    });\n  }\n\n  async setCubeMapImageData({\n    width,\n    height,\n    pixels,\n    data,\n    border = 0,\n    format = 6408,\n    type = 5121\n  }) {\n    const {\n      gl\n    } = this;\n    const imageDataMap = pixels || data;\n    const resolvedFaces = await Promise.all(FACES.map(face => {\n      const facePixels = imageDataMap[face];\n      return Promise.all(Array.isArray(facePixels) ? facePixels : [facePixels]);\n    }));\n    this.bind();\n    FACES.forEach((face, index) => {\n      if (resolvedFaces[index].length > 1 && this.opts.mipmaps !== false) {\n        log.warn(\"\".concat(this.id, \" has mipmap and multiple LODs.\"))();\n      }\n\n      resolvedFaces[index].forEach((image, lodLevel) => {\n        if (width && height) {\n          gl.texImage2D(face, lodLevel, format, width, height, border, format, type, image);\n        } else {\n          gl.texImage2D(face, lodLevel, format, format, type, image);\n        }\n      });\n    });\n    this.unbind();\n  }\n\n  setImageDataForFace(options) {\n    const {\n      face,\n      width,\n      height,\n      pixels,\n      data,\n      border = 0,\n      format = 6408,\n      type = 5121\n    } = options;\n    const {\n      gl\n    } = this;\n    const imageData = pixels || data;\n    this.bind();\n\n    if (imageData instanceof Promise) {\n      imageData.then(resolvedImageData => this.setImageDataForFace(Object.assign({}, options, {\n        face,\n        data: resolvedImageData,\n        pixels: resolvedImageData\n      })));\n    } else if (this.width || this.height) {\n      gl.texImage2D(face, 0, format, width, height, border, format, type, imageData);\n    } else {\n      gl.texImage2D(face, 0, format, format, type, imageData);\n    }\n\n    return this;\n  }\n\n}\nTextureCube.FACES = FACES;\n//# sourceMappingURL=texture-cube.js.map","import { isWebGL2, assertWebGL2Context, withParameters } from '@luma.gl/gltools';\nimport Texture from './texture';\nimport { DATA_FORMAT_CHANNELS, TYPE_SIZES } from './texture-formats';\nimport Buffer from './buffer';\nexport default class Texture3D extends Texture {\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGL2Context(gl);\n    props = Object.assign({\n      depth: 1\n    }, props, {\n      target: 32879,\n      unpackFlipY: false\n    });\n    super(gl, props);\n    this.initialize(props);\n    Object.seal(this);\n  }\n\n  setImageData({\n    level = 0,\n    dataFormat = 6408,\n    width,\n    height,\n    depth = 1,\n    border = 0,\n    format,\n    type = 5121,\n    offset = 0,\n    data,\n    parameters = {}\n  }) {\n    this._trackDeallocatedMemory('Texture');\n\n    this.gl.bindTexture(this.target, this.handle);\n    withParameters(this.gl, parameters, () => {\n      if (ArrayBuffer.isView(data)) {\n        this.gl.texImage3D(this.target, level, dataFormat, width, height, depth, border, format, type, data);\n      }\n\n      if (data instanceof Buffer) {\n        this.gl.bindBuffer(35052, data.handle);\n        this.gl.texImage3D(this.target, level, dataFormat, width, height, depth, border, format, type, offset);\n      }\n    });\n\n    if (data && data.byteLength) {\n      this._trackAllocatedMemory(data.byteLength, 'Texture');\n    } else {\n      const channels = DATA_FORMAT_CHANNELS[this.dataFormat] || 4;\n      const channelSize = TYPE_SIZES[this.type] || 1;\n\n      this._trackAllocatedMemory(this.width * this.height * this.depth * channels * channelSize, 'Texture');\n    }\n\n    this.loaded = true;\n    return this;\n  }\n\n}\n//# sourceMappingURL=texture-3d.js.map","const EXT_FLOAT_WEBGL2 = 'EXT_color_buffer_float';\nexport default {\n  [33189]: {\n    bpp: 2\n  },\n  [33190]: {\n    gl2: true,\n    bpp: 3\n  },\n  [36012]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36168]: {\n    bpp: 1\n  },\n  [34041]: {\n    bpp: 4\n  },\n  [35056]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36013]: {\n    gl2: true,\n    bpp: 5\n  },\n  [32854]: {\n    bpp: 2\n  },\n  [36194]: {\n    bpp: 2\n  },\n  [32855]: {\n    bpp: 2\n  },\n  [33321]: {\n    gl2: true,\n    bpp: 1\n  },\n  [33330]: {\n    gl2: true,\n    bpp: 1\n  },\n  [33329]: {\n    gl2: true,\n    bpp: 1\n  },\n  [33332]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33331]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33334]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33333]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33323]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33336]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33335]: {\n    gl2: true,\n    bpp: 2\n  },\n  [33338]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33337]: {\n    gl2: true,\n    bpp: 4\n  },\n  [33340]: {\n    gl2: true,\n    bpp: 8\n  },\n  [33339]: {\n    gl2: true,\n    bpp: 8\n  },\n  [32849]: {\n    gl2: true,\n    bpp: 3\n  },\n  [32856]: {\n    gl2: true,\n    bpp: 4\n  },\n  [32857]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36220]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36238]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36975]: {\n    gl2: true,\n    bpp: 4\n  },\n  [36214]: {\n    gl2: true,\n    bpp: 8\n  },\n  [36232]: {\n    gl2: true,\n    bpp: 8\n  },\n  [36226]: {\n    gl2: true,\n    bpp: 16\n  },\n  [36208]: {\n    gl2: true,\n    bpp: 16\n  },\n  [33325]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 2\n  },\n  [33327]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 4\n  },\n  [34842]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 8\n  },\n  [33326]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 4\n  },\n  [33328]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 8\n  },\n  [34836]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 16\n  },\n  [35898]: {\n    gl2: EXT_FLOAT_WEBGL2,\n    bpp: 4\n  }\n};\n//# sourceMappingURL=renderbuffer-formats.js.map","import Resource from './resource';\nimport RENDERBUFFER_FORMATS from './renderbuffer-formats';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert } from '../utils';\n\nfunction isFormatSupported(gl, format, formats) {\n  const info = formats[format];\n\n  if (!info) {\n    return false;\n  }\n\n  const value = isWebGL2(gl) ? info.gl2 || info.gl1 : info.gl1;\n\n  if (typeof value === 'string') {\n    return gl.getExtension(value);\n  }\n\n  return value;\n}\n\nexport default class Renderbuffer extends Resource {\n  static isSupported(gl, {\n    format\n  } = {\n    format: null\n  }) {\n    return !format || isFormatSupported(gl, format, RENDERBUFFER_FORMATS);\n  }\n\n  static getSamplesForFormat(gl, {\n    format\n  }) {\n    return gl.getInternalformatParameter(36161, format, 32937);\n  }\n\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  initialize({\n    format,\n    width = 1,\n    height = 1,\n    samples = 0\n  }) {\n    assert(format, 'Needs format');\n\n    this._trackDeallocatedMemory();\n\n    this.gl.bindRenderbuffer(36161, this.handle);\n\n    if (samples !== 0 && isWebGL2(this.gl)) {\n      this.gl.renderbufferStorageMultisample(36161, samples, format, width, height);\n    } else {\n      this.gl.renderbufferStorage(36161, format, width, height);\n    }\n\n    this.format = format;\n    this.width = width;\n    this.height = height;\n    this.samples = samples;\n\n    this._trackAllocatedMemory(this.width * this.height * (this.samples || 1) * RENDERBUFFER_FORMATS[this.format].bpp);\n\n    return this;\n  }\n\n  resize({\n    width,\n    height\n  }) {\n    if (width !== this.width || height !== this.height) {\n      return this.initialize({\n        width,\n        height,\n        format: this.format,\n        samples: this.samples\n      });\n    }\n\n    return this;\n  }\n\n  _createHandle() {\n    return this.gl.createRenderbuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteRenderbuffer(this.handle);\n\n    this._trackDeallocatedMemory();\n  }\n\n  _bindHandle(handle) {\n    this.gl.bindRenderbuffer(36161, handle);\n  }\n\n  _syncHandle(handle) {\n    this.format = this.getParameter(36164);\n    this.width = this.getParameter(36162);\n    this.height = this.getParameter(36163);\n    this.samples = this.getParameter(36011);\n  }\n\n  _getParameter(pname) {\n    this.gl.bindRenderbuffer(36161, this.handle);\n    const value = this.gl.getRenderbufferParameter(36161, pname);\n    return value;\n  }\n\n}\n//# sourceMappingURL=renderbuffer.js.map","import { assertWebGL2Context, withParameters } from '@luma.gl/gltools';\nimport { assert } from '../utils';\nconst GL_DEPTH_BUFFER_BIT = 0x00000100;\nconst GL_STENCIL_BUFFER_BIT = 0x00000400;\nconst GL_COLOR_BUFFER_BIT = 0x00004000;\nconst GL_COLOR = 0x1800;\nconst GL_DEPTH = 0x1801;\nconst GL_STENCIL = 0x1802;\nconst GL_DEPTH_STENCIL = 0x84f9;\nconst ERR_ARGUMENTS = 'clear: bad arguments';\nexport function clear(gl, {\n  framebuffer = null,\n  color = null,\n  depth = null,\n  stencil = null\n} = {}) {\n  const parameters = {};\n\n  if (framebuffer) {\n    parameters.framebuffer = framebuffer;\n  }\n\n  let clearFlags = 0;\n\n  if (color) {\n    clearFlags |= GL_COLOR_BUFFER_BIT;\n\n    if (color !== true) {\n      parameters.clearColor = color;\n    }\n  }\n\n  if (depth) {\n    clearFlags |= GL_DEPTH_BUFFER_BIT;\n\n    if (depth !== true) {\n      parameters.clearDepth = depth;\n    }\n  }\n\n  if (stencil) {\n    clearFlags |= GL_STENCIL_BUFFER_BIT;\n\n    if (depth !== true) {\n      parameters.clearStencil = depth;\n    }\n  }\n\n  assert(clearFlags !== 0, ERR_ARGUMENTS);\n  withParameters(gl, parameters, () => {\n    gl.clear(clearFlags);\n  });\n}\nexport function clearBuffer(gl, {\n  framebuffer = null,\n  buffer = GL_COLOR,\n  drawBuffer = 0,\n  value = [0, 0, 0, 0]\n} = {}) {\n  assertWebGL2Context(gl);\n  withParameters(gl, {\n    framebuffer\n  }, () => {\n    switch (buffer) {\n      case GL_COLOR:\n        switch (value.constructor) {\n          case Int32Array:\n            gl.clearBufferiv(buffer, drawBuffer, value);\n            break;\n\n          case Uint32Array:\n            gl.clearBufferuiv(buffer, drawBuffer, value);\n            break;\n\n          case Float32Array:\n          default:\n            gl.clearBufferfv(buffer, drawBuffer, value);\n        }\n\n        break;\n\n      case GL_DEPTH:\n        gl.clearBufferfv(GL_DEPTH, 0, [value]);\n        break;\n\n      case GL_STENCIL:\n        gl.clearBufferiv(GL_STENCIL, 0, [value]);\n        break;\n\n      case GL_DEPTH_STENCIL:\n        const [depth, stencil] = value;\n        gl.clearBufferfi(GL_DEPTH_STENCIL, 0, depth, stencil);\n        break;\n\n      default:\n        assert(false, ERR_ARGUMENTS);\n    }\n  });\n}\n//# sourceMappingURL=clear.js.map","import Buffer from './buffer';\nimport Framebuffer from './framebuffer';\nimport Texture from './texture';\nimport { assertWebGL2Context, withParameters, log } from '@luma.gl/gltools';\nimport { flipRows, scalePixels } from '../webgl-utils';\nimport { getTypedArrayFromGLType, getGLTypeFromTypedArray } from '../webgl-utils/typed-array-utils';\nimport { glFormatToComponents, glTypeToBytes } from '../webgl-utils/format-utils';\nimport { toFramebuffer } from '../webgl-utils/texture-utils';\nimport { assert } from '../utils';\nexport function readPixelsToArray(source, options = {}) {\n  const {\n    sourceX = 0,\n    sourceY = 0,\n    sourceFormat = 6408\n  } = options;\n  let {\n    sourceAttachment = 36064,\n    target = null,\n    sourceWidth,\n    sourceHeight,\n    sourceType\n  } = options;\n  const {\n    framebuffer,\n    deleteFramebuffer\n  } = getFramebuffer(source);\n  assert(framebuffer);\n  const {\n    gl,\n    handle,\n    attachments\n  } = framebuffer;\n  sourceWidth = sourceWidth || framebuffer.width;\n  sourceHeight = sourceHeight || framebuffer.height;\n\n  if (sourceAttachment === 36064 && handle === null) {\n    sourceAttachment = 1028;\n  }\n\n  assert(attachments[sourceAttachment]);\n  sourceType = sourceType || attachments[sourceAttachment].type;\n  target = getPixelArray(target, sourceType, sourceFormat, sourceWidth, sourceHeight);\n  sourceType = sourceType || getGLTypeFromTypedArray(target);\n  const prevHandle = gl.bindFramebuffer(36160, handle);\n  gl.readPixels(sourceX, sourceY, sourceWidth, sourceHeight, sourceFormat, sourceType, target);\n  gl.bindFramebuffer(36160, prevHandle || null);\n\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return target;\n}\nexport function readPixelsToBuffer(source, {\n  sourceX = 0,\n  sourceY = 0,\n  sourceFormat = 6408,\n  target = null,\n  targetByteOffset = 0,\n  sourceWidth,\n  sourceHeight,\n  sourceType\n}) {\n  const {\n    framebuffer,\n    deleteFramebuffer\n  } = getFramebuffer(source);\n  assert(framebuffer);\n  sourceWidth = sourceWidth || framebuffer.width;\n  sourceHeight = sourceHeight || framebuffer.height;\n  const gl2 = assertWebGL2Context(framebuffer.gl);\n  sourceType = sourceType || (target ? target.type : 5121);\n\n  if (!target) {\n    const components = glFormatToComponents(sourceFormat);\n    const byteCount = glTypeToBytes(sourceType);\n    const byteLength = targetByteOffset + sourceWidth * sourceHeight * components * byteCount;\n    target = new Buffer(gl2, {\n      byteLength,\n      accessor: {\n        type: sourceType,\n        size: components\n      }\n    });\n  }\n\n  target.bind({\n    target: 35051\n  });\n  withParameters(gl2, {\n    framebuffer\n  }, () => {\n    gl2.readPixels(sourceX, sourceY, sourceWidth, sourceHeight, sourceFormat, sourceType, targetByteOffset);\n  });\n  target.unbind({\n    target: 35051\n  });\n\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return target;\n}\nexport function copyToDataUrl(source, {\n  sourceAttachment = 36064,\n  targetMaxHeight = Number.MAX_SAFE_INTEGER\n} = {}) {\n  let data = readPixelsToArray(source, {\n    sourceAttachment\n  });\n  let {\n    width,\n    height\n  } = source;\n\n  while (height > targetMaxHeight) {\n    ({\n      data,\n      width,\n      height\n    } = scalePixels({\n      data,\n      width,\n      height\n    }));\n  }\n\n  flipRows({\n    data,\n    width,\n    height\n  });\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const context = canvas.getContext('2d');\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(data);\n  context.putImageData(imageData, 0, 0);\n  return canvas.toDataURL();\n}\nexport function copyToImage(source, {\n  sourceAttachment = 36064,\n  targetImage = null\n} = {}) {\n  const dataUrl = copyToDataUrl(source, {\n    sourceAttachment\n  });\n  targetImage = targetImage || new Image();\n  targetImage.src = dataUrl;\n  return targetImage;\n}\nexport function copyToTexture(source, target, options = {}) {\n  const {\n    sourceX = 0,\n    sourceY = 0,\n    targetMipmaplevel = 0,\n    targetInternalFormat = 6408\n  } = options;\n  let {\n    targetX,\n    targetY,\n    targetZ,\n    width,\n    height\n  } = options;\n  const {\n    framebuffer,\n    deleteFramebuffer\n  } = getFramebuffer(source);\n  assert(framebuffer);\n  const {\n    gl,\n    handle\n  } = framebuffer;\n  const isSubCopy = typeof targetX !== 'undefined' || typeof targetY !== 'undefined' || typeof targetZ !== 'undefined';\n  targetX = targetX || 0;\n  targetY = targetY || 0;\n  targetZ = targetZ || 0;\n  const prevHandle = gl.bindFramebuffer(36160, handle);\n  assert(target);\n  let texture = null;\n\n  if (target instanceof Texture) {\n    texture = target;\n    width = Number.isFinite(width) ? width : texture.width;\n    height = Number.isFinite(height) ? height : texture.height;\n    texture.bind(0);\n    target = texture.target;\n  }\n\n  if (!isSubCopy) {\n    gl.copyTexImage2D(target, targetMipmaplevel, targetInternalFormat, sourceX, sourceY, width, height, 0);\n  } else {\n    switch (target) {\n      case 3553:\n      case 34067:\n        gl.copyTexSubImage2D(target, targetMipmaplevel, targetX, targetY, sourceX, sourceY, width, height);\n        break;\n\n      case 35866:\n      case 32879:\n        const gl2 = assertWebGL2Context(gl);\n        gl2.copyTexSubImage3D(target, targetMipmaplevel, targetX, targetY, targetZ, sourceX, sourceY, width, height);\n        break;\n\n      default:\n    }\n  }\n\n  if (texture) {\n    texture.unbind();\n  }\n\n  gl.bindFramebuffer(36160, prevHandle || null);\n\n  if (deleteFramebuffer) {\n    framebuffer.delete();\n  }\n\n  return texture;\n}\nexport function blit(source, target, options = {}) {\n  const {\n    sourceX0 = 0,\n    sourceY0 = 0,\n    targetX0 = 0,\n    targetY0 = 0,\n    color = true,\n    depth = false,\n    stencil = false,\n    filter = 9728\n  } = options;\n  let {\n    sourceX1,\n    sourceY1,\n    targetX1,\n    targetY1,\n    sourceAttachment = 36064,\n    mask = 0\n  } = options;\n  const {\n    framebuffer: srcFramebuffer,\n    deleteFramebuffer: deleteSrcFramebuffer\n  } = getFramebuffer(source);\n  const {\n    framebuffer: dstFramebuffer,\n    deleteFramebuffer: deleteDstFramebuffer\n  } = getFramebuffer(target);\n  assert(srcFramebuffer);\n  assert(dstFramebuffer);\n  const {\n    gl,\n    handle,\n    width,\n    height,\n    readBuffer\n  } = dstFramebuffer;\n  const gl2 = assertWebGL2Context(gl);\n\n  if (!srcFramebuffer.handle && sourceAttachment === 36064) {\n    sourceAttachment = 1028;\n  }\n\n  if (color) {\n    mask |= 16384;\n  }\n\n  if (depth) {\n    mask |= 256;\n  }\n\n  if (stencil) {\n    mask |= 1024;\n  }\n\n  if (deleteSrcFramebuffer || deleteDstFramebuffer) {\n    if (mask & (256 | 1024)) {\n      mask = 16384;\n      log.warn('Blitting from or into a Texture object, forcing mask to GL.COLOR_BUFFER_BIT')();\n    }\n  }\n\n  assert(mask);\n  sourceX1 = sourceX1 === undefined ? srcFramebuffer.width : sourceX1;\n  sourceY1 = sourceY1 === undefined ? srcFramebuffer.height : sourceY1;\n  targetX1 = targetX1 === undefined ? width : targetX1;\n  targetY1 = targetY1 === undefined ? height : targetY1;\n  const prevDrawHandle = gl.bindFramebuffer(36009, handle);\n  const prevReadHandle = gl.bindFramebuffer(36008, srcFramebuffer.handle);\n  gl2.readBuffer(sourceAttachment);\n  gl2.blitFramebuffer(sourceX0, sourceY0, sourceX1, sourceY1, targetX0, targetY0, targetX1, targetY1, mask, filter);\n  gl2.readBuffer(readBuffer);\n  gl2.bindFramebuffer(36008, prevReadHandle || null);\n  gl2.bindFramebuffer(36009, prevDrawHandle || null);\n\n  if (deleteSrcFramebuffer) {\n    srcFramebuffer.delete();\n  }\n\n  if (deleteDstFramebuffer) {\n    dstFramebuffer.delete();\n  }\n\n  return dstFramebuffer;\n}\n\nfunction getFramebuffer(source) {\n  if (!(source instanceof Framebuffer)) {\n    return {\n      framebuffer: toFramebuffer(source),\n      deleteFramebuffer: true\n    };\n  }\n\n  return {\n    framebuffer: source,\n    deleteFramebuffer: false\n  };\n}\n\nfunction getPixelArray(pixelArray, type, format, width, height) {\n  if (pixelArray) {\n    return pixelArray;\n  }\n\n  type = type || 5121;\n  const ArrayType = getTypedArrayFromGLType(type, {\n    clamped: false\n  });\n  const components = glFormatToComponents(format);\n  return new ArrayType(width * height * components);\n}\n//# sourceMappingURL=copy-and-blit.js.map","import { assert } from '../utils';\nexport function glFormatToComponents(format) {\n  switch (format) {\n    case 6406:\n    case 33326:\n    case 6403:\n      return 1;\n\n    case 33328:\n    case 33319:\n      return 2;\n\n    case 6407:\n    case 34837:\n      return 3;\n\n    case 6408:\n    case 34836:\n      return 4;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function glTypeToBytes(type) {\n  switch (type) {\n    case 5121:\n      return 1;\n\n    case 33635:\n    case 32819:\n    case 32820:\n      return 2;\n\n    case 5126:\n      return 4;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\n//# sourceMappingURL=format-utils.js.map","import Framebuffer from '../classes/framebuffer';\nimport Texture2D from '../classes/texture-2d';\nexport const FEATURES = {\n  WEBGL2: 'WEBGL2',\n  VERTEX_ARRAY_OBJECT: 'VERTEX_ARRAY_OBJECT',\n  TIMER_QUERY: 'TIMER_QUERY',\n  INSTANCED_RENDERING: 'INSTANCED_RENDERING',\n  MULTIPLE_RENDER_TARGETS: 'MULTIPLE_RENDER_TARGETS',\n  ELEMENT_INDEX_UINT32: 'ELEMENT_INDEX_UINT32',\n  BLEND_EQUATION_MINMAX: 'BLEND_EQUATION_MINMAX',\n  FLOAT_BLEND: 'FLOAT_BLEND',\n  COLOR_ENCODING_SRGB: 'COLOR_ENCODING_SRGB',\n  TEXTURE_DEPTH: 'TEXTURE_DEPTH',\n  TEXTURE_FLOAT: 'TEXTURE_FLOAT',\n  TEXTURE_HALF_FLOAT: 'TEXTURE_HALF_FLOAT',\n  TEXTURE_FILTER_LINEAR_FLOAT: 'TEXTURE_FILTER_LINEAR_FLOAT',\n  TEXTURE_FILTER_LINEAR_HALF_FLOAT: 'TEXTURE_FILTER_LINEAR_HALF_FLOAT',\n  TEXTURE_FILTER_ANISOTROPIC: 'TEXTURE_FILTER_ANISOTROPIC',\n  COLOR_ATTACHMENT_RGBA32F: 'COLOR_ATTACHMENT_RGBA32F',\n  COLOR_ATTACHMENT_FLOAT: 'COLOR_ATTACHMENT_FLOAT',\n  COLOR_ATTACHMENT_HALF_FLOAT: 'COLOR_ATTACHMENT_HALF_FLOAT',\n  GLSL_FRAG_DATA: 'GLSL_FRAG_DATA',\n  GLSL_FRAG_DEPTH: 'GLSL_FRAG_DEPTH',\n  GLSL_DERIVATIVES: 'GLSL_DERIVATIVES',\n  GLSL_TEXTURE_LOD: 'GLSL_TEXTURE_LOD'\n};\n\nfunction checkFloat32ColorAttachment(gl) {\n  const testTexture = new Texture2D(gl, {\n    format: 6408,\n    type: 5126,\n    dataFormat: 6408\n  });\n  const testFb = new Framebuffer(gl, {\n    id: \"test-framebuffer\",\n    check: false,\n    attachments: {\n      [36064]: testTexture\n    }\n  });\n  const status = testFb.getStatus();\n  testTexture.delete();\n  testFb.delete();\n  return status === 36053;\n}\n\nexport default {\n  [FEATURES.WEBGL2]: [false, true],\n  [FEATURES.VERTEX_ARRAY_OBJECT]: ['OES_vertex_array_object', true],\n  [FEATURES.TIMER_QUERY]: ['EXT_disjoint_timer_query', 'EXT_disjoint_timer_query_webgl2'],\n  [FEATURES.INSTANCED_RENDERING]: ['ANGLE_instanced_arrays', true],\n  [FEATURES.MULTIPLE_RENDER_TARGETS]: ['WEBGL_draw_buffers', true],\n  [FEATURES.ELEMENT_INDEX_UINT32]: ['OES_element_index_uint', true],\n  [FEATURES.BLEND_EQUATION_MINMAX]: ['EXT_blend_minmax', true],\n  [FEATURES.FLOAT_BLEND]: ['EXT_float_blend'],\n  [FEATURES.COLOR_ENCODING_SRGB]: ['EXT_sRGB', true],\n  [FEATURES.TEXTURE_DEPTH]: ['WEBGL_depth_texture', true],\n  [FEATURES.TEXTURE_FLOAT]: ['OES_texture_float', true],\n  [FEATURES.TEXTURE_HALF_FLOAT]: ['OES_texture_half_float', true],\n  [FEATURES.TEXTURE_FILTER_LINEAR_FLOAT]: ['OES_texture_float_linear'],\n  [FEATURES.TEXTURE_FILTER_LINEAR_HALF_FLOAT]: ['OES_texture_half_float_linear'],\n  [FEATURES.TEXTURE_FILTER_ANISOTROPIC]: ['EXT_texture_filter_anisotropic'],\n  [FEATURES.COLOR_ATTACHMENT_RGBA32F]: [checkFloat32ColorAttachment, 'EXT_color_buffer_float'],\n  [FEATURES.COLOR_ATTACHMENT_FLOAT]: [false, 'EXT_color_buffer_float'],\n  [FEATURES.COLOR_ATTACHMENT_HALF_FLOAT]: ['EXT_color_buffer_half_float'],\n  [FEATURES.GLSL_FRAG_DATA]: ['WEBGL_draw_buffers', true],\n  [FEATURES.GLSL_FRAG_DEPTH]: ['EXT_frag_depth', true],\n  [FEATURES.GLSL_DERIVATIVES]: ['OES_standard_derivatives', true],\n  [FEATURES.GLSL_TEXTURE_LOD]: ['EXT_shader_texture_lod', true]\n};\n//# sourceMappingURL=webgl-features-table.js.map","import WEBGL_FEATURES from './webgl-features-table';\nimport { isWebGL2, log } from '@luma.gl/gltools';\nimport { assert } from '../utils';\nconst LOG_UNSUPPORTED_FEATURE = 2;\nexport function hasFeature(gl, feature) {\n  return hasFeatures(gl, feature);\n}\nexport function hasFeatures(gl, features) {\n  features = Array.isArray(features) ? features : [features];\n  return features.every(feature => {\n    return isFeatureSupported(gl, feature);\n  });\n}\nexport function getFeatures(gl) {\n  gl.luma = gl.luma || {};\n  gl.luma.caps = gl.luma.caps || {};\n\n  for (const cap in WEBGL_FEATURES) {\n    if (gl.luma.caps[cap] === undefined) {\n      gl.luma.caps[cap] = isFeatureSupported(gl, cap);\n    }\n  }\n\n  return gl.luma.caps;\n}\n\nfunction isFeatureSupported(gl, cap) {\n  gl.luma = gl.luma || {};\n  gl.luma.caps = gl.luma.caps || {};\n\n  if (gl.luma.caps[cap] === undefined) {\n    gl.luma.caps[cap] = queryFeature(gl, cap);\n  }\n\n  if (!gl.luma.caps[cap]) {\n    log.log(LOG_UNSUPPORTED_FEATURE, \"Feature: \".concat(cap, \" not supported\"))();\n  }\n\n  return gl.luma.caps[cap];\n}\n\nfunction queryFeature(gl, cap) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n  let isSupported;\n  const featureDefinition = isWebGL2(gl) ? feature[1] || feature[0] : feature[0];\n\n  if (typeof featureDefinition === 'function') {\n    isSupported = featureDefinition(gl);\n  } else if (Array.isArray(featureDefinition)) {\n    isSupported = true;\n\n    for (const extension of featureDefinition) {\n      isSupported = isSupported && Boolean(gl.getExtension(extension));\n    }\n  } else if (typeof featureDefinition === 'string') {\n    isSupported = Boolean(gl.getExtension(featureDefinition));\n  } else if (typeof featureDefinition === 'boolean') {\n    isSupported = featureDefinition;\n  } else {\n    assert(false);\n  }\n\n  return isSupported;\n}\n//# sourceMappingURL=features.js.map","import { getWebGL2Context, assertWebGL2Context, log } from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Texture2D from './texture-2d';\nimport Renderbuffer from './renderbuffer';\nimport { clear, clearBuffer } from './clear';\nimport { copyToDataUrl } from './copy-and-blit.js';\nimport { getFeatures } from '../features';\nimport { getKey } from '../webgl-utils';\nimport { assert } from '../utils';\nconst ERR_MULTIPLE_RENDERTARGETS = 'Multiple render targets not supported';\nexport default class Framebuffer extends Resource {\n  static isSupported(gl, options = {}) {\n    const {\n      colorBufferFloat,\n      colorBufferHalfFloat\n    } = options;\n    let supported = true;\n\n    if (colorBufferFloat) {\n      supported = Boolean(gl.getExtension('EXT_color_buffer_float') || gl.getExtension('WEBGL_color_buffer_float') || gl.getExtension('OES_texture_float'));\n    }\n\n    if (colorBufferHalfFloat) {\n      supported = supported && Boolean(gl.getExtension('EXT_color_buffer_float') || gl.getExtension('EXT_color_buffer_half_float'));\n    }\n\n    return supported;\n  }\n\n  static getDefaultFramebuffer(gl) {\n    gl.luma = gl.luma || {};\n    gl.luma.defaultFramebuffer = gl.luma.defaultFramebuffer || new Framebuffer(gl, {\n      id: 'default-framebuffer',\n      handle: null,\n      attachments: {}\n    });\n    return gl.luma.defaultFramebuffer;\n  }\n\n  get MAX_COLOR_ATTACHMENTS() {\n    const gl2 = assertWebGL2Context(this.gl);\n    return gl2.getParameter(gl2.MAX_COLOR_ATTACHMENTS);\n  }\n\n  get MAX_DRAW_BUFFERS() {\n    const gl2 = assertWebGL2Context(this.gl);\n    return gl2.getParameter(gl2.MAX_DRAW_BUFFERS);\n  }\n\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n    this.width = null;\n    this.height = null;\n    this.attachments = {};\n    this.readBuffer = 36064;\n    this.drawBuffers = [36064];\n    this.ownResources = [];\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  get color() {\n    return this.attachments[36064] || null;\n  }\n\n  get texture() {\n    return this.attachments[36064] || null;\n  }\n\n  get depth() {\n    return this.attachments[36096] || this.attachments[33306] || null;\n  }\n\n  get stencil() {\n    return this.attachments[36128] || this.attachments[33306] || null;\n  }\n\n  initialize({\n    width = 1,\n    height = 1,\n    attachments = null,\n    color = true,\n    depth = true,\n    stencil = false,\n    check = true,\n    readBuffer = undefined,\n    drawBuffers = undefined\n  }) {\n    assert(width >= 0 && height >= 0, 'Width and height need to be integers');\n    this.width = width;\n    this.height = height;\n\n    if (attachments) {\n      for (const attachment in attachments) {\n        const target = attachments[attachment];\n        const object = Array.isArray(target) ? target[0] : target;\n        object.resize({\n          width,\n          height\n        });\n      }\n    } else {\n      attachments = this._createDefaultAttachments(color, depth, stencil, width, height);\n    }\n\n    this.update({\n      clearAttachments: true,\n      attachments,\n      readBuffer,\n      drawBuffers\n    });\n\n    if (attachments && check) {\n      this.checkStatus();\n    }\n  }\n\n  delete() {\n    for (const resource of this.ownResources) {\n      resource.delete();\n    }\n\n    super.delete();\n    return this;\n  }\n\n  update({\n    attachments = {},\n    readBuffer,\n    drawBuffers,\n    clearAttachments = false,\n    resizeAttachments = true\n  }) {\n    this.attach(attachments, {\n      clearAttachments,\n      resizeAttachments\n    });\n    const {\n      gl\n    } = this;\n    const prevHandle = gl.bindFramebuffer(36160, this.handle);\n\n    if (readBuffer) {\n      this._setReadBuffer(readBuffer);\n    }\n\n    if (drawBuffers) {\n      this._setDrawBuffers(drawBuffers);\n    }\n\n    gl.bindFramebuffer(36160, prevHandle || null);\n    return this;\n  }\n\n  resize(options = {}) {\n    let {\n      width,\n      height\n    } = options;\n\n    if (this.handle === null) {\n      assert(width === undefined && height === undefined);\n      this.width = this.gl.drawingBufferWidth;\n      this.height = this.gl.drawingBufferHeight;\n      return this;\n    }\n\n    if (width === undefined) {\n      width = this.gl.drawingBufferWidth;\n    }\n\n    if (height === undefined) {\n      height = this.gl.drawingBufferHeight;\n    }\n\n    if (width !== this.width && height !== this.height) {\n      log.log(2, \"Resizing framebuffer \".concat(this.id, \" to \").concat(width, \"x\").concat(height))();\n    }\n\n    for (const attachmentPoint in this.attachments) {\n      this.attachments[attachmentPoint].resize({\n        width,\n        height\n      });\n    }\n\n    this.width = width;\n    this.height = height;\n    return this;\n  }\n\n  attach(attachments, {\n    clearAttachments = false,\n    resizeAttachments = true\n  } = {}) {\n    const newAttachments = {};\n\n    if (clearAttachments) {\n      Object.keys(this.attachments).forEach(key => {\n        newAttachments[key] = null;\n      });\n    }\n\n    Object.assign(newAttachments, attachments);\n    const prevHandle = this.gl.bindFramebuffer(36160, this.handle);\n\n    for (const key in newAttachments) {\n      assert(key !== undefined, 'Misspelled framebuffer binding point?');\n      const attachment = Number(key);\n      const descriptor = newAttachments[attachment];\n      let object = descriptor;\n\n      if (!object) {\n        this._unattach(attachment);\n      } else if (object instanceof Renderbuffer) {\n        this._attachRenderbuffer({\n          attachment,\n          renderbuffer: object\n        });\n      } else if (Array.isArray(descriptor)) {\n        const [texture, layer = 0, level = 0] = descriptor;\n        object = texture;\n\n        this._attachTexture({\n          attachment,\n          texture,\n          layer,\n          level\n        });\n      } else {\n        this._attachTexture({\n          attachment,\n          texture: object,\n          layer: 0,\n          level: 0\n        });\n      }\n\n      if (resizeAttachments && object) {\n        object.resize({\n          width: this.width,\n          height: this.height\n        });\n      }\n    }\n\n    this.gl.bindFramebuffer(36160, prevHandle || null);\n    Object.assign(this.attachments, attachments);\n    Object.keys(this.attachments).filter(key => !this.attachments[key]).forEach(key => {\n      delete this.attachments[key];\n    });\n  }\n\n  checkStatus() {\n    const {\n      gl\n    } = this;\n    const status = this.getStatus();\n\n    if (status !== 36053) {\n      throw new Error(_getFrameBufferStatus(status));\n    }\n\n    return this;\n  }\n\n  getStatus() {\n    const {\n      gl\n    } = this;\n    const prevHandle = gl.bindFramebuffer(36160, this.handle);\n    const status = gl.checkFramebufferStatus(36160);\n    gl.bindFramebuffer(36160, prevHandle || null);\n    return status;\n  }\n\n  clear(options = {}) {\n    const {\n      color,\n      depth,\n      stencil,\n      drawBuffers = []\n    } = options;\n    const prevHandle = this.gl.bindFramebuffer(36160, this.handle);\n\n    if (color || depth || stencil) {\n      clear(this.gl, {\n        color,\n        depth,\n        stencil\n      });\n    }\n\n    drawBuffers.forEach((value, drawBuffer) => {\n      clearBuffer(this.gl, {\n        drawBuffer,\n        value\n      });\n    });\n    this.gl.bindFramebuffer(36160, prevHandle || null);\n    return this;\n  }\n\n  readPixels(opts = {}) {\n    log.error('Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)')();\n    return null;\n  }\n\n  readPixelsToBuffer(opts = {}) {\n    log.error('Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)')();\n    return null;\n  }\n\n  copyToDataUrl(opts = {}) {\n    log.error('Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)')();\n    return null;\n  }\n\n  copyToImage(opts = {}) {\n    log.error('Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)')();\n    return null;\n  }\n\n  copyToTexture(opts = {}) {\n    log.error('Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})')();\n    return null;\n  }\n\n  blit(opts = {}) {\n    log.error('Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)')();\n    return null;\n  }\n\n  invalidate({\n    attachments = [],\n    x = 0,\n    y = 0,\n    width,\n    height\n  }) {\n    const gl2 = assertWebGL2Context(this.gl);\n    const prevHandle = gl2.bindFramebuffer(36008, this.handle);\n    const invalidateAll = x === 0 && y === 0 && width === undefined && height === undefined;\n\n    if (invalidateAll) {\n      gl2.invalidateFramebuffer(36008, attachments);\n    } else {\n      gl2.invalidateFramebuffer(36008, attachments, x, y, width, height);\n    }\n\n    gl2.bindFramebuffer(36008, prevHandle);\n    return this;\n  }\n\n  getAttachmentParameter(attachment, pname, keys) {\n    let value = this._getAttachmentParameterFallback(pname);\n\n    if (value === null) {\n      this.gl.bindFramebuffer(36160, this.handle);\n      value = this.gl.getFramebufferAttachmentParameter(36160, attachment, pname);\n      this.gl.bindFramebuffer(36160, null);\n    }\n\n    if (keys && value > 1000) {\n      value = getKey(this.gl, value);\n    }\n\n    return value;\n  }\n\n  getAttachmentParameters(attachment = 36064, keys, parameters = this.constructor.ATTACHMENT_PARAMETERS || []) {\n    const values = {};\n\n    for (const pname of parameters) {\n      const key = keys ? getKey(this.gl, pname) : pname;\n      values[key] = this.getAttachmentParameter(attachment, pname, keys);\n    }\n\n    return values;\n  }\n\n  getParameters(keys = true) {\n    const attachments = Object.keys(this.attachments);\n    const parameters = {};\n\n    for (const attachmentName of attachments) {\n      const attachment = Number(attachmentName);\n      const key = keys ? getKey(this.gl, attachment) : attachment;\n      parameters[key] = this.getAttachmentParameters(attachment, keys);\n    }\n\n    return parameters;\n  }\n\n  show() {\n    if (typeof window !== 'undefined') {\n      window.open(copyToDataUrl(this), 'luma-debug-texture');\n    }\n\n    return this;\n  }\n\n  log(logLevel = 0, message = '') {\n    if (logLevel > log.level || typeof window === 'undefined') {\n      return this;\n    }\n\n    message = message || \"Framebuffer \".concat(this.id);\n    const image = copyToDataUrl(this, {\n      targetMaxHeight: 100\n    });\n    log.image({\n      logLevel,\n      message,\n      image\n    }, message)();\n    return this;\n  }\n\n  bind({\n    target = 36160\n  } = {}) {\n    this.gl.bindFramebuffer(target, this.handle);\n    return this;\n  }\n\n  unbind({\n    target = 36160\n  } = {}) {\n    this.gl.bindFramebuffer(target, null);\n    return this;\n  }\n\n  _createDefaultAttachments(color, depth, stencil, width, height) {\n    let defaultAttachments = null;\n\n    if (color) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[36064] = new Texture2D(this.gl, {\n        id: \"\".concat(this.id, \"-color0\"),\n        pixels: null,\n        format: 6408,\n        type: 5121,\n        width,\n        height,\n        mipmaps: false,\n        parameters: {\n          [10241]: 9729,\n          [10240]: 9729,\n          [10242]: 33071,\n          [10243]: 33071\n        }\n      });\n      this.ownResources.push(defaultAttachments[36064]);\n    }\n\n    if (depth && stencil) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[33306] = new Renderbuffer(this.gl, {\n        id: \"\".concat(this.id, \"-depth-stencil\"),\n        format: 35056,\n        width,\n        height: 111\n      });\n      this.ownResources.push(defaultAttachments[33306]);\n    } else if (depth) {\n      defaultAttachments = defaultAttachments || {};\n      defaultAttachments[36096] = new Renderbuffer(this.gl, {\n        id: \"\".concat(this.id, \"-depth\"),\n        format: 33189,\n        width,\n        height\n      });\n      this.ownResources.push(defaultAttachments[36096]);\n    } else if (stencil) {\n      assert(false);\n    }\n\n    return defaultAttachments;\n  }\n\n  _unattach(attachment) {\n    const oldAttachment = this.attachments[attachment];\n\n    if (!oldAttachment) {\n      return;\n    }\n\n    if (oldAttachment instanceof Renderbuffer) {\n      this.gl.framebufferRenderbuffer(36160, attachment, 36161, null);\n    } else {\n      this.gl.framebufferTexture2D(36160, attachment, 3553, null, 0);\n    }\n\n    delete this.attachments[attachment];\n  }\n\n  _attachRenderbuffer({\n    attachment = 36064,\n    renderbuffer\n  }) {\n    const {\n      gl\n    } = this;\n    gl.framebufferRenderbuffer(36160, attachment, 36161, renderbuffer.handle);\n    this.attachments[attachment] = renderbuffer;\n  }\n\n  _attachTexture({\n    attachment = 36064,\n    texture,\n    layer,\n    level\n  }) {\n    const {\n      gl\n    } = this;\n    gl.bindTexture(texture.target, texture.handle);\n\n    switch (texture.target) {\n      case 35866:\n      case 32879:\n        const gl2 = assertWebGL2Context(gl);\n        gl2.framebufferTextureLayer(36160, attachment, texture.target, level, layer);\n        break;\n\n      case 34067:\n        const face = mapIndexToCubeMapFace(layer);\n        gl.framebufferTexture2D(36160, attachment, face, texture.handle, level);\n        break;\n\n      case 3553:\n        gl.framebufferTexture2D(36160, attachment, 3553, texture.handle, level);\n        break;\n\n      default:\n        assert(false, 'Illegal texture type');\n    }\n\n    gl.bindTexture(texture.target, null);\n    this.attachments[attachment] = texture;\n  }\n\n  _setReadBuffer(readBuffer) {\n    const gl2 = getWebGL2Context(this.gl);\n\n    if (gl2) {\n      gl2.readBuffer(readBuffer);\n    } else {\n      assert(readBuffer === 36064 || readBuffer === 1029, ERR_MULTIPLE_RENDERTARGETS);\n    }\n\n    this.readBuffer = readBuffer;\n  }\n\n  _setDrawBuffers(drawBuffers) {\n    const {\n      gl\n    } = this;\n    const gl2 = assertWebGL2Context(gl);\n\n    if (gl2) {\n      gl2.drawBuffers(drawBuffers);\n    } else {\n      const ext = gl.getExtension('WEBGL_draw_buffers');\n\n      if (ext) {\n        ext.drawBuffersWEBGL(drawBuffers);\n      } else {\n        assert(drawBuffers.length === 1 && (drawBuffers[0] === 36064 || drawBuffers[0] === 1029), ERR_MULTIPLE_RENDERTARGETS);\n      }\n    }\n\n    this.drawBuffers = drawBuffers;\n  }\n\n  _getAttachmentParameterFallback(pname) {\n    const caps = getFeatures(this.gl);\n\n    switch (pname) {\n      case 36052:\n        return !caps.WEBGL2 ? 0 : null;\n\n      case 33298:\n      case 33299:\n      case 33300:\n      case 33301:\n      case 33302:\n      case 33303:\n        return !caps.WEBGL2 ? 8 : null;\n\n      case 33297:\n        return !caps.WEBGL2 ? 5125 : null;\n\n      case 33296:\n        return !caps.WEBGL2 && !caps.EXT_sRGB ? 9729 : null;\n\n      default:\n        return null;\n    }\n  }\n\n  _createHandle() {\n    return this.gl.createFramebuffer();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteFramebuffer(this.handle);\n  }\n\n  _bindHandle(handle) {\n    return this.gl.bindFramebuffer(36160, handle);\n  }\n\n}\n\nfunction mapIndexToCubeMapFace(layer) {\n  return layer < 34069 ? layer + 34069 : layer;\n}\n\nfunction _getFrameBufferStatus(status) {\n  const STATUS = Framebuffer.STATUS || {};\n  return STATUS[status] || \"Framebuffer error \".concat(status);\n}\n\nexport const FRAMEBUFFER_ATTACHMENT_PARAMETERS = [36049, 36048, 33296, 33298, 33299, 33300, 33301, 33302, 33303];\nFramebuffer.ATTACHMENT_PARAMETERS = FRAMEBUFFER_ATTACHMENT_PARAMETERS;\n//# sourceMappingURL=framebuffer.js.map","import Texture2D from '../classes/texture-2d';\nimport TextureCube from '../classes/texture-cube';\nimport Texture3D from '../classes/texture-3d';\nimport Framebuffer from '../classes/framebuffer';\nimport { assert } from '../utils';\nexport function cloneTextureFrom(refTexture, overrides) {\n  assert(refTexture instanceof Texture2D || refTexture instanceof TextureCube || refTexture instanceof Texture3D);\n  const TextureType = refTexture.constructor;\n  const {\n    gl,\n    width,\n    height,\n    format,\n    type,\n    dataFormat,\n    border,\n    mipmaps\n  } = refTexture;\n  const textureOptions = Object.assign({\n    width,\n    height,\n    format,\n    type,\n    dataFormat,\n    border,\n    mipmaps\n  }, overrides);\n  return new TextureType(gl, textureOptions);\n}\nexport function toFramebuffer(texture, opts) {\n  const {\n    gl,\n    width,\n    height,\n    id\n  } = texture;\n  const framebuffer = new Framebuffer(gl, Object.assign({}, opts, {\n    id: \"framebuffer-for-\".concat(id),\n    width,\n    height,\n    attachments: {\n      [36064]: texture\n    }\n  }));\n  return framebuffer;\n}\n//# sourceMappingURL=texture-utils.js.map","export default function getShaderName(shader, defaultName = 'unnamed') {\n  const SHADER_NAME_REGEXP = /#define[\\s*]SHADER_NAME[\\s*]([A-Za-z0-9_-]+)[\\s*]/;\n  const match = shader.match(SHADER_NAME_REGEXP);\n  return match ? match[1] : defaultName;\n}\n//# sourceMappingURL=get-shader-name.js.map","import getShaderName from './get-shader-name';\nimport getShaderTypeName from './get-shader-type-name';\nexport default function formatGLSLCompilerError(errLog, src, shaderType) {\n  const {\n    shaderName,\n    errors,\n    warnings\n  } = parseGLSLCompilerError(errLog, src, shaderType);\n  return \"GLSL compilation error in \".concat(shaderName, \"\\n\\n\").concat(errors, \"\\n\").concat(warnings);\n}\nexport function parseGLSLCompilerError(errLog, src, shaderType, shaderName) {\n  const errorStrings = errLog.split(/\\r?\\n/);\n  const errors = {};\n  const warnings = {};\n  const name = shaderName || getShaderName(src) || '(unnamed)';\n  const shaderDescription = \"\".concat(getShaderTypeName(shaderType), \" shader \").concat(name);\n\n  for (let i = 0; i < errorStrings.length; i++) {\n    const errorString = errorStrings[i];\n\n    if (errorString.length <= 1) {\n      continue;\n    }\n\n    const segments = errorString.split(':');\n    const type = segments[0];\n    const line = parseInt(segments[2], 10);\n\n    if (isNaN(line)) {\n      throw new Error(\"GLSL compilation error in \".concat(shaderDescription, \": \").concat(errLog));\n    }\n\n    if (type !== 'WARNING') {\n      errors[line] = errorString;\n    } else {\n      warnings[line] = errorString;\n    }\n  }\n\n  const lines = addLineNumbers(src);\n  return {\n    shaderName: shaderDescription,\n    errors: formatErrors(errors, lines),\n    warnings: formatErrors(warnings, lines)\n  };\n}\n\nfunction formatErrors(errors, lines) {\n  let message = '';\n\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i];\n\n    if (!errors[i + 3] && !errors[i + 2] && !errors[i + 1]) {\n      continue;\n    }\n\n    message += \"\".concat(line, \"\\n\");\n\n    if (errors[i + 1]) {\n      const error = errors[i + 1];\n      const segments = error.split(':', 3);\n      const type = segments[0];\n      const column = parseInt(segments[1], 10) || 0;\n      const err = error.substring(segments.join(':').length + 1).trim();\n      message += padLeft(\"^^^ \".concat(type, \": \").concat(err, \"\\n\\n\"), column);\n    }\n  }\n\n  return message;\n}\n\nfunction addLineNumbers(string, start = 1, delim = ': ') {\n  const lines = string.split(/\\r?\\n/);\n  const maxDigits = String(lines.length + start - 1).length;\n  return lines.map((line, i) => {\n    const lineNumber = String(i + start);\n    const digits = lineNumber.length;\n    const prefix = padLeft(lineNumber, maxDigits - digits);\n    return prefix + delim + line;\n  });\n}\n\nfunction padLeft(string, digits) {\n  let result = '';\n\n  for (let i = 0; i < digits; ++i) {\n    result += ' ';\n  }\n\n  return \"\".concat(result).concat(string);\n}\n//# sourceMappingURL=format-glsl-error.js.map","const GL_FRAGMENT_SHADER = 0x8b30;\nconst GL_VERTEX_SHADER = 0x8b31;\nexport default function getShaderTypeName(type) {\n  switch (type) {\n    case GL_FRAGMENT_SHADER:\n      return 'fragment';\n\n    case GL_VERTEX_SHADER:\n      return 'vertex';\n\n    default:\n      return 'unknown type';\n  }\n}\n//# sourceMappingURL=get-shader-type-name.js.map","export default function getShaderVersion(source) {\n  let version = 100;\n  const words = source.match(/[^\\s]+/g);\n\n  if (words.length >= 2 && words[0] === '#version') {\n    const v = parseInt(words[1], 10);\n\n    if (Number.isFinite(v)) {\n      version = v;\n    }\n  }\n\n  return version;\n}\n//# sourceMappingURL=get-shader-version.js.map","import { assertWebGLContext, log } from '@luma.gl/gltools';\nimport { parseGLSLCompilerError, getShaderName } from '../glsl-utils';\nimport { uid, assert } from '../utils';\nimport Resource from './resource';\nconst ERR_SOURCE = 'Shader: GLSL source code must be a JavaScript string';\nexport class Shader extends Resource {\n  static getTypeName(shaderType) {\n    switch (shaderType) {\n      case 35633:\n        return 'vertex-shader';\n\n      case 35632:\n        return 'fragment-shader';\n\n      default:\n        assert(false);\n        return 'unknown';\n    }\n  }\n\n  constructor(gl, props) {\n    assertWebGLContext(gl);\n    assert(typeof props.source === 'string', ERR_SOURCE);\n    const id = getShaderName(props.source, null) || props.id || uid(\"unnamed \".concat(Shader.getTypeName(props.shaderType)));\n    super(gl, {\n      id\n    });\n    this.shaderType = props.shaderType;\n    this.source = props.source;\n    this.initialize(props);\n  }\n\n  initialize({\n    source\n  }) {\n    const shaderName = getShaderName(source, null);\n\n    if (shaderName) {\n      this.id = uid(shaderName);\n    }\n\n    this._compile(source);\n  }\n\n  getParameter(pname) {\n    return this.gl.getShaderParameter(this.handle, pname);\n  }\n\n  toString() {\n    return \"\".concat(Shader.getTypeName(this.shaderType), \":\").concat(this.id);\n  }\n\n  getName() {\n    return getShaderName(this.source) || 'unnamed-shader';\n  }\n\n  getSource() {\n    return this.gl.getShaderSource(this.handle);\n  }\n\n  getTranslatedSource() {\n    const extension = this.gl.getExtension('WEBGL_debug_shaders');\n    return extension ? extension.getTranslatedShaderSource(this.handle) : 'No translated source available. WEBGL_debug_shaders not implemented';\n  }\n\n  _compile(source = this.source) {\n    if (!source.startsWith('#version ')) {\n      source = \"#version 100\\n\".concat(source);\n    }\n\n    this.source = source;\n    this.gl.shaderSource(this.handle, this.source);\n    this.gl.compileShader(this.handle);\n    const compileStatus = this.getParameter(35713);\n\n    if (!compileStatus) {\n      const infoLog = this.gl.getShaderInfoLog(this.handle);\n      const {\n        shaderName,\n        errors,\n        warnings\n      } = parseGLSLCompilerError(infoLog, this.source, this.shaderType, this.id);\n      log.error(\"GLSL compilation errors in \".concat(shaderName, \"\\n\").concat(errors))();\n      log.warn(\"GLSL compilation warnings in \".concat(shaderName, \"\\n\").concat(warnings))();\n      throw new Error(\"GLSL compilation errors in \".concat(shaderName));\n    }\n  }\n\n  _deleteHandle() {\n    this.gl.deleteShader(this.handle);\n  }\n\n  _getOptsFromHandle() {\n    return {\n      type: this.getParameter(35663),\n      source: this.getSource()\n    };\n  }\n\n}\nexport class VertexShader extends Shader {\n  constructor(gl, props) {\n    if (typeof props === 'string') {\n      props = {\n        source: props\n      };\n    }\n\n    super(gl, Object.assign({}, props, {\n      shaderType: 35633\n    }));\n  }\n\n  _createHandle() {\n    return this.gl.createShader(35633);\n  }\n\n}\nexport class FragmentShader extends Shader {\n  constructor(gl, props) {\n    if (typeof props === 'string') {\n      props = {\n        source: props\n      };\n    }\n\n    super(gl, Object.assign({}, props, {\n      shaderType: 35632\n    }));\n  }\n\n  _createHandle() {\n    return this.gl.createShader(35632);\n  }\n\n}\n//# sourceMappingURL=shader.js.map","import { log } from '@luma.gl/gltools';\nimport Framebuffer from './framebuffer';\nimport Renderbuffer from './renderbuffer';\nimport Texture from './texture';\nimport { assert } from '../utils';\nconst UNIFORM_SETTERS = {\n  [5126]: getArraySetter.bind(null, 'uniform1fv', toFloatArray, 1, setVectorUniform),\n  [35664]: getArraySetter.bind(null, 'uniform2fv', toFloatArray, 2, setVectorUniform),\n  [35665]: getArraySetter.bind(null, 'uniform3fv', toFloatArray, 3, setVectorUniform),\n  [35666]: getArraySetter.bind(null, 'uniform4fv', toFloatArray, 4, setVectorUniform),\n  [5124]: getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n  [35667]: getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n  [35668]: getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n  [35669]: getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n  [35670]: getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n  [35671]: getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n  [35672]: getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n  [35673]: getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n  [35674]: getArraySetter.bind(null, 'uniformMatrix2fv', toFloatArray, 4, setMatrixUniform),\n  [35675]: getArraySetter.bind(null, 'uniformMatrix3fv', toFloatArray, 9, setMatrixUniform),\n  [35676]: getArraySetter.bind(null, 'uniformMatrix4fv', toFloatArray, 16, setMatrixUniform),\n  [35678]: getSamplerSetter,\n  [35680]: getSamplerSetter,\n  [5125]: getArraySetter.bind(null, 'uniform1uiv', toUIntArray, 1, setVectorUniform),\n  [36294]: getArraySetter.bind(null, 'uniform2uiv', toUIntArray, 2, setVectorUniform),\n  [36295]: getArraySetter.bind(null, 'uniform3uiv', toUIntArray, 3, setVectorUniform),\n  [36296]: getArraySetter.bind(null, 'uniform4uiv', toUIntArray, 4, setVectorUniform),\n  [35685]: getArraySetter.bind(null, 'uniformMatrix2x3fv', toFloatArray, 6, setMatrixUniform),\n  [35686]: getArraySetter.bind(null, 'uniformMatrix2x4fv', toFloatArray, 8, setMatrixUniform),\n  [35687]: getArraySetter.bind(null, 'uniformMatrix3x2fv', toFloatArray, 6, setMatrixUniform),\n  [35688]: getArraySetter.bind(null, 'uniformMatrix3x4fv', toFloatArray, 12, setMatrixUniform),\n  [35689]: getArraySetter.bind(null, 'uniformMatrix4x2fv', toFloatArray, 8, setMatrixUniform),\n  [35690]: getArraySetter.bind(null, 'uniformMatrix4x3fv', toFloatArray, 12, setMatrixUniform),\n  [35678]: getSamplerSetter,\n  [35680]: getSamplerSetter,\n  [35679]: getSamplerSetter,\n  [35682]: getSamplerSetter,\n  [36289]: getSamplerSetter,\n  [36292]: getSamplerSetter,\n  [36293]: getSamplerSetter,\n  [36298]: getSamplerSetter,\n  [36299]: getSamplerSetter,\n  [36300]: getSamplerSetter,\n  [36303]: getSamplerSetter,\n  [36306]: getSamplerSetter,\n  [36307]: getSamplerSetter,\n  [36308]: getSamplerSetter,\n  [36311]: getSamplerSetter\n};\nconst FLOAT_ARRAY = {};\nconst INT_ARRAY = {};\nconst UINT_ARRAY = {};\nconst array1 = [0];\n\nfunction toTypedArray(value, uniformLength, Type, cache) {\n  if (uniformLength === 1 && typeof value === 'boolean') {\n    value = value ? 1 : 0;\n  }\n\n  if (Number.isFinite(value)) {\n    array1[0] = value;\n    value = array1;\n  }\n\n  const length = value.length;\n\n  if (length % uniformLength) {\n    log.warn(\"Uniform size should be multiples of \".concat(uniformLength), value)();\n  }\n\n  if (value instanceof Type) {\n    return value;\n  }\n\n  let result = cache[length];\n\n  if (!result) {\n    result = new Type(length);\n    cache[length] = result;\n  }\n\n  for (let i = 0; i < length; i++) {\n    result[i] = value[i];\n  }\n\n  return result;\n}\n\nfunction toFloatArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Float32Array, FLOAT_ARRAY);\n}\n\nfunction toIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Int32Array, INT_ARRAY);\n}\n\nfunction toUIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Uint32Array, UINT_ARRAY);\n}\n\nexport function getUniformSetter(gl, location, info) {\n  const setter = UNIFORM_SETTERS[info.type];\n\n  if (!setter) {\n    throw new Error(\"Unknown GLSL uniform type \".concat(info.type));\n  }\n\n  return setter().bind(null, gl, location);\n}\nexport function parseUniformName(name) {\n  if (name[name.length - 1] !== ']') {\n    return {\n      name,\n      length: 1,\n      isArray: false\n    };\n  }\n\n  const UNIFORM_NAME_REGEXP = /([^[]*)(\\[[0-9]+\\])?/;\n  const matches = name.match(UNIFORM_NAME_REGEXP);\n\n  if (!matches || matches.length < 2) {\n    throw new Error(\"Failed to parse GLSL uniform name \".concat(name));\n  }\n\n  return {\n    name: matches[1],\n    length: matches[2] || 1,\n    isArray: Boolean(matches[2])\n  };\n}\nexport function checkUniformValues(uniforms, source, uniformMap) {\n  for (const uniformName in uniforms) {\n    const value = uniforms[uniformName];\n    const shouldCheck = !uniformMap || Boolean(uniformMap[uniformName]);\n\n    if (shouldCheck && !checkUniformValue(value)) {\n      source = source ? \"\".concat(source, \" \") : '';\n      console.error(\"\".concat(source, \" Bad uniform \").concat(uniformName), value);\n      throw new Error(\"\".concat(source, \" Bad uniform \").concat(uniformName));\n    }\n  }\n\n  return true;\n}\n\nfunction checkUniformValue(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return checkUniformArray(value);\n  }\n\n  if (isFinite(value)) {\n    return true;\n  } else if (value === true || value === false) {\n    return true;\n  } else if (value instanceof Texture) {\n    return true;\n  } else if (value instanceof Renderbuffer) {\n    return true;\n  } else if (value instanceof Framebuffer) {\n    return Boolean(value.texture);\n  }\n\n  return false;\n}\n\nexport function copyUniform(uniforms, key, value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    if (uniforms[key]) {\n      const dest = uniforms[key];\n\n      for (let i = 0, len = value.length; i < len; ++i) {\n        dest[i] = value[i];\n      }\n    } else {\n      uniforms[key] = value.slice();\n    }\n  } else {\n    uniforms[key] = value;\n  }\n}\n\nfunction checkUniformArray(value) {\n  if (value.length === 0) {\n    return false;\n  }\n\n  const checkLength = Math.min(value.length, 16);\n\n  for (let i = 0; i < checkLength; ++i) {\n    if (!Number.isFinite(value[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction getSamplerSetter() {\n  let cache = null;\n  return (gl, location, value) => {\n    const update = cache !== value;\n\n    if (update) {\n      gl.uniform1i(location, value);\n      cache = value;\n    }\n\n    return update;\n  };\n}\n\nfunction getArraySetter(functionName, toArray, size, uniformSetter) {\n  let cache = null;\n  let cacheLength = null;\n  return (gl, location, value) => {\n    const arrayValue = toArray(value, size);\n    const length = arrayValue.length;\n    let update = false;\n\n    if (cache === null) {\n      cache = new Float32Array(length);\n      cacheLength = length;\n      update = true;\n    } else {\n      assert(cacheLength === length, 'Uniform length cannot change.');\n\n      for (let i = 0; i < length; ++i) {\n        if (arrayValue[i] !== cache[i]) {\n          update = true;\n          break;\n        }\n      }\n    }\n\n    if (update) {\n      uniformSetter(gl, functionName, location, arrayValue);\n      cache.set(arrayValue);\n    }\n\n    return update;\n  };\n}\n\nfunction setVectorUniform(gl, functionName, location, value) {\n  gl[functionName](location, value);\n}\n\nfunction setMatrixUniform(gl, functionName, location, value) {\n  gl[functionName](location, false, value);\n}\n//# sourceMappingURL=uniforms.js.map","import { assert } from '../utils';\nconst GL_BYTE = 0x1400;\nconst GL_UNSIGNED_BYTE = 0x1401;\nconst GL_SHORT = 0x1402;\nconst GL_UNSIGNED_SHORT = 0x1403;\nconst GL_POINTS = 0x0;\nconst GL_LINES = 0x1;\nconst GL_LINE_LOOP = 0x2;\nconst GL_LINE_STRIP = 0x3;\nconst GL_TRIANGLES = 0x4;\nconst GL_TRIANGLE_STRIP = 0x5;\nconst GL_TRIANGLE_FAN = 0x6;\nconst GL_FLOAT = 0x1406;\nconst GL_FLOAT_VEC2 = 0x8b50;\nconst GL_FLOAT_VEC3 = 0x8b51;\nconst GL_FLOAT_VEC4 = 0x8b52;\nconst GL_INT = 0x1404;\nconst GL_INT_VEC2 = 0x8b53;\nconst GL_INT_VEC3 = 0x8b54;\nconst GL_INT_VEC4 = 0x8b55;\nconst GL_UNSIGNED_INT = 0x1405;\nconst GL_UNSIGNED_INT_VEC2 = 0x8dc6;\nconst GL_UNSIGNED_INT_VEC3 = 0x8dc7;\nconst GL_UNSIGNED_INT_VEC4 = 0x8dc8;\nconst GL_BOOL = 0x8b56;\nconst GL_BOOL_VEC2 = 0x8b57;\nconst GL_BOOL_VEC3 = 0x8b58;\nconst GL_BOOL_VEC4 = 0x8b59;\nconst GL_FLOAT_MAT2 = 0x8b5a;\nconst GL_FLOAT_MAT3 = 0x8b5b;\nconst GL_FLOAT_MAT4 = 0x8b5c;\nconst GL_FLOAT_MAT2x3 = 0x8b65;\nconst GL_FLOAT_MAT2x4 = 0x8b66;\nconst GL_FLOAT_MAT3x2 = 0x8b67;\nconst GL_FLOAT_MAT3x4 = 0x8b68;\nconst GL_FLOAT_MAT4x2 = 0x8b69;\nconst GL_FLOAT_MAT4x3 = 0x8b6a;\nconst COMPOSITE_GL_TYPES = {\n  [GL_FLOAT]: [GL_FLOAT, 1, 'float'],\n  [GL_FLOAT_VEC2]: [GL_FLOAT, 2, 'vec2'],\n  [GL_FLOAT_VEC3]: [GL_FLOAT, 3, 'vec3'],\n  [GL_FLOAT_VEC4]: [GL_FLOAT, 4, 'vec4'],\n  [GL_INT]: [GL_INT, 1, 'int'],\n  [GL_INT_VEC2]: [GL_INT, 2, 'ivec2'],\n  [GL_INT_VEC3]: [GL_INT, 3, 'ivec3'],\n  [GL_INT_VEC4]: [GL_INT, 4, 'ivec4'],\n  [GL_UNSIGNED_INT]: [GL_UNSIGNED_INT, 1, 'uint'],\n  [GL_UNSIGNED_INT_VEC2]: [GL_UNSIGNED_INT, 2, 'uvec2'],\n  [GL_UNSIGNED_INT_VEC3]: [GL_UNSIGNED_INT, 3, 'uvec3'],\n  [GL_UNSIGNED_INT_VEC4]: [GL_UNSIGNED_INT, 4, 'uvec4'],\n  [GL_BOOL]: [GL_FLOAT, 1, 'bool'],\n  [GL_BOOL_VEC2]: [GL_FLOAT, 2, 'bvec2'],\n  [GL_BOOL_VEC3]: [GL_FLOAT, 3, 'bvec3'],\n  [GL_BOOL_VEC4]: [GL_FLOAT, 4, 'bvec4'],\n  [GL_FLOAT_MAT2]: [GL_FLOAT, 8, 'mat2'],\n  [GL_FLOAT_MAT2x3]: [GL_FLOAT, 8, 'mat2x3'],\n  [GL_FLOAT_MAT2x4]: [GL_FLOAT, 8, 'mat2x4'],\n  [GL_FLOAT_MAT3]: [GL_FLOAT, 12, 'mat3'],\n  [GL_FLOAT_MAT3x2]: [GL_FLOAT, 12, 'mat3x2'],\n  [GL_FLOAT_MAT3x4]: [GL_FLOAT, 12, 'mat3x4'],\n  [GL_FLOAT_MAT4]: [GL_FLOAT, 16, 'mat4'],\n  [GL_FLOAT_MAT4x2]: [GL_FLOAT, 16, 'mat4x2'],\n  [GL_FLOAT_MAT4x3]: [GL_FLOAT, 16, 'mat4x3']\n};\nexport function getPrimitiveDrawMode(drawMode) {\n  switch (drawMode) {\n    case GL_POINTS:\n      return GL_POINTS;\n\n    case GL_LINES:\n      return GL_LINES;\n\n    case GL_LINE_STRIP:\n      return GL_LINES;\n\n    case GL_LINE_LOOP:\n      return GL_LINES;\n\n    case GL_TRIANGLES:\n      return GL_TRIANGLES;\n\n    case GL_TRIANGLE_STRIP:\n      return GL_TRIANGLES;\n\n    case GL_TRIANGLE_FAN:\n      return GL_TRIANGLES;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function getPrimitiveCount({\n  drawMode,\n  vertexCount\n}) {\n  switch (drawMode) {\n    case GL_POINTS:\n    case GL_LINE_LOOP:\n      return vertexCount;\n\n    case GL_LINES:\n      return vertexCount / 2;\n\n    case GL_LINE_STRIP:\n      return vertexCount - 1;\n\n    case GL_TRIANGLES:\n      return vertexCount / 3;\n\n    case GL_TRIANGLE_STRIP:\n    case GL_TRIANGLE_FAN:\n      return vertexCount - 2;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function getVertexCount({\n  drawMode,\n  vertexCount\n}) {\n  const primitiveCount = getPrimitiveCount({\n    drawMode,\n    vertexCount\n  });\n\n  switch (getPrimitiveDrawMode(drawMode)) {\n    case GL_POINTS:\n      return primitiveCount;\n\n    case GL_LINES:\n      return primitiveCount * 2;\n\n    case GL_TRIANGLES:\n      return primitiveCount * 3;\n\n    default:\n      assert(false);\n      return 0;\n  }\n}\nexport function decomposeCompositeGLType(compositeGLType) {\n  const typeAndSize = COMPOSITE_GL_TYPES[compositeGLType];\n\n  if (!typeAndSize) {\n    return null;\n  }\n\n  const [type, components] = typeAndSize;\n  return {\n    type,\n    components\n  };\n}\nexport function getCompositeGLType(type, components) {\n  switch (type) {\n    case GL_BYTE:\n    case GL_UNSIGNED_BYTE:\n    case GL_SHORT:\n    case GL_UNSIGNED_SHORT:\n      type = GL_FLOAT;\n      break;\n\n    default:\n  }\n\n  for (const glType in COMPOSITE_GL_TYPES) {\n    const [compType, compComponents, name] = COMPOSITE_GL_TYPES[glType];\n\n    if (compType === type && compComponents === components) {\n      return {\n        glType,\n        name\n      };\n    }\n  }\n\n  return null;\n}\n//# sourceMappingURL=attribute-utils.js.map","import Accessor from './accessor';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { decomposeCompositeGLType } from '../webgl-utils/attribute-utils';\nexport default class ProgramConfiguration {\n  constructor(program) {\n    this.id = program.id;\n    this.attributeInfos = [];\n    this.attributeInfosByName = {};\n    this.attributeInfosByLocation = [];\n    this.varyingInfos = [];\n    this.varyingInfosByName = {};\n    Object.seal(this);\n\n    this._readAttributesFromProgram(program);\n\n    this._readVaryingsFromProgram(program);\n  }\n\n  getAttributeInfo(locationOrName) {\n    const location = Number(locationOrName);\n\n    if (Number.isFinite(location)) {\n      return this.attributeInfosByLocation[location];\n    }\n\n    return this.attributeInfosByName[locationOrName] || null;\n  }\n\n  getAttributeLocation(locationOrName) {\n    const attributeInfo = this.getAttributeInfo(locationOrName);\n    return attributeInfo ? attributeInfo.location : -1;\n  }\n\n  getAttributeAccessor(locationOrName) {\n    const attributeInfo = this.getAttributeInfo(locationOrName);\n    return attributeInfo ? attributeInfo.accessor : null;\n  }\n\n  getVaryingInfo(locationOrName) {\n    const location = Number(locationOrName);\n\n    if (Number.isFinite(location)) {\n      return this.varyingInfos[location];\n    }\n\n    return this.varyingInfosByName[locationOrName] || null;\n  }\n\n  getVaryingIndex(locationOrName) {\n    const varying = this.getVaryingInfo();\n    return varying ? varying.location : -1;\n  }\n\n  getVaryingAccessor(locationOrName) {\n    const varying = this.getVaryingInfo();\n    return varying ? varying.accessor : null;\n  }\n\n  _readAttributesFromProgram(program) {\n    const {\n      gl\n    } = program;\n    const count = gl.getProgramParameter(program.handle, 35721);\n\n    for (let index = 0; index < count; index++) {\n      const {\n        name,\n        type,\n        size\n      } = gl.getActiveAttrib(program.handle, index);\n      const location = gl.getAttribLocation(program.handle, name);\n\n      if (location >= 0) {\n        this._addAttribute(location, name, type, size);\n      }\n    }\n\n    this.attributeInfos.sort((a, b) => a.location - b.location);\n  }\n\n  _readVaryingsFromProgram(program) {\n    const {\n      gl\n    } = program;\n\n    if (!isWebGL2(gl)) {\n      return;\n    }\n\n    const count = gl.getProgramParameter(program.handle, 35971);\n\n    for (let location = 0; location < count; location++) {\n      const {\n        name,\n        type,\n        size\n      } = gl.getTransformFeedbackVarying(program.handle, location);\n\n      this._addVarying(location, name, type, size);\n    }\n\n    this.varyingInfos.sort((a, b) => a.location - b.location);\n  }\n\n  _addAttribute(location, name, compositeType, size) {\n    const {\n      type,\n      components\n    } = decomposeCompositeGLType(compositeType);\n    const accessor = {\n      type,\n      size: size * components\n    };\n\n    this._inferProperties(location, name, accessor);\n\n    const attributeInfo = {\n      location,\n      name,\n      accessor: new Accessor(accessor)\n    };\n    this.attributeInfos.push(attributeInfo);\n    this.attributeInfosByLocation[location] = attributeInfo;\n    this.attributeInfosByName[attributeInfo.name] = attributeInfo;\n  }\n\n  _inferProperties(location, name, accessor) {\n    if (/instance/i.test(name)) {\n      accessor.divisor = 1;\n    }\n  }\n\n  _addVarying(location, name, compositeType, size) {\n    const {\n      type,\n      components\n    } = decomposeCompositeGLType(compositeType);\n    const accessor = new Accessor({\n      type,\n      size: size * components\n    });\n    const varying = {\n      location,\n      name,\n      accessor\n    };\n    this.varyingInfos.push(varying);\n    this.varyingInfosByName[varying.name] = varying;\n  }\n\n}\n//# sourceMappingURL=program-configuration.js.map","import Resource from './resource';\nimport Texture from './texture';\nimport Framebuffer from './framebuffer';\nimport { parseUniformName, getUniformSetter } from './uniforms';\nimport { VertexShader, FragmentShader } from './shader';\nimport ProgramConfiguration from './program-configuration';\nimport { copyUniform, checkUniformValues } from './uniforms';\nimport { isWebGL2, assertWebGL2Context, withParameters, log } from '@luma.gl/gltools';\nimport { getKey } from '../webgl-utils';\nimport { getPrimitiveDrawMode } from '../webgl-utils/attribute-utils';\nimport { uid, assert } from '../utils';\nconst LOG_PROGRAM_PERF_PRIORITY = 4;\nconst GL_SEPARATE_ATTRIBS = 0x8c8d;\nconst V6_DEPRECATED_METHODS = ['setVertexArray', 'setAttributes', 'setBuffers', 'unsetBuffers', 'use', 'getUniformCount', 'getUniformInfo', 'getUniformLocation', 'getUniformValue', 'getVarying', 'getFragDataLocation', 'getAttachedShaders', 'getAttributeCount', 'getAttributeLocation', 'getAttributeInfo'];\nexport default class Program extends Resource {\n  constructor(gl, props = {}) {\n    super(gl, props);\n    this.stubRemovedMethods('Program', 'v6.0', V6_DEPRECATED_METHODS);\n    this._isCached = false;\n    this.initialize(props);\n    Object.seal(this);\n\n    this._setId(props.id);\n  }\n\n  initialize(props = {}) {\n    const {\n      hash,\n      vs,\n      fs,\n      varyings,\n      bufferMode = GL_SEPARATE_ATTRIBS\n    } = props;\n    this.hash = hash || '';\n    this.vs = typeof vs === 'string' ? new VertexShader(this.gl, {\n      id: \"\".concat(props.id, \"-vs\"),\n      source: vs\n    }) : vs;\n    this.fs = typeof fs === 'string' ? new FragmentShader(this.gl, {\n      id: \"\".concat(props.id, \"-fs\"),\n      source: fs\n    }) : fs;\n    assert(this.vs instanceof VertexShader);\n    assert(this.fs instanceof FragmentShader);\n    this.uniforms = {};\n    this._textureUniforms = {};\n\n    if (varyings && varyings.length > 0) {\n      assertWebGL2Context(this.gl);\n      this.varyings = varyings;\n      this.gl2.transformFeedbackVaryings(this.handle, varyings, bufferMode);\n    }\n\n    this._compileAndLink();\n\n    this._readUniformLocationsFromLinkedProgram();\n\n    this.configuration = new ProgramConfiguration(this);\n    return this.setProps(props);\n  }\n\n  delete(options = {}) {\n    if (this._isCached) {\n      return this;\n    }\n\n    return super.delete(options);\n  }\n\n  setProps(props) {\n    if ('uniforms' in props) {\n      this.setUniforms(props.uniforms);\n    }\n\n    return this;\n  }\n\n  draw({\n    logPriority,\n    drawMode = 4,\n    vertexCount,\n    offset = 0,\n    start,\n    end,\n    isIndexed = false,\n    indexType = 5123,\n    instanceCount = 0,\n    isInstanced = instanceCount > 0,\n    vertexArray = null,\n    transformFeedback,\n    framebuffer,\n    parameters = {},\n    uniforms,\n    samplers\n  }) {\n    if (uniforms || samplers) {\n      log.deprecated('Program.draw({uniforms})', 'Program.setUniforms(uniforms)')();\n      this.setUniforms(uniforms || {});\n    }\n\n    if (log.priority >= logPriority) {\n      const fb = framebuffer ? framebuffer.id : 'default';\n      const message = \"mode=\".concat(getKey(this.gl, drawMode), \" verts=\").concat(vertexCount, \" \") + \"instances=\".concat(instanceCount, \" indexType=\").concat(getKey(this.gl, indexType), \" \") + \"isInstanced=\".concat(isInstanced, \" isIndexed=\").concat(isIndexed, \" \") + \"Framebuffer=\".concat(fb);\n      log.log(logPriority, message)();\n    }\n\n    assert(vertexArray);\n    this.gl.useProgram(this.handle);\n\n    if (!this._areTexturesRenderable() || vertexCount === 0 || isInstanced && instanceCount === 0) {\n      return false;\n    }\n\n    vertexArray.bindForDraw(vertexCount, instanceCount, () => {\n      if (framebuffer !== undefined) {\n        parameters = Object.assign({}, parameters, {\n          framebuffer\n        });\n      }\n\n      if (transformFeedback) {\n        const primitiveMode = getPrimitiveDrawMode(drawMode);\n        transformFeedback.begin(primitiveMode);\n      }\n\n      this._bindTextures();\n\n      withParameters(this.gl, parameters, () => {\n        if (isIndexed && isInstanced) {\n          this.gl2.drawElementsInstanced(drawMode, vertexCount, indexType, offset, instanceCount);\n        } else if (isIndexed && isWebGL2(this.gl) && !isNaN(start) && !isNaN(end)) {\n          this.gl2.drawRangeElements(drawMode, start, end, vertexCount, indexType, offset);\n        } else if (isIndexed) {\n          this.gl.drawElements(drawMode, vertexCount, indexType, offset);\n        } else if (isInstanced) {\n          this.gl2.drawArraysInstanced(drawMode, offset, vertexCount, instanceCount);\n        } else {\n          this.gl.drawArrays(drawMode, offset, vertexCount);\n        }\n      });\n\n      if (transformFeedback) {\n        transformFeedback.end();\n      }\n    });\n    return true;\n  }\n\n  setUniforms(uniforms = {}) {\n    if (log.priority >= 2) {\n      checkUniformValues(uniforms, this.id, this._uniformSetters);\n    }\n\n    this.gl.useProgram(this.handle);\n\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n      const uniformSetter = this._uniformSetters[uniformName];\n\n      if (uniformSetter) {\n        let value = uniform;\n        let textureUpdate = false;\n\n        if (value instanceof Framebuffer) {\n          value = value.texture;\n        }\n\n        if (value instanceof Texture) {\n          textureUpdate = this.uniforms[uniformName] !== uniform;\n\n          if (textureUpdate) {\n            if (uniformSetter.textureIndex === undefined) {\n              uniformSetter.textureIndex = this._textureIndexCounter++;\n            }\n\n            const texture = value;\n            const {\n              textureIndex\n            } = uniformSetter;\n            texture.bind(textureIndex);\n            value = textureIndex;\n            this._textureUniforms[uniformName] = texture;\n          } else {\n            value = uniformSetter.textureIndex;\n          }\n        } else if (this._textureUniforms[uniformName]) {\n          delete this._textureUniforms[uniformName];\n        }\n\n        if (uniformSetter(value) || textureUpdate) {\n          copyUniform(this.uniforms, uniformName, uniform);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  _areTexturesRenderable() {\n    let texturesRenderable = true;\n\n    for (const uniformName in this._textureUniforms) {\n      const texture = this._textureUniforms[uniformName];\n      texture.update();\n      texturesRenderable = texturesRenderable && texture.loaded;\n    }\n\n    return texturesRenderable;\n  }\n\n  _bindTextures() {\n    for (const uniformName in this._textureUniforms) {\n      const textureIndex = this._uniformSetters[uniformName].textureIndex;\n\n      this._textureUniforms[uniformName].bind(textureIndex);\n    }\n  }\n\n  _createHandle() {\n    return this.gl.createProgram();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteProgram(this.handle);\n  }\n\n  _getOptionsFromHandle(handle) {\n    const shaderHandles = this.gl.getAttachedShaders(handle);\n    const opts = {};\n\n    for (const shaderHandle of shaderHandles) {\n      const type = this.gl.getShaderParameter(this.handle, 35663);\n\n      switch (type) {\n        case 35633:\n          opts.vs = new VertexShader({\n            handle: shaderHandle\n          });\n          break;\n\n        case 35632:\n          opts.fs = new FragmentShader({\n            handle: shaderHandle\n          });\n          break;\n\n        default:\n      }\n    }\n\n    return opts;\n  }\n\n  _getParameter(pname) {\n    return this.gl.getProgramParameter(this.handle, pname);\n  }\n\n  _setId(id) {\n    if (!id) {\n      const programName = this._getName();\n\n      this.id = uid(programName);\n    }\n  }\n\n  _getName() {\n    let programName = this.vs.getName() || this.fs.getName();\n    programName = programName.replace(/shader/i, '');\n    programName = programName ? \"\".concat(programName, \"-program\") : 'program';\n    return programName;\n  }\n\n  _compileAndLink() {\n    const {\n      gl\n    } = this;\n    gl.attachShader(this.handle, this.vs.handle);\n    gl.attachShader(this.handle, this.fs.handle);\n    log.time(LOG_PROGRAM_PERF_PRIORITY, \"linkProgram for \".concat(this._getName()))();\n    gl.linkProgram(this.handle);\n    log.timeEnd(LOG_PROGRAM_PERF_PRIORITY, \"linkProgram for \".concat(this._getName()))();\n\n    if (gl.debug || log.level > 0) {\n      const linked = gl.getProgramParameter(this.handle, 35714);\n\n      if (!linked) {\n        throw new Error(\"Error linking: \".concat(gl.getProgramInfoLog(this.handle)));\n      }\n\n      gl.validateProgram(this.handle);\n      const validated = gl.getProgramParameter(this.handle, 35715);\n\n      if (!validated) {\n        throw new Error(\"Error validating: \".concat(gl.getProgramInfoLog(this.handle)));\n      }\n    }\n  }\n\n  _readUniformLocationsFromLinkedProgram() {\n    const {\n      gl\n    } = this;\n    this._uniformSetters = {};\n    this._uniformCount = this._getParameter(35718);\n\n    for (let i = 0; i < this._uniformCount; i++) {\n      const info = this.gl.getActiveUniform(this.handle, i);\n      const {\n        name\n      } = parseUniformName(info.name);\n      let location = gl.getUniformLocation(this.handle, name);\n      this._uniformSetters[name] = getUniformSetter(gl, location, info);\n\n      if (info.size > 1) {\n        for (let l = 0; l < info.size; l++) {\n          location = gl.getUniformLocation(this.handle, \"\".concat(name, \"[\").concat(l, \"]\"));\n          this._uniformSetters[\"\".concat(name, \"[\").concat(l, \"]\")] = getUniformSetter(gl, location, info);\n        }\n      }\n    }\n\n    this._textureIndexCounter = 0;\n  }\n\n  getActiveUniforms(uniformIndices, pname) {\n    return this.gl2.getActiveUniforms(this.handle, uniformIndices, pname);\n  }\n\n  getUniformBlockIndex(blockName) {\n    return this.gl2.getUniformBlockIndex(this.handle, blockName);\n  }\n\n  getActiveUniformBlockParameter(blockIndex, pname) {\n    return this.gl2.getActiveUniformBlockParameter(this.handle, blockIndex, pname);\n  }\n\n  uniformBlockBinding(blockIndex, blockBinding) {\n    this.gl2.uniformBlockBinding(this.handle, blockIndex, blockBinding);\n  }\n\n}\n//# sourceMappingURL=program.js.map","import Resource from './resource';\nimport { FEATURES, hasFeatures } from '../features';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert } from '../utils';\nconst GL_QUERY_RESULT = 0x8866;\nconst GL_QUERY_RESULT_AVAILABLE = 0x8867;\nconst GL_TIME_ELAPSED_EXT = 0x88bf;\nconst GL_GPU_DISJOINT_EXT = 0x8fbb;\nconst GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN = 0x8c88;\nconst GL_ANY_SAMPLES_PASSED = 0x8c2f;\nconst GL_ANY_SAMPLES_PASSED_CONSERVATIVE = 0x8d6a;\nexport default class Query extends Resource {\n  static isSupported(gl, opts = []) {\n    const webgl2 = isWebGL2(gl);\n    const hasTimerQuery = hasFeatures(gl, FEATURES.TIMER_QUERY);\n    let supported = webgl2 || hasTimerQuery;\n\n    for (const key of opts) {\n      switch (key) {\n        case 'queries':\n          supported = supported && webgl2;\n          break;\n\n        case 'timers':\n          supported = supported && hasTimerQuery;\n          break;\n\n        default:\n          assert(false);\n      }\n    }\n\n    return supported;\n  }\n\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n    this.target = null;\n    this._queryPending = false;\n    this._pollingPromise = null;\n    Object.seal(this);\n  }\n\n  beginTimeElapsedQuery() {\n    return this.begin(GL_TIME_ELAPSED_EXT);\n  }\n\n  beginOcclusionQuery({\n    conservative = false\n  } = {}) {\n    return this.begin(conservative ? GL_ANY_SAMPLES_PASSED_CONSERVATIVE : GL_ANY_SAMPLES_PASSED);\n  }\n\n  beginTransformFeedbackQuery() {\n    return this.begin(GL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN);\n  }\n\n  begin(target) {\n    if (this._queryPending) {\n      return this;\n    }\n\n    this.target = target;\n    this.gl2.beginQuery(this.target, this.handle);\n    return this;\n  }\n\n  end() {\n    if (this._queryPending) {\n      return this;\n    }\n\n    if (this.target) {\n      this.gl2.endQuery(this.target);\n      this.target = null;\n      this._queryPending = true;\n    }\n\n    return this;\n  }\n\n  isResultAvailable() {\n    if (!this._queryPending) {\n      return false;\n    }\n\n    const resultAvailable = this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT_AVAILABLE);\n\n    if (resultAvailable) {\n      this._queryPending = false;\n    }\n\n    return resultAvailable;\n  }\n\n  isTimerDisjoint() {\n    return this.gl2.getParameter(GL_GPU_DISJOINT_EXT);\n  }\n\n  getResult() {\n    return this.gl2.getQueryParameter(this.handle, GL_QUERY_RESULT);\n  }\n\n  getTimerMilliseconds() {\n    return this.getResult() / 1e6;\n  }\n\n  createPoll(limit = Number.POSITIVE_INFINITY) {\n    if (this._pollingPromise) {\n      return this._pollingPromise;\n    }\n\n    let counter = 0;\n    this._pollingPromise = new Promise((resolve, reject) => {\n      const poll = () => {\n        if (this.isResultAvailable()) {\n          resolve(this.getResult());\n          this._pollingPromise = null;\n        } else if (counter++ > limit) {\n          reject('Timed out');\n          this._pollingPromise = null;\n        } else {\n          requestAnimationFrame(poll);\n        }\n      };\n\n      requestAnimationFrame(poll);\n    });\n    return this._pollingPromise;\n  }\n\n  _createHandle() {\n    return Query.isSupported(this.gl) ? this.gl2.createQuery() : null;\n  }\n\n  _deleteHandle() {\n    this.gl2.deleteQuery(this.handle);\n  }\n\n}\n//# sourceMappingURL=query.js.map","import { isWebGL2, assertWebGL2Context, log } from '@luma.gl/gltools';\nimport Resource from './resource';\nimport Buffer from './buffer';\nimport { isObjectEmpty } from '../utils';\nexport default class TransformFeedback extends Resource {\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl, props = {}) {\n    assertWebGL2Context(gl);\n    super(gl, props);\n    this.initialize(props);\n    this.stubRemovedMethods('TransformFeedback', 'v6.0', ['pause', 'resume']);\n    Object.seal(this);\n  }\n\n  initialize(props = {}) {\n    this.buffers = {};\n    this.unused = {};\n    this.configuration = null;\n    this.bindOnUse = true;\n\n    if (!isObjectEmpty(this.buffers)) {\n      this.bind(() => this._unbindBuffers());\n    }\n\n    this.setProps(props);\n    return this;\n  }\n\n  setProps(props) {\n    if ('program' in props) {\n      this.configuration = props.program && props.program.configuration;\n    }\n\n    if ('configuration' in props) {\n      this.configuration = props.configuration;\n    }\n\n    if ('bindOnUse' in props) {\n      props = props.bindOnUse;\n    }\n\n    if ('buffers' in props) {\n      this.setBuffers(props.buffers);\n    }\n  }\n\n  setBuffers(buffers = {}) {\n    this.bind(() => {\n      for (const bufferName in buffers) {\n        this.setBuffer(bufferName, buffers[bufferName]);\n      }\n    });\n    return this;\n  }\n\n  setBuffer(locationOrName, bufferOrParams) {\n    const location = this._getVaryingIndex(locationOrName);\n\n    const {\n      buffer,\n      byteSize,\n      byteOffset\n    } = this._getBufferParams(bufferOrParams);\n\n    if (location < 0) {\n      this.unused[locationOrName] = buffer;\n      log.warn(() => \"\".concat(this.id, \" unused varying buffer \").concat(locationOrName))();\n      return this;\n    }\n\n    this.buffers[location] = bufferOrParams;\n\n    if (!this.bindOnUse) {\n      this._bindBuffer(location, buffer, byteOffset, byteSize);\n    }\n\n    return this;\n  }\n\n  begin(primitiveMode = 0) {\n    this.gl.bindTransformFeedback(36386, this.handle);\n\n    this._bindBuffers();\n\n    this.gl.beginTransformFeedback(primitiveMode);\n    return this;\n  }\n\n  end() {\n    this.gl.endTransformFeedback();\n\n    this._unbindBuffers();\n\n    this.gl.bindTransformFeedback(36386, null);\n    return this;\n  }\n\n  _getBufferParams(bufferOrParams) {\n    let byteOffset;\n    let byteSize;\n    let buffer;\n\n    if (bufferOrParams instanceof Buffer === false) {\n      buffer = bufferOrParams.buffer;\n      byteSize = bufferOrParams.byteSize;\n      byteOffset = bufferOrParams.byteOffset;\n    } else {\n      buffer = bufferOrParams;\n    }\n\n    if (byteOffset !== undefined || byteSize !== undefined) {\n      byteOffset = byteOffset || 0;\n      byteSize = byteSize || buffer.byteLength - byteOffset;\n    }\n\n    return {\n      buffer,\n      byteOffset,\n      byteSize\n    };\n  }\n\n  _getVaryingInfo(locationOrName) {\n    return this.configuration && this.configuration.getVaryingInfo(locationOrName);\n  }\n\n  _getVaryingIndex(locationOrName) {\n    if (this.configuration) {\n      return this.configuration.getVaryingInfo(locationOrName).location;\n    }\n\n    const location = Number(locationOrName);\n    return Number.isFinite(location) ? location : -1;\n  }\n\n  _bindBuffers() {\n    if (this.bindOnUse) {\n      for (const bufferIndex in this.buffers) {\n        const {\n          buffer,\n          byteSize,\n          byteOffset\n        } = this._getBufferParams(this.buffers[bufferIndex]);\n\n        this._bindBuffer(bufferIndex, buffer, byteOffset, byteSize);\n      }\n    }\n  }\n\n  _unbindBuffers() {\n    if (this.bindOnUse) {\n      for (const bufferIndex in this.buffers) {\n        this._bindBuffer(bufferIndex, null);\n      }\n    }\n  }\n\n  _bindBuffer(index, buffer, byteOffset = 0, byteSize) {\n    const handle = buffer && buffer.handle;\n\n    if (!handle || byteSize === undefined) {\n      this.gl.bindBufferBase(35982, index, handle);\n    } else {\n      this.gl.bindBufferRange(35982, index, handle, byteOffset, byteSize);\n    }\n\n    return this;\n  }\n\n  _createHandle() {\n    return this.gl.createTransformFeedback();\n  }\n\n  _deleteHandle() {\n    this.gl.deleteTransformFeedback(this.handle);\n  }\n\n  _bindHandle(handle) {\n    this.gl.bindTransformFeedback(36386, this.handle);\n  }\n\n}\n//# sourceMappingURL=transform-feedback.js.map","let arrayBuffer = null;\nexport function getScratchArrayBuffer(byteLength) {\n  if (!arrayBuffer || arrayBuffer.byteLength < byteLength) {\n    arrayBuffer = new ArrayBuffer(byteLength);\n  }\n\n  return arrayBuffer;\n}\nexport function getScratchArray(Type, length) {\n  const scratchArrayBuffer = getScratchArrayBuffer(Type.BYTES_PER_ELEMENT * length);\n  return new Type(scratchArrayBuffer, 0, length);\n}\nexport function fillArray({\n  target,\n  source,\n  start = 0,\n  count = 1\n}) {\n  const length = source.length;\n  const total = count * length;\n  let copied = 0;\n\n  for (let i = start; copied < length; copied++) {\n    target[i++] = source[copied];\n  }\n\n  while (copied < total) {\n    if (copied < total - copied) {\n      target.copyWithin(start + copied, start, start + copied);\n      copied *= 2;\n    } else {\n      target.copyWithin(start + copied, start, start + total - copied);\n      copied = total;\n    }\n  }\n\n  return target;\n}\n//# sourceMappingURL=array-utils-flat.js.map","import Resource from './resource';\nimport Buffer from './buffer';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { getScratchArray, fillArray } from '../utils/array-utils-flat';\nimport { assert } from '../utils';\nimport { getBrowser } from 'probe.gl';\nconst ERR_ELEMENTS = 'elements must be GL.ELEMENT_ARRAY_BUFFER';\nexport default class VertexArrayObject extends Resource {\n  static isSupported(gl, options = {}) {\n    if (options.constantAttributeZero) {\n      return isWebGL2(gl) || getBrowser() === 'Chrome';\n    }\n\n    return true;\n  }\n\n  static getDefaultArray(gl) {\n    gl.luma = gl.luma || {};\n\n    if (!gl.luma.defaultVertexArray) {\n      gl.luma.defaultVertexArray = new VertexArrayObject(gl, {\n        handle: null,\n        isDefaultArray: true\n      });\n    }\n\n    return gl.luma.defaultVertexArray;\n  }\n\n  static getMaxAttributes(gl) {\n    VertexArrayObject.MAX_ATTRIBUTES = VertexArrayObject.MAX_ATTRIBUTES || gl.getParameter(34921);\n    return VertexArrayObject.MAX_ATTRIBUTES;\n  }\n\n  static setConstant(gl, location, array) {\n    switch (array.constructor) {\n      case Float32Array:\n        VertexArrayObject._setConstantFloatArray(gl, location, array);\n\n        break;\n\n      case Int32Array:\n        VertexArrayObject._setConstantIntArray(gl, location, array);\n\n        break;\n\n      case Uint32Array:\n        VertexArrayObject._setConstantUintArray(gl, location, array);\n\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  constructor(gl, opts = {}) {\n    const id = opts.id || opts.program && opts.program.id;\n    super(gl, Object.assign({}, opts, {\n      id\n    }));\n    this.buffer = null;\n    this.bufferValue = null;\n    this.isDefaultArray = opts.isDefaultArray || false;\n    this.gl2 = gl;\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  delete() {\n    super.delete();\n\n    if (this.buffer) {\n      this.buffer.delete();\n    }\n\n    return this;\n  }\n\n  get MAX_ATTRIBUTES() {\n    return VertexArrayObject.getMaxAttributes(this.gl);\n  }\n\n  initialize(props = {}) {\n    return this.setProps(props);\n  }\n\n  setProps(props) {\n    return this;\n  }\n\n  setElementBuffer(elementBuffer = null, opts = {}) {\n    assert(!elementBuffer || elementBuffer.target === 34963, ERR_ELEMENTS);\n    this.bind(() => {\n      this.gl.bindBuffer(34963, elementBuffer ? elementBuffer.handle : null);\n    });\n    return this;\n  }\n\n  setBuffer(location, buffer, accessor) {\n    if (buffer.target === 34963) {\n      return this.setElementBuffer(buffer, accessor);\n    }\n\n    const {\n      size,\n      type,\n      stride,\n      offset,\n      normalized,\n      integer,\n      divisor\n    } = accessor;\n    const {\n      gl,\n      gl2\n    } = this;\n    location = Number(location);\n    this.bind(() => {\n      gl.bindBuffer(34962, buffer.handle);\n\n      if (integer) {\n        assert(isWebGL2(gl));\n        gl2.vertexAttribIPointer(location, size, type, stride, offset);\n      } else {\n        gl.vertexAttribPointer(location, size, type, normalized, stride, offset);\n      }\n\n      gl.enableVertexAttribArray(location);\n      gl2.vertexAttribDivisor(location, divisor || 0);\n    });\n    return this;\n  }\n\n  enable(location, enable = true) {\n    const disablingAttributeZero = !enable && location === 0 && !VertexArrayObject.isSupported(this.gl, {\n      constantAttributeZero: true\n    });\n\n    if (!disablingAttributeZero) {\n      location = Number(location);\n      this.bind(() => enable ? this.gl.enableVertexAttribArray(location) : this.gl.disableVertexAttribArray(location));\n    }\n\n    return this;\n  }\n\n  getConstantBuffer(elementCount, value) {\n    const constantValue = this._normalizeConstantArrayValue(value);\n\n    const byteLength = constantValue.byteLength * elementCount;\n    const length = constantValue.length * elementCount;\n    let updateNeeded = !this.buffer;\n    this.buffer = this.buffer || new Buffer(this.gl, byteLength);\n    updateNeeded = updateNeeded || this.buffer.reallocate(byteLength);\n    updateNeeded = updateNeeded || !this._compareConstantArrayValues(constantValue, this.bufferValue);\n\n    if (updateNeeded) {\n      const typedArray = getScratchArray(value.constructor, length);\n      fillArray({\n        target: typedArray,\n        source: constantValue,\n        start: 0,\n        count: length\n      });\n      this.buffer.subData(typedArray);\n      this.bufferValue = value;\n    }\n\n    return this.buffer;\n  }\n\n  _normalizeConstantArrayValue(arrayValue) {\n    if (Array.isArray(arrayValue)) {\n      return new Float32Array(arrayValue);\n    }\n\n    return arrayValue;\n  }\n\n  _compareConstantArrayValues(v1, v2) {\n    if (!v1 || !v2 || v1.length !== v2.length || v1.constructor !== v2.constructor) {\n      return false;\n    }\n\n    for (let i = 0; i < v1.length; ++i) {\n      if (v1[i] !== v2[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  static _setConstantFloatArray(gl, location, array) {\n    switch (array.length) {\n      case 1:\n        gl.vertexAttrib1fv(location, array);\n        break;\n\n      case 2:\n        gl.vertexAttrib2fv(location, array);\n        break;\n\n      case 3:\n        gl.vertexAttrib3fv(location, array);\n        break;\n\n      case 4:\n        gl.vertexAttrib4fv(location, array);\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  static _setConstantIntArray(gl, location, array) {\n    assert(isWebGL2(gl));\n\n    switch (array.length) {\n      case 1:\n        gl.vertexAttribI1iv(location, array);\n        break;\n\n      case 2:\n        gl.vertexAttribI2iv(location, array);\n        break;\n\n      case 3:\n        gl.vertexAttribI3iv(location, array);\n        break;\n\n      case 4:\n        gl.vertexAttribI4iv(location, array);\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  static _setConstantUintArray(gl, location, array) {\n    assert(isWebGL2(gl));\n\n    switch (array.length) {\n      case 1:\n        gl.vertexAttribI1uiv(location, array);\n        break;\n\n      case 2:\n        gl.vertexAttribI2uiv(location, array);\n        break;\n\n      case 3:\n        gl.vertexAttribI3uiv(location, array);\n        break;\n\n      case 4:\n        gl.vertexAttribI4uiv(location, array);\n        break;\n\n      default:\n        assert(false);\n    }\n  }\n\n  _createHandle() {\n    const gl2 = this.gl;\n    return gl2.createVertexArray();\n  }\n\n  _deleteHandle(handle) {\n    this.gl2.deleteVertexArray(handle);\n    return [this.elements];\n  }\n\n  _bindHandle(handle) {\n    this.gl2.bindVertexArray(handle);\n  }\n\n  _getParameter(pname, {\n    location\n  }) {\n    assert(Number.isFinite(location));\n    return this.bind(() => {\n      switch (pname) {\n        case 34373:\n          return this.gl.getVertexAttribOffset(location, pname);\n\n        default:\n          return this.gl.getVertexAttrib(location, pname);\n      }\n    });\n  }\n\n}\n//# sourceMappingURL=vertex-array-object.js.map","import { window } from './globals';\nimport isBrowser from './is-browser';\nimport isElectron from './is-electron';\nexport function isMobile() {\n  return typeof window.orientation !== 'undefined';\n}\nexport default function getBrowser(mockUserAgent) {\n  if (!mockUserAgent && !isBrowser()) {\n    return 'Node';\n  }\n\n  if (isElectron(mockUserAgent)) {\n    return 'Electron';\n  }\n\n  const navigator_ = typeof navigator !== 'undefined' ? navigator : {};\n  const userAgent = mockUserAgent || navigator_.userAgent || '';\n\n  if (userAgent.indexOf('Edge') > -1) {\n    return 'Edge';\n  }\n\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n\n  if (isMSIE || isTrident) {\n    return 'IE';\n  }\n\n  if (window.chrome) {\n    return 'Chrome';\n  }\n\n  if (window.safari) {\n    return 'Safari';\n  }\n\n  if (window.mozInnerScreenX) {\n    return 'Firefox';\n  }\n\n  return 'Unknown';\n}\n//# sourceMappingURL=get-browser.js.map","import { log } from '@luma.gl/gltools';\nimport Accessor from './accessor';\nimport Buffer from './buffer';\nimport VertexArrayObject from './vertex-array-object';\nimport { assert, stubRemovedMethods } from '../utils';\nconst ERR_ATTRIBUTE_TYPE = 'VertexArray: attributes must be Buffers or constants (i.e. typed array)';\nconst MULTI_LOCATION_ATTRIBUTE_REGEXP = /^(.+)__LOCATION_([0-9]+)$/;\nconst DEPRECATIONS_V6 = ['setBuffers', 'setGeneric', 'clearBindings', 'setLocations', 'setGenericValues', 'setDivisor', 'enable', 'disable'];\nexport default class VertexArray {\n  constructor(gl, opts = {}) {\n    const id = opts.id || opts.program && opts.program.id;\n    this.id = id;\n    this.gl = gl;\n    this.configuration = null;\n    this.elements = null;\n    this.elementsAccessor = null;\n    this.values = null;\n    this.accessors = null;\n    this.unused = null;\n    this.drawParams = null;\n    this.buffer = null;\n    this.attributes = {};\n    this.vertexArrayObject = new VertexArrayObject(gl);\n    stubRemovedMethods(this, 'VertexArray', 'v6.0', DEPRECATIONS_V6);\n    this.initialize(opts);\n    Object.seal(this);\n  }\n\n  delete() {\n    if (this.buffer) {\n      this.buffer.delete();\n    }\n\n    this.vertexArrayObject.delete();\n  }\n\n  initialize(props = {}) {\n    this.reset();\n    this.configuration = null;\n    this.bindOnUse = false;\n    return this.setProps(props);\n  }\n\n  reset() {\n    this.elements = null;\n    this.elementsAccessor = null;\n    const {\n      MAX_ATTRIBUTES\n    } = this.vertexArrayObject;\n    this.values = new Array(MAX_ATTRIBUTES).fill(null);\n    this.accessors = new Array(MAX_ATTRIBUTES).fill(null);\n    this.unused = {};\n    this.drawParams = null;\n    return this;\n  }\n\n  setProps(props) {\n    if ('program' in props) {\n      this.configuration = props.program && props.program.configuration;\n    }\n\n    if ('configuration' in props) {\n      this.configuration = props.configuration;\n    }\n\n    if ('attributes' in props) {\n      this.setAttributes(props.attributes);\n    }\n\n    if ('elements' in props) {\n      this.setElementBuffer(props.elements);\n    }\n\n    if ('bindOnUse' in props) {\n      props = props.bindOnUse;\n    }\n\n    return this;\n  }\n\n  clearDrawParams() {\n    this.drawParams = null;\n  }\n\n  getDrawParams() {\n    this.drawParams = this.drawParams || this._updateDrawParams();\n    return this.drawParams;\n  }\n\n  setAttributes(attributes) {\n    Object.assign(this.attributes, attributes);\n    this.vertexArrayObject.bind(() => {\n      for (const locationOrName in attributes) {\n        const value = attributes[locationOrName];\n\n        this._setAttribute(locationOrName, value);\n      }\n\n      this.gl.bindBuffer(34962, null);\n    });\n    return this;\n  }\n\n  setElementBuffer(elementBuffer = null, accessor = {}) {\n    this.elements = elementBuffer;\n    this.elementsAccessor = accessor;\n    this.clearDrawParams();\n    this.vertexArrayObject.setElementBuffer(elementBuffer, accessor);\n    return this;\n  }\n\n  setBuffer(locationOrName, buffer, appAccessor = {}) {\n    if (buffer.target === 34963) {\n      return this.setElementBuffer(buffer, appAccessor);\n    }\n\n    const {\n      location,\n      accessor\n    } = this._resolveLocationAndAccessor(locationOrName, buffer, buffer.accessor, appAccessor);\n\n    if (location >= 0) {\n      this.values[location] = buffer;\n      this.accessors[location] = accessor;\n      this.clearDrawParams();\n      this.vertexArrayObject.setBuffer(location, buffer, accessor);\n    }\n\n    return this;\n  }\n\n  setConstant(locationOrName, arrayValue, appAccessor = {}) {\n    const {\n      location,\n      accessor\n    } = this._resolveLocationAndAccessor(locationOrName, arrayValue, Object.assign({\n      size: arrayValue.length\n    }, appAccessor));\n\n    if (location >= 0) {\n      arrayValue = this.vertexArrayObject._normalizeConstantArrayValue(arrayValue);\n      this.values[location] = arrayValue;\n      this.accessors[location] = accessor;\n      this.clearDrawParams();\n      this.vertexArrayObject.enable(location, false);\n    }\n\n    return this;\n  }\n\n  unbindBuffers() {\n    this.vertexArrayObject.bind(() => {\n      if (this.elements) {\n        this.vertexArrayObject.setElementBuffer(null);\n      }\n\n      this.buffer = this.buffer || new Buffer(this.gl, {\n        accessor: {\n          size: 4\n        }\n      });\n\n      for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n        if (this.values[location] instanceof Buffer) {\n          this.gl.disableVertexAttribArray(location);\n          this.gl.bindBuffer(34962, this.buffer.handle);\n          this.gl.vertexAttribPointer(location, 1, 5126, false, 0, 0);\n        }\n      }\n    });\n    return this;\n  }\n\n  bindBuffers() {\n    this.vertexArrayObject.bind(() => {\n      if (this.elements) {\n        this.setElementBuffer(this.elements);\n      }\n\n      for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n        const buffer = this.values[location];\n\n        if (buffer instanceof Buffer) {\n          this.setBuffer(location, buffer);\n        }\n      }\n    });\n    return this;\n  }\n\n  bindForDraw(vertexCount, instanceCount, func) {\n    let value;\n    this.vertexArrayObject.bind(() => {\n      this._setConstantAttributes(vertexCount, instanceCount);\n\n      value = func();\n    });\n    return value;\n  }\n\n  _resolveLocationAndAccessor(locationOrName, value, valueAccessor, appAccessor) {\n    const INVALID_RESULT = {\n      location: -1,\n      accessor: null\n    };\n\n    const {\n      location,\n      name\n    } = this._getAttributeIndex(locationOrName);\n\n    if (!Number.isFinite(location) || location < 0) {\n      this.unused[locationOrName] = value;\n      log.once(3, () => \"unused value \".concat(locationOrName, \" in \").concat(this.id))();\n      return INVALID_RESULT;\n    }\n\n    const accessInfo = this._getAttributeInfo(name || location);\n\n    if (!accessInfo) {\n      return INVALID_RESULT;\n    }\n\n    const currentAccessor = this.accessors[location] || {};\n    const accessor = Accessor.resolve(accessInfo.accessor, currentAccessor, valueAccessor, appAccessor);\n    const {\n      size,\n      type\n    } = accessor;\n    assert(Number.isFinite(size) && Number.isFinite(type));\n    return {\n      location,\n      accessor\n    };\n  }\n\n  _getAttributeInfo(attributeName) {\n    return this.configuration && this.configuration.getAttributeInfo(attributeName);\n  }\n\n  _getAttributeIndex(locationOrName) {\n    const location = Number(locationOrName);\n\n    if (Number.isFinite(location)) {\n      return {\n        location\n      };\n    }\n\n    const multiLocation = MULTI_LOCATION_ATTRIBUTE_REGEXP.exec(locationOrName);\n    const name = multiLocation ? multiLocation[1] : locationOrName;\n    const locationOffset = multiLocation ? Number(multiLocation[2]) : 0;\n\n    if (this.configuration) {\n      return {\n        location: this.configuration.getAttributeLocation(name) + locationOffset,\n        name\n      };\n    }\n\n    return {\n      location: -1\n    };\n  }\n\n  _setAttribute(locationOrName, value) {\n    if (value instanceof Buffer) {\n      this.setBuffer(locationOrName, value);\n    } else if (Array.isArray(value) && value.length && value[0] instanceof Buffer) {\n      const buffer = value[0];\n      const accessor = value[1];\n      this.setBuffer(locationOrName, buffer, accessor);\n    } else if (ArrayBuffer.isView(value) || Array.isArray(value)) {\n      const constant = value;\n      this.setConstant(locationOrName, constant);\n    } else if (value.buffer instanceof Buffer) {\n      const accessor = value;\n      this.setBuffer(locationOrName, accessor.buffer, accessor);\n    } else {\n      throw new Error(ERR_ATTRIBUTE_TYPE);\n    }\n  }\n\n  _setConstantAttributes(vertexCount, instanceCount) {\n    const elementCount = Math.max(vertexCount | 0, instanceCount | 0);\n    let constant = this.values[0];\n\n    if (ArrayBuffer.isView(constant)) {\n      this._setConstantAttributeZero(constant, elementCount);\n    }\n\n    for (let location = 1; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n      constant = this.values[location];\n\n      if (ArrayBuffer.isView(constant)) {\n        this._setConstantAttribute(location, constant);\n      }\n    }\n  }\n\n  _setConstantAttributeZero(constant, elementCount) {\n    if (VertexArrayObject.isSupported(this.gl, {\n      constantAttributeZero: true\n    })) {\n      this._setConstantAttribute(0, constant);\n\n      return;\n    }\n\n    const buffer = this.vertexArrayObject.getConstantBuffer(elementCount, constant);\n    this.vertexArrayObject.setBuffer(0, buffer, this.accessors[0]);\n  }\n\n  _setConstantAttribute(location, constant) {\n    VertexArrayObject.setConstant(this.gl, location, constant);\n  }\n\n  _updateDrawParams() {\n    const drawParams = {\n      isIndexed: false,\n      isInstanced: false,\n      indexCount: Infinity,\n      vertexCount: Infinity,\n      instanceCount: Infinity\n    };\n\n    for (let location = 0; location < this.vertexArrayObject.MAX_ATTRIBUTES; location++) {\n      this._updateDrawParamsForLocation(drawParams, location);\n    }\n\n    if (this.elements) {\n      drawParams.elementCount = this.elements.getElementCount(this.elements.accessor);\n      drawParams.isIndexed = true;\n      drawParams.indexType = this.elementsAccessor.type || this.elements.accessor.type;\n      drawParams.indexOffset = this.elementsAccessor.offset || 0;\n    }\n\n    if (drawParams.indexCount === Infinity) {\n      drawParams.indexCount = 0;\n    }\n\n    if (drawParams.vertexCount === Infinity) {\n      drawParams.vertexCount = 0;\n    }\n\n    if (drawParams.instanceCount === Infinity) {\n      drawParams.instanceCount = 0;\n    }\n\n    return drawParams;\n  }\n\n  _updateDrawParamsForLocation(drawParams, location) {\n    const value = this.values[location];\n    const accessor = this.accessors[location];\n\n    if (!value) {\n      return;\n    }\n\n    const {\n      divisor\n    } = accessor;\n    const isInstanced = divisor > 0;\n    drawParams.isInstanced = drawParams.isInstanced || isInstanced;\n\n    if (value instanceof Buffer) {\n      const buffer = value;\n\n      if (isInstanced) {\n        const instanceCount = buffer.getVertexCount(accessor);\n        drawParams.instanceCount = Math.min(drawParams.instanceCount, instanceCount);\n      } else {\n        const vertexCount = buffer.getVertexCount(accessor);\n        drawParams.vertexCount = Math.min(drawParams.vertexCount, vertexCount);\n      }\n    }\n  }\n\n  setElements(elementBuffer = null, accessor = {}) {\n    log.deprecated('setElements', 'setElementBuffer')();\n    return this.setElementBuffer(elementBuffer, accessor);\n  }\n\n}\n//# sourceMappingURL=vertex-array.js.map","import { formatValue, assert } from '../utils';\nexport function getDebugTableForUniforms({\n  header = 'Uniforms',\n  program,\n  uniforms,\n  undefinedOnly = false\n}) {\n  assert(program);\n  const SHADER_MODULE_UNIFORM_REGEXP = '.*_.*';\n  const PROJECT_MODULE_UNIFORM_REGEXP = '.*Matrix';\n  const uniformLocations = program._uniformSetters;\n  const table = {};\n  const uniformNames = Object.keys(uniformLocations).sort();\n  let count = 0;\n\n  for (const uniformName of uniformNames) {\n    if (!uniformName.match(SHADER_MODULE_UNIFORM_REGEXP) && !uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({\n        table,\n        header,\n        uniforms,\n        uniformName,\n        undefinedOnly\n      })) {\n        count++;\n      }\n    }\n  }\n\n  for (const uniformName of uniformNames) {\n    if (uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({\n        table,\n        header,\n        uniforms,\n        uniformName,\n        undefinedOnly\n      })) {\n        count++;\n      }\n    }\n  }\n\n  for (const uniformName of uniformNames) {\n    if (!table[uniformName]) {\n      if (addUniformToTable({\n        table,\n        header,\n        uniforms,\n        uniformName,\n        undefinedOnly\n      })) {\n        count++;\n      }\n    }\n  }\n\n  let unusedCount = 0;\n  const unusedTable = {};\n\n  if (!undefinedOnly) {\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n\n      if (!table[uniformName]) {\n        unusedCount++;\n        unusedTable[uniformName] = {\n          Type: \"NOT USED: \".concat(uniform),\n          [header]: formatValue(uniform)\n        };\n      }\n    }\n  }\n\n  return {\n    table,\n    count,\n    unusedTable,\n    unusedCount\n  };\n}\n\nfunction addUniformToTable({\n  table,\n  header,\n  uniforms,\n  uniformName,\n  undefinedOnly\n}) {\n  const value = uniforms[uniformName];\n  const isDefined = isUniformDefined(value);\n\n  if (!undefinedOnly || !isDefined) {\n    table[uniformName] = {\n      [header]: isDefined ? formatValue(value) : 'N/A',\n      'Uniform Type': isDefined ? value : 'NOT PROVIDED'\n    };\n    return true;\n  }\n\n  return false;\n}\n\nfunction isUniformDefined(value) {\n  return value !== undefined && value !== null;\n}\n//# sourceMappingURL=debug-uniforms.js.map","import Buffer from '../classes/buffer';\nimport { getKey } from '../webgl-utils';\nimport { getCompositeGLType } from '../webgl-utils/attribute-utils';\nimport { formatValue } from '../utils';\nexport function getDebugTableForVertexArray({\n  vertexArray,\n  header = 'Attributes'\n}) {\n  if (!vertexArray.configuration) {\n    return {};\n  }\n\n  const table = {};\n\n  if (vertexArray.elements) {\n    table.ELEMENT_ARRAY_BUFFER = getDebugTableRow(vertexArray, vertexArray.elements, null, header);\n  }\n\n  const attributes = vertexArray.values;\n\n  for (const attributeLocation in attributes) {\n    const info = vertexArray._getAttributeInfo(attributeLocation);\n\n    if (info) {\n      let rowHeader = \"\".concat(attributeLocation, \": \").concat(info.name);\n      const accessor = vertexArray.accessors[info.location];\n\n      if (accessor) {\n        rowHeader = \"\".concat(attributeLocation, \": \").concat(getGLSLDeclaration(info.name, accessor));\n      }\n\n      table[rowHeader] = getDebugTableRow(vertexArray, attributes[attributeLocation], accessor, header);\n    }\n  }\n\n  return table;\n}\n\nfunction getDebugTableRow(vertexArray, attribute, accessor, header) {\n  const {\n    gl\n  } = vertexArray;\n\n  if (!attribute) {\n    return {\n      [header]: 'null',\n      'Format ': 'N/A'\n    };\n  }\n\n  let type = 'NOT PROVIDED';\n  let size = 1;\n  let verts = 0;\n  let bytes = 0;\n  let isInteger;\n  let marker;\n  let value;\n\n  if (accessor) {\n    type = accessor.type;\n    size = accessor.size;\n    type = String(type).replace('Array', '');\n    isInteger = type.indexOf('nt') !== -1;\n  }\n\n  if (attribute instanceof Buffer) {\n    const buffer = attribute;\n    const {\n      data,\n      changed\n    } = buffer.getDebugData();\n    marker = changed ? '*' : '';\n    value = data;\n    bytes = buffer.byteLength;\n    verts = bytes / data.BYTES_PER_ELEMENT / size;\n    let format;\n\n    if (accessor) {\n      const instanced = accessor.divisor > 0;\n      format = \"\".concat(instanced ? 'I ' : 'P ', \" \").concat(verts, \" (x\").concat(size, \"=\").concat(bytes, \" bytes \").concat(getKey(gl, type), \")\");\n    } else {\n      isInteger = true;\n      format = \"\".concat(bytes, \" bytes\");\n    }\n\n    return {\n      [header]: \"\".concat(marker).concat(formatValue(value, {\n        size,\n        isInteger\n      })),\n      'Format ': format\n    };\n  }\n\n  value = attribute;\n  size = attribute.length;\n  type = String(attribute.constructor.name).replace('Array', '');\n  isInteger = type.indexOf('nt') !== -1;\n  return {\n    [header]: \"\".concat(formatValue(value, {\n      size,\n      isInteger\n    }), \" (constant)\"),\n    'Format ': \"\".concat(size, \"x\").concat(type, \" (constant)\")\n  };\n}\n\nfunction getGLSLDeclaration(name, accessor) {\n  const {\n    type,\n    size\n  } = accessor;\n  const typeAndName = getCompositeGLType(type, size);\n  return typeAndName ? \"\".concat(name, \" (\").concat(typeAndName.name, \")\") : name;\n}\n//# sourceMappingURL=debug-vertex-array.js.map","import { getCompositeGLType } from '../webgl-utils/attribute-utils';\nexport function getDebugTableForProgramConfiguration(config) {\n  const table = {};\n  const header = \"Accessors for \".concat(config.id);\n\n  for (const attributeInfo of config.attributeInfos) {\n    if (attributeInfo) {\n      const glslDeclaration = getGLSLDeclaration(attributeInfo);\n      table[\"in \".concat(glslDeclaration)] = {\n        [header]: JSON.stringify(attributeInfo.accessor)\n      };\n    }\n  }\n\n  for (const varyingInfo of config.varyingInfos) {\n    if (varyingInfo) {\n      const glslDeclaration = getGLSLDeclaration(varyingInfo);\n      table[\"out \".concat(glslDeclaration)] = {\n        [header]: JSON.stringify(varyingInfo.accessor)\n      };\n    }\n  }\n\n  return table;\n}\n\nfunction getGLSLDeclaration(attributeInfo) {\n  const {\n    type,\n    size\n  } = attributeInfo.accessor;\n  const typeAndName = getCompositeGLType(type, size);\n\n  if (typeAndName) {\n    return \"\".concat(typeAndName.name, \" \").concat(attributeInfo.name);\n  }\n\n  return attributeInfo.name;\n}\n//# sourceMappingURL=debug-program-configuration.js.map","import { isWebGL, createGLContext, instrumentGLContext, resizeGLContext, resetParameters } from '@luma.gl/gltools';\nimport { requestAnimationFrame, cancelAnimationFrame, Query, lumaStats, Framebuffer, log, assert } from '@luma.gl/webgl';\nimport { isBrowser } from 'probe.gl/env';\nconst isPage = isBrowser() && typeof document !== 'undefined';\nlet statIdCounter = 0;\nexport default class AnimationLoop {\n  constructor(props = {}) {\n    const {\n      onCreateContext = opts => createGLContext(opts),\n      onAddHTML = null,\n      onInitialize = () => {},\n      onRender = () => {},\n      onFinalize = () => {},\n      onError,\n      gl = null,\n      glOptions = {},\n      debug = false,\n      createFramebuffer = false,\n      autoResizeViewport = true,\n      autoResizeDrawingBuffer = true,\n      stats = lumaStats.get(\"animation-loop-\".concat(statIdCounter++))\n    } = props;\n    let {\n      useDevicePixels = true\n    } = props;\n\n    if ('useDevicePixelRatio' in props) {\n      log.deprecated('useDevicePixelRatio', 'useDevicePixels')();\n      useDevicePixels = props.useDevicePixelRatio;\n    }\n\n    this.props = {\n      onCreateContext,\n      onAddHTML,\n      onInitialize,\n      onRender,\n      onFinalize,\n      onError,\n      gl,\n      glOptions,\n      debug,\n      createFramebuffer\n    };\n    this.gl = gl;\n    this.needsRedraw = null;\n    this.timeline = null;\n    this.stats = stats;\n    this.cpuTime = this.stats.get('CPU Time');\n    this.gpuTime = this.stats.get('GPU Time');\n    this.frameRate = this.stats.get('Frame Rate');\n    this._initialized = false;\n    this._running = false;\n    this._animationFrameId = null;\n    this._nextFramePromise = null;\n    this._resolveNextFrame = null;\n    this._cpuStartTime = 0;\n    this.setProps({\n      autoResizeViewport,\n      autoResizeDrawingBuffer,\n      useDevicePixels\n    });\n    this.start = this.start.bind(this);\n    this.stop = this.stop.bind(this);\n    this._pageLoadPromise = null;\n    this._onMousemove = this._onMousemove.bind(this);\n    this._onMouseleave = this._onMouseleave.bind(this);\n  }\n\n  delete() {\n    this.stop();\n\n    this._setDisplay(null);\n  }\n\n  setNeedsRedraw(reason) {\n    assert(typeof reason === 'string');\n    this.needsRedraw = this.needsRedraw || reason;\n    return this;\n  }\n\n  setProps(props) {\n    if ('autoResizeViewport' in props) {\n      this.autoResizeViewport = props.autoResizeViewport;\n    }\n\n    if ('autoResizeDrawingBuffer' in props) {\n      this.autoResizeDrawingBuffer = props.autoResizeDrawingBuffer;\n    }\n\n    if ('useDevicePixels' in props) {\n      this.useDevicePixels = props.useDevicePixels;\n    }\n\n    return this;\n  }\n\n  start(opts = {}) {\n    if (this._running) {\n      return this;\n    }\n\n    this._running = true;\n\n    const startPromise = this._getPageLoadPromise().then(() => {\n      if (!this._running || this._initialized) {\n        return null;\n      }\n\n      this._createWebGLContext(opts);\n\n      this._createFramebuffer();\n\n      this._startEventHandling();\n\n      this._initializeCallbackData();\n\n      this._updateCallbackData();\n\n      this._resizeCanvasDrawingBuffer();\n\n      this._resizeViewport();\n\n      this._gpuTimeQuery = Query.isSupported(this.gl, ['timers']) ? new Query(this.gl) : null;\n      this._initialized = true;\n      return this.onInitialize(this.animationProps);\n    }).then(appContext => {\n      if (this._running) {\n        this._addCallbackData(appContext || {});\n\n        if (appContext !== false) {\n          this._startLoop();\n        }\n      }\n    });\n\n    if (this.props.onError) {\n      startPromise.catch(this.props.onError);\n    }\n\n    return this;\n  }\n\n  redraw() {\n    if (this.isContextLost()) {\n      return this;\n    }\n\n    this._beginTimers();\n\n    this._setupFrame();\n\n    this._updateCallbackData();\n\n    this._renderFrame(this.animationProps);\n\n    this._clearNeedsRedraw();\n\n    if (this.offScreen && this.gl.commit) {\n      this.gl.commit();\n    }\n\n    if (this._resolveNextFrame) {\n      this._resolveNextFrame(this);\n\n      this._nextFramePromise = null;\n      this._resolveNextFrame = null;\n    }\n\n    this._endTimers();\n\n    return this;\n  }\n\n  stop() {\n    if (this._running) {\n      this._finalizeCallbackData();\n\n      cancelAnimationFrame(this._animationFrameId);\n      this._nextFramePromise = null;\n      this._resolveNextFrame = null;\n      this._animationFrameId = null;\n      this._running = false;\n    }\n\n    return this;\n  }\n\n  attachTimeline(timeline) {\n    this.timeline = timeline;\n    return this.timeline;\n  }\n\n  detachTimeline() {\n    this.timeline = null;\n  }\n\n  waitForRender() {\n    this.setNeedsRedraw('waitForRender');\n\n    if (!this._nextFramePromise) {\n      this._nextFramePromise = new Promise(resolve => {\n        this._resolveNextFrame = resolve;\n      });\n    }\n\n    return this._nextFramePromise;\n  }\n\n  async toDataURL() {\n    this.setNeedsRedraw('toDataURL');\n    await this.waitForRender();\n    return this.gl.canvas.toDataURL();\n  }\n\n  isContextLost() {\n    return this.gl.isContextLost();\n  }\n\n  onCreateContext(...args) {\n    return this.props.onCreateContext(...args);\n  }\n\n  onInitialize(...args) {\n    return this.props.onInitialize(...args);\n  }\n\n  onRender(...args) {\n    return this.props.onRender(...args);\n  }\n\n  onFinalize(...args) {\n    return this.props.onFinalize(...args);\n  }\n\n  getHTMLControlValue(id, defaultValue = 1) {\n    const element = document.getElementById(id);\n    return element ? Number(element.value) : defaultValue;\n  }\n\n  setViewParameters() {\n    log.removed('AnimationLoop.setViewParameters', 'AnimationLoop.setProps')();\n    return this;\n  }\n\n  _startLoop() {\n    const renderFrame = () => {\n      if (!this._running) {\n        return;\n      }\n\n      this.redraw();\n      this._animationFrameId = this._requestAnimationFrame(renderFrame);\n    };\n\n    cancelAnimationFrame(this._animationFrameId);\n    this._animationFrameId = this._requestAnimationFrame(renderFrame);\n  }\n\n  _getPageLoadPromise() {\n    if (!this._pageLoadPromise) {\n      this._pageLoadPromise = isPage ? new Promise((resolve, reject) => {\n        if (isPage && document.readyState === 'complete') {\n          resolve(document);\n          return;\n        }\n\n        window.addEventListener('load', () => {\n          resolve(document);\n        });\n      }) : Promise.resolve({});\n    }\n\n    return this._pageLoadPromise;\n  }\n\n  _setDisplay(display) {\n    if (this.display) {\n      this.display.delete();\n      this.display.animationLoop = null;\n    }\n\n    if (display) {\n      display.animationLoop = this;\n    }\n\n    this.display = display;\n  }\n\n  _requestAnimationFrame(renderFrameCallback) {\n    if (this.display && this.display.requestAnimationFrame(renderFrameCallback)) {\n      return;\n    }\n\n    requestAnimationFrame(renderFrameCallback);\n  }\n\n  _renderFrame(...args) {\n    if (this.display) {\n      this.display._renderFrame(...args);\n\n      return;\n    }\n\n    this.onRender(...args);\n  }\n\n  _clearNeedsRedraw() {\n    this.needsRedraw = null;\n  }\n\n  _setupFrame() {\n    this._resizeCanvasDrawingBuffer();\n\n    this._resizeViewport();\n\n    this._resizeFramebuffer();\n  }\n\n  _initializeCallbackData() {\n    this.animationProps = {\n      gl: this.gl,\n      stop: this.stop,\n      canvas: this.gl.canvas,\n      framebuffer: this.framebuffer,\n      useDevicePixels: this.useDevicePixels,\n      needsRedraw: null,\n      startTime: Date.now(),\n      engineTime: 0,\n      tick: 0,\n      tock: 0,\n      time: 0,\n      _timeline: this.timeline,\n      _loop: this,\n      _animationLoop: this,\n      _mousePosition: null\n    };\n  }\n\n  _updateCallbackData() {\n    const {\n      width,\n      height,\n      aspect\n    } = this._getSizeAndAspect();\n\n    if (width !== this.animationProps.width || height !== this.animationProps.height) {\n      this.setNeedsRedraw('drawing buffer resized');\n    }\n\n    if (aspect !== this.animationProps.aspect) {\n      this.setNeedsRedraw('drawing buffer aspect changed');\n    }\n\n    this.animationProps.width = width;\n    this.animationProps.height = height;\n    this.animationProps.aspect = aspect;\n    this.animationProps.needsRedraw = this.needsRedraw;\n    this.animationProps.engineTime = Date.now() - this.animationProps.startTime;\n\n    if (this.timeline) {\n      this.timeline.update(this.animationProps.engineTime);\n    }\n\n    this.animationProps.tick = Math.floor(this.animationProps.time / 1000 * 60);\n    this.animationProps.tock++;\n    this.animationProps.time = this.timeline ? this.timeline.getTime() : this.animationProps.engineTime;\n    this.animationProps._offScreen = this.offScreen;\n  }\n\n  _finalizeCallbackData() {\n    this.onFinalize(this.animationProps);\n  }\n\n  _addCallbackData(appContext) {\n    if (typeof appContext === 'object' && appContext !== null) {\n      this.animationProps = Object.assign({}, this.animationProps, appContext);\n    }\n  }\n\n  _createWebGLContext(opts) {\n    this.offScreen = opts.canvas && typeof OffscreenCanvas !== 'undefined' && opts.canvas instanceof OffscreenCanvas;\n    opts = Object.assign({}, opts, this.props.glOptions);\n    this.gl = this.props.gl ? instrumentGLContext(this.props.gl, opts) : this.onCreateContext(opts);\n\n    if (!isWebGL(this.gl)) {\n      throw new Error('AnimationLoop.onCreateContext - illegal context returned');\n    }\n\n    resetParameters(this.gl);\n\n    this._createInfoDiv();\n  }\n\n  _createInfoDiv() {\n    if (this.gl.canvas && this.props.onAddHTML) {\n      const wrapperDiv = document.createElement('div');\n      document.body.appendChild(wrapperDiv);\n      wrapperDiv.style.position = 'relative';\n      const div = document.createElement('div');\n      div.style.position = 'absolute';\n      div.style.left = '10px';\n      div.style.bottom = '10px';\n      div.style.width = '300px';\n      div.style.background = 'white';\n      wrapperDiv.appendChild(this.gl.canvas);\n      wrapperDiv.appendChild(div);\n      const html = this.props.onAddHTML(div);\n\n      if (html) {\n        div.innerHTML = html;\n      }\n    }\n  }\n\n  _getSizeAndAspect() {\n    const width = this.gl.drawingBufferWidth;\n    const height = this.gl.drawingBufferHeight;\n    let aspect = 1;\n    const {\n      canvas\n    } = this.gl;\n\n    if (canvas && canvas.clientHeight) {\n      aspect = canvas.clientWidth / canvas.clientHeight;\n    } else if (width > 0 && height > 0) {\n      aspect = width / height;\n    }\n\n    return {\n      width,\n      height,\n      aspect\n    };\n  }\n\n  _resizeViewport() {\n    if (this.autoResizeViewport) {\n      this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\n    }\n  }\n\n  _resizeCanvasDrawingBuffer() {\n    if (this.autoResizeDrawingBuffer) {\n      resizeGLContext(this.gl, {\n        useDevicePixels: this.useDevicePixels\n      });\n    }\n  }\n\n  _createFramebuffer() {\n    if (this.props.createFramebuffer) {\n      this.framebuffer = new Framebuffer(this.gl);\n    }\n  }\n\n  _resizeFramebuffer() {\n    if (this.framebuffer) {\n      this.framebuffer.resize({\n        width: this.gl.drawingBufferWidth,\n        height: this.gl.drawingBufferHeight\n      });\n    }\n  }\n\n  _beginTimers() {\n    this.frameRate.timeEnd();\n    this.frameRate.timeStart();\n\n    if (this._gpuTimeQuery && this._gpuTimeQuery.isResultAvailable() && !this._gpuTimeQuery.isTimerDisjoint()) {\n      this.stats.get('GPU Time').addTime(this._gpuTimeQuery.getTimerMilliseconds());\n    }\n\n    if (this._gpuTimeQuery) {\n      this._gpuTimeQuery.beginTimeElapsedQuery();\n    }\n\n    this.cpuTime.timeStart();\n  }\n\n  _endTimers() {\n    this.cpuTime.timeEnd();\n\n    if (this._gpuTimeQuery) {\n      this._gpuTimeQuery.end();\n    }\n  }\n\n  _startEventHandling() {\n    const {\n      canvas\n    } = this.gl;\n\n    if (canvas) {\n      canvas.addEventListener('mousemove', this._onMousemove);\n      canvas.addEventListener('mouseleave', this._onMouseleave);\n    }\n  }\n\n  _onMousemove(e) {\n    this.animationProps._mousePosition = [e.offsetX, e.offsetY];\n  }\n\n  _onMouseleave(e) {\n    this.animationProps._mousePosition = null;\n  }\n\n}\n//# sourceMappingURL=animation-loop.js.map","export const VERTEX_SHADER = 'vs';\nexport const FRAGMENT_SHADER = 'fs';\n//# sourceMappingURL=constants.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'shadertools: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","const TYPE_DEFINITIONS = {\n  number: {\n    validate(value, propType) {\n      return Number.isFinite(value) && (!('max' in propType) || value <= propType.max) && (!('min' in propType) || value >= propType.min);\n    }\n\n  },\n  array: {\n    validate(value, propType) {\n      return Array.isArray(value) || ArrayBuffer.isView(value);\n    }\n\n  }\n};\nexport function parsePropTypes(propDefs) {\n  const propTypes = {};\n\n  for (const propName in propDefs) {\n    const propDef = propDefs[propName];\n    const propType = parsePropType(propDef);\n    propTypes[propName] = propType;\n  }\n\n  return propTypes;\n}\n\nfunction parsePropType(propDef) {\n  let type = getTypeOf(propDef);\n\n  if (type === 'object') {\n    if (!propDef) {\n      return {\n        type: 'object',\n        value: null\n      };\n    }\n\n    if ('type' in propDef) {\n      return Object.assign({}, propDef, TYPE_DEFINITIONS[propDef.type]);\n    }\n\n    if (!('value' in propDef)) {\n      return {\n        type: 'object',\n        value: propDef\n      };\n    }\n\n    type = getTypeOf(propDef.value);\n    return Object.assign({\n      type\n    }, propDef, TYPE_DEFINITIONS[type]);\n  }\n\n  return Object.assign({\n    type,\n    value: propDef\n  }, TYPE_DEFINITIONS[type]);\n}\n\nfunction getTypeOf(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return 'array';\n  }\n\n  return typeof value;\n}\n//# sourceMappingURL=prop-types.js.map","import { assert } from '../utils';\nimport { parsePropTypes } from './filters/prop-types';\nconst VERTEX_SHADER = 'vs';\nconst FRAGMENT_SHADER = 'fs';\nexport default class ShaderModule {\n  constructor({\n    name,\n    vs,\n    fs,\n    dependencies = [],\n    uniforms,\n    getUniforms,\n    deprecations = [],\n    defines = {},\n    inject = {},\n    vertexShader,\n    fragmentShader\n  }) {\n    assert(typeof name === 'string');\n    this.name = name;\n    this.vs = vs || vertexShader;\n    this.fs = fs || fragmentShader;\n    this.getModuleUniforms = getUniforms;\n    this.dependencies = dependencies;\n    this.deprecations = this._parseDeprecationDefinitions(deprecations);\n    this.defines = defines;\n    this.injections = normalizeInjections(inject);\n\n    if (uniforms) {\n      this.uniforms = parsePropTypes(uniforms);\n    }\n  }\n\n  getModuleSource(type) {\n    let moduleSource;\n\n    switch (type) {\n      case VERTEX_SHADER:\n        moduleSource = this.vs || '';\n        break;\n\n      case FRAGMENT_SHADER:\n        moduleSource = this.fs || '';\n        break;\n\n      default:\n        assert(false);\n    }\n\n    return \"#define MODULE_\".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi, '_'), \"\\n\").concat(moduleSource, \"// END MODULE_\").concat(this.name, \"\\n\\n\");\n  }\n\n  getUniforms(opts, uniforms) {\n    if (this.getModuleUniforms) {\n      return this.getModuleUniforms(opts, uniforms);\n    }\n\n    if (this.uniforms) {\n      return this._defaultGetUniforms(opts);\n    }\n\n    return {};\n  }\n\n  getDefines() {\n    return this.defines;\n  }\n\n  checkDeprecations(shaderSource, log) {\n    this.deprecations.forEach(def => {\n      if (def.regex.test(shaderSource)) {\n        if (def.deprecated) {\n          log.deprecated(def.old, def.new)();\n        } else {\n          log.removed(def.old, def.new)();\n        }\n      }\n    });\n  }\n\n  _parseDeprecationDefinitions(deprecations) {\n    deprecations.forEach(def => {\n      switch (def.type) {\n        case 'function':\n          def.regex = new RegExp(\"\\\\b\".concat(def.old, \"\\\\(\"));\n          break;\n\n        default:\n          def.regex = new RegExp(\"\".concat(def.type, \" \").concat(def.old, \";\"));\n      }\n    });\n    return deprecations;\n  }\n\n  _defaultGetUniforms(opts = {}) {\n    const uniforms = {};\n    const propTypes = this.uniforms;\n\n    for (const key in propTypes) {\n      const propDef = propTypes[key];\n\n      if (key in opts && !propDef.private) {\n        if (propDef.validate) {\n          assert(propDef.validate(opts[key], propDef), \"\".concat(this.name, \": invalid \").concat(key));\n        }\n\n        uniforms[key] = opts[key];\n      } else {\n        uniforms[key] = propDef.value;\n      }\n    }\n\n    return uniforms;\n  }\n\n}\nexport function normalizeShaderModule(module) {\n  if (!module.normalized) {\n    module.normalized = true;\n\n    if (module.uniforms && !module.getUniforms) {\n      const shaderModule = new ShaderModule(module);\n      module.getUniforms = shaderModule.getUniforms.bind(shaderModule);\n    }\n  }\n\n  return module;\n}\n\nfunction normalizeInjections(injections) {\n  const result = {\n    vs: {},\n    fs: {}\n  };\n\n  for (const hook in injections) {\n    let injection = injections[hook];\n    const stage = hook.slice(0, 2);\n\n    if (typeof injection === 'string') {\n      injection = {\n        order: 0,\n        injection\n      };\n    }\n\n    result[stage][hook] = injection;\n  }\n\n  return result;\n}\n//# sourceMappingURL=shader-module.js.map","import ShaderModule from './shader-module';\nimport { assert } from '../utils';\nexport function resolveModules(modules) {\n  return getShaderDependencies(instantiateModules(modules));\n}\n\nfunction getShaderDependencies(modules) {\n  const moduleMap = {};\n  const moduleDepth = {};\n  getDependencyGraph({\n    modules,\n    level: 0,\n    moduleMap,\n    moduleDepth\n  });\n  return Object.keys(moduleDepth).sort((a, b) => moduleDepth[b] - moduleDepth[a]).map(name => moduleMap[name]);\n}\n\nfunction getDependencyGraph({\n  modules,\n  level,\n  moduleMap,\n  moduleDepth\n}) {\n  if (level >= 5) {\n    throw new Error('Possible loop in shader dependency graph');\n  }\n\n  for (const module of modules) {\n    moduleMap[module.name] = module;\n\n    if (moduleDepth[module.name] === undefined || moduleDepth[module.name] < level) {\n      moduleDepth[module.name] = level;\n    }\n  }\n\n  for (const module of modules) {\n    if (module.dependencies) {\n      getDependencyGraph({\n        modules: module.dependencies,\n        level: level + 1,\n        moduleMap,\n        moduleDepth\n      });\n    }\n  }\n}\n\nfunction instantiateModules(modules, seen) {\n  return modules.map(module => {\n    if (module instanceof ShaderModule) {\n      return module;\n    }\n\n    assert(typeof module !== 'string', \"Shader module use by name is deprecated. Import shader module '\".concat(module, \"' and use it directly.\"));\n    assert(module.name, 'shader module has no name');\n    module = new ShaderModule(module);\n    module.dependencies = instantiateModules(module.dependencies);\n    return module;\n  });\n}\n\nexport const TEST_EXPORTS = {\n  getShaderDependencies,\n  getDependencyGraph\n};\n//# sourceMappingURL=resolve-modules.js.map","import isOldIE from './is-old-ie';\nimport assert from './assert';\nconst GL_VENDOR = 0x1f00;\nconst GL_RENDERER = 0x1f01;\nconst GL_VERSION = 0x1f02;\nconst GL_SHADING_LANGUAGE_VERSION = 0x8b8c;\nconst WEBGL_FEATURES = {\n  GLSL_FRAG_DATA: ['WEBGL_draw_buffers', true],\n  GLSL_FRAG_DEPTH: ['EXT_frag_depth', true],\n  GLSL_DERIVATIVES: ['OES_standard_derivatives', true],\n  GLSL_TEXTURE_LOD: ['EXT_shader_texture_lod', true]\n};\nconst FEATURES = {};\nObject.keys(WEBGL_FEATURES).forEach(key => {\n  FEATURES[key] = key;\n});\nexport { FEATURES };\n\nfunction isWebGL2(gl) {\n  if (typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext) {\n    return true;\n  }\n\n  return Boolean(gl && gl._version === 2);\n}\n\nexport function getContextInfo(gl) {\n  const info = gl.getExtension('WEBGL_debug_renderer_info');\n  const vendor = gl.getParameter(info && info.UNMASKED_VENDOR_WEBGL || GL_VENDOR);\n  const renderer = gl.getParameter(info && info.UNMASKED_RENDERER_WEBGL || GL_RENDERER);\n  const gpuVendor = identifyGPUVendor(vendor, renderer);\n  const gpuInfo = {\n    gpuVendor,\n    vendor,\n    renderer,\n    version: gl.getParameter(GL_VERSION),\n    shadingLanguageVersion: gl.getParameter(GL_SHADING_LANGUAGE_VERSION)\n  };\n  return gpuInfo;\n}\n\nfunction identifyGPUVendor(vendor, renderer) {\n  if (vendor.match(/NVIDIA/i) || renderer.match(/NVIDIA/i)) {\n    return 'NVIDIA';\n  }\n\n  if (vendor.match(/INTEL/i) || renderer.match(/INTEL/i)) {\n    return 'INTEL';\n  }\n\n  if (vendor.match(/AMD/i) || renderer.match(/AMD/i) || vendor.match(/ATI/i) || renderer.match(/ATI/i)) {\n    return 'AMD';\n  }\n\n  return 'UNKNOWN GPU';\n}\n\nconst compiledGlslExtensions = {};\nexport function canCompileGLGSExtension(gl, cap, opts = {}) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n\n  if (!isOldIE(opts)) {\n    return true;\n  }\n\n  if (cap in compiledGlslExtensions) {\n    return compiledGlslExtensions[cap];\n  }\n\n  const extensionName = feature[0];\n  const behavior = opts.behavior || 'enable';\n  const source = \"#extension GL_\".concat(extensionName, \" : \").concat(behavior, \"\\nvoid main(void) {}\");\n  const shader = gl.createShader(35633);\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const canCompile = gl.getShaderParameter(shader, 35713);\n  gl.deleteShader(shader);\n  compiledGlslExtensions[cap] = canCompile;\n  return canCompile;\n}\n\nfunction getFeature(gl, cap) {\n  const feature = WEBGL_FEATURES[cap];\n  assert(feature, cap);\n  const extensionName = isWebGL2(gl) ? feature[1] || feature[0] : feature[0];\n  const value = typeof extensionName === 'string' ? Boolean(gl.getExtension(extensionName)) : extensionName;\n  assert(value === false || value === true);\n  return value;\n}\n\nexport function hasFeatures(gl, features) {\n  features = Array.isArray(features) ? features : [features];\n  return features.every(feature => getFeature(gl, feature));\n}\n//# sourceMappingURL=webgl-info.js.map","export default function isOldIE(opts = {}) {\n  const navigator = typeof window !== 'undefined' ? window.navigator || {} : {};\n  const userAgent = opts.userAgent || navigator.userAgent || '';\n  const isMSIE = userAgent.indexOf('MSIE ') !== -1;\n  const isTrident = userAgent.indexOf('Trident/') !== -1;\n  return isMSIE || isTrident;\n}\n//# sourceMappingURL=is-old-ie.js.map","export const MODULE_INJECTORS_VS = \"#ifdef MODULE_LOGDEPTH\\n  logdepth_adjustPosition(gl_Position);\\n#endif\\n\";\nexport const MODULE_INJECTORS_FS = \"#ifdef MODULE_MATERIAL\\n  gl_FragColor = material_filterColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_LIGHTING\\n  gl_FragColor = lighting_filterColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_FOG\\n  gl_FragColor = fog_filterColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_PICKING\\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\\n#endif\\n\\n#ifdef MODULE_LOGDEPTH\\n  logdepth_setFragDepth();\\n#endif\\n\";\n//# sourceMappingURL=module-injectors.js.map","import { MODULE_INJECTORS_VS, MODULE_INJECTORS_FS } from '../modules/module-injectors';\nimport { VERTEX_SHADER, FRAGMENT_SHADER } from './constants';\nimport { assert } from '../utils';\nconst MODULE_INJECTORS = {\n  [VERTEX_SHADER]: MODULE_INJECTORS_VS,\n  [FRAGMENT_SHADER]: MODULE_INJECTORS_FS\n};\nexport const DECLARATION_INJECT_MARKER = '__LUMA_INJECT_DECLARATIONS__';\nconst REGEX_START_OF_MAIN = /void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/;\nconst REGEX_END_OF_MAIN = /}\\n?[^{}]*$/;\nconst fragments = [];\nexport default function injectShader(source, type, inject, injectStandardStubs = false) {\n  const isVertex = type === VERTEX_SHADER;\n\n  for (const key in inject) {\n    const fragmentData = inject[key];\n    fragmentData.sort((a, b) => a.order - b.order);\n    fragments.length = fragmentData.length;\n\n    for (let i = 0, len = fragmentData.length; i < len; ++i) {\n      fragments[i] = fragmentData[i].injection;\n    }\n\n    const fragmentString = \"\".concat(fragments.join('\\n'), \"\\n\");\n\n    switch (key) {\n      case 'vs:#decl':\n        if (isVertex) {\n          source = source.replace(DECLARATION_INJECT_MARKER, fragmentString);\n        }\n\n        break;\n\n      case 'vs:#main-start':\n        if (isVertex) {\n          source = source.replace(REGEX_START_OF_MAIN, match => match + fragmentString);\n        }\n\n        break;\n\n      case 'vs:#main-end':\n        if (isVertex) {\n          source = source.replace(REGEX_END_OF_MAIN, match => fragmentString + match);\n        }\n\n        break;\n\n      case 'fs:#decl':\n        if (!isVertex) {\n          source = source.replace(DECLARATION_INJECT_MARKER, fragmentString);\n        }\n\n        break;\n\n      case 'fs:#main-start':\n        if (!isVertex) {\n          source = source.replace(REGEX_START_OF_MAIN, match => match + fragmentString);\n        }\n\n        break;\n\n      case 'fs:#main-end':\n        if (!isVertex) {\n          source = source.replace(REGEX_END_OF_MAIN, match => fragmentString + match);\n        }\n\n        break;\n\n      default:\n        source = source.replace(key, match => match + fragmentString);\n    }\n  }\n\n  source = source.replace(DECLARATION_INJECT_MARKER, '');\n\n  if (injectStandardStubs) {\n    source = source.replace(/\\}\\s*$/, match => match + MODULE_INJECTORS[type]);\n  }\n\n  return source;\n}\nexport function combineInjects(injects) {\n  const result = {};\n  assert(Array.isArray(injects) && injects.length > 1);\n  injects.forEach(inject => {\n    for (const key in inject) {\n      result[key] = result[key] ? \"\".concat(result[key], \"\\n\").concat(inject[key]) : inject[key];\n    }\n  });\n  return result;\n}\n//# sourceMappingURL=inject-shader.js.map","function testVariable(qualifier) {\n  return new RegExp(\"\\\\b\".concat(qualifier, \"[ \\\\t]+(\\\\w+[ \\\\t]+\\\\w+(\\\\[\\\\w+\\\\])?;)\"), 'g');\n}\n\nconst ES300_REPLACEMENTS = [[/^(#version[ \\t]+(100|300[ \\t]+es))?[ \\t]*\\n/, '#version 300 es\\n'], [/\\btexture(2D|2DProj|Cube)Lod(EXT)?\\(/g, 'textureLod('], [/\\btexture(2D|2DProj|Cube)(EXT)?\\(/g, 'texture(']];\nconst ES300_VERTEX_REPLACEMENTS = [...ES300_REPLACEMENTS, [testVariable('attribute'), 'in $1'], [testVariable('varying'), 'out $1']];\nconst ES300_FRAGMENT_REPLACEMENTS = [...ES300_REPLACEMENTS, [testVariable('varying'), 'in $1']];\nconst ES100_REPLACEMENTS = [[/^#version[ \\t]+300[ \\t]+es/, '#version 100'], [/\\btexture(2D|2DProj|Cube)Lod\\(/g, 'texture$1LodEXT('], [/\\btexture\\(/g, 'texture2D('], [/\\btextureLod\\(/g, 'texture2DLodEXT(']];\nconst ES100_VERTEX_REPLACEMENTS = [...ES100_REPLACEMENTS, [testVariable('in'), 'attribute $1'], [testVariable('out'), 'varying $1']];\nconst ES100_FRAGMENT_REPLACEMENTS = [...ES100_REPLACEMENTS, [testVariable('in'), 'varying $1']];\nconst ES100_FRAGMENT_OUTPUT_NAME = 'gl_FragColor';\nconst ES300_FRAGMENT_OUTPUT_REGEX = /\\bout[ \\t]+vec4[ \\t]+(\\w+)[ \\t]*;\\n?/;\nconst REGEX_START_OF_MAIN = /void\\s+main\\s*\\([^)]*\\)\\s*\\{\\n?/;\nexport default function transpileShader(source, targetGLSLVersion, isVertex) {\n  switch (targetGLSLVersion) {\n    case 300:\n      return isVertex ? convertShader(source, ES300_VERTEX_REPLACEMENTS) : convertFragmentShaderTo300(source);\n\n    case 100:\n      return isVertex ? convertShader(source, ES100_VERTEX_REPLACEMENTS) : convertFragmentShaderTo100(source);\n\n    default:\n      throw new Error(\"unknown GLSL version \".concat(targetGLSLVersion));\n  }\n}\n\nfunction convertShader(source, replacements) {\n  for (const [pattern, replacement] of replacements) {\n    source = source.replace(pattern, replacement);\n  }\n\n  return source;\n}\n\nfunction convertFragmentShaderTo300(source) {\n  source = convertShader(source, ES300_FRAGMENT_REPLACEMENTS);\n  const outputMatch = source.match(ES300_FRAGMENT_OUTPUT_REGEX);\n\n  if (outputMatch) {\n    const outputName = outputMatch[1];\n    source = source.replace(new RegExp(\"\\\\b\".concat(ES100_FRAGMENT_OUTPUT_NAME, \"\\\\b\"), 'g'), outputName);\n  } else {\n    const outputName = 'fragmentColor';\n    source = source.replace(REGEX_START_OF_MAIN, match => \"out vec4 \".concat(outputName, \";\\n\").concat(match)).replace(new RegExp(\"\\\\b\".concat(ES100_FRAGMENT_OUTPUT_NAME, \"\\\\b\"), 'g'), outputName);\n  }\n\n  return source;\n}\n\nfunction convertFragmentShaderTo100(source) {\n  source = convertShader(source, ES100_FRAGMENT_REPLACEMENTS);\n  const outputMatch = source.match(ES300_FRAGMENT_OUTPUT_REGEX);\n\n  if (outputMatch) {\n    const outputName = outputMatch[1];\n    source = source.replace(ES300_FRAGMENT_OUTPUT_REGEX, '').replace(new RegExp(\"\\\\b\".concat(outputName, \"\\\\b\"), 'g'), ES100_FRAGMENT_OUTPUT_NAME);\n  }\n\n  return source;\n}\n//# sourceMappingURL=transpile-shader.js.map","import { VERTEX_SHADER, FRAGMENT_SHADER } from './constants';\nimport { resolveModules } from './resolve-modules';\nimport { getPlatformShaderDefines, getVersionDefines } from './platform-defines';\nimport injectShader, { DECLARATION_INJECT_MARKER } from './inject-shader';\nimport transpileShader from './transpile-shader';\nimport { assert } from '../utils';\nconst INJECT_SHADER_DECLARATIONS = \"\\n\\n\".concat(DECLARATION_INJECT_MARKER, \"\\n\\n\");\nconst SHADER_TYPE = {\n  [VERTEX_SHADER]: 'vertex',\n  [FRAGMENT_SHADER]: 'fragment'\n};\nconst FRAGMENT_SHADER_PROLOGUE = \"precision highp float;\\n\\n\";\nexport function assembleShaders(gl, opts) {\n  const {\n    vs,\n    fs\n  } = opts;\n  const modules = resolveModules(opts.modules || []);\n  return {\n    gl,\n    vs: assembleShader(gl, Object.assign({}, opts, {\n      source: vs,\n      type: VERTEX_SHADER,\n      modules\n    })),\n    fs: assembleShader(gl, Object.assign({}, opts, {\n      source: fs,\n      type: FRAGMENT_SHADER,\n      modules\n    })),\n    getUniforms: assembleGetUniforms(modules)\n  };\n}\n\nfunction assembleShader(gl, {\n  id,\n  source,\n  type,\n  modules,\n  defines = {},\n  hookFunctions = [],\n  inject = {},\n  transpileToGLSL100 = false,\n  prologue = true,\n  log\n}) {\n  assert(typeof source === 'string', 'shader source must be a string');\n  const isVertex = type === VERTEX_SHADER;\n  const sourceLines = source.split('\\n');\n  let glslVersion = 100;\n  let versionLine = '';\n  let coreSource = source;\n\n  if (sourceLines[0].indexOf('#version ') === 0) {\n    glslVersion = 300;\n    versionLine = sourceLines[0];\n    coreSource = sourceLines.slice(1).join('\\n');\n  } else {\n    versionLine = \"#version \".concat(glslVersion);\n  }\n\n  const allDefines = {};\n  modules.forEach(module => {\n    Object.assign(allDefines, module.getDefines());\n  });\n  Object.assign(allDefines, defines);\n  let assembledSource = prologue ? \"\".concat(versionLine, \"\\n\").concat(getShaderName({\n    id,\n    source,\n    type\n  }), \"\\n\").concat(getShaderType({\n    type\n  }), \"\\n\").concat(getPlatformShaderDefines(gl), \"\\n\").concat(getVersionDefines(gl, glslVersion, !isVertex), \"\\n\").concat(getApplicationDefines(allDefines), \"\\n\").concat(isVertex ? '' : FRAGMENT_SHADER_PROLOGUE, \"\\n\") : \"\".concat(versionLine, \"\\n\");\n  const hookFunctionMap = normalizeHookFunctions(hookFunctions);\n  const hookInjections = {};\n  const declInjections = {};\n  const mainInjections = {};\n\n  for (const key in inject) {\n    const injection = typeof inject[key] === 'string' ? {\n      injection: inject[key],\n      order: 0\n    } : inject[key];\n    const match = key.match(/^(v|f)s:(#)?([\\w-]+)$/);\n\n    if (match) {\n      const hash = match[2];\n      const name = match[3];\n\n      if (hash) {\n        if (name === 'decl') {\n          declInjections[key] = [injection];\n        } else {\n          mainInjections[key] = [injection];\n        }\n      } else {\n        hookInjections[key] = [injection];\n      }\n    } else {\n      mainInjections[key] = [injection];\n    }\n  }\n\n  for (const module of modules) {\n    if (log) {\n      module.checkDeprecations(coreSource, log);\n    }\n\n    const moduleSource = module.getModuleSource(type, glslVersion);\n    assembledSource += moduleSource;\n    const injections = module.injections[type];\n\n    for (const key in injections) {\n      const match = key.match(/^(v|f)s:#([\\w-]+)$/);\n\n      if (match) {\n        const name = match[2];\n        const injectionType = name === 'decl' ? declInjections : mainInjections;\n        injectionType[key] = injectionType[key] || [];\n        injectionType[key].push(injections[key]);\n      } else {\n        hookInjections[key] = hookInjections[key] || [];\n        hookInjections[key].push(injections[key]);\n      }\n    }\n  }\n\n  assembledSource += INJECT_SHADER_DECLARATIONS;\n  assembledSource = injectShader(assembledSource, type, declInjections);\n  assembledSource += getHookFunctions(hookFunctionMap[type], hookInjections);\n  assembledSource += coreSource;\n  assembledSource = injectShader(assembledSource, type, mainInjections);\n  assembledSource = transpileShader(assembledSource, transpileToGLSL100 ? 100 : glslVersion, isVertex);\n  return assembledSource;\n}\n\nfunction assembleGetUniforms(modules) {\n  return function getUniforms(opts) {\n    const uniforms = {};\n\n    for (const module of modules) {\n      const moduleUniforms = module.getUniforms(opts, uniforms);\n      Object.assign(uniforms, moduleUniforms);\n    }\n\n    return uniforms;\n  };\n}\n\nfunction getShaderType({\n  type\n}) {\n  return \"\\n#define SHADER_TYPE_\".concat(SHADER_TYPE[type].toUpperCase(), \"\\n\");\n}\n\nfunction getShaderName({\n  id,\n  source,\n  type\n}) {\n  const injectShaderName = id && typeof id === 'string' && source.indexOf('SHADER_NAME') === -1;\n  return injectShaderName ? \"\\n#define SHADER_NAME \".concat(id, \"_\").concat(SHADER_TYPE[type], \"\\n\\n\") : '';\n}\n\nfunction getApplicationDefines(defines = {}) {\n  let count = 0;\n  let sourceText = '';\n\n  for (const define in defines) {\n    if (count === 0) {\n      sourceText += '\\n// APPLICATION DEFINES\\n';\n    }\n\n    count++;\n    const value = defines[define];\n\n    if (value || Number.isFinite(value)) {\n      sourceText += \"#define \".concat(define.toUpperCase(), \" \").concat(defines[define], \"\\n\");\n    }\n  }\n\n  if (count === 0) {\n    sourceText += '\\n';\n  }\n\n  return sourceText;\n}\n\nfunction getHookFunctions(hookFunctions, hookInjections) {\n  let result = '';\n\n  for (const hookName in hookFunctions) {\n    const hookFunction = hookFunctions[hookName];\n    result += \"void \".concat(hookFunction.signature, \" {\\n\");\n\n    if (hookFunction.header) {\n      result += \"  \".concat(hookFunction.header);\n    }\n\n    if (hookInjections[hookName]) {\n      const injections = hookInjections[hookName];\n      injections.sort((a, b) => a.order - b.order);\n\n      for (const injection of injections) {\n        result += \"  \".concat(injection.injection, \"\\n\");\n      }\n    }\n\n    if (hookFunction.footer) {\n      result += \"  \".concat(hookFunction.footer);\n    }\n\n    result += '}\\n';\n  }\n\n  return result;\n}\n\nfunction normalizeHookFunctions(hookFunctions) {\n  const result = {\n    vs: {},\n    fs: {}\n  };\n  hookFunctions.forEach(hook => {\n    let opts;\n\n    if (typeof hook !== 'string') {\n      opts = hook;\n      hook = opts.hook;\n    } else {\n      opts = {};\n    }\n\n    hook = hook.trim();\n    const [stage, signature] = hook.split(':');\n    const name = hook.replace(/\\(.+/, '');\n    result[stage][name] = Object.assign(opts, {\n      signature\n    });\n  });\n  return result;\n}\n//# sourceMappingURL=assemble-shaders.js.map","import { getContextInfo, hasFeatures, canCompileGLGSExtension, FEATURES } from '../utils/webgl-info';\nexport function getPlatformShaderDefines(gl) {\n  const debugInfo = getContextInfo(gl);\n\n  switch (debugInfo.gpuVendor.toLowerCase()) {\n    case 'nvidia':\n      return \"#define NVIDIA_GPU\\n// Nvidia optimizes away the calculation necessary for emulated fp64\\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\\n\";\n\n    case 'intel':\n      return \"#define INTEL_GPU\\n// Intel optimizes away the calculation necessary for emulated fp64\\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\\n// Intel's built-in 'tan' function doesn't have acceptable precision\\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\\n\";\n\n    case 'amd':\n      return \"#define AMD_GPU\\n\";\n\n    default:\n      return \"#define DEFAULT_GPU\\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\\n// Intel's built-in 'tan' function doesn't have acceptable precision\\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\\n\";\n  }\n}\nexport function getVersionDefines(gl, glslVersion, isFragment) {\n  let versionDefines = \"#if (__VERSION__ > 120)\\n\\n# define FEATURE_GLSL_DERIVATIVES\\n# define FEATURE_GLSL_DRAW_BUFFERS\\n# define FEATURE_GLSL_FRAG_DEPTH\\n# define FEATURE_GLSL_TEXTURE_LOD\\n\\n// DEPRECATED FLAGS, remove in v9\\n# define FRAG_DEPTH\\n# define DERIVATIVES\\n# define DRAW_BUFFERS\\n# define TEXTURE_LOD\\n\\n#endif // __VERSION\\n\";\n\n  if (hasFeatures(gl, FEATURES.GLSL_FRAG_DEPTH)) {\n    versionDefines += \"\\n// FRAG_DEPTH => gl_FragDepth is available\\n#ifdef GL_EXT_frag_depth\\n#extension GL_EXT_frag_depth : enable\\n# define FEATURE_GLSL_FRAG_DEPTH\\n# define FRAG_DEPTH\\n# define gl_FragDepth gl_FragDepthEXT\\n#endif\\n\";\n  }\n\n  if (hasFeatures(gl, FEATURES.GLSL_DERIVATIVES) && canCompileGLGSExtension(gl, FEATURES.GLSL_DERIVATIVES)) {\n    versionDefines += \"\\n// DERIVATIVES => dxdF, dxdY and fwidth are available\\n#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n# define FEATURE_GLSL_DERIVATIVES\\n# define DERIVATIVES\\n#endif\\n\";\n  }\n\n  if (hasFeatures(gl, FEATURES.GLSL_FRAG_DATA) && canCompileGLGSExtension(gl, FEATURES.GLSL_FRAG_DATA, {\n    behavior: 'require'\n  })) {\n    versionDefines += \"\\n// DRAW_BUFFERS => gl_FragData[] is available\\n#ifdef GL_EXT_draw_buffers\\n#extension GL_EXT_draw_buffers : require\\n#define FEATURE_GLSL_DRAW_BUFFERS\\n#define DRAW_BUFFERS\\n#endif\\n\";\n  }\n\n  if (hasFeatures(gl, FEATURES.GLSL_TEXTURE_LOD)) {\n    versionDefines += \"// TEXTURE_LOD => texture2DLod etc are available\\n#ifdef GL_EXT_shader_texture_lod\\n#extension GL_EXT_shader_texture_lod : enable\\n\\n# define FEATURE_GLSL_TEXTURE_LOD\\n# define TEXTURE_LOD\\n\\n#endif\\n\";\n  }\n\n  return versionDefines;\n}\n//# sourceMappingURL=platform-defines.js.map","import { assert } from '../utils';\nconst FS100 = \"void main() {gl_FragColor = vec4(0);}\";\nconst FS_GLES = \"out vec4 transform_output;\\nvoid main() {\\n  transform_output = vec4(0);\\n}\";\nconst FS300 = \"#version 300 es\\n\".concat(FS_GLES);\nexport function getQualifierDetails(line, qualifiers) {\n  qualifiers = Array.isArray(qualifiers) ? qualifiers : [qualifiers];\n  const words = line.replace(/^\\s+/, '').split(/\\s+/);\n  const [qualifier, type, definition] = words;\n\n  if (!qualifiers.includes(qualifier) || !type || !definition) {\n    return null;\n  }\n\n  const name = definition.split(';')[0];\n  return {\n    qualifier,\n    type,\n    name\n  };\n}\nexport function getPassthroughFS(options = {}) {\n  const {\n    version = 100,\n    input,\n    inputType,\n    output\n  } = options;\n\n  if (!input) {\n    if (version === 300) {\n      return FS300;\n    } else if (version > 300) {\n      return \"#version \".concat(version, \"\\n\").concat(FS_GLES);\n    }\n\n    return FS100;\n  }\n\n  const outputValue = convertToVec4(input, inputType);\n\n  if (version >= 300) {\n    return \"#version \".concat(version, \" \").concat(version === 300 ? 'es' : '', \"\\nin \").concat(inputType, \" \").concat(input, \";\\nout vec4 \").concat(output, \";\\nvoid main() {\\n  \").concat(output, \" = \").concat(outputValue, \";\\n}\");\n  }\n\n  return \"varying \".concat(inputType, \" \").concat(input, \";\\nvoid main() {\\n  gl_FragColor = \").concat(outputValue, \";\\n}\");\n}\nexport function typeToChannelSuffix(type) {\n  switch (type) {\n    case 'float':\n      return 'x';\n\n    case 'vec2':\n      return 'xy';\n\n    case 'vec3':\n      return 'xyz';\n\n    case 'vec4':\n      return 'xyzw';\n\n    default:\n      assert(false);\n      return null;\n  }\n}\nexport function typeToChannelCount(type) {\n  switch (type) {\n    case 'float':\n      return 1;\n\n    case 'vec2':\n      return 2;\n\n    case 'vec3':\n      return 3;\n\n    case 'vec4':\n      return 4;\n\n    default:\n      assert(false);\n      return null;\n  }\n}\nexport function convertToVec4(variable, type) {\n  switch (type) {\n    case 'float':\n      return \"vec4(\".concat(variable, \", 0.0, 0.0, 1.0)\");\n\n    case 'vec2':\n      return \"vec4(\".concat(variable, \", 0.0, 1.0)\");\n\n    case 'vec3':\n      return \"vec4(\".concat(variable, \", 1.0)\");\n\n    case 'vec4':\n      return variable;\n\n    default:\n      assert(false);\n      return null;\n  }\n}\n//# sourceMappingURL=shader-utils.js.map","const fp32shader = \"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\\nconst float TWO_PI = 6.2831854820251465;\\nconst float PI_2 = 1.5707963705062866;\\nconst float PI_16 = 0.1963495463132858;\\n\\nconst float SIN_TABLE_0 = 0.19509032368659973;\\nconst float SIN_TABLE_1 = 0.3826834261417389;\\nconst float SIN_TABLE_2 = 0.5555702447891235;\\nconst float SIN_TABLE_3 = 0.7071067690849304;\\n\\nconst float COS_TABLE_0 = 0.9807852506637573;\\nconst float COS_TABLE_1 = 0.9238795042037964;\\nconst float COS_TABLE_2 = 0.8314695954322815;\\nconst float COS_TABLE_3 = 0.7071067690849304;\\n\\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\\n\\nfloat sin_taylor_fp32(float a) {\\n  float r, s, t, x;\\n\\n  if (a == 0.0) {\\n    return 0.0;\\n  }\\n\\n  x = -a * a;\\n  s = a;\\n  r = a;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_3;\\n  s = s + t;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_5;\\n  s = s + t;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_7;\\n  s = s + t;\\n\\n  r = r * x;\\n  t = r * INVERSE_FACTORIAL_9;\\n  s = s + t;\\n\\n  return s;\\n}\\n\\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\\n  if (a == 0.0) {\\n    sin_t = 0.0;\\n    cos_t = 1.0;\\n  }\\n  sin_t = sin_taylor_fp32(a);\\n  cos_t = sqrt(1.0 - sin_t * sin_t);\\n}\\n\\nfloat tan_taylor_fp32(float a) {\\n    float sin_a;\\n    float cos_a;\\n\\n    if (a == 0.0) {\\n        return 0.0;\\n    }\\n    float z = floor(a / TWO_PI);\\n    float r = a - TWO_PI * z;\\n\\n    float t;\\n    float q = floor(r / PI_2 + 0.5);\\n    int j = int(q);\\n\\n    if (j < -2 || j > 2) {\\n        return 0.0 / 0.0;\\n    }\\n\\n    t = r - PI_2 * q;\\n\\n    q = floor(t / PI_16 + 0.5);\\n    int k = int(q);\\n    int abs_k = int(abs(float(k)));\\n\\n    if (abs_k > 4) {\\n        return 0.0 / 0.0;\\n    } else {\\n        t = t - PI_16 * q;\\n    }\\n\\n    float u = 0.0;\\n    float v = 0.0;\\n\\n    float sin_t, cos_t;\\n    float s, c;\\n    sincos_taylor_fp32(t, sin_t, cos_t);\\n\\n    if (k == 0) {\\n        s = sin_t;\\n        c = cos_t;\\n    } else {\\n        if (abs(float(abs_k) - 1.0) < 0.5) {\\n            u = COS_TABLE_0;\\n            v = SIN_TABLE_0;\\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\\n            u = COS_TABLE_1;\\n            v = SIN_TABLE_1;\\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\\n            u = COS_TABLE_2;\\n            v = SIN_TABLE_2;\\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\\n            u = COS_TABLE_3;\\n            v = SIN_TABLE_3;\\n        }\\n        if (k > 0) {\\n            s = u * sin_t + v * cos_t;\\n            c = u * cos_t - v * sin_t;\\n        } else {\\n            s = u * sin_t - v * cos_t;\\n            c = u * cos_t + v * sin_t;\\n        }\\n    }\\n\\n    if (j == 0) {\\n        sin_a = s;\\n        cos_a = c;\\n    } else if (j == 1) {\\n        sin_a = c;\\n        cos_a = -s;\\n    } else if (j == -1) {\\n        sin_a = -c;\\n        cos_a = s;\\n    } else {\\n        sin_a = -s;\\n        cos_a = -c;\\n    }\\n    return sin_a / cos_a;\\n}\\n#endif\\n\\nfloat tan_fp32(float a) {\\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\\n  return tan_taylor_fp32(a);\\n#else\\n  return tan(a);\\n#endif\\n}\\n\";\nexport const fp32 = {\n  name: 'fp32',\n  vs: fp32shader,\n  fs: null\n};\n//# sourceMappingURL=fp32.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(`math.gl assertion ${message}`);\n  }\n}\n//# sourceMappingURL=assert.js.map","import assert from './assert';\nconst RADIANS_TO_DEGREES = 1 / Math.PI * 180;\nconst DEGREES_TO_RADIANS = 1 / 180 * Math.PI;\nconst config = {};\nconfig.EPSILON = 1e-12;\nconfig.debug = false;\nconfig.precision = 4;\nconfig.printTypes = false;\nconfig.printDegrees = false;\nconfig.printRowMajor = true;\nexport { config };\nexport function configure(options = {}) {\n  for (const key in options) {\n    assert(key in config);\n    config[key] = options[key];\n  }\n\n  return config;\n}\n\nfunction round(value) {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\nexport function formatValue(value, {\n  precision = config.precision || 4\n} = {}) {\n  value = round(value);\n  return `${parseFloat(value.toPrecision(precision))}`;\n}\nexport function isArray(value) {\n  return Array.isArray(value) || ArrayBuffer.isView(value) && !(value instanceof DataView);\n}\n\nfunction duplicateArray(array) {\n  return array.clone ? array.clone() : new Array(array.length);\n}\n\nexport function clone(array) {\n  return array.clone ? array.clone() : new Array(...array);\n}\n\nfunction map(value, func, result) {\n  if (isArray(value)) {\n    result = result || duplicateArray(value);\n\n    for (let i = 0; i < result.length && i < value.length; ++i) {\n      result[i] = func(value[i], i, result);\n    }\n\n    return result;\n  }\n\n  return func(value);\n}\n\nexport function toRadians(degrees) {\n  return radians(degrees);\n}\nexport function toDegrees(radians) {\n  return degrees(radians);\n}\nexport function radians(degrees, result) {\n  return map(degrees, degrees => degrees * DEGREES_TO_RADIANS, result);\n}\nexport function degrees(radians, result) {\n  return map(radians, radians => radians * RADIANS_TO_DEGREES, result);\n}\nexport function sin(radians) {\n  return map(radians, angle => Math.sin(angle));\n}\nexport function cos(radians) {\n  return map(radians, angle => Math.cos(angle));\n}\nexport function tan(radians) {\n  return map(radians, angle => Math.tan(angle));\n}\nexport function asin(radians) {\n  return map(radians, angle => Math.asin(angle));\n}\nexport function acos(radians) {\n  return map(radians, angle => Math.acos(angle));\n}\nexport function atan(radians) {\n  return map(radians, angle => Math.atan(angle));\n}\nexport function clamp(value, min, max) {\n  return map(value, value => Math.max(min, Math.min(max, value)));\n}\nexport function lerp(a, b, t) {\n  if (isArray(a)) {\n    return a.map((ai, i) => lerp(ai, b[i], t));\n  }\n\n  return t * b + (1 - t) * a;\n}\nexport function equals(a, b, epsilon) {\n  const oldEpsilon = config.EPSILON;\n\n  if (epsilon) {\n    config.EPSILON = epsilon;\n  }\n\n  try {\n    if (a === b) {\n      return true;\n    }\n\n    if (isArray(a) && isArray(b)) {\n      if (a.length !== b.length) {\n        return false;\n      }\n\n      for (let i = 0; i < a.length; ++i) {\n        if (!equals(a[i], b[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    if (a && a.equals) {\n      return a.equals(b);\n    }\n\n    if (b && b.equals) {\n      return b.equals(a);\n    }\n\n    if (Number.isFinite(a) && Number.isFinite(b)) {\n      return Math.abs(a - b) <= config.EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n    }\n\n    return false;\n  } finally {\n    config.EPSILON = oldEpsilon;\n  }\n}\nexport function exactEquals(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a && typeof a === 'object' && b && typeof b === 'object') {\n    if (a.constructor !== b.constructor) {\n      return false;\n    }\n\n    if (a.exactEquals) {\n      return a.exactEquals(b);\n    }\n  }\n\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    for (let i = 0; i < a.length; ++i) {\n      if (!exactEquals(a[i], b[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\nexport function withEpsilon(EPSILON, func) {\n  const oldPrecision = config.EPSILON;\n  config.EPSILON = EPSILON;\n  let value;\n\n  try {\n    value = func();\n  } finally {\n    config.EPSILON = oldPrecision;\n  }\n\n  return value;\n}\n//# sourceMappingURL=common.js.map","function _extendableBuiltin(cls) {\n  function ExtendableBuiltin() {\n    var instance = Reflect.construct(cls, Array.from(arguments));\n    Object.setPrototypeOf(instance, Object.getPrototypeOf(this));\n    return instance;\n  }\n\n  ExtendableBuiltin.prototype = Object.create(cls.prototype, {\n    constructor: {\n      value: cls,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(ExtendableBuiltin, cls);\n  } else {\n    ExtendableBuiltin.__proto__ = cls;\n  }\n\n  return ExtendableBuiltin;\n}\n\nimport { config, formatValue, equals, isArray } from '../../lib/common';\nimport assert from '../../lib/assert';\nexport default class MathArray extends _extendableBuiltin(Array) {\n  get ELEMENTS() {\n    assert(false);\n    return 0;\n  }\n\n  clone() {\n    return new this.constructor().copy(this);\n  }\n\n  from(arrayOrObject) {\n    return Array.isArray(arrayOrObject) ? this.copy(arrayOrObject) : this.fromObject(arrayOrObject);\n  }\n\n  fromArray(array, offset = 0) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = array[i + offset];\n    }\n\n    return this.check();\n  }\n\n  to(arrayOrObject) {\n    if (arrayOrObject === this) {\n      return this;\n    }\n\n    return isArray(arrayOrObject) ? this.toArray(arrayOrObject) : this.toObject(arrayOrObject);\n  }\n\n  toTarget(target) {\n    return target ? this.to(target) : this;\n  }\n\n  toArray(array = [], offset = 0) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      array[offset + i] = this[i];\n    }\n\n    return array;\n  }\n\n  toFloat32Array() {\n    return new Float32Array(this);\n  }\n\n  toString() {\n    return this.formatString(config);\n  }\n\n  formatString(opts) {\n    let string = '';\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      string += (i > 0 ? ', ' : '') + formatValue(this[i], opts);\n    }\n\n    return `${opts.printTypes ? this.constructor.name : ''}[${string}]`;\n  }\n\n  equals(array) {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (!equals(this[i], array[i])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  exactEquals(array) {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (this[i] !== array[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  negate() {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = -this[i];\n    }\n\n    return this.check();\n  }\n\n  lerp(a, b, t) {\n    if (t === undefined) {\n      t = b;\n      b = a;\n      a = this;\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const ai = a[i];\n      this[i] = ai + t * (b[i] - ai);\n    }\n\n    return this.check();\n  }\n\n  min(vector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(vector[i], this[i]);\n    }\n\n    return this.check();\n  }\n\n  max(vector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.max(vector[i], this[i]);\n    }\n\n    return this.check();\n  }\n\n  clamp(minVector, maxVector) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], minVector[i]), maxVector[i]);\n    }\n\n    return this.check();\n  }\n\n  add(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] += vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  subtract(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] -= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  scale(scale) {\n    if (Array.isArray(scale)) {\n      return this.multiply(scale);\n    }\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scale;\n    }\n\n    return this.check();\n  }\n\n  sub(a) {\n    return this.subtract(a);\n  }\n\n  setScalar(a) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = a;\n    }\n\n    return this.check();\n  }\n\n  addScalar(a) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] += a;\n    }\n\n    return this.check();\n  }\n\n  subScalar(a) {\n    return this.addScalar(-a);\n  }\n\n  multiplyScalar(scalar) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n\n    return this.check();\n  }\n\n  divideScalar(a) {\n    return this.scale(1 / a);\n  }\n\n  clampScalar(min, max) {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], min), max);\n    }\n\n    return this.check();\n  }\n\n  multiplyByScalar(scalar) {\n    return this.scale(scalar);\n  }\n\n  get elements() {\n    return this;\n  }\n\n  check() {\n    if (config.debug && !this.validate()) {\n      throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);\n    }\n\n    return this;\n  }\n\n  validate() {\n    let valid = this.length === this.ELEMENTS;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      valid = valid && Number.isFinite(this[i]);\n    }\n\n    return valid;\n  }\n\n}\n//# sourceMappingURL=math-array.js.map","import { config } from './common';\nexport function validateVector(v, length) {\n  if (v.length !== length) {\n    return false;\n  }\n\n  for (let i = 0; i < v.length; ++i) {\n    if (!Number.isFinite(v[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\nexport function checkNumber(value) {\n  if (!Number.isFinite(value)) {\n    throw new Error(`Invalid number ${value}`);\n  }\n\n  return value;\n}\nexport function checkVector(v, length, callerName = '') {\n  if (config.debug && !validateVector(v, length)) {\n    throw new Error(`math.gl: ${callerName} some fields set to invalid numbers'`);\n  }\n\n  return v;\n}\nconst map = {};\nexport function deprecated(method, version) {\n  if (!map[method]) {\n    map[method] = true;\n    console.warn(`${method} has been removed in version ${version}, see upgrade guide for more information`);\n  }\n}\n//# sourceMappingURL=validators.js.map","import MathArray from './math-array';\nimport { checkNumber } from '../../lib/validators';\nimport assert from '../../lib/assert';\nexport default class Vector extends MathArray {\n  get ELEMENTS() {\n    assert(false);\n    return 0;\n  }\n\n  copy(vector) {\n    assert(false);\n    return this;\n  }\n\n  get x() {\n    return this[0];\n  }\n\n  set x(value) {\n    this[0] = checkNumber(value);\n  }\n\n  get y() {\n    return this[1];\n  }\n\n  set y(value) {\n    this[1] = checkNumber(value);\n  }\n\n  len() {\n    return Math.sqrt(this.lengthSquared());\n  }\n\n  magnitude() {\n    return this.len();\n  }\n\n  lengthSquared() {\n    let length = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      length += this[i] * this[i];\n    }\n\n    return length;\n  }\n\n  magnitudeSquared() {\n    return this.lengthSquared();\n  }\n\n  distance(mathArray) {\n    return Math.sqrt(this.distanceSquared(mathArray));\n  }\n\n  distanceSquared(mathArray) {\n    let length = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const dist = this[i] - mathArray[i];\n      length += dist * dist;\n    }\n\n    return checkNumber(length);\n  }\n\n  dot(mathArray) {\n    let product = 0;\n\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      product += this[i] * mathArray[i];\n    }\n\n    return checkNumber(product);\n  }\n\n  normalize() {\n    const length = this.magnitude();\n\n    if (length !== 0) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= length;\n      }\n    }\n\n    return this.check();\n  }\n\n  multiply(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  divide(...vectors) {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= vector[i];\n      }\n    }\n\n    return this.check();\n  }\n\n  lengthSq() {\n    return this.lengthSquared();\n  }\n\n  distanceTo(vector) {\n    return this.distance(vector);\n  }\n\n  distanceToSquared(vector) {\n    return this.distanceSquared(vector);\n  }\n\n  getComponent(i) {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    return checkNumber(this[i]);\n  }\n\n  setComponent(i, value) {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    this[i] = value;\n    return this.check();\n  }\n\n  addVectors(a, b) {\n    return this.copy(a).add(b);\n  }\n\n  subVectors(a, b) {\n    return this.copy(a).subtract(b);\n  }\n\n  multiplyVectors(a, b) {\n    return this.copy(a).multiply(b);\n  }\n\n  addScaledVector(a, b) {\n    return this.add(new this.constructor(a).multiplyScalar(b));\n  }\n\n}\n//# sourceMappingURL=vector.js.map","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","export function vec2_transformMat4AsVector(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const w = m[3] * x + m[7] * y || 1.0;\n  out[0] = (m[0] * x + m[4] * y) / w;\n  out[1] = (m[1] * x + m[5] * y) / w;\n  return out;\n}\nexport function vec3_transformMat4AsVector(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  const w = m[3] * x + m[7] * y + m[11] * z || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z) / w;\n  return out;\n}\nexport function vec3_transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  return out;\n}\nexport function vec4_transformMat2(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\nexport function vec4_transformMat3(out, a, m) {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  out[0] = m[0] * x + m[3] * y + m[6] * z;\n  out[1] = m[1] * x + m[4] * y + m[7] * z;\n  out[2] = m[2] * x + m[5] * y + m[8] * z;\n  out[3] = a[3];\n  return out;\n}\n//# sourceMappingURL=gl-matrix-extras.js.map","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import Vector from './base/vector';\nimport { config, isArray } from '../lib/common';\nimport { checkNumber } from '../lib/validators';\nimport * as vec3 from 'gl-matrix/vec3';\nimport { vec3_transformMat2, vec3_transformMat4AsVector } from '../lib/gl-matrix-extras';\nconst ORIGIN = [0, 0, 0];\nconst constants = {};\nexport default class Vector3 extends Vector {\n  static get ZERO() {\n    return constants.ZERO = constants.ZERO || Object.freeze(new Vector3(0, 0, 0, 0));\n  }\n\n  constructor(x = 0, y = 0, z = 0) {\n    super(-0, -0, -0);\n\n    if (arguments.length === 1 && isArray(x)) {\n      this.copy(x);\n    } else {\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n      }\n\n      this[0] = x;\n      this[1] = y;\n      this[2] = z;\n    }\n  }\n\n  set(x, y, z) {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    return this.check();\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    return this.check();\n  }\n\n  fromObject(object) {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n    }\n\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    return this.check();\n  }\n\n  toObject(object) {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    return object;\n  }\n\n  get ELEMENTS() {\n    return 3;\n  }\n\n  get z() {\n    return this[2];\n  }\n\n  set z(value) {\n    this[2] = checkNumber(value);\n  }\n\n  angle(vector) {\n    return vec3.angle(this, vector);\n  }\n\n  cross(vector) {\n    vec3.cross(this, this, vector);\n    return this.check();\n  }\n\n  rotateX({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateX(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateY({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateY(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateZ({\n    radians,\n    origin = ORIGIN\n  }) {\n    vec3.rotateZ(this, this, origin, radians);\n    return this.check();\n  }\n\n  transform(matrix4) {\n    return this.transformAsPoint(matrix4);\n  }\n\n  transformAsPoint(matrix4) {\n    vec3.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  transformAsVector(matrix4) {\n    vec3_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3) {\n    vec3.transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2) {\n    vec3_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion) {\n    vec3.transformQuat(this, this, quaternion);\n    return this.check();\n  }\n\n}\n//# sourceMappingURL=vector3.js.map","import MathArray from './math-array';\nimport { checkNumber } from '../../lib/validators';\nimport { config } from '../../lib/common';\nimport assert from '../../lib/assert';\nexport default class Matrix extends MathArray {\n  get ELEMENTS() {\n    assert(false);\n    return 0;\n  }\n\n  get RANK() {\n    assert(false);\n    return 0;\n  }\n\n  toString() {\n    let string = '[';\n\n    if (config.printRowMajor) {\n      string += 'row-major:';\n\n      for (let row = 0; row < this.RANK; ++row) {\n        for (let col = 0; col < this.RANK; ++col) {\n          string += ` ${this[col * this.RANK + row]}`;\n        }\n      }\n    } else {\n      string += 'column-major:';\n\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        string += ` ${this[i]}`;\n      }\n    }\n\n    string += ']';\n    return string;\n  }\n\n  getElementIndex(row, col) {\n    return col * this.RANK + row;\n  }\n\n  getElement(row, col) {\n    return this[col * this.RANK + row];\n  }\n\n  setElement(row, col, value) {\n    this[col * this.RANK + row] = checkNumber(value);\n    return this;\n  }\n\n  getColumn(columnIndex, result = new Array(this.RANK).fill(-0)) {\n    const firstIndex = columnIndex * this.RANK;\n\n    for (let i = 0; i < this.RANK; ++i) {\n      result[i] = this[firstIndex + i];\n    }\n\n    return result;\n  }\n\n  setColumn(columnIndex, columnVector) {\n    const firstIndex = columnIndex * this.RANK;\n\n    for (let i = 0; i < this.RANK; ++i) {\n      this[firstIndex + i] = columnVector[i];\n    }\n\n    return this;\n  }\n\n}\n//# sourceMappingURL=matrix.js.map","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import { checkVector, deprecated } from '../lib/validators';\nimport Matrix from './base/matrix';\nimport { vec2_transformMat4AsVector, vec3_transformMat4AsVector } from '../lib/gl-matrix-extras';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport * as vec4 from 'gl-matrix/vec4';\nconst IDENTITY = Object.freeze([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\nconst ZERO = Object.freeze([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\nconst INDICES = Object.freeze({\n  COL0ROW0: 0,\n  COL0ROW1: 1,\n  COL0ROW2: 2,\n  COL0ROW3: 3,\n  COL1ROW0: 4,\n  COL1ROW1: 5,\n  COL1ROW2: 6,\n  COL1ROW3: 7,\n  COL2ROW0: 8,\n  COL2ROW1: 9,\n  COL2ROW2: 10,\n  COL2ROW3: 11,\n  COL3ROW0: 12,\n  COL3ROW1: 13,\n  COL3ROW2: 14,\n  COL3ROW3: 15\n});\nconst constants = {};\nexport default class Matrix4 extends Matrix {\n  static get IDENTITY() {\n    constants.IDENTITY = constants.IDENTITY || Object.freeze(new Matrix4(IDENTITY));\n    return constants.IDENTITY;\n  }\n\n  static get ZERO() {\n    constants.ZERO = constants.ZERO || Object.freeze(new Matrix4(ZERO));\n    return constants.ZERO;\n  }\n\n  get INDICES() {\n    return INDICES;\n  }\n\n  get ELEMENTS() {\n    return 16;\n  }\n\n  get RANK() {\n    return 4;\n  }\n\n  constructor(array) {\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0);\n\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array) {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    this[9] = array[9];\n    this[10] = array[10];\n    this[11] = array[11];\n    this[12] = array[12];\n    this[13] = array[13];\n    this[14] = array[14];\n    this[15] = array[15];\n    return this.check();\n  }\n\n  set(m00, m10, m20, m30, m01, m11, m21, m31, m02, m12, m22, m32, m03, m13, m23, m33) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  setRowMajor(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  toRowMajor(result) {\n    result[0] = this[0];\n    result[1] = this[4];\n    result[2] = this[8];\n    result[3] = this[12];\n    result[4] = this[1];\n    result[5] = this[5];\n    result[6] = this[9];\n    result[7] = this[13];\n    result[8] = this[2];\n    result[9] = this[6];\n    result[10] = this[10];\n    result[11] = this[14];\n    result[12] = this[3];\n    result[13] = this[7];\n    result[14] = this[11];\n    result[15] = this[15];\n    return result;\n  }\n\n  identity() {\n    return this.copy(IDENTITY);\n  }\n\n  fromQuaternion(q) {\n    mat4.fromQuat(this, q);\n    return this.check();\n  }\n\n  frustum({\n    left,\n    right,\n    bottom,\n    top,\n    near,\n    far\n  }) {\n    if (far === Infinity) {\n      Matrix4._computeInfinitePerspectiveOffCenter(this, left, right, bottom, top, near);\n    } else {\n      mat4.frustum(this, left, right, bottom, top, near, far);\n    }\n\n    return this.check();\n  }\n\n  static _computeInfinitePerspectiveOffCenter(result, left, right, bottom, top, near) {\n    const column0Row0 = 2.0 * near / (right - left);\n    const column1Row1 = 2.0 * near / (top - bottom);\n    const column2Row0 = (right + left) / (right - left);\n    const column2Row1 = (top + bottom) / (top - bottom);\n    const column2Row2 = -1.0;\n    const column2Row3 = -1.0;\n    const column3Row2 = -2.0 * near;\n    result[0] = column0Row0;\n    result[1] = 0.0;\n    result[2] = 0.0;\n    result[3] = 0.0;\n    result[4] = 0.0;\n    result[5] = column1Row1;\n    result[6] = 0.0;\n    result[7] = 0.0;\n    result[8] = column2Row0;\n    result[9] = column2Row1;\n    result[10] = column2Row2;\n    result[11] = column2Row3;\n    result[12] = 0.0;\n    result[13] = 0.0;\n    result[14] = column3Row2;\n    result[15] = 0.0;\n    return result;\n  }\n\n  lookAt(eye, center, up) {\n    if (arguments.length === 1) {\n      ({\n        eye,\n        center,\n        up\n      } = eye);\n    }\n\n    center = center || [0, 0, 0];\n    up = up || [0, 1, 0];\n    mat4.lookAt(this, eye, center, up);\n    return this.check();\n  }\n\n  ortho({\n    left,\n    right,\n    bottom,\n    top,\n    near = 0.1,\n    far = 500\n  }) {\n    mat4.ortho(this, left, right, bottom, top, near, far);\n    return this.check();\n  }\n\n  orthographic({\n    fovy = 45 * Math.PI / 180,\n    aspect = 1,\n    focalDistance = 1,\n    near = 0.1,\n    far = 500\n  }) {\n    if (fovy > Math.PI * 2) {\n      throw Error('radians');\n    }\n\n    const halfY = fovy / 2;\n    const top = focalDistance * Math.tan(halfY);\n    const right = top * aspect;\n    return new Matrix4().ortho({\n      left: -right,\n      right,\n      bottom: -top,\n      top,\n      near,\n      far\n    });\n  }\n\n  perspective({\n    fovy = undefined,\n    fov = 45 * Math.PI / 180,\n    aspect = 1,\n    near = 0.1,\n    far = 500\n  } = {}) {\n    fovy = fovy || fov;\n\n    if (fovy > Math.PI * 2) {\n      throw Error('radians');\n    }\n\n    mat4.perspective(this, fovy, aspect, near, far);\n    return this.check();\n  }\n\n  determinant() {\n    return mat4.determinant(this);\n  }\n\n  getScale(result = [-0, -0, -0]) {\n    result[0] = Math.sqrt(this[0] * this[0] + this[1] * this[1] + this[2] * this[2]);\n    result[1] = Math.sqrt(this[4] * this[4] + this[5] * this[5] + this[6] * this[6]);\n    result[2] = Math.sqrt(this[8] * this[8] + this[9] * this[9] + this[10] * this[10]);\n    return result;\n  }\n\n  getTranslation(result = [-0, -0, -0]) {\n    result[0] = this[12];\n    result[1] = this[13];\n    result[2] = this[14];\n    return result;\n  }\n\n  getRotation(result = [-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0], scaleResult = null) {\n    const scale = this.getScale(scaleResult || [-0, -0, -0]);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = 0;\n    result[4] = this[4] * inverseScale0;\n    result[5] = this[5] * inverseScale1;\n    result[6] = this[6] * inverseScale2;\n    result[7] = 0;\n    result[8] = this[8] * inverseScale0;\n    result[9] = this[9] * inverseScale1;\n    result[10] = this[10] * inverseScale2;\n    result[11] = 0;\n    result[12] = 0;\n    result[13] = 0;\n    result[14] = 0;\n    result[15] = 1;\n    return result;\n  }\n\n  getRotationMatrix3(result = [-0, -0, -0, -0, -0, -0, -0, -0, -0], scaleResult = null) {\n    const scale = this.getScale(scaleResult || [-0, -0, -0]);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = this[4] * inverseScale0;\n    result[4] = this[5] * inverseScale1;\n    result[5] = this[6] * inverseScale2;\n    result[6] = this[8] * inverseScale0;\n    result[7] = this[9] * inverseScale1;\n    result[8] = this[10] * inverseScale2;\n    return result;\n  }\n\n  transpose() {\n    mat4.transpose(this, this);\n    return this.check();\n  }\n\n  invert() {\n    mat4.invert(this, this);\n    return this.check();\n  }\n\n  multiplyLeft(a) {\n    mat4.multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a) {\n    mat4.multiply(this, this, a);\n    return this.check();\n  }\n\n  rotateX(radians) {\n    mat4.rotateX(this, this, radians);\n    return this.check();\n  }\n\n  rotateY(radians) {\n    mat4.rotateY(this, this, radians);\n    return this.check();\n  }\n\n  rotateZ(radians) {\n    mat4.rotateZ(this, this, radians);\n    return this.check();\n  }\n\n  rotateXYZ([rx, ry, rz]) {\n    return this.rotateX(rx).rotateY(ry).rotateZ(rz);\n  }\n\n  rotateAxis(radians, axis) {\n    mat4.rotate(this, this, radians, axis);\n    return this.check();\n  }\n\n  scale(factor) {\n    if (Array.isArray(factor)) {\n      mat4.scale(this, this, factor);\n    } else {\n      mat4.scale(this, this, [factor, factor, factor]);\n    }\n\n    return this.check();\n  }\n\n  translate(vec) {\n    mat4.translate(this, this, vec);\n    return this.check();\n  }\n\n  transform(vector, result) {\n    if (vector.length === 4) {\n      result = vec4.transformMat4(result || [-0, -0, -0, -0], vector, this);\n      checkVector(result, 4);\n      return result;\n    }\n\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformAsPoint(vector, result) {\n    const {\n      length\n    } = vector;\n\n    switch (length) {\n      case 2:\n        result = vec2.transformMat4(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        result = vec3.transformMat4(result || [-0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(result, vector.length);\n    return result;\n  }\n\n  transformAsVector(vector, result) {\n    switch (vector.length) {\n      case 2:\n        result = vec2_transformMat4AsVector(result || [-0, -0], vector, this);\n        break;\n\n      case 3:\n        result = vec3_transformMat4AsVector(result || [-0, -0, -0], vector, this);\n        break;\n\n      default:\n        throw new Error('Illegal vector');\n    }\n\n    checkVector(result, vector.length);\n    return result;\n  }\n\n  makeRotationX(radians) {\n    return this.identity().rotateX(radians);\n  }\n\n  makeTranslation(x, y, z) {\n    return this.identity().translate([x, y, z]);\n  }\n\n  transformPoint(vector, result) {\n    deprecated('Matrix4.transformPoint', '3.0');\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformVector(vector, result) {\n    deprecated('Matrix4.transformVector', '3.0');\n    return this.transformAsPoint(vector, result);\n  }\n\n  transformDirection(vector, result) {\n    deprecated('Matrix4.transformDirection', '3.0');\n    return this.transformAsVector(vector, result);\n  }\n\n}\n//# sourceMappingURL=matrix4.js.map","const DEFAULT_HIGHLIGHT_COLOR = new Uint8Array([0, 255, 255, 255]);\nconst DEFAULT_MODULE_OPTIONS = {\n  pickingSelectedColor: null,\n  pickingHighlightColor: DEFAULT_HIGHLIGHT_COLOR,\n  pickingActive: false,\n  pickingAttribute: false\n};\n\nfunction getUniforms(opts = DEFAULT_MODULE_OPTIONS) {\n  const uniforms = {};\n\n  if (opts.pickingSelectedColor !== undefined) {\n    if (!opts.pickingSelectedColor) {\n      uniforms.picking_uSelectedColorValid = 0;\n    } else {\n      const selectedColor = opts.pickingSelectedColor.slice(0, 3);\n      uniforms.picking_uSelectedColorValid = 1;\n      uniforms.picking_uSelectedColor = selectedColor;\n    }\n  }\n\n  if (opts.pickingHighlightColor) {\n    const color = Array.from(opts.pickingHighlightColor, x => x / 255);\n\n    if (!Number.isFinite(color[3])) {\n      color[3] = 1;\n    }\n\n    uniforms.picking_uHighlightColor = color;\n  }\n\n  if (opts.pickingActive !== undefined) {\n    uniforms.picking_uActive = Boolean(opts.pickingActive);\n    uniforms.picking_uAttribute = Boolean(opts.pickingAttribute);\n  }\n\n  return uniforms;\n}\n\nconst vs = \"uniform bool picking_uActive;\\nuniform bool picking_uAttribute;\\nuniform vec3 picking_uSelectedColor;\\nuniform bool picking_uSelectedColorValid;\\n\\nout vec4 picking_vRGBcolor_Avalid;\\n\\nconst float COLOR_SCALE = 1. / 255.;\\n\\nbool picking_isColorValid(vec3 color) {\\n  return dot(color, vec3(1.0)) > 0.001;\\n}\\n\\nbool isVertexPicked(vec3 vertexColor) {\\n  return\\n    picking_uSelectedColorValid &&\\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\\n}\\n\\nvoid picking_setPickingColor(vec3 pickingColor) {\\n  if (picking_uActive) {\\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\\n\\n    if (!picking_uAttribute) {\\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\\n    }\\n  } else {\\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\\n  }\\n}\\n\\nvoid picking_setPickingAttribute(float value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.r = value;\\n  }\\n}\\nvoid picking_setPickingAttribute(vec2 value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.rg = value;\\n  }\\n}\\nvoid picking_setPickingAttribute(vec3 value) {\\n  if (picking_uAttribute) {\\n    picking_vRGBcolor_Avalid.rgb = value;\\n  }\\n}\\n\";\nconst fs = \"uniform bool picking_uActive;\\nuniform vec3 picking_uSelectedColor;\\nuniform vec4 picking_uHighlightColor;\\n\\nin vec4 picking_vRGBcolor_Avalid;\\nvec4 picking_filterHighlightColor(vec4 color) {\\n  if (picking_uActive) {\\n    return color;\\n  }\\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\\n\\n  if (selected) {\\n    float highLightAlpha = picking_uHighlightColor.a;\\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\\n    float highLightRatio = highLightAlpha / blendedAlpha;\\n\\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\\n    return vec4(blendedRGB, blendedAlpha);\\n  } else {\\n    return color;\\n  }\\n}\\nvec4 picking_filterPickingColor(vec4 color) {\\n  if (picking_uActive) {\\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\\n      discard;\\n    }\\n    return picking_vRGBcolor_Avalid;\\n  }\\n  return color;\\n}\\nvec4 picking_filterColor(vec4 color) {\\n  vec4 highightColor = picking_filterHighlightColor(color);\\n  return picking_filterPickingColor(highightColor);\\n}\\n\\n\";\nexport const picking = {\n  name: 'picking',\n  vs,\n  fs,\n  getUniforms\n};\n//# sourceMappingURL=picking.js.map","const vs = \"attribute float transform_elementID;\\nvec2 transform_getPixelSizeHalf(vec2 size) {\\n  return vec2(1.) / (2. * size);\\n}\\n\\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\\n  return vec2(xIndex, yIndex);\\n}\\nvec2 transform_getTexCoord(vec2 size) {\\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\\n  vec2 coord = indices / size + pixelSizeHalf;\\n  return coord;\\n}\\nvec2 transform_getPos(vec2 size) {\\n  vec2 texCoord = transform_getTexCoord(size);\\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\\n  return pos;\\n}\\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\\n  vec2 texCoord = transform_getTexCoord(size);\\n  vec4 textureColor = texture2D(texSampler, texCoord);\\n  return textureColor;\\n}\\n\";\nexport const transform = {\n  name: 'transform',\n  vs,\n  fs: null\n};\n//# sourceMappingURL=transform.js.map","import { assembleShaders } from '@luma.gl/shadertools';\nimport { Program } from '@luma.gl/webgl';\nexport default class ProgramManager {\n  static getDefaultProgramManager(gl) {\n    gl.luma = gl.luma || {};\n    gl.luma.defaultProgramManager = gl.luma.defaultProgramManager || new ProgramManager(gl);\n    return gl.luma.defaultProgramManager;\n  }\n\n  constructor(gl) {\n    this.gl = gl;\n    this._programCache = {};\n    this._getUniforms = {};\n    this._registeredModules = {};\n    this._hookFunctions = [];\n    this._defaultModules = [];\n    this._hashes = {};\n    this._hashCounter = 0;\n    this.stateHash = 0;\n    this._useCounts = {};\n  }\n\n  addDefaultModule(module) {\n    if (!this._defaultModules.find(m => m.name === module.name)) {\n      this._defaultModules.push(module);\n    }\n\n    this.stateHash++;\n  }\n\n  removeDefaultModule(module) {\n    const moduleName = typeof module === 'string' ? module : module.name;\n    this._defaultModules = this._defaultModules.filter(m => m.name !== moduleName);\n    this.stateHash++;\n  }\n\n  addShaderHook(hook, opts) {\n    if (opts) {\n      hook = Object.assign(opts, {\n        hook\n      });\n    }\n\n    this._hookFunctions.push(hook);\n\n    this.stateHash++;\n  }\n\n  get(props = {}) {\n    const {\n      vs = '',\n      fs = '',\n      defines = {},\n      inject = {},\n      varyings = [],\n      bufferMode = 0x8c8d,\n      transpileToGLSL100 = false\n    } = props;\n\n    const modules = this._getModuleList(props.modules);\n\n    const vsHash = this._getHash(vs);\n\n    const fsHash = this._getHash(fs);\n\n    const moduleHashes = modules.map(m => this._getHash(m.name)).sort();\n    const varyingHashes = varyings.map(v => this._getHash(v));\n    const defineKeys = Object.keys(defines).sort();\n    const injectKeys = Object.keys(inject).sort();\n    const defineHashes = [];\n    const injectHashes = [];\n\n    for (const key of defineKeys) {\n      defineHashes.push(this._getHash(key));\n      defineHashes.push(this._getHash(defines[key]));\n    }\n\n    for (const key of injectKeys) {\n      injectHashes.push(this._getHash(key));\n      injectHashes.push(this._getHash(inject[key]));\n    }\n\n    const hash = \"\".concat(vsHash, \"/\").concat(fsHash, \"D\").concat(defineHashes.join('/'), \"M\").concat(moduleHashes.join('/'), \"I\").concat(injectHashes.join('/'), \"V\").concat(varyingHashes.join('/'), \"H\").concat(this.stateHash, \"B\").concat(bufferMode).concat(transpileToGLSL100 ? 'T' : '');\n\n    if (!this._programCache[hash]) {\n      const assembled = assembleShaders(this.gl, {\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        hookFunctions: this._hookFunctions,\n        transpileToGLSL100\n      });\n      this._programCache[hash] = new Program(this.gl, {\n        hash,\n        vs: assembled.vs,\n        fs: assembled.fs,\n        varyings,\n        bufferMode\n      });\n\n      this._getUniforms[hash] = assembled.getUniforms || (x => {});\n\n      this._useCounts[hash] = 0;\n    }\n\n    this._useCounts[hash]++;\n    return this._programCache[hash];\n  }\n\n  getUniforms(program) {\n    return this._getUniforms[program.hash] || null;\n  }\n\n  release(program) {\n    const hash = program.hash;\n    this._useCounts[hash]--;\n\n    if (this._useCounts[hash] === 0) {\n      this._programCache[hash].delete();\n\n      delete this._programCache[hash];\n      delete this._getUniforms[hash];\n      delete this._useCounts[hash];\n    }\n  }\n\n  _getHash(key) {\n    if (this._hashes[key] === undefined) {\n      this._hashes[key] = this._hashCounter++;\n    }\n\n    return this._hashes[key];\n  }\n\n  _getModuleList(appModules = []) {\n    const modules = new Array(this._defaultModules.length + appModules.length);\n    const seen = {};\n    let count = 0;\n\n    for (let i = 0, len = this._defaultModules.length; i < len; ++i) {\n      const module = this._defaultModules[i];\n      const name = module.name;\n      modules[count++] = module;\n      seen[name] = true;\n    }\n\n    for (let i = 0, len = appModules.length; i < len; ++i) {\n      const module = appModules[i];\n      const name = module.name;\n\n      if (!seen[name]) {\n        modules[count++] = module;\n        seen[name] = true;\n      }\n    }\n\n    modules.length = count;\n    return modules;\n  }\n\n}\n//# sourceMappingURL=program-manager.js.map","import { Buffer, assert } from '@luma.gl/webgl';\nconst GLTF_TO_LUMA_ATTRIBUTE_MAP = {\n  POSITION: 'positions',\n  NORMAL: 'normals',\n  COLOR_0: 'colors',\n  TEXCOORD_0: 'texCoords',\n  TEXCOORD_1: 'texCoords1',\n  TEXCOORD_2: 'texCoords2'\n};\nexport function getBuffersFromGeometry(gl, geometry, options) {\n  const buffers = {};\n  let indices = geometry.indices;\n\n  for (const name in geometry.attributes) {\n    const attribute = geometry.attributes[name];\n    const remappedName = mapAttributeName(name, options);\n\n    if (name === 'indices') {\n      indices = attribute;\n    } else if (attribute.constant) {\n      buffers[remappedName] = attribute.value;\n    } else {\n      const typedArray = attribute.value;\n      const accessor = { ...attribute\n      };\n      delete accessor.value;\n      buffers[remappedName] = [new Buffer(gl, typedArray), accessor];\n      inferAttributeAccessor(name, accessor);\n    }\n  }\n\n  if (indices) {\n    const data = indices.value || indices;\n    assert(data instanceof Uint16Array || data instanceof Uint32Array, 'attribute array for \"indices\" must be of integer type');\n    const accessor = {\n      size: 1,\n      isIndexed: indices.isIndexed === undefined ? true : indices.isIndexed\n    };\n    buffers.indices = [new Buffer(gl, {\n      data,\n      target: 34963\n    }), accessor];\n  }\n\n  return buffers;\n}\n\nfunction mapAttributeName(name, options) {\n  const {\n    attributeMap = GLTF_TO_LUMA_ATTRIBUTE_MAP\n  } = options || {};\n  return attributeMap && attributeMap[name] || name;\n}\n\nexport function inferAttributeAccessor(attributeName, attribute) {\n  let category;\n\n  switch (attributeName) {\n    case 'texCoords':\n    case 'texCoord1':\n    case 'texCoord2':\n    case 'texCoord3':\n      category = 'uvs';\n      break;\n\n    case 'vertices':\n    case 'positions':\n    case 'normals':\n    case 'pickingColors':\n      category = 'vectors';\n      break;\n\n    default:\n  }\n\n  switch (category) {\n    case 'vectors':\n      attribute.size = attribute.size || 3;\n      break;\n\n    case 'uvs':\n      attribute.size = attribute.size || 2;\n      break;\n\n    default:\n  }\n\n  assert(Number.isFinite(attribute.size), \"attribute \".concat(attributeName, \" needs size\"));\n}\n//# sourceMappingURL=model-utils.js.map","import { isWebGL } from '@luma.gl/gltools';\nimport ProgramManager from './program-manager';\nimport { Program, VertexArray, clear, TransformFeedback, Buffer, log, isObjectEmpty, uid, assert } from '@luma.gl/webgl';\nimport { getDebugTableForUniforms, getDebugTableForVertexArray, getDebugTableForProgramConfiguration } from '@luma.gl/webgl';\nimport { getBuffersFromGeometry } from './model-utils';\nconst LOG_DRAW_PRIORITY = 2;\nconst LOG_DRAW_TIMEOUT = 10000;\nconst ERR_MODEL_PARAMS = 'Model needs drawMode and vertexCount';\n\nconst NOOP = () => {};\n\nconst DRAW_PARAMS = {};\nexport default class Model {\n  constructor(gl, props = {}) {\n    const {\n      id = uid('model')\n    } = props;\n    assert(isWebGL(gl));\n    this.id = id;\n    this.gl = gl;\n    this.id = props.id || uid('Model');\n    this.lastLogTime = 0;\n    this.animated = false;\n    this.initialize(props);\n  }\n\n  initialize(props) {\n    this.props = {};\n    this.programManager = props.programManager || ProgramManager.getDefaultProgramManager(this.gl);\n    this._programManagerState = -1;\n    this._managedProgram = false;\n    const {\n      program = null,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    } = props;\n    this.programProps = {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    };\n    this.program = null;\n    this.vertexArray = null;\n    this._programDirty = true;\n    this.userData = {};\n    this.needsRedraw = true;\n    this._attributes = {};\n    this.attributes = {};\n    this.uniforms = {};\n    this.pickable = true;\n\n    this._checkProgram();\n\n    this.setUniforms(Object.assign({}, this.getModuleUniforms(props.moduleSettings)));\n    this.drawMode = props.drawMode !== undefined ? props.drawMode : 4;\n    this.vertexCount = props.vertexCount || 0;\n    this.geometryBuffers = {};\n    this.isInstanced = props.isInstanced || props.instanced || props.instanceCount > 0;\n\n    this._setModelProps(props);\n\n    this.geometry = {};\n    assert(this.drawMode !== undefined && Number.isFinite(this.vertexCount), ERR_MODEL_PARAMS);\n  }\n\n  setProps(props) {\n    this._setModelProps(props);\n  }\n\n  delete() {\n    for (const key in this._attributes) {\n      if (this._attributes[key] !== this.attributes[key]) {\n        this._attributes[key].delete();\n      }\n    }\n\n    if (this._managedProgram) {\n      this.programManager.release(this.program);\n      this._managedProgram = false;\n    }\n\n    this.vertexArray.delete();\n\n    this._deleteGeometryBuffers();\n  }\n\n  getDrawMode() {\n    return this.drawMode;\n  }\n\n  getVertexCount() {\n    return this.vertexCount;\n  }\n\n  getInstanceCount() {\n    return this.instanceCount;\n  }\n\n  getAttributes() {\n    return this.attributes;\n  }\n\n  getProgram() {\n    return this.program;\n  }\n\n  setProgram(props) {\n    const {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    } = props;\n    this.programProps = {\n      program,\n      vs,\n      fs,\n      modules,\n      defines,\n      inject,\n      varyings,\n      bufferMode,\n      transpileToGLSL100\n    };\n    this._programDirty = true;\n  }\n\n  getUniforms() {\n    return this.uniforms;\n  }\n\n  setDrawMode(drawMode) {\n    this.drawMode = drawMode;\n    return this;\n  }\n\n  setVertexCount(vertexCount) {\n    assert(Number.isFinite(vertexCount));\n    this.vertexCount = vertexCount;\n    return this;\n  }\n\n  setInstanceCount(instanceCount) {\n    assert(Number.isFinite(instanceCount));\n    this.instanceCount = instanceCount;\n    return this;\n  }\n\n  setGeometry(geometry) {\n    this.drawMode = geometry.drawMode;\n    this.vertexCount = geometry.getVertexCount();\n\n    this._deleteGeometryBuffers();\n\n    this.geometryBuffers = getBuffersFromGeometry(this.gl, geometry);\n    this.vertexArray.setAttributes(this.geometryBuffers);\n    return this;\n  }\n\n  setAttributes(attributes = {}) {\n    if (isObjectEmpty(attributes)) {\n      return this;\n    }\n\n    const normalizedAttributes = {};\n\n    for (const name in attributes) {\n      const attribute = attributes[name];\n      normalizedAttributes[name] = attribute.getValue ? attribute.getValue() : attribute;\n    }\n\n    this.vertexArray.setAttributes(normalizedAttributes);\n    return this;\n  }\n\n  setUniforms(uniforms = {}) {\n    Object.assign(this.uniforms, uniforms);\n    return this;\n  }\n\n  getModuleUniforms(opts) {\n    this._checkProgram();\n\n    const getUniforms = this.programManager.getUniforms(this.program);\n\n    if (getUniforms) {\n      return getUniforms(opts);\n    }\n\n    return {};\n  }\n\n  updateModuleSettings(opts) {\n    const uniforms = this.getModuleUniforms(opts || {});\n    return this.setUniforms(uniforms);\n  }\n\n  clear(opts) {\n    clear(this.program.gl, opts);\n    return this;\n  }\n\n  draw(opts = {}) {\n    this._checkProgram();\n\n    const {\n      moduleSettings = null,\n      framebuffer,\n      uniforms = {},\n      attributes = {},\n      transformFeedback = this.transformFeedback,\n      parameters = {},\n      vertexArray = this.vertexArray\n    } = opts;\n    this.setAttributes(attributes);\n    this.updateModuleSettings(moduleSettings);\n    this.setUniforms(uniforms);\n    let logPriority;\n\n    if (log.priority >= LOG_DRAW_PRIORITY) {\n      logPriority = this._logDrawCallStart(LOG_DRAW_PRIORITY);\n    }\n\n    const drawParams = this.vertexArray.getDrawParams();\n    const {\n      isIndexed = drawParams.isIndexed,\n      indexType = drawParams.indexType,\n      indexOffset = drawParams.indexOffset,\n      vertexArrayInstanced = drawParams.isInstanced\n    } = this.props;\n\n    if (vertexArrayInstanced && !this.isInstanced) {\n      log.warn('Found instanced attributes on non-instanced model', this.id)();\n    }\n\n    const {\n      isInstanced,\n      instanceCount\n    } = this;\n    const {\n      onBeforeRender = NOOP,\n      onAfterRender = NOOP\n    } = this.props;\n    onBeforeRender();\n    this.program.setUniforms(this.uniforms);\n    const didDraw = this.program.draw(Object.assign(DRAW_PARAMS, opts, {\n      logPriority,\n      uniforms: null,\n      framebuffer,\n      parameters,\n      drawMode: this.getDrawMode(),\n      vertexCount: this.getVertexCount(),\n      vertexArray,\n      transformFeedback,\n      isIndexed,\n      indexType,\n      isInstanced,\n      instanceCount,\n      offset: isIndexed ? indexOffset : 0\n    }));\n    onAfterRender();\n\n    if (log.priority >= LOG_DRAW_PRIORITY) {\n      this._logDrawCallEnd(logPriority, vertexArray, framebuffer);\n    }\n\n    return didDraw;\n  }\n\n  transform(opts = {}) {\n    const {\n      discard = true,\n      feedbackBuffers,\n      unbindModels = []\n    } = opts;\n    let {\n      parameters\n    } = opts;\n\n    if (feedbackBuffers) {\n      this._setFeedbackBuffers(feedbackBuffers);\n    }\n\n    if (discard) {\n      parameters = Object.assign({}, parameters, {\n        [35977]: discard\n      });\n    }\n\n    unbindModels.forEach(model => model.vertexArray.unbindBuffers());\n\n    try {\n      this.draw(Object.assign({}, opts, {\n        parameters\n      }));\n    } finally {\n      unbindModels.forEach(model => model.vertexArray.bindBuffers());\n    }\n\n    return this;\n  }\n\n  render(uniforms = {}) {\n    log.warn('Model.render() is deprecated. Use Model.setUniforms() and Model.draw()')();\n    return this.setUniforms(uniforms).draw();\n  }\n\n  _setModelProps(props) {\n    Object.assign(this.props, props);\n\n    if ('uniforms' in props) {\n      this.setUniforms(props.uniforms);\n    }\n\n    if ('pickable' in props) {\n      this.pickable = props.pickable;\n    }\n\n    if ('instanceCount' in props) {\n      this.instanceCount = props.instanceCount;\n    }\n\n    if ('geometry' in props) {\n      this.setGeometry(props.geometry);\n    }\n\n    if ('attributes' in props) {\n      this.setAttributes(props.attributes);\n    }\n\n    if ('_feedbackBuffers' in props) {\n      this._setFeedbackBuffers(props._feedbackBuffers);\n    }\n  }\n\n  _checkProgram() {\n    const needsUpdate = this._programDirty || this.programManager.stateHash !== this._programManagerState;\n\n    if (!needsUpdate) {\n      return;\n    }\n\n    let {\n      program\n    } = this.programProps;\n\n    if (program) {\n      this._managedProgram = false;\n    } else {\n      const {\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        varyings,\n        bufferMode,\n        transpileToGLSL100\n      } = this.programProps;\n      program = this.programManager.get({\n        vs,\n        fs,\n        modules,\n        inject,\n        defines,\n        varyings,\n        bufferMode,\n        transpileToGLSL100\n      });\n\n      if (this.program && this._managedProgram) {\n        this.programManager.release(this.program);\n      }\n\n      this._programManagerState = this.programManager.stateHash;\n      this._managedProgram = true;\n    }\n\n    assert(program instanceof Program, 'Model needs a program');\n    this._programDirty = false;\n\n    if (program === this.program) {\n      return;\n    }\n\n    this.program = program;\n\n    if (this.vertexArray) {\n      this.vertexArray.setProps({\n        program: this.program,\n        attributes: this.vertexArray.attributes\n      });\n    } else {\n      this.vertexArray = new VertexArray(this.gl, {\n        program: this.program\n      });\n    }\n\n    this.setUniforms(Object.assign({}, this.getModuleUniforms()));\n  }\n\n  _deleteGeometryBuffers() {\n    for (const name in this.geometryBuffers) {\n      const buffer = this.geometryBuffers[name][0] || this.geometryBuffers[name];\n\n      if (buffer instanceof Buffer) {\n        buffer.delete();\n      }\n    }\n  }\n\n  _setAnimationProps(animationProps) {\n    if (this.animated) {\n      assert(animationProps, 'Model.draw(): animated uniforms but no animationProps');\n    }\n  }\n\n  _setFeedbackBuffers(feedbackBuffers = {}) {\n    if (isObjectEmpty(feedbackBuffers)) {\n      return this;\n    }\n\n    const {\n      gl\n    } = this.program;\n    this.transformFeedback = this.transformFeedback || new TransformFeedback(gl, {\n      program: this.program\n    });\n    this.transformFeedback.setBuffers(feedbackBuffers);\n    return this;\n  }\n\n  _logDrawCallStart(logLevel) {\n    const logDrawTimeout = logLevel > 3 ? 0 : LOG_DRAW_TIMEOUT;\n\n    if (Date.now() - this.lastLogTime < logDrawTimeout) {\n      return undefined;\n    }\n\n    this.lastLogTime = Date.now();\n    log.group(LOG_DRAW_PRIORITY, \">>> DRAWING MODEL \".concat(this.id), {\n      collapsed: log.level <= 2\n    })();\n    return logLevel;\n  }\n\n  _logDrawCallEnd(logLevel, vertexArray, uniforms, framebuffer) {\n    if (logLevel === undefined) {\n      return;\n    }\n\n    const attributeTable = getDebugTableForVertexArray({\n      vertexArray,\n      header: \"\".concat(this.id, \" attributes\"),\n      attributes: this._attributes\n    });\n    const {\n      table: uniformTable,\n      unusedTable,\n      unusedCount\n    } = getDebugTableForUniforms({\n      header: \"\".concat(this.id, \" uniforms\"),\n      program: this.program,\n      uniforms: Object.assign({}, this.program.uniforms, uniforms)\n    });\n    const {\n      table: missingTable,\n      count: missingCount\n    } = getDebugTableForUniforms({\n      header: \"\".concat(this.id, \" uniforms\"),\n      program: this.program,\n      uniforms: Object.assign({}, this.program.uniforms, uniforms),\n      undefinedOnly: true\n    });\n\n    if (missingCount > 0) {\n      log.log('MISSING UNIFORMS', Object.keys(missingTable))();\n    }\n\n    if (unusedCount > 0) {\n      log.log('UNUSED UNIFORMS', Object.keys(unusedTable))();\n    }\n\n    const configTable = getDebugTableForProgramConfiguration(this.vertexArray.configuration);\n    log.table(logLevel, attributeTable)();\n    log.table(logLevel, uniformTable)();\n    log.table(logLevel + 1, configTable)();\n\n    if (framebuffer) {\n      framebuffer.log({\n        logLevel: LOG_DRAW_PRIORITY,\n        message: \"Rendered to \".concat(framebuffer.id)\n      });\n    }\n\n    log.groupEnd(LOG_DRAW_PRIORITY, \">>> DRAWING MODEL \".concat(this.id))();\n  }\n\n}\n//# sourceMappingURL=model.js.map","import { isWebGL2 } from '@luma.gl/gltools';\nimport { Buffer, TransformFeedback } from '@luma.gl/webgl';\nimport { assert } from '@luma.gl/webgl';\nexport default class BufferTransform {\n  constructor(gl, props = {}) {\n    this.gl = gl;\n    this.currentIndex = 0;\n    this.feedbackMap = {};\n    this.varyings = null;\n    this.bindings = [];\n    this.resources = {};\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  setupResources(opts) {\n    for (const binding of this.bindings) {\n      this._setupTransformFeedback(binding, opts);\n    }\n  }\n\n  updateModelProps(props = {}) {\n    const {\n      varyings\n    } = this;\n\n    if (varyings.length > 0) {\n      props = Object.assign({}, props, {\n        varyings\n      });\n    }\n\n    return props;\n  }\n\n  getDrawOptions(opts = {}) {\n    const binding = this.bindings[this.currentIndex];\n    const {\n      sourceBuffers,\n      transformFeedback\n    } = binding;\n    const attributes = Object.assign({}, sourceBuffers, opts.attributes);\n    return {\n      attributes,\n      transformFeedback\n    };\n  }\n\n  swap() {\n    if (this.feedbackMap) {\n      this.currentIndex = this._getNextIndex();\n      return true;\n    }\n\n    return false;\n  }\n\n  update(opts = {}) {\n    this._setupBuffers(opts);\n  }\n\n  getBuffer(varyingName) {\n    const {\n      feedbackBuffers\n    } = this.bindings[this.currentIndex];\n    const bufferOrParams = varyingName ? feedbackBuffers[varyingName] : null;\n\n    if (!bufferOrParams) {\n      return null;\n    }\n\n    return bufferOrParams instanceof Buffer ? bufferOrParams : bufferOrParams.buffer;\n  }\n\n  getData(options = {}) {\n    const {\n      varyingName\n    } = options;\n    const buffer = this.getBuffer(varyingName);\n\n    if (buffer) {\n      return buffer.getData();\n    }\n\n    return null;\n  }\n\n  delete() {\n    for (const name in this.resources) {\n      this.resources[name].delete();\n    }\n  }\n\n  _initialize(props = {}) {\n    this._setupBuffers(props);\n\n    this.varyings = props.varyings || Object.keys(this.bindings[this.currentIndex].feedbackBuffers);\n\n    if (this.varyings.length > 0) {\n      assert(isWebGL2(this.gl));\n    }\n  }\n\n  _getFeedbackBuffers(props) {\n    const {\n      sourceBuffers = {}\n    } = props;\n    const feedbackBuffers = {};\n\n    if (this.bindings[this.currentIndex]) {\n      Object.assign(feedbackBuffers, this.bindings[this.currentIndex].feedbackBuffers);\n    }\n\n    if (this.feedbackMap) {\n      for (const sourceName in this.feedbackMap) {\n        const feedbackName = this.feedbackMap[sourceName];\n\n        if (sourceName in sourceBuffers) {\n          feedbackBuffers[feedbackName] = sourceName;\n        }\n      }\n    }\n\n    Object.assign(feedbackBuffers, props.feedbackBuffers);\n\n    for (const bufferName in feedbackBuffers) {\n      const bufferOrRef = feedbackBuffers[bufferName];\n\n      if (typeof bufferOrRef === 'string') {\n        const sourceBuffer = sourceBuffers[bufferOrRef];\n        const {\n          byteLength,\n          usage,\n          accessor\n        } = sourceBuffer;\n        feedbackBuffers[bufferName] = this._createNewBuffer(bufferName, {\n          byteLength,\n          usage,\n          accessor\n        });\n      }\n    }\n\n    return feedbackBuffers;\n  }\n\n  _setupBuffers(props = {}) {\n    const {\n      sourceBuffers = null\n    } = props;\n    Object.assign(this.feedbackMap, props.feedbackMap);\n\n    const feedbackBuffers = this._getFeedbackBuffers(props);\n\n    this._updateBindings({\n      sourceBuffers,\n      feedbackBuffers\n    });\n  }\n\n  _setupTransformFeedback(binding, {\n    model\n  }) {\n    const {\n      program\n    } = model;\n    binding.transformFeedback = new TransformFeedback(this.gl, {\n      program,\n      buffers: binding.feedbackBuffers\n    });\n  }\n\n  _updateBindings(opts) {\n    this.bindings[this.currentIndex] = this._updateBinding(this.bindings[this.currentIndex], opts);\n\n    if (this.feedbackMap) {\n      const {\n        sourceBuffers,\n        feedbackBuffers\n      } = this._swapBuffers(this.bindings[this.currentIndex]);\n\n      const nextIndex = this._getNextIndex();\n\n      this.bindings[nextIndex] = this._updateBinding(this.bindings[nextIndex], {\n        sourceBuffers,\n        feedbackBuffers\n      });\n    }\n  }\n\n  _updateBinding(binding, opts) {\n    if (!binding) {\n      return {\n        sourceBuffers: Object.assign({}, opts.sourceBuffers),\n        feedbackBuffers: Object.assign({}, opts.feedbackBuffers)\n      };\n    }\n\n    Object.assign(binding.sourceBuffers, opts.sourceBuffers);\n    Object.assign(binding.feedbackBuffers, opts.feedbackBuffers);\n\n    if (binding.transformFeedback) {\n      binding.transformFeedback.setBuffers(binding.feedbackBuffers);\n    }\n\n    return binding;\n  }\n\n  _swapBuffers(opts) {\n    if (!this.feedbackMap) {\n      return null;\n    }\n\n    const sourceBuffers = Object.assign({}, opts.sourceBuffers);\n    const feedbackBuffers = Object.assign({}, opts.feedbackBuffers);\n\n    for (const srcName in this.feedbackMap) {\n      const dstName = this.feedbackMap[srcName];\n      sourceBuffers[srcName] = opts.feedbackBuffers[dstName];\n      feedbackBuffers[dstName] = opts.sourceBuffers[srcName];\n      assert(feedbackBuffers[dstName] instanceof Buffer);\n    }\n\n    return {\n      sourceBuffers,\n      feedbackBuffers\n    };\n  }\n\n  _createNewBuffer(name, opts) {\n    const buffer = new Buffer(this.gl, opts);\n\n    if (this.resources[name]) {\n      this.resources[name].delete();\n    }\n\n    this.resources[name] = buffer;\n    return buffer;\n  }\n\n  _getNextIndex() {\n    return (this.currentIndex + 1) % 2;\n  }\n\n}\n//# sourceMappingURL=buffer-transform.js.map","import { assert } from '@luma.gl/webgl';\nimport { combineInjects, getQualifierDetails, typeToChannelSuffix } from '@luma.gl/shadertools';\nconst SAMPLER_UNIFORM_PREFIX = 'transform_uSampler_';\nconst SIZE_UNIFORM_PREFIX = 'transform_uSize_';\nconst VS_POS_VARIABLE = 'transform_position';\nexport function updateForTextures({\n  vs,\n  sourceTextureMap,\n  targetTextureVarying,\n  targetTexture\n}) {\n  const texAttributeNames = Object.keys(sourceTextureMap);\n  let sourceCount = texAttributeNames.length;\n  let targetTextureType = null;\n  const samplerTextureMap = {};\n  let updatedVs = vs;\n  let finalInject = {};\n\n  if (sourceCount > 0 || targetTextureVarying) {\n    const vsLines = updatedVs.split('\\n');\n    const updateVsLines = vsLines.slice();\n    vsLines.forEach((line, index, lines) => {\n      if (sourceCount > 0) {\n        const updated = processAttributeDefinition(line, sourceTextureMap);\n\n        if (updated) {\n          const {\n            updatedLine,\n            inject\n          } = updated;\n          updateVsLines[index] = updatedLine;\n          finalInject = combineInjects([finalInject, inject]);\n          Object.assign(samplerTextureMap, updated.samplerTextureMap);\n          sourceCount--;\n        }\n      }\n\n      if (targetTextureVarying && !targetTextureType) {\n        targetTextureType = getVaryingType(line, targetTextureVarying);\n      }\n    });\n\n    if (targetTextureVarying) {\n      assert(targetTexture);\n      const sizeName = \"\".concat(SIZE_UNIFORM_PREFIX).concat(targetTextureVarying);\n      const uniformDeclaration = \"uniform vec2 \".concat(sizeName, \";\\n\");\n      const posInstructions = \"     vec2 \".concat(VS_POS_VARIABLE, \" = transform_getPos(\").concat(sizeName, \");\\n     gl_Position = vec4(\").concat(VS_POS_VARIABLE, \", 0, 1.);\\n\");\n      const inject = {\n        'vs:#decl': uniformDeclaration,\n        'vs:#main-start': posInstructions\n      };\n      finalInject = combineInjects([finalInject, inject]);\n    }\n\n    updatedVs = updateVsLines.join('\\n');\n  }\n\n  return {\n    vs: updatedVs,\n    targetTextureType,\n    inject: finalInject,\n    samplerTextureMap\n  };\n}\nexport function getSizeUniforms({\n  sourceTextureMap,\n  targetTextureVarying,\n  targetTexture\n}) {\n  const uniforms = {};\n  let width;\n  let height;\n\n  if (targetTextureVarying) {\n    ({\n      width,\n      height\n    } = targetTexture);\n    uniforms[\"\".concat(SIZE_UNIFORM_PREFIX).concat(targetTextureVarying)] = [width, height];\n  }\n\n  for (const textureName in sourceTextureMap) {\n    ({\n      width,\n      height\n    } = sourceTextureMap[textureName]);\n    uniforms[\"\".concat(SIZE_UNIFORM_PREFIX).concat(textureName)] = [width, height];\n  }\n\n  return uniforms;\n}\n\nfunction getAttributeDefinition(line) {\n  return getQualifierDetails(line, ['attribute', 'in']);\n}\n\nfunction getSamplerDeclerations(textureName) {\n  const samplerName = \"\".concat(SAMPLER_UNIFORM_PREFIX).concat(textureName);\n  const sizeName = \"\".concat(SIZE_UNIFORM_PREFIX).concat(textureName);\n  const uniformDeclerations = \"  uniform sampler2D \".concat(samplerName, \";\\n  uniform vec2 \").concat(sizeName, \";\");\n  return {\n    samplerName,\n    sizeName,\n    uniformDeclerations\n  };\n}\n\nexport function getVaryingType(line, varying) {\n  const qualaiferDetails = getQualifierDetails(line, ['varying', 'out']);\n\n  if (!qualaiferDetails) {\n    return null;\n  }\n\n  return qualaiferDetails.name === varying ? qualaiferDetails.type : null;\n}\nexport function processAttributeDefinition(line, textureMap) {\n  const samplerTextureMap = {};\n  const attributeData = getAttributeDefinition(line);\n\n  if (!attributeData) {\n    return null;\n  }\n\n  const {\n    type,\n    name\n  } = attributeData;\n\n  if (name && textureMap[name]) {\n    const updatedLine = \"// \".concat(line, \" => Replaced by Transform with a sampler\");\n    const {\n      samplerName,\n      sizeName,\n      uniformDeclerations\n    } = getSamplerDeclerations(name);\n    const channels = typeToChannelSuffix(type);\n    const sampleInstruction = \"  \".concat(type, \" \").concat(name, \" = transform_getInput(\").concat(samplerName, \", \").concat(sizeName, \").\").concat(channels, \";\\n\");\n    samplerTextureMap[samplerName] = name;\n    const inject = {\n      'vs:#decl': uniformDeclerations,\n      'vs:#main-start': sampleInstruction\n    };\n    return {\n      updatedLine,\n      inject,\n      samplerTextureMap\n    };\n  }\n\n  return null;\n}\n//# sourceMappingURL=transform-shader-utils.js.map","import { cloneTextureFrom, readPixelsToArray, getShaderVersion, Buffer, Texture2D, Framebuffer } from '@luma.gl/webgl';\nimport { _transform as transformModule, getPassthroughFS, typeToChannelCount, combineInjects } from '@luma.gl/shadertools';\nimport { updateForTextures, getSizeUniforms } from './transform-shader-utils';\nconst SRC_TEX_PARAMETER_OVERRIDES = {\n  [10241]: 9728,\n  [10240]: 9728,\n  [10242]: 33071,\n  [10243]: 33071\n};\nconst FS_OUTPUT_VARIABLE = 'transform_output';\nexport default class TextureTransform {\n  constructor(gl, props = {}) {\n    this.gl = gl;\n    this.id = this.currentIndex = 0;\n    this._swapTexture = null;\n    this.targetTextureVarying = null;\n    this.targetTextureType = null;\n    this.samplerTextureMap = null;\n    this.bindings = [];\n    this.resources = {};\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  updateModelProps(props = {}) {\n    const updatedModelProps = this._processVertexShader(props);\n\n    return Object.assign({}, props, updatedModelProps);\n  }\n\n  getDrawOptions(opts = {}) {\n    const {\n      sourceBuffers,\n      sourceTextures,\n      framebuffer,\n      targetTexture\n    } = this.bindings[this.currentIndex];\n    const attributes = Object.assign({}, sourceBuffers, opts.attributes);\n    const uniforms = Object.assign({}, opts.uniforms);\n    const parameters = Object.assign({}, opts.parameters);\n    let discard = opts.discard;\n\n    if (this.hasSourceTextures || this.hasTargetTexture) {\n      attributes.transform_elementID = this.elementIDBuffer;\n\n      for (const sampler in this.samplerTextureMap) {\n        const textureName = this.samplerTextureMap[sampler];\n        uniforms[sampler] = sourceTextures[textureName];\n      }\n\n      this._setSourceTextureParameters();\n\n      const sizeUniforms = getSizeUniforms({\n        sourceTextureMap: sourceTextures,\n        targetTextureVarying: this.targetTextureVarying,\n        targetTexture\n      });\n      Object.assign(uniforms, sizeUniforms);\n    }\n\n    if (this.hasTargetTexture) {\n      discard = false;\n      parameters.viewport = [0, 0, framebuffer.width, framebuffer.height];\n    }\n\n    return {\n      attributes,\n      framebuffer,\n      uniforms,\n      discard,\n      parameters\n    };\n  }\n\n  swap() {\n    if (this._swapTexture) {\n      this.currentIndex = this._getNextIndex();\n      return true;\n    }\n\n    return false;\n  }\n\n  update(opts = {}) {\n    this._setupTextures(opts);\n  }\n\n  getTargetTexture() {\n    const {\n      targetTexture\n    } = this.bindings[this.currentIndex];\n    return targetTexture;\n  }\n\n  getData({\n    packed = false\n  } = {}) {\n    const {\n      framebuffer\n    } = this.bindings[this.currentIndex];\n    const pixels = readPixelsToArray(framebuffer);\n\n    if (!packed) {\n      return pixels;\n    }\n\n    const ArrayType = pixels.constructor;\n    const channelCount = typeToChannelCount(this.targetTextureType);\n    const packedPixels = new ArrayType(pixels.length * channelCount / 4);\n    let packCount = 0;\n\n    for (let i = 0; i < pixels.length; i += 4) {\n      for (let j = 0; j < channelCount; j++) {\n        packedPixels[packCount++] = pixels[i + j];\n      }\n    }\n\n    return packedPixels;\n  }\n\n  getFramebuffer() {\n    const currentResources = this.bindings[this.currentIndex];\n    return currentResources.framebuffer;\n  }\n\n  delete() {\n    if (this.ownTexture) {\n      this.ownTexture.delete();\n    }\n\n    if (this.elementIDBuffer) {\n      this.elementIDBuffer.delete();\n    }\n  }\n\n  _initialize(props = {}) {\n    const {\n      _targetTextureVarying,\n      _swapTexture\n    } = props;\n    this._swapTexture = _swapTexture;\n    this.targetTextureVarying = _targetTextureVarying;\n    this.hasTargetTexture = _targetTextureVarying;\n\n    this._setupTextures(props);\n  }\n\n  _createTargetTexture(props) {\n    const {\n      sourceTextures,\n      textureOrReference\n    } = props;\n\n    if (textureOrReference instanceof Texture2D) {\n      return textureOrReference;\n    }\n\n    const refTexture = sourceTextures[textureOrReference];\n\n    if (!refTexture) {\n      return null;\n    }\n\n    this._targetRefTexName = textureOrReference;\n    return this._createNewTexture(refTexture);\n  }\n\n  _setupTextures(props = {}) {\n    const {\n      sourceBuffers,\n      _sourceTextures = {},\n      _targetTexture\n    } = props;\n\n    const targetTexture = this._createTargetTexture({\n      sourceTextures: _sourceTextures,\n      textureOrReference: _targetTexture\n    });\n\n    this.hasSourceTextures = this.hasSourceTextures || _sourceTextures && Object.keys(_sourceTextures).length > 0;\n\n    this._updateBindings({\n      sourceBuffers,\n      sourceTextures: _sourceTextures,\n      targetTexture\n    });\n\n    if ('elementCount' in props) {\n      this._updateElementIDBuffer(props.elementCount);\n    }\n  }\n\n  _updateElementIDBuffer(elementCount) {\n    if (typeof elementCount !== 'number' || this.elementCount >= elementCount) {\n      return;\n    }\n\n    const elementIds = new Float32Array(elementCount);\n    elementIds.forEach((_, index, array) => {\n      array[index] = index;\n    });\n\n    if (!this.elementIDBuffer) {\n      this.elementIDBuffer = new Buffer(this.gl, {\n        data: elementIds,\n        accessor: {\n          size: 1\n        }\n      });\n    } else {\n      this.elementIDBuffer.setData({\n        data: elementIds\n      });\n    }\n\n    this.elementCount = elementCount;\n  }\n\n  _updateBindings(opts) {\n    this.bindings[this.currentIndex] = this._updateBinding(this.bindings[this.currentIndex], opts);\n\n    if (this._swapTexture) {\n      const {\n        sourceTextures,\n        targetTexture\n      } = this._swapTextures(this.bindings[this.currentIndex]);\n\n      const nextIndex = this._getNextIndex();\n\n      this.bindings[nextIndex] = this._updateBinding(this.bindings[nextIndex], {\n        sourceTextures,\n        targetTexture\n      });\n    }\n  }\n\n  _updateBinding(binding, opts) {\n    const {\n      sourceBuffers,\n      sourceTextures,\n      targetTexture\n    } = opts;\n\n    if (!binding) {\n      binding = {\n        sourceBuffers: {},\n        sourceTextures: {},\n        targetTexture: null\n      };\n    }\n\n    Object.assign(binding.sourceTextures, sourceTextures);\n    Object.assign(binding.sourceBuffers, sourceBuffers);\n\n    if (targetTexture) {\n      binding.targetTexture = targetTexture;\n      const {\n        width,\n        height\n      } = targetTexture;\n      const {\n        framebuffer\n      } = binding;\n\n      if (framebuffer) {\n        framebuffer.update({\n          attachments: {\n            [36064]: targetTexture\n          },\n          resizeAttachments: false\n        });\n        framebuffer.resize({\n          width,\n          height\n        });\n      } else {\n        binding.framebuffer = new Framebuffer(this.gl, {\n          id: \"transform-framebuffer\",\n          width,\n          height,\n          attachments: {\n            [36064]: targetTexture\n          }\n        });\n      }\n    }\n\n    return binding;\n  }\n\n  _setSourceTextureParameters() {\n    const index = this.currentIndex;\n    const {\n      sourceTextures\n    } = this.bindings[index];\n\n    for (const name in sourceTextures) {\n      sourceTextures[name].setParameters(SRC_TEX_PARAMETER_OVERRIDES);\n    }\n  }\n\n  _swapTextures(opts) {\n    if (!this._swapTexture) {\n      return null;\n    }\n\n    const sourceTextures = Object.assign({}, opts.sourceTextures);\n    sourceTextures[this._swapTexture] = opts.targetTexture;\n    const targetTexture = opts.sourceTextures[this._swapTexture];\n    return {\n      sourceTextures,\n      targetTexture\n    };\n  }\n\n  _createNewTexture(refTexture) {\n    const texture = cloneTextureFrom(refTexture, {\n      parameters: {\n        [10241]: 9728,\n        [10240]: 9728,\n        [10242]: 33071,\n        [10243]: 33071\n      },\n      pixelStore: {\n        [37440]: false\n      }\n    });\n\n    if (this.ownTexture) {\n      this.ownTexture.delete();\n    }\n\n    this.ownTexture = texture;\n    return texture;\n  }\n\n  _getNextIndex() {\n    return (this.currentIndex + 1) % 2;\n  }\n\n  _processVertexShader(props = {}) {\n    const {\n      sourceTextures,\n      targetTexture\n    } = this.bindings[this.currentIndex];\n    const {\n      vs,\n      uniforms,\n      targetTextureType,\n      inject,\n      samplerTextureMap\n    } = updateForTextures({\n      vs: props.vs,\n      sourceTextureMap: sourceTextures,\n      targetTextureVarying: this.targetTextureVarying,\n      targetTexture\n    });\n    const combinedInject = combineInjects([props.inject || {}, inject]);\n    this.targetTextureType = targetTextureType;\n    this.samplerTextureMap = samplerTextureMap;\n    const fs = props._fs || getPassthroughFS({\n      version: getShaderVersion(vs),\n      input: this.targetTextureVarying,\n      inputType: targetTextureType,\n      output: FS_OUTPUT_VARIABLE\n    });\n    const modules = this.hasSourceTextures || this.targetTextureVarying ? [transformModule].concat(props.modules || []) : props.modules;\n    return {\n      vs,\n      fs,\n      modules,\n      uniforms,\n      inject: combinedInject\n    };\n  }\n\n}\n//# sourceMappingURL=texture-transform.js.map","import { getPassthroughFS } from '@luma.gl/shadertools';\nimport BufferTransform from './buffer-transform';\nimport TextureTransform from './texture-transform';\nimport { isWebGL2 } from '@luma.gl/gltools';\nimport { assert, isObjectEmpty, getShaderVersion } from '@luma.gl/webgl';\nimport Model from '../lib/model';\nexport default class Transform {\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  constructor(gl, props = {}) {\n    this.gl = gl;\n    this.model = null;\n    this.elementCount = 0;\n    this.bufferTransform = null;\n    this.textureTransform = null;\n    this.elementIDBuffer = null;\n\n    this._initialize(props);\n\n    Object.seal(this);\n  }\n\n  delete() {\n    const {\n      model,\n      bufferTransform,\n      textureTransform\n    } = this;\n\n    if (model) {\n      model.delete();\n    }\n\n    if (bufferTransform) {\n      bufferTransform.delete();\n    }\n\n    if (textureTransform) {\n      textureTransform.delete();\n    }\n  }\n\n  run(opts = {}) {\n    const {\n      clearRenderTarget = true\n    } = opts;\n\n    const updatedOpts = this._updateDrawOptions(opts);\n\n    if (clearRenderTarget && updatedOpts.framebuffer) {\n      updatedOpts.framebuffer.clear({\n        color: true\n      });\n    }\n\n    this.model.transform(updatedOpts);\n  }\n\n  swap() {\n    let swapped = false;\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      swapped = swapped || resourceTransform.swap();\n    }\n\n    assert(swapped, 'Nothing to swap');\n  }\n\n  getBuffer(varyingName = null) {\n    return this.bufferTransform && this.bufferTransform.getBuffer(varyingName);\n  }\n\n  getData(opts = {}) {\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      const data = resourceTransform.getData(opts);\n\n      if (data) {\n        return data;\n      }\n    }\n\n    return null;\n  }\n\n  getFramebuffer() {\n    return this.textureTransform && this.textureTransform.getFramebuffer();\n  }\n\n  update(opts = {}) {\n    if ('elementCount' in opts) {\n      this.model.setVertexCount(opts.elementCount);\n    }\n\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      resourceTransform.update(opts);\n    }\n  }\n\n  _initialize(props = {}) {\n    const {\n      gl\n    } = this;\n\n    this._buildResourceTransforms(gl, props);\n\n    props = this._updateModelProps(props);\n    this.model = new Model(gl, Object.assign({}, props, {\n      fs: props.fs || getPassthroughFS({\n        version: getShaderVersion(props.vs)\n      }),\n      id: props.id || 'transform-model',\n      drawMode: props.drawMode || 0,\n      vertexCount: props.elementCount\n    }));\n    this.bufferTransform && this.bufferTransform.setupResources({\n      model: this.model\n    });\n  }\n\n  _updateModelProps(props) {\n    let updatedProps = Object.assign({}, props);\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      updatedProps = resourceTransform.updateModelProps(updatedProps);\n    }\n\n    return updatedProps;\n  }\n\n  _buildResourceTransforms(gl, props) {\n    if (canCreateBufferTransform(props)) {\n      this.bufferTransform = new BufferTransform(gl, props);\n    }\n\n    if (canCreateTextureTransform(props)) {\n      this.textureTransform = new TextureTransform(gl, props);\n    }\n\n    assert(this.bufferTransform || this.textureTransform, 'must provide source/feedback buffers or source/target textures');\n  }\n\n  _updateDrawOptions(opts) {\n    let updatedOpts = Object.assign({}, opts);\n    const resourceTransforms = [this.bufferTransform, this.textureTransform].filter(Boolean);\n\n    for (const resourceTransform of resourceTransforms) {\n      updatedOpts = Object.assign(updatedOpts, resourceTransform.getDrawOptions(updatedOpts));\n    }\n\n    return updatedOpts;\n  }\n\n}\n\nfunction canCreateBufferTransform(props) {\n  if (!isObjectEmpty(props.feedbackBuffers) || !isObjectEmpty(props.feedbackMap) || props.varyings && props.varyings.length > 0) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction canCreateTextureTransform(props) {\n  if (!isObjectEmpty(props._sourceTextures) || props._targetTexture || props._targetTextureVarying) {\n    return true;\n  }\n\n  return false;\n}\n//# sourceMappingURL=transform.js.map","import { uid, assert } from '@luma.gl/webgl';\nexport const DRAW_MODE = {\n  POINTS: 0x0000,\n  LINES: 0x0001,\n  LINE_LOOP: 0x0002,\n  LINE_STRIP: 0x0003,\n  TRIANGLES: 0x0004,\n  TRIANGLE_STRIP: 0x0005,\n  TRIANGLE_FAN: 0x0006\n};\nexport default class Geometry {\n  static get DRAW_MODE() {\n    return DRAW_MODE;\n  }\n\n  constructor(props = {}) {\n    const {\n      id = uid('geometry'),\n      drawMode = DRAW_MODE.TRIANGLES,\n      attributes = {},\n      indices = null,\n      vertexCount = null\n    } = props;\n    this.id = id;\n    this.drawMode = drawMode | 0;\n    this.attributes = {};\n    this.userData = {};\n\n    this._setAttributes(attributes, indices);\n\n    this.vertexCount = vertexCount || this._calculateVertexCount(this.attributes, this.indices);\n  }\n\n  get mode() {\n    return this.drawMode;\n  }\n\n  getVertexCount() {\n    return this.vertexCount;\n  }\n\n  getAttributes() {\n    return this.indices ? {\n      indices: this.indices,\n      ...this.attributes\n    } : this.attributes;\n  }\n\n  _print(attributeName) {\n    return \"Geometry \".concat(this.id, \" attribute \").concat(attributeName);\n  }\n\n  _setAttributes(attributes, indices) {\n    if (indices) {\n      this.indices = ArrayBuffer.isView(indices) ? {\n        value: indices,\n        size: 1\n      } : indices;\n    }\n\n    for (const attributeName in attributes) {\n      let attribute = attributes[attributeName];\n      attribute = ArrayBuffer.isView(attribute) ? {\n        value: attribute\n      } : attribute;\n      assert(ArrayBuffer.isView(attribute.value), \"\".concat(this._print(attributeName), \": must be typed array or object with value as typed array\"));\n\n      if ((attributeName === 'POSITION' || attributeName === 'positions') && !attribute.size) {\n        attribute.size = 3;\n      }\n\n      if (attributeName === 'indices') {\n        assert(!this.indices);\n        this.indices = attribute;\n      } else {\n        this.attributes[attributeName] = attribute;\n      }\n    }\n\n    if (this.indices && this.indices.isIndexed !== undefined) {\n      this.indices = Object.assign({}, this.indices);\n      delete this.indices.isIndexed;\n    }\n\n    return this;\n  }\n\n  _calculateVertexCount(attributes, indices) {\n    if (indices) {\n      return indices.value.length;\n    }\n\n    let vertexCount = Infinity;\n\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      const {\n        value,\n        size,\n        constant\n      } = attribute;\n\n      if (!constant && value && size >= 1) {\n        vertexCount = Math.min(vertexCount, value.length / size);\n      }\n    }\n\n    assert(Number.isFinite(vertexCount));\n    return vertexCount;\n  }\n\n}\n//# sourceMappingURL=geometry.js.map","let channelHandles = 1;\nlet animationHandles = 1;\nexport class Timeline {\n  constructor() {\n    this.time = 0;\n    this.channels = new Map();\n    this.animations = new Map();\n    this.playing = false;\n    this.lastEngineTime = -1;\n  }\n\n  addChannel(props) {\n    const {\n      delay = 0,\n      duration = Number.POSITIVE_INFINITY,\n      rate = 1,\n      repeat = 1\n    } = props;\n    const handle = channelHandles++;\n    const channel = {\n      time: 0,\n      delay,\n      duration,\n      rate,\n      repeat\n    };\n\n    this._setChannelTime(channel, this.time);\n\n    this.channels.set(handle, channel);\n    return handle;\n  }\n\n  removeChannel(handle) {\n    this.channels.delete(handle);\n\n    for (const [animationHandle, animation] of this.animations) {\n      if (animation.channel === handle) {\n        this.detachAnimation(animationHandle);\n      }\n    }\n  }\n\n  isFinished(handle) {\n    const channel = this.channels.get(handle);\n\n    if (channel === undefined) {\n      return false;\n    }\n\n    return this.time >= channel.delay + channel.duration * channel.repeat;\n  }\n\n  getTime(handle) {\n    if (handle === undefined) {\n      return this.time;\n    }\n\n    const channel = this.channels.get(handle);\n\n    if (channel === undefined) {\n      return -1;\n    }\n\n    return channel.time;\n  }\n\n  setTime(time) {\n    this.time = Math.max(0, time);\n    const channels = this.channels.values();\n\n    for (const channel of channels) {\n      this._setChannelTime(channel, this.time);\n    }\n\n    const animations = this.animations.values();\n\n    for (const animationData of animations) {\n      const {\n        animation,\n        channel\n      } = animationData;\n      animation.setTime(this.getTime(channel));\n    }\n  }\n\n  play() {\n    this.playing = true;\n  }\n\n  pause() {\n    this.playing = false;\n    this.lastEngineTime = -1;\n  }\n\n  reset() {\n    this.setTime(0);\n  }\n\n  attachAnimation(animation, channelHandle) {\n    const animationHandle = animationHandles++;\n    this.animations.set(animationHandle, {\n      animation,\n      channel: channelHandle\n    });\n    animation.setTime(this.getTime(channelHandle));\n    return animationHandle;\n  }\n\n  detachAnimation(handle) {\n    this.animations.delete(handle);\n  }\n\n  update(engineTime) {\n    if (this.playing) {\n      if (this.lastEngineTime === -1) {\n        this.lastEngineTime = engineTime;\n      }\n\n      this.setTime(this.time + (engineTime - this.lastEngineTime));\n      this.lastEngineTime = engineTime;\n    }\n  }\n\n  _setChannelTime(channel, time) {\n    const offsetTime = time - channel.delay;\n    const totalDuration = channel.duration * channel.repeat;\n\n    if (offsetTime >= totalDuration) {\n      channel.time = channel.duration * channel.rate;\n    } else {\n      channel.time = Math.max(0, offsetTime) % channel.duration;\n      channel.time *= channel.rate;\n    }\n  }\n\n}\n//# sourceMappingURL=timeline.js.map","const vs = \"\\nstruct VertexGeometry {\\n  vec4 position;\\n  vec3 worldPosition;\\n  vec3 worldPositionAlt;\\n  vec3 normal;\\n  vec2 uv;\\n  vec3 pickingColor;\\n} geometry;\\n\";\nconst fs = \"\\n#define SMOOTH_EDGE_RADIUS 0.5\\n\\nstruct FragmentGeometry {\\n  vec2 uv;\\n} geometry;\\n\\nfloat smoothedge(float edge, float x) {\\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\\n}\\n\";\nexport default {\n  name: 'geometry',\n  vs,\n  fs\n};\n//# sourceMappingURL=geometry.js.map","import log from '../utils/log';\nexport const COORDINATE_SYSTEM = {\n  DEFAULT: -1,\n  LNGLAT: 1,\n  METER_OFFSETS: 2,\n  LNGLAT_OFFSETS: 3,\n  CARTESIAN: 0\n};\nObject.defineProperty(COORDINATE_SYSTEM, 'IDENTITY', {\n  get: () => log.deprecated('COORDINATE_SYSTEM.IDENTITY', 'COORDINATE_SYSTEM.CARTESIAN')() || 0\n});\nexport const PROJECTION_MODE = {\n  WEB_MERCATOR: 1,\n  GLOBE: 2,\n  WEB_MERCATOR_AUTO_OFFSET: 4,\n  IDENTITY: 0\n};\nexport const EVENTS = {\n  click: {\n    handler: 'onClick'\n  },\n  panstart: {\n    handler: 'onDragStart'\n  },\n  panmove: {\n    handler: 'onDrag'\n  },\n  panend: {\n    handler: 'onDragEnd'\n  }\n};\n//# sourceMappingURL=constants.js.map","import { COORDINATE_SYSTEM, PROJECTION_MODE } from '../../lib/constants';\nconst COORDINATE_SYSTEM_GLSL_CONSTANTS = Object.keys(COORDINATE_SYSTEM).map(key => \"const int COORDINATE_SYSTEM_\".concat(key, \" = \").concat(COORDINATE_SYSTEM[key], \";\")).join('');\nconst PROJECTION_MODE_GLSL_CONSTANTS = Object.keys(PROJECTION_MODE).map(key => \"const int PROJECTION_MODE_\".concat(key, \" = \").concat(PROJECTION_MODE[key], \";\")).join('');\nexport default \"\".concat(COORDINATE_SYSTEM_GLSL_CONSTANTS, \"\\n\").concat(PROJECTION_MODE_GLSL_CONSTANTS, \"\\n\\nuniform int project_uCoordinateSystem;\\nuniform int project_uProjectionMode;\\nuniform float project_uScale;\\nuniform bool project_uWrapLongitude;\\nuniform vec3 project_uCommonUnitsPerMeter;\\nuniform vec3 project_uCommonUnitsPerWorldUnit;\\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\\nuniform vec4 project_uCenter;\\nuniform mat4 project_uModelMatrix;\\nuniform mat4 project_uViewProjectionMatrix;\\nuniform vec2 project_uViewportSize;\\nuniform float project_uDevicePixelRatio;\\nuniform float project_uFocalDistance;\\nuniform vec3 project_uCameraPosition;\\nuniform vec3 project_uCoordinateOrigin;\\n\\nconst float TILE_SIZE = 512.0;\\nconst float PI = 3.1415926536;\\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\\nconst vec3 ZERO_64_LOW = vec3(0.0);\\nconst float EARTH_RADIUS = 6370972.0;\\nconst float GLOBE_RADIUS = 256.0;\\nfloat project_size(float meters) {\\n  return meters * project_uCommonUnitsPerMeter.z;\\n}\\n\\nvec2 project_size(vec2 meters) {\\n  return meters * project_uCommonUnitsPerMeter.xy;\\n}\\n\\nvec3 project_size(vec3 meters) {\\n  return meters * project_uCommonUnitsPerMeter;\\n}\\n\\nvec4 project_size(vec4 meters) {\\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\\n}\\nvec3 project_normal(vec3 vector) {\\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\\n}\\n\\nvec4 project_offset_(vec4 offset) {\\n  float dy = offset.y;\\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\\n    dy = clamp(dy, -1., 1.);\\n  }\\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\\n}\\nvec2 project_mercator_(vec2 lnglat) {\\n  float x = lnglat.x;\\n  if (project_uWrapLongitude) {\\n    x = mod(x + 180., 360.0) - 180.;\\n  }\\n  float y = clamp(lnglat.y, -89.9, 89.9);\\n  return vec2(\\n    radians(x) + PI,\\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\\n  );\\n}\\n\\nvec3 project_globe_(vec3 lnglatz) {\\n  float lambda = radians(lnglatz.x);\\n  float phi = radians(lnglatz.y);\\n  float cosPhi = cos(phi);\\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\\n\\n  return vec3(\\n    sin(lambda) * cosPhi,\\n    -cos(lambda) * cosPhi,\\n    sin(phi)\\n  ) * D;\\n}\\nvec4 project_position(vec4 position, vec3 position64Low) {\\n  vec4 position_world = project_uModelMatrix * position;\\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\\n      return vec4(\\n        project_mercator_(position_world.xy) * WORLD_SCALE,\\n        project_size(position_world.z),\\n        position_world.w\\n      );\\n    }\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\\n      position_world.xyz += project_uCoordinateOrigin;\\n    }\\n  }\\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\\n      return vec4(\\n        project_globe_(position_world.xyz),\\n        position_world.w\\n      );\\n    }\\n  }\\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\\n    position_world.xyz -= project_uCoordinateOrigin;\\n  }\\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\\n}\\n\\nvec4 project_position(vec4 position) {\\n  return project_position(position, ZERO_64_LOW);\\n}\\n\\nvec3 project_position(vec3 position, vec3 position64Low) {\\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\\n  return projected_position.xyz;\\n}\\n\\nvec3 project_position(vec3 position) {\\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\\n  return projected_position.xyz;\\n}\\n\\nvec2 project_position(vec2 position) {\\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\\n  return projected_position.xy;\\n}\\n\\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\\n  return viewProjectionMatrix * position + center;\\n}\\nvec4 project_common_position_to_clipspace(vec4 position) {\\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\\n}\\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\\n  return offset * project_uFocalDistance;\\n}\\n\\nfloat project_size_to_pixel(float meters) {\\n  return project_size(meters) * project_uScale;\\n}\\nfloat project_pixel_size(float pixels) {\\n  return pixels / project_uScale;\\n}\\nvec2 project_pixel_size(vec2 pixels) {\\n  return pixels / project_uScale;\\n}\\nmat3 project_get_orientation_matrix(vec3 up) {\\n  vec3 uz = normalize(up);\\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\\n  vec3 uy = cross(uz, ux);\\n  return mat3(ux, uy, uz);\\n}\\n\\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\\n    transform = project_get_orientation_matrix(commonPosition);\\n    return true;\\n  }\\n  return false;\\n}\\n\");\n//# sourceMappingURL=project.glsl.js.map","function isEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (Array.isArray(a)) {\n    const len = a.length;\n\n    if (!b || b.length !== len) {\n      return false;\n    }\n\n    for (let i = 0; i < len; i++) {\n      if (a[i] !== b[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\n\nexport default function memoize(compute) {\n  let cachedArgs = {};\n  let cachedResult;\n  return args => {\n    for (const key in args) {\n      if (!isEqual(args[key], cachedArgs[key])) {\n        cachedResult = compute(args);\n        cachedArgs = args;\n        break;\n      }\n    }\n\n    return cachedResult;\n  };\n}\n//# sourceMappingURL=memoize.js.map","import * as mat4 from 'gl-matrix/mat4';\nimport * as vec4 from 'gl-matrix/vec4';\nimport { COORDINATE_SYSTEM, PROJECTION_MODE } from '../../lib/constants';\nimport memoize from '../../utils/memoize';\nconst ZERO_VECTOR = [0, 0, 0, 0];\nconst VECTOR_TO_POINT_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];\nconst IDENTITY_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\nconst DEFAULT_PIXELS_PER_UNIT2 = [0, 0, 0];\nconst DEFAULT_COORDINATE_ORIGIN = [0, 0, 0];\nconst getMemoizedViewportUniforms = memoize(calculateViewportUniforms);\nexport function getOffsetOrigin(viewport, coordinateSystem, coordinateOrigin = DEFAULT_COORDINATE_ORIGIN) {\n  let shaderCoordinateOrigin = coordinateOrigin;\n  let geospatialOrigin;\n  let offsetMode = true;\n\n  if (coordinateSystem === COORDINATE_SYSTEM.LNGLAT_OFFSETS || coordinateSystem === COORDINATE_SYSTEM.METER_OFFSETS) {\n    geospatialOrigin = coordinateOrigin;\n  } else {\n    geospatialOrigin = viewport.isGeospatial ? [Math.fround(viewport.longitude), Math.fround(viewport.latitude), 0] : null;\n  }\n\n  switch (viewport.projectionMode) {\n    case PROJECTION_MODE.WEB_MERCATOR:\n      if (coordinateSystem === COORDINATE_SYSTEM.LNGLAT || coordinateSystem === COORDINATE_SYSTEM.CARTESIAN) {\n        offsetMode = false;\n      }\n\n      break;\n\n    case PROJECTION_MODE.WEB_MERCATOR_AUTO_OFFSET:\n      if (coordinateSystem === COORDINATE_SYSTEM.LNGLAT) {\n        shaderCoordinateOrigin = geospatialOrigin;\n      } else if (coordinateSystem === COORDINATE_SYSTEM.CARTESIAN) {\n        shaderCoordinateOrigin = [Math.fround(viewport.center[0]), Math.fround(viewport.center[1]), 0];\n        geospatialOrigin = viewport.unprojectPosition(shaderCoordinateOrigin);\n        shaderCoordinateOrigin[0] -= coordinateOrigin[0];\n        shaderCoordinateOrigin[1] -= coordinateOrigin[1];\n        shaderCoordinateOrigin[2] -= coordinateOrigin[2];\n      }\n\n      break;\n\n    case PROJECTION_MODE.IDENTITY:\n      shaderCoordinateOrigin = viewport.position.map(Math.fround);\n      break;\n\n    case PROJECTION_MODE.GLOBE:\n      offsetMode = false;\n      geospatialOrigin = null;\n      break;\n\n    default:\n      offsetMode = false;\n  }\n\n  shaderCoordinateOrigin[2] = shaderCoordinateOrigin[2] || 0;\n  return {\n    geospatialOrigin,\n    shaderCoordinateOrigin,\n    offsetMode\n  };\n}\n\nfunction calculateMatrixAndOffset(viewport, coordinateSystem, coordinateOrigin) {\n  const {\n    viewMatrixUncentered,\n    projectionMatrix\n  } = viewport;\n  let {\n    viewMatrix,\n    viewProjectionMatrix\n  } = viewport;\n  let projectionCenter = ZERO_VECTOR;\n  let cameraPosCommon = viewport.cameraPosition;\n  const {\n    geospatialOrigin,\n    shaderCoordinateOrigin,\n    offsetMode\n  } = getOffsetOrigin(viewport, coordinateSystem, coordinateOrigin);\n\n  if (offsetMode) {\n    const positionCommonSpace = viewport.projectPosition(geospatialOrigin || shaderCoordinateOrigin);\n    cameraPosCommon = [cameraPosCommon[0] - positionCommonSpace[0], cameraPosCommon[1] - positionCommonSpace[1], cameraPosCommon[2] - positionCommonSpace[2]];\n    positionCommonSpace[3] = 1;\n    projectionCenter = vec4.transformMat4([], positionCommonSpace, viewProjectionMatrix);\n    viewMatrix = viewMatrixUncentered || viewMatrix;\n    viewProjectionMatrix = mat4.multiply([], projectionMatrix, viewMatrix);\n    viewProjectionMatrix = mat4.multiply([], viewProjectionMatrix, VECTOR_TO_POINT_MATRIX);\n  }\n\n  return {\n    viewMatrix,\n    viewProjectionMatrix,\n    projectionCenter,\n    cameraPosCommon,\n    shaderCoordinateOrigin,\n    geospatialOrigin\n  };\n}\n\nexport function getUniformsFromViewport({\n  viewport,\n  devicePixelRatio = 1,\n  modelMatrix = null,\n  coordinateSystem = COORDINATE_SYSTEM.DEFAULT,\n  coordinateOrigin,\n  autoWrapLongitude = false\n} = {}) {\n  if (coordinateSystem === COORDINATE_SYSTEM.DEFAULT) {\n    coordinateSystem = viewport.isGeospatial ? COORDINATE_SYSTEM.LNGLAT : COORDINATE_SYSTEM.CARTESIAN;\n  }\n\n  const uniforms = getMemoizedViewportUniforms({\n    viewport,\n    devicePixelRatio,\n    coordinateSystem,\n    coordinateOrigin\n  });\n  uniforms.project_uWrapLongitude = autoWrapLongitude;\n  uniforms.project_uModelMatrix = modelMatrix || IDENTITY_MATRIX;\n  return uniforms;\n}\n\nfunction calculateViewportUniforms({\n  viewport,\n  devicePixelRatio,\n  coordinateSystem,\n  coordinateOrigin\n}) {\n  const {\n    projectionCenter,\n    viewProjectionMatrix,\n    cameraPosCommon,\n    shaderCoordinateOrigin,\n    geospatialOrigin\n  } = calculateMatrixAndOffset(viewport, coordinateSystem, coordinateOrigin);\n  const distanceScales = viewport.getDistanceScales();\n  const viewportSize = [viewport.width * devicePixelRatio, viewport.height * devicePixelRatio];\n  const focalDistance = viewport.projectionMatrix.transform([0, 0, -viewport.focalDistance, 1])[3] || 1;\n  const uniforms = {\n    project_uCoordinateSystem: coordinateSystem,\n    project_uProjectionMode: viewport.projectionMode,\n    project_uCoordinateOrigin: shaderCoordinateOrigin,\n    project_uCenter: projectionCenter,\n    project_uViewportSize: viewportSize,\n    project_uDevicePixelRatio: devicePixelRatio,\n    project_uFocalDistance: focalDistance,\n    project_uCommonUnitsPerMeter: distanceScales.unitsPerMeter,\n    project_uCommonUnitsPerWorldUnit: distanceScales.unitsPerMeter,\n    project_uCommonUnitsPerWorldUnit2: DEFAULT_PIXELS_PER_UNIT2,\n    project_uScale: viewport.scale,\n    project_uViewProjectionMatrix: viewProjectionMatrix,\n    project_uCameraPosition: cameraPosCommon\n  };\n\n  if (geospatialOrigin) {\n    const distanceScalesAtOrigin = viewport.getDistanceScales(geospatialOrigin);\n\n    switch (coordinateSystem) {\n      case COORDINATE_SYSTEM.METER_OFFSETS:\n        uniforms.project_uCommonUnitsPerWorldUnit = distanceScalesAtOrigin.unitsPerMeter;\n        uniforms.project_uCommonUnitsPerWorldUnit2 = distanceScalesAtOrigin.unitsPerMeter2;\n        break;\n\n      case COORDINATE_SYSTEM.LNGLAT:\n      case COORDINATE_SYSTEM.LNGLAT_OFFSETS:\n        uniforms.project_uCommonUnitsPerWorldUnit = distanceScalesAtOrigin.unitsPerDegree;\n        uniforms.project_uCommonUnitsPerWorldUnit2 = distanceScalesAtOrigin.unitsPerDegree2;\n        break;\n\n      case COORDINATE_SYSTEM.CARTESIAN:\n        uniforms.project_uCommonUnitsPerWorldUnit = [1, 1, distanceScalesAtOrigin.unitsPerMeter[2]];\n        uniforms.project_uCommonUnitsPerWorldUnit2 = [0, 0, distanceScalesAtOrigin.unitsPerMeter2[2]];\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  return uniforms;\n}\n//# sourceMappingURL=viewport-uniforms.js.map","import { fp32 } from '@luma.gl/core';\nimport projectShader from './project.glsl';\nimport { getUniformsFromViewport } from './viewport-uniforms';\nconst INITIAL_MODULE_OPTIONS = {};\n\nfunction getUniforms(opts = INITIAL_MODULE_OPTIONS) {\n  if (opts.viewport) {\n    return getUniformsFromViewport(opts);\n  }\n\n  return {};\n}\n\nexport default {\n  name: 'project',\n  dependencies: [fp32],\n  vs: projectShader,\n  getUniforms\n};\n//# sourceMappingURL=project.js.map","import project from '../project/project';\nconst vs = \"\\nvec4 project_position_to_clipspace(\\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\\n) {\\n  vec3 projectedPosition = project_position(position, position64Low);\\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\\n    // offset is specified as ENU\\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\\n    offset = rotation * offset;\\n  }\\n  commonPosition = vec4(projectedPosition + offset, 1.0);\\n  return project_common_position_to_clipspace(commonPosition);\\n}\\n\\nvec4 project_position_to_clipspace(\\n  vec3 position, vec3 position64Low, vec3 offset\\n) {\\n  vec4 commonPosition;\\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\\n}\\n\";\nexport default {\n  name: 'project32',\n  dependencies: [project],\n  vs\n};\n//# sourceMappingURL=project32.js.map","import * as vec4 from 'gl-matrix/vec4';\nexport function createMat4() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\nexport function transformVector(matrix, vector) {\n  const result = vec4.transformMat4([], vector, matrix);\n  vec4.scale(result, result, 1 / result[3]);\n  return result;\n}\nexport function mod(value, divisor) {\n  const modulus = value % divisor;\n  return modulus < 0 ? divisor + modulus : modulus;\n}\nexport function lerp(start, end, step) {\n  return step * end + (1 - step) * start;\n}\n\nfunction ieLog2(x) {\n  return Math.log(x) * Math.LOG2E;\n}\n\nexport const log2 = Math.log2 || ieLog2;\n//# sourceMappingURL=math-utils.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || '@math.gl/web-mercator: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import { createMat4, transformVector, log2 } from './math-utils';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport assert from './assert';\nconst PI = Math.PI;\nconst PI_4 = PI / 4;\nconst DEGREES_TO_RADIANS = PI / 180;\nconst RADIANS_TO_DEGREES = 180 / PI;\nconst TILE_SIZE = 512;\nconst EARTH_CIRCUMFERENCE = 40.03e6;\nexport const DEFAULT_ALTITUDE = 1.5;\nexport function zoomToScale(zoom) {\n  return Math.pow(2, zoom);\n}\nexport function scaleToZoom(scale) {\n  return log2(scale);\n}\nexport function lngLatToWorld([lng, lat]) {\n  assert(Number.isFinite(lng));\n  assert(Number.isFinite(lat) && lat >= -90 && lat <= 90, 'invalid latitude');\n  const lambda2 = lng * DEGREES_TO_RADIANS;\n  const phi2 = lat * DEGREES_TO_RADIANS;\n  const x = TILE_SIZE * (lambda2 + PI) / (2 * PI);\n  const y = TILE_SIZE * (PI + Math.log(Math.tan(PI_4 + phi2 * 0.5))) / (2 * PI);\n  return [x, y];\n}\nexport function worldToLngLat([x, y]) {\n  const lambda2 = x / TILE_SIZE * (2 * PI) - PI;\n  const phi2 = 2 * (Math.atan(Math.exp(y / TILE_SIZE * (2 * PI) - PI)) - PI_4);\n  return [lambda2 * RADIANS_TO_DEGREES, phi2 * RADIANS_TO_DEGREES];\n}\nexport function getMeterZoom({\n  latitude\n}) {\n  assert(Number.isFinite(latitude));\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  return scaleToZoom(EARTH_CIRCUMFERENCE * latCosine) - 9;\n}\nexport function getDistanceScales({\n  latitude,\n  longitude,\n  highPrecision = false\n}) {\n  assert(Number.isFinite(latitude) && Number.isFinite(longitude));\n  const result = {};\n  const worldSize = TILE_SIZE;\n  const latCosine = Math.cos(latitude * DEGREES_TO_RADIANS);\n  const unitsPerDegreeX = worldSize / 360;\n  const unitsPerDegreeY = unitsPerDegreeX / latCosine;\n  const altUnitsPerMeter = worldSize / EARTH_CIRCUMFERENCE / latCosine;\n  result.unitsPerMeter = [altUnitsPerMeter, altUnitsPerMeter, altUnitsPerMeter];\n  result.metersPerUnit = [1 / altUnitsPerMeter, 1 / altUnitsPerMeter, 1 / altUnitsPerMeter];\n  result.unitsPerDegree = [unitsPerDegreeX, unitsPerDegreeY, altUnitsPerMeter];\n  result.degreesPerUnit = [1 / unitsPerDegreeX, 1 / unitsPerDegreeY, 1 / altUnitsPerMeter];\n\n  if (highPrecision) {\n    const latCosine2 = DEGREES_TO_RADIANS * Math.tan(latitude * DEGREES_TO_RADIANS) / latCosine;\n    const unitsPerDegreeY2 = unitsPerDegreeX * latCosine2 / 2;\n    const altUnitsPerDegree2 = worldSize / EARTH_CIRCUMFERENCE * latCosine2;\n    const altUnitsPerMeter2 = altUnitsPerDegree2 / unitsPerDegreeY * altUnitsPerMeter;\n    result.unitsPerDegree2 = [0, unitsPerDegreeY2, altUnitsPerDegree2];\n    result.unitsPerMeter2 = [altUnitsPerMeter2, 0, altUnitsPerMeter2];\n  }\n\n  return result;\n}\nexport function addMetersToLngLat(lngLatZ, xyz) {\n  const [longitude, latitude, z0] = lngLatZ;\n  const [x, y, z] = xyz;\n  const {\n    unitsPerMeter,\n    unitsPerMeter2\n  } = getDistanceScales({\n    longitude,\n    latitude,\n    highPrecision: true\n  });\n  const worldspace = lngLatToWorld(lngLatZ);\n  worldspace[0] += x * (unitsPerMeter[0] + unitsPerMeter2[0] * y);\n  worldspace[1] += y * (unitsPerMeter[1] + unitsPerMeter2[1] * y);\n  const newLngLat = worldToLngLat(worldspace);\n  const newZ = (z0 || 0) + (z || 0);\n  return Number.isFinite(z0) || Number.isFinite(z) ? [newLngLat[0], newLngLat[1], newZ] : newLngLat;\n}\nexport function getViewMatrix({\n  height,\n  pitch,\n  bearing,\n  altitude,\n  scale,\n  center = null\n}) {\n  const vm = createMat4();\n  mat4.translate(vm, vm, [0, 0, -altitude]);\n  mat4.rotateX(vm, vm, -pitch * DEGREES_TO_RADIANS);\n  mat4.rotateZ(vm, vm, bearing * DEGREES_TO_RADIANS);\n  scale /= height;\n  mat4.scale(vm, vm, [scale, scale, scale]);\n\n  if (center) {\n    mat4.translate(vm, vm, vec3.negate([], center));\n  }\n\n  return vm;\n}\nexport function getProjectionParameters({\n  width,\n  height,\n  fovy = altitudeToFovy(DEFAULT_ALTITUDE),\n  altitude,\n  pitch = 0,\n  nearZMultiplier = 1,\n  farZMultiplier = 1\n}) {\n  if (altitude !== undefined) {\n    fovy = altitudeToFovy(altitude);\n  }\n\n  const halfFov = 0.5 * fovy * DEGREES_TO_RADIANS;\n  const focalDistance = fovyToAltitude(fovy);\n  const pitchRadians = pitch * DEGREES_TO_RADIANS;\n  const topHalfSurfaceDistance = Math.sin(halfFov) * focalDistance / Math.sin(Math.min(Math.max(Math.PI / 2 - pitchRadians - halfFov, 0.01), Math.PI - 0.01));\n  const farZ = Math.sin(pitchRadians) * topHalfSurfaceDistance + focalDistance;\n  return {\n    fov: 2 * halfFov,\n    aspect: width / height,\n    focalDistance,\n    near: nearZMultiplier,\n    far: farZ * farZMultiplier\n  };\n}\nexport function getProjectionMatrix({\n  width,\n  height,\n  pitch,\n  altitude,\n  fovy,\n  nearZMultiplier,\n  farZMultiplier\n}) {\n  const {\n    fov,\n    aspect,\n    near,\n    far\n  } = getProjectionParameters({\n    width,\n    height,\n    altitude,\n    fovy,\n    pitch,\n    nearZMultiplier,\n    farZMultiplier\n  });\n  const projectionMatrix = mat4.perspective([], fov, aspect, near, far);\n  return projectionMatrix;\n}\nexport function altitudeToFovy(altitude) {\n  return 2 * Math.atan(0.5 / altitude) * RADIANS_TO_DEGREES;\n}\nexport function fovyToAltitude(fovy) {\n  return 0.5 / Math.tan(0.5 * fovy * DEGREES_TO_RADIANS);\n}\nexport function worldToPixels(xyz, pixelProjectionMatrix) {\n  const [x, y, z = 0] = xyz;\n  assert(Number.isFinite(x) && Number.isFinite(y) && Number.isFinite(z));\n  return transformVector(pixelProjectionMatrix, [x, y, z, 1]);\n}\nexport function pixelsToWorld(xyz, pixelUnprojectionMatrix, targetZ = 0) {\n  const [x, y, z] = xyz;\n  assert(Number.isFinite(x) && Number.isFinite(y), 'invalid pixel coordinate');\n\n  if (Number.isFinite(z)) {\n    const coord = transformVector(pixelUnprojectionMatrix, [x, y, z, 1]);\n    return coord;\n  }\n\n  const coord0 = transformVector(pixelUnprojectionMatrix, [x, y, 0, 1]);\n  const coord1 = transformVector(pixelUnprojectionMatrix, [x, y, 1, 1]);\n  const z0 = coord0[2];\n  const z1 = coord1[2];\n  const t = z0 === z1 ? 0 : ((targetZ || 0) - z0) / (z1 - z0);\n  return vec2.lerp([], coord0, coord1, t);\n}\n//# sourceMappingURL=web-mercator-utils.js.map","import WebMercatorViewport from './web-mercator-viewport';\nimport assert from './assert';\nimport { log2 } from './math-utils';\nexport default function fitBounds({\n  width,\n  height,\n  bounds,\n  minExtent = 0,\n  maxZoom = 24,\n  padding = 0,\n  offset = [0, 0]\n}) {\n  const [[west, south], [east, north]] = bounds;\n\n  if (Number.isFinite(padding)) {\n    const p = padding;\n    padding = {\n      top: p,\n      bottom: p,\n      left: p,\n      right: p\n    };\n  } else {\n    assert(Number.isFinite(padding.top) && Number.isFinite(padding.bottom) && Number.isFinite(padding.left) && Number.isFinite(padding.right));\n  }\n\n  const viewport = new WebMercatorViewport({\n    width,\n    height,\n    longitude: 0,\n    latitude: 0,\n    zoom: 0\n  });\n  const nw = viewport.project([west, north]);\n  const se = viewport.project([east, south]);\n  const size = [Math.max(Math.abs(se[0] - nw[0]), minExtent), Math.max(Math.abs(se[1] - nw[1]), minExtent)];\n  const targetSize = [width - padding.left - padding.right - Math.abs(offset[0]) * 2, height - padding.top - padding.bottom - Math.abs(offset[1]) * 2];\n  assert(targetSize[0] > 0 && targetSize[1] > 0);\n  const scaleX = targetSize[0] / size[0];\n  const scaleY = targetSize[1] / size[1];\n  const offsetX = (padding.right - padding.left) / 2 / scaleX;\n  const offsetY = (padding.bottom - padding.top) / 2 / scaleY;\n  const center = [(se[0] + nw[0]) / 2 + offsetX, (se[1] + nw[1]) / 2 + offsetY];\n  const centerLngLat = viewport.unproject(center);\n  const zoom = Math.min(maxZoom, viewport.zoom + log2(Math.abs(Math.min(scaleX, scaleY))));\n  assert(Number.isFinite(zoom));\n  return {\n    longitude: centerLngLat[0],\n    latitude: centerLngLat[1],\n    zoom\n  };\n}\n//# sourceMappingURL=fit-bounds.js.map","import { worldToLngLat } from './web-mercator-utils';\nimport * as vec2 from 'gl-matrix/vec2';\nimport { transformVector } from './math-utils';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\nexport default function getBounds(viewport, z = 0) {\n  const {\n    width,\n    height,\n    unproject\n  } = viewport;\n  const unprojectOps = {\n    targetZ: z\n  };\n  const bottomLeft = unproject([0, height], unprojectOps);\n  const bottomRight = unproject([width, height], unprojectOps);\n  let topLeft;\n  let topRight;\n  const halfFov = viewport.fovy ? 0.5 * viewport.fovy * DEGREES_TO_RADIANS : Math.atan(0.5 / viewport.altitude);\n  const angleToGround = (90 - viewport.pitch) * DEGREES_TO_RADIANS;\n\n  if (halfFov > angleToGround - 0.01) {\n    topLeft = unprojectOnFarPlane(viewport, 0, z);\n    topRight = unprojectOnFarPlane(viewport, width, z);\n  } else {\n    topLeft = unproject([0, 0], unprojectOps);\n    topRight = unproject([width, 0], unprojectOps);\n  }\n\n  return [bottomLeft, bottomRight, topRight, topLeft];\n}\n\nfunction unprojectOnFarPlane(viewport, x, targetZ) {\n  const {\n    pixelUnprojectionMatrix\n  } = viewport;\n  const coord0 = transformVector(pixelUnprojectionMatrix, [x, 0, 1, 1]);\n  const coord1 = transformVector(pixelUnprojectionMatrix, [x, viewport.height, 1, 1]);\n  const z = targetZ * viewport.distanceScales.unitsPerMeter[2];\n  const t = (z - coord0[2]) / (coord1[2] - coord0[2]);\n  const coord = vec2.lerp([], coord0, coord1, t);\n  const result = worldToLngLat(coord);\n  result[2] = targetZ;\n  return result;\n}\n//# sourceMappingURL=get-bounds.js.map","import { createMat4 } from './math-utils';\nimport { zoomToScale, pixelsToWorld, lngLatToWorld, worldToLngLat, worldToPixels, altitudeToFovy, fovyToAltitude, DEFAULT_ALTITUDE, getProjectionMatrix, getDistanceScales, getViewMatrix } from './web-mercator-utils';\nimport fitBounds from './fit-bounds';\nimport getBounds from './get-bounds';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nexport default class WebMercatorViewport {\n  constructor({\n    width,\n    height,\n    latitude = 0,\n    longitude = 0,\n    zoom = 0,\n    pitch = 0,\n    bearing = 0,\n    altitude = null,\n    fovy = null,\n    position = null,\n    nearZMultiplier = 0.02,\n    farZMultiplier = 1.01\n  } = {\n    width: 1,\n    height: 1\n  }) {\n    width = width || 1;\n    height = height || 1;\n\n    if (fovy === null && altitude === null) {\n      altitude = DEFAULT_ALTITUDE;\n      fovy = altitudeToFovy(altitude);\n    } else if (fovy === null) {\n      fovy = altitudeToFovy(altitude);\n    } else if (altitude === null) {\n      altitude = fovyToAltitude(fovy);\n    }\n\n    const scale = zoomToScale(zoom);\n    altitude = Math.max(0.75, altitude);\n    const distanceScales = getDistanceScales({\n      longitude,\n      latitude\n    });\n    const center = lngLatToWorld([longitude, latitude]);\n    center[2] = 0;\n\n    if (position) {\n      vec3.add(center, center, vec3.mul([], position, distanceScales.unitsPerMeter));\n    }\n\n    this.projectionMatrix = getProjectionMatrix({\n      width,\n      height,\n      pitch,\n      fovy,\n      nearZMultiplier,\n      farZMultiplier\n    });\n    this.viewMatrix = getViewMatrix({\n      height,\n      scale,\n      center,\n      pitch,\n      bearing,\n      altitude\n    });\n    this.width = width;\n    this.height = height;\n    this.scale = scale;\n    this.latitude = latitude;\n    this.longitude = longitude;\n    this.zoom = zoom;\n    this.pitch = pitch;\n    this.bearing = bearing;\n    this.altitude = altitude;\n    this.fovy = fovy;\n    this.center = center;\n    this.meterOffset = position || [0, 0, 0];\n    this.distanceScales = distanceScales;\n\n    this._initMatrices();\n\n    this.equals = this.equals.bind(this);\n    this.project = this.project.bind(this);\n    this.unproject = this.unproject.bind(this);\n    this.projectPosition = this.projectPosition.bind(this);\n    this.unprojectPosition = this.unprojectPosition.bind(this);\n    Object.freeze(this);\n  }\n\n  _initMatrices() {\n    const {\n      width,\n      height,\n      projectionMatrix,\n      viewMatrix\n    } = this;\n    const vpm = createMat4();\n    mat4.multiply(vpm, vpm, projectionMatrix);\n    mat4.multiply(vpm, vpm, viewMatrix);\n    this.viewProjectionMatrix = vpm;\n    const m = createMat4();\n    mat4.scale(m, m, [width / 2, -height / 2, 1]);\n    mat4.translate(m, m, [1, -1, 0]);\n    mat4.multiply(m, m, vpm);\n    const mInverse = mat4.invert(createMat4(), m);\n\n    if (!mInverse) {\n      throw new Error('Pixel project matrix not invertible');\n    }\n\n    this.pixelProjectionMatrix = m;\n    this.pixelUnprojectionMatrix = mInverse;\n  }\n\n  equals(viewport) {\n    if (!(viewport instanceof WebMercatorViewport)) {\n      return false;\n    }\n\n    return viewport.width === this.width && viewport.height === this.height && mat4.equals(viewport.projectionMatrix, this.projectionMatrix) && mat4.equals(viewport.viewMatrix, this.viewMatrix);\n  }\n\n  project(xyz, {\n    topLeft = true\n  } = {}) {\n    const worldPosition = this.projectPosition(xyz);\n    const coord = worldToPixels(worldPosition, this.pixelProjectionMatrix);\n    const [x, y] = coord;\n    const y2 = topLeft ? y : this.height - y;\n    return xyz.length === 2 ? [x, y2] : [x, y2, coord[2]];\n  }\n\n  unproject(xyz, {\n    topLeft = true,\n    targetZ = undefined\n  } = {}) {\n    const [x, y, z] = xyz;\n    const y2 = topLeft ? y : this.height - y;\n    const targetZWorld = targetZ && targetZ * this.distanceScales.unitsPerMeter[2];\n    const coord = pixelsToWorld([x, y2, z], this.pixelUnprojectionMatrix, targetZWorld);\n    const [X, Y, Z] = this.unprojectPosition(coord);\n\n    if (Number.isFinite(z)) {\n      return [X, Y, Z];\n    }\n\n    return Number.isFinite(targetZ) ? [X, Y, targetZ] : [X, Y];\n  }\n\n  projectPosition(xyz) {\n    const [X, Y] = lngLatToWorld(xyz);\n    const Z = (xyz[2] || 0) * this.distanceScales.unitsPerMeter[2];\n    return [X, Y, Z];\n  }\n\n  unprojectPosition(xyz) {\n    const [X, Y] = worldToLngLat(xyz);\n    const Z = (xyz[2] || 0) * this.distanceScales.metersPerUnit[2];\n    return [X, Y, Z];\n  }\n\n  projectFlat(lngLat) {\n    return lngLatToWorld(lngLat);\n  }\n\n  unprojectFlat(xy) {\n    return worldToLngLat(xy);\n  }\n\n  getMapCenterByLngLatPosition({\n    lngLat,\n    pos\n  }) {\n    const fromLocation = pixelsToWorld(pos, this.pixelUnprojectionMatrix);\n    const toLocation = lngLatToWorld(lngLat);\n    const translate = vec2.add([], toLocation, vec2.negate([], fromLocation));\n    const newCenter = vec2.add([], this.center, translate);\n    return worldToLngLat(newCenter);\n  }\n\n  getLocationAtPoint({\n    lngLat,\n    pos\n  }) {\n    return this.getMapCenterByLngLatPosition({\n      lngLat,\n      pos\n    });\n  }\n\n  fitBounds(bounds, options = {}) {\n    const {\n      width,\n      height\n    } = this;\n    const {\n      longitude,\n      latitude,\n      zoom\n    } = fitBounds(Object.assign({\n      width,\n      height,\n      bounds\n    }, options));\n    return new WebMercatorViewport({\n      width,\n      height,\n      longitude,\n      latitude,\n      zoom\n    });\n  }\n\n  getBounds(options) {\n    const corners = this.getBoundingRegion(options);\n    const west = Math.min(...corners.map(p => p[0]));\n    const east = Math.max(...corners.map(p => p[0]));\n    const south = Math.min(...corners.map(p => p[1]));\n    const north = Math.max(...corners.map(p => p[1]));\n    return [[west, south], [east, north]];\n  }\n\n  getBoundingRegion(options = {}) {\n    return getBounds(this, options.z || 0);\n  }\n\n}\n//# sourceMappingURL=web-mercator-viewport.js.map","import WebMercatorViewport from './web-mercator-viewport';\nimport { mod, log2 } from './math-utils';\nconst MAX_LATITUDE = 85.05113;\nconst MIN_LATITUDE = -85.05113;\nexport default function normalizeViewportProps({\n  width,\n  height,\n  longitude,\n  latitude,\n  zoom,\n  pitch = 0,\n  bearing = 0\n}) {\n  if (longitude < -180 || longitude > 180) {\n    longitude = mod(longitude + 180, 360) - 180;\n  }\n\n  if (bearing < -180 || bearing > 180) {\n    bearing = mod(bearing + 180, 360) - 180;\n  }\n\n  let flatViewport = new WebMercatorViewport({\n    width,\n    height,\n    longitude,\n    latitude,\n    zoom\n  });\n  let topY = flatViewport.project([longitude, MAX_LATITUDE])[1];\n  let bottomY = flatViewport.project([longitude, MIN_LATITUDE])[1];\n  let shiftY = 0;\n\n  if (bottomY - topY < height) {\n    zoom += log2(height / (bottomY - topY));\n    flatViewport = new WebMercatorViewport({\n      width,\n      height,\n      longitude,\n      latitude,\n      zoom\n    });\n    topY = flatViewport.project([longitude, MAX_LATITUDE])[1];\n    bottomY = flatViewport.project([longitude, MIN_LATITUDE])[1];\n  }\n\n  if (topY > 0) {\n    shiftY = topY;\n  } else if (bottomY < height) {\n    shiftY = bottomY - height;\n  }\n\n  if (shiftY) {\n    latitude = flatViewport.unproject([width / 2, height / 2 + shiftY])[1];\n  }\n\n  return {\n    width,\n    height,\n    longitude,\n    latitude,\n    zoom,\n    pitch,\n    bearing\n  };\n}\n//# sourceMappingURL=normalize-viewport-props.js.map","import { COORDINATE_SYSTEM, PROJECTION_MODE } from '../../lib/constants';\nimport project from '../project/project';\nimport { Vector3, Matrix4 } from 'math.gl';\nimport memoize from '../../utils/memoize';\nimport { pixelsToWorld } from '@math.gl/web-mercator';\nconst vs = \"\\nconst int max_lights = 2;\\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\\nuniform vec4 shadow_uProjectCenters[max_lights];\\nuniform bool shadow_uDrawShadowMap;\\nuniform bool shadow_uUseShadowMap;\\nuniform int shadow_uLightId;\\nuniform float shadow_uLightCount;\\n\\nvarying vec3 shadow_vPosition[max_lights];\\n\\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\\n  if (shadow_uDrawShadowMap) {\\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\\n  }\\n  if (shadow_uUseShadowMap) {\\n    for (int i = 0; i < max_lights; i++) {\\n      if(i < int(shadow_uLightCount)) {\\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\\n      }\\n    }\\n  }\\n  return gl_Position;\\n}\\n\";\nconst fs = \"\\nconst int max_lights = 2;\\nuniform bool shadow_uDrawShadowMap;\\nuniform bool shadow_uUseShadowMap;\\nuniform sampler2D shadow_uShadowMap0;\\nuniform sampler2D shadow_uShadowMap1;\\nuniform vec4 shadow_uColor;\\nuniform float shadow_uLightCount;\\n\\nvarying vec3 shadow_vPosition[max_lights];\\n\\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\\n\\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\\n\\n  float z = dot(rgbaDepth, bitUnpackShift);\\n  return smoothstep(0.001, 0.01, position.z - z);\\n}\\n\\nvec4 shadow_filterShadowColor(vec4 color) {\\n  if (shadow_uDrawShadowMap) {\\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\\n    return rgbaDepth;\\n  }\\n  if (shadow_uUseShadowMap) {\\n    float shadowAlpha = 0.0;\\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\\n    if(shadow_uLightCount > 1.0) {\\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\\n    }\\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\\n\\n    return vec4(\\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\\n      blendedAlpha\\n    );\\n  }\\n  return color;\\n}\\n\";\nconst getMemoizedViewportCenterPosition = memoize(getViewportCenterPosition);\nconst getMemoizedViewProjectionMatrices = memoize(getViewProjectionMatrices);\nconst DEFAULT_SHADOW_COLOR = [0, 0, 0, 1.0];\nconst VECTOR_TO_POINT_MATRIX = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0];\n\nfunction screenToCommonSpace(xyz, pixelUnprojectionMatrix) {\n  const [x, y, z] = xyz;\n  const coord = pixelsToWorld([x, y, z], pixelUnprojectionMatrix);\n\n  if (Number.isFinite(z)) {\n    return coord;\n  }\n\n  return [coord[0], coord[1], 0];\n}\n\nfunction getViewportCenterPosition({\n  viewport,\n  center\n}) {\n  return new Matrix4(viewport.viewProjectionMatrix).invert().transform(center);\n}\n\nfunction getViewProjectionMatrices({\n  viewport,\n  shadowMatrices\n}) {\n  const projectionMatrices = [];\n  const pixelUnprojectionMatrix = viewport.pixelUnprojectionMatrix;\n  const farZ = viewport.isGeospatial ? undefined : 1;\n  const corners = [[0, 0, farZ], [viewport.width, 0, farZ], [0, viewport.height, farZ], [viewport.width, viewport.height, farZ], [0, 0, -1], [viewport.width, 0, -1], [0, viewport.height, -1], [viewport.width, viewport.height, -1]].map(pixel => screenToCommonSpace(pixel, pixelUnprojectionMatrix));\n\n  for (const shadowMatrix of shadowMatrices) {\n    const viewMatrix = shadowMatrix.clone().translate(new Vector3(viewport.center).negate());\n    const positions = corners.map(corner => viewMatrix.transform(corner));\n    const projectionMatrix = new Matrix4().ortho({\n      left: Math.min(...positions.map(position => position[0])),\n      right: Math.max(...positions.map(position => position[0])),\n      bottom: Math.min(...positions.map(position => position[1])),\n      top: Math.max(...positions.map(position => position[1])),\n      near: Math.min(...positions.map(position => -position[2])),\n      far: Math.max(...positions.map(position => -position[2]))\n    });\n    projectionMatrices.push(projectionMatrix.multiplyRight(shadowMatrix));\n  }\n\n  return projectionMatrices;\n}\n\nfunction createShadowUniforms(opts = {}, context = {}) {\n  const uniforms = {\n    shadow_uDrawShadowMap: Boolean(opts.drawToShadowMap),\n    shadow_uUseShadowMap: opts.shadowMaps ? opts.shadowMaps.length > 0 : false,\n    shadow_uColor: opts.shadowColor || DEFAULT_SHADOW_COLOR,\n    shadow_uLightId: opts.shadowLightId || 0,\n    shadow_uLightCount: opts.shadowMatrices.length\n  };\n  const center = getMemoizedViewportCenterPosition({\n    viewport: opts.viewport,\n    center: context.project_uCenter\n  });\n  const projectCenters = [];\n  const viewProjectionMatrices = getMemoizedViewProjectionMatrices({\n    shadowMatrices: opts.shadowMatrices,\n    viewport: opts.viewport\n  }).slice();\n\n  for (let i = 0; i < opts.shadowMatrices.length; i++) {\n    const viewProjectionMatrix = viewProjectionMatrices[i];\n    const viewProjectionMatrixCentered = viewProjectionMatrix.clone().translate(new Vector3(opts.viewport.center).negate());\n\n    if (context.project_uCoordinateSystem === COORDINATE_SYSTEM.LNGLAT && context.project_uProjectionMode === PROJECTION_MODE.WEB_MERCATOR) {\n      viewProjectionMatrices[i] = viewProjectionMatrixCentered;\n      projectCenters[i] = center;\n    } else {\n      viewProjectionMatrices[i] = viewProjectionMatrix.clone().multiplyRight(VECTOR_TO_POINT_MATRIX);\n      projectCenters[i] = viewProjectionMatrixCentered.transform(center);\n    }\n  }\n\n  for (let i = 0; i < viewProjectionMatrices.length; i++) {\n    uniforms[\"shadow_uViewProjectionMatrices[\".concat(i, \"]\")] = viewProjectionMatrices[i];\n    uniforms[\"shadow_uProjectCenters[\".concat(i, \"]\")] = projectCenters[i];\n\n    if (opts.shadowMaps && opts.shadowMaps.length > 0) {\n      uniforms[\"shadow_uShadowMap\".concat(i)] = opts.shadowMaps[i];\n    } else {\n      uniforms[\"shadow_uShadowMap\".concat(i)] = opts.dummyShadowMap;\n    }\n  }\n\n  return uniforms;\n}\n\nexport default {\n  name: 'shadow',\n  dependencies: [project],\n  vs,\n  fs,\n  inject: {\n    'vs:DECKGL_FILTER_GL_POSITION': \"\\n    position = shadow_setVertexPosition(geometry.position);\\n    \",\n    'fs:DECKGL_FILTER_COLOR': \"\\n    color = shadow_filterShadowColor(color);\\n    \"\n  },\n  getUniforms: (opts = {}, context = {}) => {\n    if (opts.drawToShadowMap || opts.shadowMaps && opts.shadowMaps.length > 0) {\n      const {\n        shadowEnabled = true\n      } = opts;\n      return shadowEnabled && opts.shadowMatrices && opts.shadowMatrices.length > 0 ? createShadowUniforms(opts, context) : {\n        shadow_uDrawShadowMap: false,\n        shadow_uUseShadowMap: false\n      };\n    }\n\n    return {};\n  }\n};\n//# sourceMappingURL=shadow.js.map","import { picking } from '@luma.gl/core';\nexport default {\n  inject: {\n    'vs:DECKGL_FILTER_COLOR': \"\\n  picking_setPickingColor(geometry.pickingColor);\\n  // for picking depth values\\n  picking_setPickingAttribute(geometry.position.z);\\n  \",\n    'fs:DECKGL_FILTER_COLOR': {\n      order: 99,\n      injection: \"\\n  // use highlight color if this fragment belongs to the selected object.\\n  color = picking_filterHighlightColor(color);\\n\\n  // use picking color if rendering to picking FBO.\\n  color = picking_filterPickingColor(color);\\n    \"\n    }\n  },\n  ...picking\n};\n//# sourceMappingURL=picking.js.map","import { ProgramManager } from '@luma.gl/core';\nimport { gouraudLighting, phongLighting } from '@luma.gl/core';\nimport geometry from './misc/geometry';\nimport project from './project/project';\nimport project32 from './project32/project32';\nimport shadow from './shadow/shadow';\nimport picking from './picking/picking';\nconst DEFAULT_MODULES = [geometry, project];\nconst SHADER_HOOKS = ['vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)', 'vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)', 'vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)', 'fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)'];\nexport function createProgramManager(gl) {\n  const programManager = ProgramManager.getDefaultProgramManager(gl);\n\n  for (const shaderModule of DEFAULT_MODULES) {\n    programManager.addDefaultModule(shaderModule);\n  }\n\n  for (const shaderHook of SHADER_HOOKS) {\n    programManager.addShaderHook(shaderHook);\n  }\n\n  return programManager;\n}\nexport { picking, project, project32, gouraudLighting, phongLighting, shadow };\n//# sourceMappingURL=index.js.map","const DEFAULT_LIGHT_COLOR = [255, 255, 255];\nconst DEFAULT_LIGHT_INTENSITY = 1.0;\nlet idCount = 0;\nexport class AmbientLight {\n  constructor(props = {}) {\n    const {\n      color = DEFAULT_LIGHT_COLOR\n    } = props;\n    const {\n      intensity = DEFAULT_LIGHT_INTENSITY\n    } = props;\n    this.id = props.id || \"ambient-\".concat(idCount++);\n    this.color = color;\n    this.intensity = intensity;\n    this.type = 'ambient';\n  }\n\n}\n//# sourceMappingURL=ambient-light.js.map","import { Vector3 } from 'math.gl';\nconst DEFAULT_LIGHT_COLOR = [255, 255, 255];\nconst DEFAULT_LIGHT_INTENSITY = 1.0;\nconst DEFAULT_LIGHT_DIRECTION = [0.0, 0.0, -1.0];\nlet idCount = 0;\nexport class DirectionalLight {\n  constructor(props = {}) {\n    const {\n      color = DEFAULT_LIGHT_COLOR\n    } = props;\n    const {\n      intensity = DEFAULT_LIGHT_INTENSITY\n    } = props;\n    const {\n      direction = DEFAULT_LIGHT_DIRECTION\n    } = props;\n    const {\n      _shadow = false\n    } = props;\n    this.id = props.id || \"directional-\".concat(idCount++);\n    this.color = color;\n    this.intensity = intensity;\n    this.type = 'directional';\n    this.direction = new Vector3(direction).normalize().toArray();\n    this.shadow = _shadow;\n  }\n\n  getProjectedLight() {\n    return this;\n  }\n\n}\n//# sourceMappingURL=directional-light.js.map","export default class Effect {\n  constructor(props = {}) {\n    const {\n      id = 'effect'\n    } = props;\n    this.id = id;\n    this.props = { ...props\n    };\n  }\n\n  preRender() {}\n\n  getModuleParameters() {}\n\n  cleanup() {}\n\n}\n//# sourceMappingURL=effect.js.map","import Pass from './pass';\nimport { clear, setParameters, withParameters, cssToDeviceRatio } from '@luma.gl/core';\nexport default class LayersPass extends Pass {\n  render(props) {\n    const gl = this.gl;\n    setParameters(gl, {\n      framebuffer: props.target\n    });\n    return this._drawLayers(props);\n  }\n\n  _drawLayers(props) {\n    const {\n      viewports,\n      views,\n      onViewportActive,\n      clearCanvas = true\n    } = props;\n    props.pass = props.pass || 'unknown';\n    const gl = this.gl;\n\n    if (clearCanvas) {\n      clearGLCanvas(gl);\n    }\n\n    const renderStats = [];\n\n    for (const viewportOrDescriptor of viewports) {\n      const viewport = viewportOrDescriptor.viewport || viewportOrDescriptor;\n      const view = views && views[viewport.id];\n      onViewportActive(viewport);\n\n      const drawLayerParams = this._getDrawLayerParams(viewport, props);\n\n      props.view = view;\n      const subViewports = viewport.subViewports || [viewport];\n\n      for (const subViewport of subViewports) {\n        props.viewport = subViewport;\n\n        const stats = this._drawLayersInViewport(gl, props, drawLayerParams);\n\n        renderStats.push(stats);\n      }\n    }\n\n    return renderStats;\n  }\n\n  _getDrawLayerParams(viewport, {\n    layers,\n    pass,\n    layerFilter,\n    effects,\n    moduleParameters\n  }) {\n    const drawLayerParams = [];\n    const indexResolver = layerIndexResolver();\n    const drawContext = {\n      viewport,\n      isPicking: pass.startsWith('picking'),\n      renderPass: pass\n    };\n\n    for (let layerIndex = 0; layerIndex < layers.length; layerIndex++) {\n      const layer = layers[layerIndex];\n\n      const shouldDrawLayer = this._shouldDrawLayer(layer, drawContext, layerFilter);\n\n      const layerRenderIndex = indexResolver(layer, shouldDrawLayer);\n      const layerParam = {\n        shouldDrawLayer,\n        layerRenderIndex\n      };\n\n      if (shouldDrawLayer) {\n        layerParam.moduleParameters = this._getModuleParameters(layer, effects, pass, moduleParameters);\n        layerParam.layerParameters = this.getLayerParameters(layer, layerIndex);\n      }\n\n      drawLayerParams[layerIndex] = layerParam;\n    }\n\n    return drawLayerParams;\n  }\n\n  _drawLayersInViewport(gl, {\n    layers,\n    pass,\n    viewport,\n    view\n  }, drawLayerParams) {\n    const glViewport = getGLViewport(gl, {\n      viewport\n    });\n\n    if (view && view.props.clear) {\n      const clearOpts = view.props.clear === true ? {\n        color: true,\n        depth: true\n      } : view.props.clear;\n      withParameters(gl, {\n        scissorTest: true,\n        scissor: glViewport\n      }, () => clear(gl, clearOpts));\n    }\n\n    const renderStatus = {\n      totalCount: layers.length,\n      visibleCount: 0,\n      compositeCount: 0,\n      pickableCount: 0\n    };\n    setParameters(gl, {\n      viewport: glViewport\n    });\n\n    for (let layerIndex = 0; layerIndex < layers.length; layerIndex++) {\n      const layer = layers[layerIndex];\n      const {\n        shouldDrawLayer,\n        layerRenderIndex,\n        moduleParameters,\n        layerParameters\n      } = drawLayerParams[layerIndex];\n\n      if (shouldDrawLayer && layer.props.pickable) {\n        renderStatus.pickableCount++;\n      }\n\n      if (layer.isComposite) {\n        renderStatus.compositeCount++;\n      } else if (shouldDrawLayer) {\n        renderStatus.visibleCount++;\n        moduleParameters.viewport = viewport;\n\n        try {\n          layer.drawLayer({\n            moduleParameters,\n            uniforms: {\n              layerIndex: layerRenderIndex\n            },\n            parameters: layerParameters\n          });\n        } catch (err) {\n          layer.raiseError(err, \"drawing \".concat(layer, \" to \").concat(pass));\n        }\n      }\n    }\n\n    return renderStatus;\n  }\n\n  shouldDrawLayer(layer) {\n    return true;\n  }\n\n  getModuleParameters(layer, effects) {\n    return null;\n  }\n\n  getLayerParameters(layer, layerIndex) {\n    return layer.props.parameters;\n  }\n\n  _shouldDrawLayer(layer, drawContext, layerFilter) {\n    const shouldDrawLayer = this.shouldDrawLayer(layer) && layer.props.visible;\n\n    if (!shouldDrawLayer) {\n      return false;\n    }\n\n    drawContext.layer = layer;\n\n    if (layerFilter && !layerFilter(drawContext)) {\n      return false;\n    }\n\n    let parent = layer.parent;\n\n    while (parent) {\n      if (!parent.filterSubLayer(drawContext)) {\n        return false;\n      }\n\n      drawContext.layer = parent;\n      parent = parent.parent;\n    }\n\n    layer.activateViewport(drawContext.viewport);\n    return true;\n  }\n\n  _getModuleParameters(layer, effects, pass, overrides) {\n    const moduleParameters = Object.assign(Object.create(layer.props), {\n      autoWrapLongitude: layer.wrapLongitude,\n      viewport: layer.context.viewport,\n      mousePosition: layer.context.mousePosition,\n      pickingActive: 0,\n      devicePixelRatio: cssToDeviceRatio(this.gl)\n    });\n\n    if (effects) {\n      for (const effect of effects) {\n        Object.assign(moduleParameters, effect.getModuleParameters(layer));\n      }\n    }\n\n    return Object.assign(moduleParameters, this.getModuleParameters(layer, effects), overrides);\n  }\n\n}\nexport function layerIndexResolver(startIndex = 0, layerIndices = {}) {\n  const resolvers = {};\n\n  const resolveLayerIndex = (layer, isDrawn) => {\n    const indexOverride = layer.props._offset;\n    const layerId = layer.id;\n    const parentId = layer.parent && layer.parent.id;\n    let index;\n\n    if (parentId && !(parentId in layerIndices)) {\n      resolveLayerIndex(layer.parent, false);\n    }\n\n    if (parentId in resolvers) {\n      const resolver = resolvers[parentId] = resolvers[parentId] || layerIndexResolver(layerIndices[parentId], layerIndices);\n      index = resolver(layer, isDrawn);\n      resolvers[layerId] = resolver;\n    } else if (Number.isFinite(indexOverride)) {\n      index = indexOverride + (layerIndices[parentId] || 0);\n      resolvers[layerId] = null;\n    } else {\n      index = startIndex;\n    }\n\n    if (isDrawn && index >= startIndex) {\n      startIndex = index + 1;\n    }\n\n    layerIndices[layerId] = index;\n    return index;\n  };\n\n  return resolveLayerIndex;\n}\n\nfunction getGLViewport(gl, {\n  viewport\n}) {\n  const height = gl.canvas ? gl.canvas.clientHeight || gl.canvas.height : 100;\n  const dimensions = viewport;\n  const pixelRatio = cssToDeviceRatio(gl);\n  return [dimensions.x * pixelRatio, (height - dimensions.y - dimensions.height) * pixelRatio, dimensions.width * pixelRatio, dimensions.height * pixelRatio];\n}\n\nfunction clearGLCanvas(gl) {\n  const width = gl.drawingBufferWidth;\n  const height = gl.drawingBufferHeight;\n  setParameters(gl, {\n    viewport: [0, 0, width, height]\n  });\n  gl.clear(16384 | 256);\n}\n//# sourceMappingURL=layers-pass.js.map","export default class Pass {\n  constructor(gl, props = {}) {\n    const {\n      id = 'pass'\n    } = props;\n    this.id = id;\n    this.gl = gl;\n    this.props = { ...props\n    };\n  }\n\n  setProps(props) {\n    Object.assign(this.props, props);\n  }\n\n  render() {}\n\n  cleanup() {}\n\n}\n//# sourceMappingURL=pass.js.map","import { default as LayersPass } from './layers-pass';\nimport { Framebuffer, Texture2D, Renderbuffer, withParameters, cssToDeviceRatio } from '@luma.gl/core';\nexport default class ShadowPass extends LayersPass {\n  constructor(gl, props) {\n    super(gl, props);\n    this.shadowMap = new Texture2D(gl, {\n      width: 1,\n      height: 1,\n      parameters: {\n        [10241]: 9729,\n        [10240]: 9729,\n        [10242]: 33071,\n        [10243]: 33071\n      }\n    });\n    this.depthBuffer = new Renderbuffer(gl, {\n      format: 33189,\n      width: 1,\n      height: 1\n    });\n    this.fbo = new Framebuffer(gl, {\n      id: 'shadowmap',\n      width: 1,\n      height: 1,\n      attachments: {\n        [36064]: this.shadowMap,\n        [36096]: this.depthBuffer\n      }\n    });\n  }\n\n  render(params) {\n    const target = this.fbo;\n    withParameters(this.gl, {\n      depthRange: [0, 1],\n      depthTest: true,\n      blend: false,\n      clearColor: [1, 1, 1, 1]\n    }, () => {\n      const viewport = params.viewports[0];\n      const pixelRatio = cssToDeviceRatio(this.gl);\n      const width = viewport.width * pixelRatio;\n      const height = viewport.height * pixelRatio;\n\n      if (width !== target.width || height !== target.height) {\n        target.resize({\n          width,\n          height\n        });\n      }\n\n      super.render({ ...params,\n        target,\n        pass: 'shadow'\n      });\n    });\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.shadowEnabled !== false;\n  }\n\n  getModuleParameters() {\n    return {\n      drawToShadowMap: true\n    };\n  }\n\n  delete() {\n    if (this.fbo) {\n      this.fbo.delete();\n      this.fbo = null;\n    }\n\n    if (this.shadowMap) {\n      this.shadowMap.delete();\n      this.shadowMap = null;\n    }\n\n    if (this.depthBuffer) {\n      this.depthBuffer.delete();\n      this.depthBuffer = null;\n    }\n  }\n\n}\n//# sourceMappingURL=shadow-pass.js.map","import { Texture2D, ProgramManager } from '@luma.gl/core';\nimport { AmbientLight } from './ambient-light';\nimport { DirectionalLight } from './directional-light';\nimport Effect from '../../lib/effect';\nimport { Matrix4, Vector3 } from 'math.gl';\nimport ShadowPass from '../../passes/shadow-pass';\nimport { default as shadow } from '../../shaderlib/shadow/shadow';\nconst DEFAULT_AMBIENT_LIGHT_PROPS = {\n  color: [255, 255, 255],\n  intensity: 1.0\n};\nconst DEFAULT_DIRECTIONAL_LIGHT_PROPS = [{\n  color: [255, 255, 255],\n  intensity: 1.0,\n  direction: [-1, 3, -1]\n}, {\n  color: [255, 255, 255],\n  intensity: 0.9,\n  direction: [1, -8, -2.5]\n}];\nconst DEFAULT_SHADOW_COLOR = [0, 0, 0, 200 / 255];\nexport default class LightingEffect extends Effect {\n  constructor(props) {\n    super(props);\n    this.ambientLight = null;\n    this.directionalLights = [];\n    this.pointLights = [];\n    this.shadowColor = DEFAULT_SHADOW_COLOR;\n    this.shadowPasses = [];\n    this.shadowMaps = [];\n    this.dummyShadowMap = null;\n    this.shadow = false;\n    this.programManager = null;\n\n    for (const key in props) {\n      const lightSource = props[key];\n\n      switch (lightSource.type) {\n        case 'ambient':\n          this.ambientLight = lightSource;\n          break;\n\n        case 'directional':\n          this.directionalLights.push(lightSource);\n          break;\n\n        case 'point':\n          this.pointLights.push(lightSource);\n          break;\n\n        default:\n      }\n    }\n\n    this._applyDefaultLights();\n\n    this.shadow = this.directionalLights.some(light => light.shadow);\n  }\n\n  preRender(gl, {\n    layers,\n    layerFilter,\n    viewports,\n    onViewportActive,\n    views\n  }) {\n    if (!this.shadow) return;\n    this.shadowMatrices = this._createLightMatrix();\n\n    if (this.shadowPasses.length === 0) {\n      this._createShadowPasses(gl);\n    }\n\n    if (!this.programManager) {\n      this.programManager = ProgramManager.getDefaultProgramManager(gl);\n\n      if (shadow) {\n        this.programManager.addDefaultModule(shadow);\n      }\n    }\n\n    if (!this.dummyShadowMap) {\n      this.dummyShadowMap = new Texture2D(gl, {\n        width: 1,\n        height: 1\n      });\n    }\n\n    for (let i = 0; i < this.shadowPasses.length; i++) {\n      const shadowPass = this.shadowPasses[i];\n      shadowPass.render({\n        layers,\n        layerFilter,\n        viewports,\n        onViewportActive,\n        views,\n        moduleParameters: {\n          shadowLightId: i,\n          dummyShadowMap: this.dummyShadowMap,\n          shadowMatrices: this.shadowMatrices\n        }\n      });\n    }\n  }\n\n  getModuleParameters(layer) {\n    const parameters = this.shadow ? {\n      shadowMaps: this.shadowMaps,\n      dummyShadowMap: this.dummyShadowMap,\n      shadowColor: this.shadowColor,\n      shadowMatrices: this.shadowMatrices\n    } : {};\n    parameters.lightSources = {\n      ambientLight: this.ambientLight,\n      directionalLights: this.directionalLights.map(directionalLight => directionalLight.getProjectedLight({\n        layer\n      })),\n      pointLights: this.pointLights.map(pointLight => pointLight.getProjectedLight({\n        layer\n      }))\n    };\n    return parameters;\n  }\n\n  cleanup() {\n    for (const shadowPass of this.shadowPasses) {\n      shadowPass.delete();\n    }\n\n    this.shadowPasses.length = 0;\n    this.shadowMaps.length = 0;\n\n    if (this.dummyShadowMap) {\n      this.dummyShadowMap.delete();\n      this.dummyShadowMap = null;\n    }\n\n    if (this.shadow && this.programManager) {\n      this.programManager.removeDefaultModule(shadow);\n      this.programManager = null;\n    }\n  }\n\n  _createLightMatrix() {\n    const lightMatrices = [];\n\n    for (const light of this.directionalLights) {\n      const viewMatrix = new Matrix4().lookAt({\n        eye: new Vector3(light.direction).negate()\n      });\n      lightMatrices.push(viewMatrix);\n    }\n\n    return lightMatrices;\n  }\n\n  _createShadowPasses(gl) {\n    for (let i = 0; i < this.directionalLights.length; i++) {\n      const shadowPass = new ShadowPass(gl);\n      this.shadowPasses[i] = shadowPass;\n      this.shadowMaps[i] = shadowPass.shadowMap;\n    }\n  }\n\n  _applyDefaultLights() {\n    const {\n      ambientLight,\n      pointLights,\n      directionalLights\n    } = this;\n\n    if (!ambientLight && pointLights.length === 0 && directionalLights.length === 0) {\n      this.ambientLight = new AmbientLight(DEFAULT_AMBIENT_LIGHT_PROPS);\n      this.directionalLights.push(new DirectionalLight(DEFAULT_DIRECTIONAL_LIGHT_PROPS[0]), new DirectionalLight(DEFAULT_DIRECTIONAL_LIGHT_PROPS[1]));\n    }\n  }\n\n}\n//# sourceMappingURL=lighting-effect.js.map","export class TypedArrayManager {\n  constructor(props) {\n    this._pool = [];\n    this.props = {\n      overAlloc: 2,\n      poolSize: 100\n    };\n    this.setProps(props);\n  }\n\n  setProps(props) {\n    Object.assign(this.props, props);\n  }\n\n  allocate(typedArray, count, {\n    size = 1,\n    type,\n    padding = 0,\n    copy = false,\n    initialize = false,\n    maxCount\n  }) {\n    const Type = type || typedArray && typedArray.constructor || Float32Array;\n    const newSize = count * size + padding;\n\n    if (ArrayBuffer.isView(typedArray)) {\n      if (newSize <= typedArray.length) {\n        return typedArray;\n      }\n\n      if (newSize * typedArray.BYTES_PER_ELEMENT <= typedArray.buffer.byteLength) {\n        return new Type(typedArray.buffer, 0, newSize);\n      }\n    }\n\n    let maxSize;\n\n    if (maxCount) {\n      maxSize = maxCount * size + padding;\n    }\n\n    const newArray = this._allocate(Type, newSize, initialize, maxSize);\n\n    if (typedArray && copy) {\n      newArray.set(typedArray);\n    } else if (!initialize) {\n      newArray.fill(0, 0, 4);\n    }\n\n    this._release(typedArray);\n\n    return newArray;\n  }\n\n  release(typedArray) {\n    this._release(typedArray);\n  }\n\n  _allocate(Type, size, initialize, maxSize) {\n    let sizeToAllocate = Math.max(Math.ceil(size * this.props.overAlloc), 1);\n\n    if (sizeToAllocate > maxSize) {\n      sizeToAllocate = maxSize;\n    }\n\n    const pool = this._pool;\n    const byteLength = Type.BYTES_PER_ELEMENT * sizeToAllocate;\n    const i = pool.findIndex(b => b.byteLength >= byteLength);\n\n    if (i >= 0) {\n      const array = new Type(pool.splice(i, 1)[0], 0, sizeToAllocate);\n\n      if (initialize) {\n        array.fill(0);\n      }\n\n      return array;\n    }\n\n    return new Type(sizeToAllocate);\n  }\n\n  _release(typedArray) {\n    if (!ArrayBuffer.isView(typedArray)) {\n      return;\n    }\n\n    const pool = this._pool;\n    const {\n      buffer\n    } = typedArray;\n    const {\n      byteLength\n    } = buffer;\n    const i = pool.findIndex(b => b.byteLength >= byteLength);\n\n    if (i < 0) {\n      pool.push(buffer);\n    } else if (i > 0 || pool.length < this.props.poolSize) {\n      pool.splice(i, 0, buffer);\n    }\n\n    if (pool.length > this.props.poolSize) {\n      pool.shift();\n    }\n  }\n\n}\nexport default new TypedArrayManager();\n//# sourceMappingURL=typed-array-manager.js.map","import typedArrayManager from './typed-array-manager';\nimport { Vector3 } from 'math.gl';\nexport function createMat4() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\nexport function mod(value, divisor) {\n  const modulus = value % divisor;\n  return modulus < 0 ? divisor + modulus : modulus;\n}\nexport function getCameraPosition(viewMatrixInverse) {\n  return [viewMatrixInverse[12], viewMatrixInverse[13], viewMatrixInverse[14]];\n}\nexport function getFrustumPlanes(viewProjectionMatrix) {\n  const planes = {};\n  planes.left = getFrustumPlane(viewProjectionMatrix[3] + viewProjectionMatrix[0], viewProjectionMatrix[7] + viewProjectionMatrix[4], viewProjectionMatrix[11] + viewProjectionMatrix[8], viewProjectionMatrix[15] + viewProjectionMatrix[12]);\n  planes.right = getFrustumPlane(viewProjectionMatrix[3] - viewProjectionMatrix[0], viewProjectionMatrix[7] - viewProjectionMatrix[4], viewProjectionMatrix[11] - viewProjectionMatrix[8], viewProjectionMatrix[15] - viewProjectionMatrix[12]);\n  planes.bottom = getFrustumPlane(viewProjectionMatrix[3] + viewProjectionMatrix[1], viewProjectionMatrix[7] + viewProjectionMatrix[5], viewProjectionMatrix[11] + viewProjectionMatrix[9], viewProjectionMatrix[15] + viewProjectionMatrix[13]);\n  planes.top = getFrustumPlane(viewProjectionMatrix[3] - viewProjectionMatrix[1], viewProjectionMatrix[7] - viewProjectionMatrix[5], viewProjectionMatrix[11] - viewProjectionMatrix[9], viewProjectionMatrix[15] - viewProjectionMatrix[13]);\n  planes.near = getFrustumPlane(viewProjectionMatrix[3] + viewProjectionMatrix[2], viewProjectionMatrix[7] + viewProjectionMatrix[6], viewProjectionMatrix[11] + viewProjectionMatrix[10], viewProjectionMatrix[15] + viewProjectionMatrix[14]);\n  planes.far = getFrustumPlane(viewProjectionMatrix[3] - viewProjectionMatrix[2], viewProjectionMatrix[7] - viewProjectionMatrix[6], viewProjectionMatrix[11] - viewProjectionMatrix[10], viewProjectionMatrix[15] - viewProjectionMatrix[14]);\n  return planes;\n}\nconst scratchVector = new Vector3();\n\nfunction getFrustumPlane(a, b, c, d) {\n  scratchVector.set(a, b, c);\n  const L = scratchVector.len();\n  return {\n    distance: d / L,\n    normal: new Vector3(-a / L, -b / L, -c / L)\n  };\n}\n\nexport function fp64LowPart(x) {\n  return x - Math.fround(x);\n}\nlet scratchArray;\nexport function toDoublePrecisionArray(typedArray, {\n  size = 1,\n  startIndex = 0,\n  endIndex\n}) {\n  if (!Number.isFinite(endIndex)) {\n    endIndex = typedArray.length;\n  }\n\n  const count = (endIndex - startIndex) / size;\n  scratchArray = typedArrayManager.allocate(scratchArray, count, {\n    type: Float32Array,\n    size: size * 2\n  });\n  let sourceIndex = startIndex;\n  let targetIndex = 0;\n\n  while (sourceIndex < endIndex) {\n    for (let j = 0; j < size; j++) {\n      const value = typedArray[sourceIndex++];\n      scratchArray[targetIndex + j] = value;\n      scratchArray[targetIndex + j + size] = fp64LowPart(value);\n    }\n\n    targetIndex += size * 2;\n  }\n\n  return scratchArray.subarray(0, count * size * 2);\n}\n//# sourceMappingURL=math-utils.js.map","import log from '../utils/log';\nimport { createMat4, getCameraPosition, getFrustumPlanes } from '../utils/math-utils';\nimport { Matrix4, Vector3, equals } from 'math.gl';\nimport * as mat4 from 'gl-matrix/mat4';\nimport { getDistanceScales, getMeterZoom, lngLatToWorld, worldToLngLat, worldToPixels, pixelsToWorld } from '@math.gl/web-mercator';\nimport { PROJECTION_MODE } from '../lib/constants';\nconst DEGREES_TO_RADIANS = Math.PI / 180;\nconst IDENTITY = createMat4();\nconst ZERO_VECTOR = [0, 0, 0];\nconst DEFAULT_ZOOM = 0;\nconst DEFAULT_DISTANCE_SCALES = {\n  unitsPerMeter: [1, 1, 1],\n  metersPerUnit: [1, 1, 1]\n};\nexport default class Viewport {\n  constructor(opts = {}) {\n    const {\n      id = null,\n      x = 0,\n      y = 0,\n      width = 1,\n      height = 1\n    } = opts;\n    this.id = id || this.constructor.displayName || 'viewport';\n    this.x = x;\n    this.y = y;\n    this.width = width || 1;\n    this.height = height || 1;\n    this._frustumPlanes = {};\n\n    this._initViewMatrix(opts);\n\n    this._initProjectionMatrix(opts);\n\n    this._initPixelMatrices();\n\n    this.equals = this.equals.bind(this);\n    this.project = this.project.bind(this);\n    this.unproject = this.unproject.bind(this);\n    this.projectPosition = this.projectPosition.bind(this);\n    this.unprojectPosition = this.unprojectPosition.bind(this);\n    this.projectFlat = this.projectFlat.bind(this);\n    this.unprojectFlat = this.unprojectFlat.bind(this);\n  }\n\n  get metersPerPixel() {\n    return this.distanceScales.metersPerUnit[2] / this.scale;\n  }\n\n  get projectionMode() {\n    if (this.isGeospatial) {\n      return this.zoom < 12 ? PROJECTION_MODE.WEB_MERCATOR : PROJECTION_MODE.WEB_MERCATOR_AUTO_OFFSET;\n    }\n\n    return PROJECTION_MODE.IDENTITY;\n  }\n\n  equals(viewport) {\n    if (!(viewport instanceof Viewport)) {\n      return false;\n    }\n\n    if (this === viewport) {\n      return true;\n    }\n\n    return viewport.width === this.width && viewport.height === this.height && viewport.scale === this.scale && equals(viewport.projectionMatrix, this.projectionMatrix) && equals(viewport.viewMatrix, this.viewMatrix);\n  }\n\n  project(xyz, {\n    topLeft = true\n  } = {}) {\n    const worldPosition = this.projectPosition(xyz);\n    const coord = worldToPixels(worldPosition, this.pixelProjectionMatrix);\n    const [x, y] = coord;\n    const y2 = topLeft ? y : this.height - y;\n    return xyz.length === 2 ? [x, y2] : [x, y2, coord[2]];\n  }\n\n  unproject(xyz, {\n    topLeft = true,\n    targetZ\n  } = {}) {\n    const [x, y, z] = xyz;\n    const y2 = topLeft ? y : this.height - y;\n    const targetZWorld = targetZ && targetZ * this.distanceScales.unitsPerMeter[2];\n    const coord = pixelsToWorld([x, y2, z], this.pixelUnprojectionMatrix, targetZWorld);\n    const [X, Y, Z] = this.unprojectPosition(coord);\n\n    if (Number.isFinite(z)) {\n      return [X, Y, Z];\n    }\n\n    return Number.isFinite(targetZ) ? [X, Y, targetZ] : [X, Y];\n  }\n\n  projectPosition(xyz) {\n    const [X, Y] = this.projectFlat(xyz);\n    const Z = (xyz[2] || 0) * this.distanceScales.unitsPerMeter[2];\n    return [X, Y, Z];\n  }\n\n  unprojectPosition(xyz) {\n    const [X, Y] = this.unprojectFlat(xyz);\n    const Z = (xyz[2] || 0) * this.distanceScales.metersPerUnit[2];\n    return [X, Y, Z];\n  }\n\n  projectFlat(xyz) {\n    if (this.isGeospatial) {\n      return lngLatToWorld(xyz);\n    }\n\n    return xyz;\n  }\n\n  unprojectFlat(xyz) {\n    if (this.isGeospatial) {\n      return worldToLngLat(xyz);\n    }\n\n    return xyz;\n  }\n\n  getBounds(options = {}) {\n    const unprojectOption = {\n      targetZ: options.z || 0\n    };\n    const topLeft = this.unproject([0, 0], unprojectOption);\n    const topRight = this.unproject([this.width, 0], unprojectOption);\n    const bottomLeft = this.unproject([0, this.height], unprojectOption);\n    const bottomRight = this.unproject([this.width, this.height], unprojectOption);\n    return [Math.min(topLeft[0], topRight[0], bottomLeft[0], bottomRight[0]), Math.min(topLeft[1], topRight[1], bottomLeft[1], bottomRight[1]), Math.max(topLeft[0], topRight[0], bottomLeft[0], bottomRight[0]), Math.max(topLeft[1], topRight[1], bottomLeft[1], bottomRight[1])];\n  }\n\n  getDistanceScales(coordinateOrigin = null) {\n    if (coordinateOrigin) {\n      return getDistanceScales({\n        longitude: coordinateOrigin[0],\n        latitude: coordinateOrigin[1],\n        highPrecision: true\n      });\n    }\n\n    return this.distanceScales;\n  }\n\n  containsPixel({\n    x,\n    y,\n    width = 1,\n    height = 1\n  }) {\n    return x < this.x + this.width && this.x < x + width && y < this.y + this.height && this.y < y + height;\n  }\n\n  getFrustumPlanes() {\n    if (this._frustumPlanes.near) {\n      return this._frustumPlanes;\n    }\n\n    Object.assign(this._frustumPlanes, getFrustumPlanes(this.viewProjectionMatrix));\n    return this._frustumPlanes;\n  }\n\n  panByPosition(coords, pixel) {\n    return null;\n  }\n\n  getCameraPosition() {\n    return this.cameraPosition;\n  }\n\n  getCameraDirection() {\n    return this.cameraDirection;\n  }\n\n  getCameraUp() {\n    return this.cameraUp;\n  }\n\n  _createProjectionMatrix({\n    orthographic,\n    fovyRadians,\n    aspect,\n    focalDistance,\n    near,\n    far\n  }) {\n    return orthographic ? new Matrix4().orthographic({\n      fovy: fovyRadians,\n      aspect,\n      focalDistance,\n      near,\n      far\n    }) : new Matrix4().perspective({\n      fovy: fovyRadians,\n      aspect,\n      near,\n      far\n    });\n  }\n\n  _initViewMatrix(opts) {\n    const {\n      viewMatrix = IDENTITY,\n      longitude = null,\n      latitude = null,\n      zoom = null,\n      position = null,\n      modelMatrix = null,\n      focalDistance = 1,\n      distanceScales = null\n    } = opts;\n    this.isGeospatial = Number.isFinite(latitude) && Number.isFinite(longitude);\n    this.zoom = zoom;\n\n    if (!Number.isFinite(this.zoom)) {\n      this.zoom = this.isGeospatial ? getMeterZoom({\n        latitude\n      }) + Math.log2(focalDistance) : DEFAULT_ZOOM;\n    }\n\n    const scale = Math.pow(2, this.zoom);\n    this.scale = scale;\n    this.distanceScales = this.isGeospatial ? getDistanceScales({\n      latitude,\n      longitude\n    }) : distanceScales || DEFAULT_DISTANCE_SCALES;\n    this.focalDistance = focalDistance;\n    this.distanceScales.metersPerUnit = new Vector3(this.distanceScales.metersPerUnit);\n    this.distanceScales.unitsPerMeter = new Vector3(this.distanceScales.unitsPerMeter);\n    this.position = ZERO_VECTOR;\n    this.meterOffset = ZERO_VECTOR;\n\n    if (position) {\n      this.position = position;\n      this.modelMatrix = modelMatrix;\n      this.meterOffset = modelMatrix ? modelMatrix.transformVector(position) : position;\n    }\n\n    if (this.isGeospatial) {\n      this.longitude = longitude;\n      this.latitude = latitude;\n      this.center = this._getCenterInWorld({\n        longitude,\n        latitude\n      });\n    } else {\n      this.center = position ? this.projectPosition(position) : [0, 0, 0];\n    }\n\n    this.viewMatrixUncentered = viewMatrix;\n    this.viewMatrix = new Matrix4().multiplyRight(this.viewMatrixUncentered).translate(new Vector3(this.center || ZERO_VECTOR).negate());\n  }\n\n  _getCenterInWorld({\n    longitude,\n    latitude\n  }) {\n    const {\n      meterOffset,\n      distanceScales\n    } = this;\n    const center = new Vector3(this.projectPosition([longitude, latitude, 0]));\n\n    if (meterOffset) {\n      const commonPosition = new Vector3(meterOffset).scale(distanceScales.unitsPerMeter);\n      center.add(commonPosition);\n    }\n\n    return center;\n  }\n\n  _initProjectionMatrix(opts) {\n    const {\n      projectionMatrix = null,\n      orthographic = false,\n      fovyRadians,\n      fovy = 75,\n      near = 0.1,\n      far = 1000,\n      focalDistance = 1\n    } = opts;\n    this.projectionMatrix = projectionMatrix || this._createProjectionMatrix({\n      orthographic,\n      fovyRadians: fovyRadians || fovy * DEGREES_TO_RADIANS,\n      aspect: this.width / this.height,\n      focalDistance,\n      near,\n      far\n    });\n  }\n\n  _initPixelMatrices() {\n    const vpm = createMat4();\n    mat4.multiply(vpm, vpm, this.projectionMatrix);\n    mat4.multiply(vpm, vpm, this.viewMatrix);\n    this.viewProjectionMatrix = vpm;\n    this.viewMatrixInverse = mat4.invert([], this.viewMatrix) || this.viewMatrix;\n    this.cameraPosition = getCameraPosition(this.viewMatrixInverse);\n    const viewportMatrix = createMat4();\n    const pixelProjectionMatrix = createMat4();\n    mat4.scale(viewportMatrix, viewportMatrix, [this.width / 2, -this.height / 2, 1]);\n    mat4.translate(viewportMatrix, viewportMatrix, [1, -1, 0]);\n    mat4.multiply(pixelProjectionMatrix, viewportMatrix, this.viewProjectionMatrix);\n    this.pixelProjectionMatrix = pixelProjectionMatrix;\n    this.viewportMatrix = viewportMatrix;\n    this.pixelUnprojectionMatrix = mat4.invert(createMat4(), this.pixelProjectionMatrix);\n\n    if (!this.pixelUnprojectionMatrix) {\n      log.warn('Pixel project matrix not invertible')();\n    }\n  }\n\n}\nViewport.displayName = 'Viewport';\n//# sourceMappingURL=viewport.js.map","import Viewport from './viewport';\nimport { pixelsToWorld, getViewMatrix, addMetersToLngLat, getProjectionParameters, fitBounds, getBounds } from '@math.gl/web-mercator';\nimport * as vec2 from 'gl-matrix/vec2';\nimport { Matrix4 } from 'math.gl';\nexport default class WebMercatorViewport extends Viewport {\n  constructor(opts = {}) {\n    const {\n      latitude = 0,\n      longitude = 0,\n      zoom = 11,\n      pitch = 0,\n      bearing = 0,\n      nearZMultiplier = 0.1,\n      farZMultiplier = 1.01,\n      orthographic = false,\n      repeat = false,\n      worldOffset = 0\n    } = opts;\n    let {\n      width,\n      height,\n      altitude = 1.5\n    } = opts;\n    const scale = Math.pow(2, zoom);\n    width = width || 1;\n    height = height || 1;\n    altitude = Math.max(0.75, altitude);\n    const {\n      fov,\n      aspect,\n      focalDistance,\n      near,\n      far\n    } = getProjectionParameters({\n      width,\n      height,\n      pitch,\n      altitude,\n      nearZMultiplier,\n      farZMultiplier\n    });\n    let viewMatrixUncentered = getViewMatrix({\n      height,\n      pitch,\n      bearing,\n      scale,\n      altitude\n    });\n\n    if (worldOffset) {\n      const viewOffset = new Matrix4().translate([512 * worldOffset, 0, 0]);\n      viewMatrixUncentered = viewOffset.multiplyLeft(viewMatrixUncentered);\n    }\n\n    super({ ...opts,\n      width,\n      height,\n      viewMatrix: viewMatrixUncentered,\n      longitude,\n      latitude,\n      zoom,\n      orthographic,\n      fovyRadians: fov,\n      aspect,\n      focalDistance,\n      near,\n      far\n    });\n    this.latitude = latitude;\n    this.longitude = longitude;\n    this.zoom = zoom;\n    this.pitch = pitch;\n    this.bearing = bearing;\n    this.altitude = altitude;\n    this.orthographic = orthographic;\n    this._subViewports = repeat ? [] : null;\n    Object.freeze(this);\n  }\n\n  get subViewports() {\n    if (this._subViewports && !this._subViewports.length) {\n      const bounds = this.getBounds();\n      const minOffset = Math.floor((bounds[0] + 180) / 360);\n      const maxOffset = Math.ceil((bounds[2] - 180) / 360);\n\n      for (let x = minOffset; x <= maxOffset; x++) {\n        const offsetViewport = x ? new WebMercatorViewport({ ...this,\n          worldOffset: x\n        }) : this;\n\n        this._subViewports.push(offsetViewport);\n      }\n    }\n\n    return this._subViewports;\n  }\n\n  addMetersToLngLat(lngLatZ, xyz) {\n    return addMetersToLngLat(lngLatZ, xyz);\n  }\n\n  panByPosition(coords, pixel) {\n    const fromLocation = pixelsToWorld(pixel, this.pixelUnprojectionMatrix);\n    const toLocation = this.projectFlat(coords);\n    const translate = vec2.add([], toLocation, vec2.negate([], fromLocation));\n    const newCenter = vec2.add([], this.center, translate);\n    const [longitude, latitude] = this.unprojectFlat(newCenter);\n    return {\n      longitude,\n      latitude\n    };\n  }\n\n  getBounds(options = {}) {\n    const corners = getBounds(this, options.z || 0);\n    return [Math.min(corners[0][0], corners[1][0], corners[2][0], corners[3][0]), Math.min(corners[0][1], corners[1][1], corners[2][1], corners[3][1]), Math.max(corners[0][0], corners[1][0], corners[2][0], corners[3][0]), Math.max(corners[0][1], corners[1][1], corners[2][1], corners[3][1])];\n  }\n\n  fitBounds(bounds, options = {}) {\n    const {\n      width,\n      height\n    } = this;\n    const {\n      longitude,\n      latitude,\n      zoom\n    } = fitBounds({\n      width,\n      height,\n      bounds,\n      ...options\n    });\n    return new WebMercatorViewport({\n      width,\n      height,\n      longitude,\n      latitude,\n      zoom\n    });\n  }\n\n}\nWebMercatorViewport.displayName = 'WebMercatorViewport';\n//# sourceMappingURL=web-mercator-viewport.js.map","import { COORDINATE_SYSTEM } from '../../lib/constants';\nimport { getOffsetOrigin } from './viewport-uniforms';\nimport WebMercatorViewport from '../../viewports/web-mercator-viewport';\nimport * as vec4 from 'gl-matrix/vec4';\nimport * as vec3 from 'gl-matrix/vec3';\nimport { addMetersToLngLat } from '@math.gl/web-mercator';\n\nfunction lngLatZToWorldPosition(lngLatZ, viewport, offsetMode = false) {\n  const p = viewport.projectPosition(lngLatZ);\n\n  if (offsetMode && viewport instanceof WebMercatorViewport) {\n    const [longitude, latitude, z = 0] = lngLatZ;\n    const distanceScales = viewport.getDistanceScales([longitude, latitude]);\n    p[2] = z * distanceScales.unitsPerMeter[2];\n  }\n\n  return p;\n}\n\nfunction normalizeParameters(opts) {\n  const normalizedParams = { ...opts\n  };\n  let {\n    coordinateSystem\n  } = opts;\n  const {\n    viewport,\n    coordinateOrigin,\n    fromCoordinateSystem,\n    fromCoordinateOrigin\n  } = opts;\n\n  if (coordinateSystem === COORDINATE_SYSTEM.DEFAULT) {\n    coordinateSystem = viewport.isGeospatial ? COORDINATE_SYSTEM.LNGLAT : COORDINATE_SYSTEM.CARTESIAN;\n  }\n\n  if (fromCoordinateSystem === undefined) {\n    normalizedParams.fromCoordinateSystem = coordinateSystem;\n  }\n\n  if (fromCoordinateOrigin === undefined) {\n    normalizedParams.fromCoordinateOrigin = coordinateOrigin;\n  }\n\n  normalizedParams.coordinateSystem = coordinateSystem;\n  return normalizedParams;\n}\n\nexport function getWorldPosition(position, {\n  viewport,\n  modelMatrix,\n  coordinateSystem,\n  coordinateOrigin,\n  offsetMode\n}) {\n  let [x, y, z = 0] = position;\n\n  if (modelMatrix) {\n    [x, y, z] = vec4.transformMat4([], [x, y, z, 1.0], modelMatrix);\n  }\n\n  switch (coordinateSystem) {\n    case COORDINATE_SYSTEM.LNGLAT:\n      return lngLatZToWorldPosition([x, y, z], viewport, offsetMode);\n\n    case COORDINATE_SYSTEM.LNGLAT_OFFSETS:\n      return lngLatZToWorldPosition([x + coordinateOrigin[0], y + coordinateOrigin[1], z + (coordinateOrigin[2] || 0)], viewport, offsetMode);\n\n    case COORDINATE_SYSTEM.METER_OFFSETS:\n      return lngLatZToWorldPosition(addMetersToLngLat(coordinateOrigin, [x, y, z]), viewport, offsetMode);\n\n    case COORDINATE_SYSTEM.CARTESIAN:\n    default:\n      return viewport.isGeospatial ? [x + coordinateOrigin[0], y + coordinateOrigin[1], z + coordinateOrigin[2]] : viewport.projectPosition([x, y, z]);\n  }\n}\nexport function projectPosition(position, params) {\n  const {\n    viewport,\n    coordinateSystem,\n    coordinateOrigin,\n    modelMatrix,\n    fromCoordinateSystem,\n    fromCoordinateOrigin\n  } = normalizeParameters(params);\n  const {\n    geospatialOrigin,\n    shaderCoordinateOrigin,\n    offsetMode\n  } = getOffsetOrigin(viewport, coordinateSystem, coordinateOrigin);\n  const worldPosition = getWorldPosition(position, {\n    viewport,\n    modelMatrix,\n    coordinateSystem: fromCoordinateSystem,\n    coordinateOrigin: fromCoordinateOrigin,\n    offsetMode\n  });\n\n  if (offsetMode) {\n    const positionCommonSpace = viewport.projectPosition(geospatialOrigin || shaderCoordinateOrigin);\n    vec3.sub(worldPosition, worldPosition, positionCommonSpace);\n  }\n\n  return worldPosition;\n}\n//# sourceMappingURL=project-functions.js.map","export const LIFECYCLE = {\n  NO_STATE: 'Awaiting state',\n  MATCHED: 'Matched. State transferred from previous layer',\n  INITIALIZED: 'Initialized',\n  AWAITING_GC: 'Discarded. Awaiting garbage collection',\n  AWAITING_FINALIZATION: 'No longer matched. Awaiting garbage collection',\n  FINALIZED: 'Finalized! Awaiting garbage collection'\n};\nexport const PROP_SYMBOLS = {\n  COMPONENT: Symbol.for('component'),\n  ASYNC_DEFAULTS: Symbol.for('asyncPropDefaults'),\n  ASYNC_ORIGINAL: Symbol.for('asyncPropOriginal'),\n  ASYNC_RESOLVED: Symbol.for('asyncPropResolved')\n};\n//# sourceMappingURL=constants.js.map","export function flatten(array, filter = () => true) {\n  if (!Array.isArray(array)) {\n    return filter(array) ? [array] : [];\n  }\n\n  return flattenArray(array, filter, []);\n}\n\nfunction flattenArray(array, filter, result) {\n  let index = -1;\n\n  while (++index < array.length) {\n    const value = array[index];\n\n    if (Array.isArray(value)) {\n      flattenArray(value, filter, result);\n    } else if (filter(value)) {\n      result.push(value);\n    }\n  }\n\n  return result;\n}\n\nexport function fillArray({\n  target,\n  source,\n  start = 0,\n  count = 1\n}) {\n  const length = source.length;\n  const total = count * length;\n  let copied = 0;\n\n  for (let i = start; copied < length; copied++) {\n    target[i++] = source[copied];\n  }\n\n  while (copied < total) {\n    if (copied < total - copied) {\n      target.copyWithin(start + copied, start, start + copied);\n      copied *= 2;\n    } else {\n      target.copyWithin(start + copied, start, start + total - copied);\n      copied = total;\n    }\n  }\n\n  return target;\n}\n//# sourceMappingURL=flatten.js.map","import { load } from '@loaders.gl/core';\nexport default class Resource {\n  constructor(id, data, context) {\n    this.id = id;\n    this.context = context;\n    this._loadCount = 0;\n    this._subscribers = new Set();\n    this.setData(data);\n  }\n\n  subscribe(consumer) {\n    this._subscribers.add(consumer);\n  }\n\n  unsubscribe(consumer) {\n    this._subscribers.delete(consumer);\n  }\n\n  inUse() {\n    return this._subscribers.size > 0;\n  }\n\n  delete() {}\n\n  getData() {\n    return this.isLoaded ? this._error ? Promise.reject(this._error) : this._content : this._loader.then(() => this.getData());\n  }\n\n  setData(data, forceUpdate) {\n    if (data === this._data && !forceUpdate) {\n      return;\n    }\n\n    this._data = data;\n    const loadCount = ++this._loadCount;\n    let loader = data;\n\n    if (typeof data === 'string') {\n      loader = load(data);\n    }\n\n    if (loader instanceof Promise) {\n      this.isLoaded = false;\n      this._loader = loader.then(result => {\n        if (this._loadCount === loadCount) {\n          this.isLoaded = true;\n          this._error = null;\n          this._content = result;\n        }\n      }).catch(error => {\n        if (this._loadCount === loadCount) {\n          this.isLoaded = true;\n          this._error = error || true;\n        }\n      });\n    } else {\n      this.isLoaded = true;\n      this._error = null;\n      this._content = data;\n    }\n\n    for (const subscriber of this._subscribers) {\n      subscriber.onChange(this.getData());\n    }\n  }\n\n}\n//# sourceMappingURL=resource.js.map","import Resource from './resource';\nexport default class ResourceManager {\n  constructor({\n    gl,\n    protocol\n  }) {\n    this.protocol = protocol || 'resource://';\n    this._context = {\n      gl,\n      resourceManager: this\n    };\n    this._resources = {};\n    this._consumers = {};\n    this._pruneRequest = null;\n  }\n\n  contains(resourceId) {\n    if (resourceId.startsWith(this.protocol)) {\n      return true;\n    }\n\n    return resourceId in this._resources;\n  }\n\n  add({\n    resourceId,\n    data,\n    forceUpdate = false,\n    persistent = true\n  }) {\n    let res = this._resources[resourceId];\n\n    if (res) {\n      res.setData(data, forceUpdate);\n    } else {\n      res = new Resource(resourceId, data, this._context);\n      this._resources[resourceId] = res;\n    }\n\n    res.persistent = persistent;\n  }\n\n  remove(resourceId) {\n    const res = this._resources[resourceId];\n\n    if (res) {\n      res.delete();\n      delete this._resources[resourceId];\n    }\n  }\n\n  unsubscribe({\n    consumerId\n  }) {\n    const consumer = this._consumers[consumerId];\n\n    if (consumer) {\n      for (const requestId in consumer) {\n        const request = consumer[requestId];\n\n        if (request.resource) {\n          request.resource.unsubscribe(request);\n        }\n      }\n\n      delete this._consumers[consumerId];\n      this.prune();\n    }\n  }\n\n  subscribe({\n    resourceId,\n    onChange,\n    consumerId,\n    requestId = 'default'\n  }) {\n    const {\n      _resources: resources,\n      protocol\n    } = this;\n\n    if (resourceId.startsWith(protocol)) {\n      resourceId = resourceId.replace(protocol, '');\n\n      if (!resources[resourceId]) {\n        this.add({\n          resourceId,\n          data: null,\n          persistent: false\n        });\n      }\n    }\n\n    const res = resources[resourceId];\n\n    this._track(consumerId, requestId, res, onChange);\n\n    if (res) {\n      return res.getData();\n    }\n\n    return undefined;\n  }\n\n  prune() {\n    if (!this._pruneRequest) {\n      this._pruneRequest = setTimeout(() => this._prune(), 0);\n    }\n  }\n\n  finalize() {\n    for (const key in this._resources) {\n      this._resources[key].delete();\n    }\n  }\n\n  _track(consumerId, requestId, resource, onChange) {\n    const consumers = this._consumers;\n    const consumer = consumers[consumerId] = consumers[consumerId] || {};\n    const request = consumer[requestId] || {};\n\n    if (request.resource) {\n      request.resource.unsubscribe(request);\n      request.resource = null;\n      this.prune();\n    }\n\n    if (resource) {\n      consumer[requestId] = request;\n      request.onChange = onChange;\n      request.resource = resource;\n      resource.subscribe(request);\n    }\n  }\n\n  _prune() {\n    this._pruneRequest = null;\n\n    for (const key of Object.keys(this._resources)) {\n      const res = this._resources[key];\n\n      if (!res.persistent && !res.inUse()) {\n        res.delete();\n        delete this._resources[key];\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=resource-manager.js.map","import { Timeline } from '@luma.gl/core';\nimport { LIFECYCLE } from '../lifecycle/constants';\nimport log from '../utils/log';\nimport debug from '../debug';\nimport { flatten } from '../utils/flatten';\nimport { Stats } from 'probe.gl';\nimport ResourceManager from './resource/resource-manager';\nimport Viewport from '../viewports/viewport';\nimport { createProgramManager } from '../shaderlib';\nconst TRACE_SET_LAYERS = 'layerManager.setLayers';\nconst TRACE_ACTIVATE_VIEWPORT = 'layerManager.activateViewport';\nconst INITIAL_CONTEXT = Object.seal({\n  layerManager: null,\n  resourceManager: null,\n  deck: null,\n  gl: null,\n  stats: null,\n  shaderCache: null,\n  pickingFBO: null,\n  mousePosition: null,\n  userData: {}\n});\nexport default class LayerManager {\n  constructor(gl, {\n    deck,\n    stats,\n    viewport,\n    timeline\n  } = {}) {\n    this.lastRenderedLayers = [];\n    this.layers = [];\n    this.resourceManager = new ResourceManager({\n      gl,\n      protocol: 'deck://'\n    });\n    this.context = { ...INITIAL_CONTEXT,\n      layerManager: this,\n      gl,\n      deck,\n      programManager: gl && createProgramManager(gl),\n      stats: stats || new Stats({\n        id: 'deck.gl'\n      }),\n      viewport: viewport || new Viewport({\n        id: 'DEFAULT-INITIAL-VIEWPORT'\n      }),\n      timeline: timeline || new Timeline(),\n      resourceManager: this.resourceManager\n    };\n    this._nextLayers = null;\n    this._needsRedraw = 'Initial render';\n    this._needsUpdate = false;\n    this._debug = false;\n    this.activateViewport = this.activateViewport.bind(this);\n    Object.seal(this);\n  }\n\n  finalize() {\n    this.resourceManager.finalize();\n\n    for (const layer of this.layers) {\n      this._finalizeLayer(layer);\n    }\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    let redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    for (const layer of this.layers) {\n      const layerNeedsRedraw = layer.getNeedsRedraw(opts);\n      redraw = redraw || layerNeedsRedraw;\n    }\n\n    return redraw;\n  }\n\n  needsUpdate() {\n    if (this._nextLayers && this._nextLayers !== this.lastRenderedLayers) {\n      return 'layers changed';\n    }\n\n    return this._needsUpdate;\n  }\n\n  setNeedsRedraw(reason) {\n    this._needsRedraw = this._needsRedraw || reason;\n  }\n\n  setNeedsUpdate(reason) {\n    this._needsUpdate = this._needsUpdate || reason;\n  }\n\n  getLayers({\n    layerIds = null\n  } = {}) {\n    return layerIds ? this.layers.filter(layer => layerIds.find(layerId => layer.id.indexOf(layerId) === 0)) : this.layers;\n  }\n\n  setProps(props) {\n    if ('debug' in props) {\n      this._debug = props.debug;\n    }\n\n    if ('userData' in props) {\n      this.context.userData = props.userData;\n    }\n\n    if ('layers' in props) {\n      this._nextLayers = props.layers;\n    }\n\n    if ('onError' in props) {\n      this.context.onError = props.onError;\n    }\n  }\n\n  setLayers(newLayers, reason) {\n    debug(TRACE_SET_LAYERS, this, reason, newLayers);\n    this.lastRenderedLayers = newLayers;\n    newLayers = flatten(newLayers, Boolean);\n\n    for (const layer of newLayers) {\n      layer.context = this.context;\n    }\n\n    this._updateLayers(this.layers, newLayers);\n\n    return this;\n  }\n\n  updateLayers() {\n    const reason = this.needsUpdate();\n\n    if (reason) {\n      this.setNeedsRedraw(\"updating layers: \".concat(reason));\n      this.setLayers(this._nextLayers || this.lastRenderedLayers, reason);\n    }\n\n    this._nextLayers = null;\n  }\n\n  activateViewport(viewport) {\n    debug(TRACE_ACTIVATE_VIEWPORT, this, viewport);\n\n    if (viewport) {\n      this.context.viewport = viewport;\n    }\n\n    return this;\n  }\n\n  _handleError(stage, error, layer) {\n    layer.raiseError(error, \"\".concat(stage, \" of \").concat(layer));\n  }\n\n  _updateLayers(oldLayers, newLayers) {\n    const oldLayerMap = {};\n\n    for (const oldLayer of oldLayers) {\n      if (oldLayerMap[oldLayer.id]) {\n        log.warn(\"Multiple old layers with same id \".concat(oldLayer.id))();\n      } else {\n        oldLayerMap[oldLayer.id] = oldLayer;\n      }\n    }\n\n    const generatedLayers = [];\n\n    this._updateSublayersRecursively(newLayers, oldLayerMap, generatedLayers);\n\n    this._finalizeOldLayers(oldLayerMap);\n\n    let needsUpdate = false;\n\n    for (const layer of generatedLayers) {\n      if (layer.hasUniformTransition()) {\n        needsUpdate = true;\n        break;\n      }\n    }\n\n    this._needsUpdate = needsUpdate;\n    this.layers = generatedLayers;\n  }\n\n  _updateSublayersRecursively(newLayers, oldLayerMap, generatedLayers) {\n    for (const newLayer of newLayers) {\n      newLayer.context = this.context;\n      const oldLayer = oldLayerMap[newLayer.id];\n\n      if (oldLayer === null) {\n        log.warn(\"Multiple new layers with same id \".concat(newLayer.id))();\n      }\n\n      oldLayerMap[newLayer.id] = null;\n      let sublayers = null;\n\n      try {\n        if (this._debug && oldLayer !== newLayer) {\n          newLayer.validateProps();\n        }\n\n        if (!oldLayer) {\n          this._initializeLayer(newLayer);\n        } else {\n          this._transferLayerState(oldLayer, newLayer);\n\n          this._updateLayer(newLayer);\n        }\n\n        generatedLayers.push(newLayer);\n        sublayers = newLayer.isComposite && newLayer.getSubLayers();\n      } catch (err) {\n        this._handleError('matching', err, newLayer);\n      }\n\n      if (sublayers) {\n        this._updateSublayersRecursively(sublayers, oldLayerMap, generatedLayers);\n      }\n    }\n  }\n\n  _finalizeOldLayers(oldLayerMap) {\n    for (const layerId in oldLayerMap) {\n      const layer = oldLayerMap[layerId];\n\n      if (layer) {\n        this._finalizeLayer(layer);\n      }\n    }\n  }\n\n  _initializeLayer(layer) {\n    try {\n      layer._initialize();\n\n      layer.lifecycle = LIFECYCLE.INITIALIZED;\n    } catch (err) {\n      this._handleError('initialization', err, layer);\n    }\n  }\n\n  _transferLayerState(oldLayer, newLayer) {\n    newLayer._transferState(oldLayer);\n\n    newLayer.lifecycle = LIFECYCLE.MATCHED;\n\n    if (newLayer !== oldLayer) {\n      oldLayer.lifecycle = LIFECYCLE.AWAITING_GC;\n    }\n  }\n\n  _updateLayer(layer) {\n    try {\n      layer._update();\n    } catch (err) {\n      this._handleError('update', err, layer);\n    }\n  }\n\n  _finalizeLayer(layer) {\n    this._needsRedraw = this._needsRedraw || \"finalized \".concat(layer);\n    layer.lifecycle = LIFECYCLE.AWAITING_FINALIZATION;\n\n    try {\n      layer._finalize();\n\n      layer.lifecycle = LIFECYCLE.FINALIZED;\n    } catch (err) {\n      this._handleError('finalization', err, layer);\n    }\n  }\n\n}\n//# sourceMappingURL=layer-manager.js.map","export function deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (!a || !b) {\n    return false;\n  }\n\n  for (const key in a) {\n    const aValue = a[key];\n    const bValue = b[key];\n    const equals = aValue === bValue || Array.isArray(aValue) && Array.isArray(bValue) && deepEqual(aValue, bValue);\n\n    if (!equals) {\n      return false;\n    }\n  }\n\n  return true;\n}\n//# sourceMappingURL=deep-equal.js.map","import { deepEqual } from '../utils/deep-equal';\nimport log from '../utils/log';\nimport { flatten } from '../utils/flatten';\nexport default class ViewManager {\n  constructor(props = {}) {\n    this.views = [];\n    this.width = 100;\n    this.height = 100;\n    this.viewState = {};\n    this.controllers = {};\n    this.timeline = props.timeline;\n    this._viewports = [];\n    this._viewportMap = {};\n    this._isUpdating = false;\n    this._needsRedraw = 'Initial render';\n    this._needsUpdate = true;\n    this._eventManager = props.eventManager;\n    this._eventCallbacks = {\n      onViewStateChange: props.onViewStateChange,\n      onInteractionStateChange: props.onInteractionStateChange\n    };\n    Object.seal(this);\n    this.setProps(props);\n  }\n\n  finalize() {\n    for (const key in this.controllers) {\n      if (this.controllers[key]) {\n        this.controllers[key].finalize();\n      }\n    }\n\n    this.controllers = {};\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    return redraw;\n  }\n\n  setNeedsUpdate(reason) {\n    this._needsUpdate = this._needsUpdate || reason;\n    this._needsRedraw = this._needsRedraw || reason;\n  }\n\n  updateViewStates() {\n    for (const viewId in this.controllers) {\n      const controller = this.controllers[viewId];\n\n      if (controller) {\n        controller.updateTransition();\n      }\n    }\n  }\n\n  getViewports(rect) {\n    if (rect) {\n      return this._viewports.filter(viewport => viewport.containsPixel(rect));\n    }\n\n    return this._viewports;\n  }\n\n  getViews() {\n    const viewMap = {};\n    this.views.forEach(view => {\n      viewMap[view.id] = view;\n    });\n    return viewMap;\n  }\n\n  getView(viewOrViewId) {\n    return typeof viewOrViewId === 'string' ? this.views.find(view => view.id === viewOrViewId) : viewOrViewId;\n  }\n\n  getViewState(viewId) {\n    const view = this.getView(viewId);\n    const viewState = view && this.viewState[view.getViewStateId()] || this.viewState;\n    return view ? view.filterViewState(viewState) : viewState;\n  }\n\n  getViewport(viewId) {\n    return this._viewportMap[viewId];\n  }\n\n  unproject(xyz, opts) {\n    const viewports = this.getViewports();\n    const pixel = {\n      x: xyz[0],\n      y: xyz[1]\n    };\n\n    for (let i = viewports.length - 1; i >= 0; --i) {\n      const viewport = viewports[i];\n\n      if (viewport.containsPixel(pixel)) {\n        const p = xyz.slice();\n        p[0] -= viewport.x;\n        p[1] -= viewport.y;\n        return viewport.unproject(p, opts);\n      }\n    }\n\n    return null;\n  }\n\n  setProps(props) {\n    if ('views' in props) {\n      this._setViews(props.views);\n    }\n\n    if ('viewState' in props) {\n      this._setViewState(props.viewState);\n    }\n\n    if ('width' in props || 'height' in props) {\n      this._setSize(props.width, props.height);\n    }\n\n    if (!this._isUpdating) {\n      this._update();\n    }\n  }\n\n  _update() {\n    this._isUpdating = true;\n\n    if (this._needsUpdate) {\n      this._needsUpdate = false;\n\n      this._rebuildViewports();\n    }\n\n    if (this._needsUpdate) {\n      this._needsUpdate = false;\n\n      this._rebuildViewports();\n    }\n\n    this._isUpdating = false;\n  }\n\n  _setSize(width, height) {\n    if (width !== this.width || height !== this.height) {\n      this.width = width;\n      this.height = height;\n      this.setNeedsUpdate('Size changed');\n    }\n  }\n\n  _setViews(views) {\n    views = flatten(views, Boolean);\n\n    const viewsChanged = this._diffViews(views, this.views);\n\n    if (viewsChanged) {\n      this.setNeedsUpdate('views changed');\n    }\n\n    this.views = views;\n  }\n\n  _setViewState(viewState) {\n    if (viewState) {\n      const viewStateChanged = !deepEqual(viewState, this.viewState);\n\n      if (viewStateChanged) {\n        this.setNeedsUpdate('viewState changed');\n      }\n\n      this.viewState = viewState;\n    } else {\n      log.warn('missing `viewState` or `initialViewState`')();\n    }\n  }\n\n  _onViewStateChange(viewId, event) {\n    event.viewId = viewId;\n\n    if (this._eventCallbacks.onViewStateChange) {\n      this._eventCallbacks.onViewStateChange(event);\n    }\n  }\n\n  _createController(view, props) {\n    const Controller = props.type;\n    const controller = new Controller({\n      timeline: this.timeline,\n      eventManager: this._eventManager,\n      onViewStateChange: this._onViewStateChange.bind(this, props.id),\n      onStateChange: this._eventCallbacks.onInteractionStateChange,\n      makeViewport: viewState => view._getViewport(viewState, {\n        width: viewState.width,\n        height: viewState.height\n      }),\n      ...props\n    });\n    return controller;\n  }\n\n  _updateController(view, viewState, viewport, controller) {\n    let controllerProps = view.controller;\n\n    if (controllerProps) {\n      controllerProps = { ...viewState,\n        ...view.props,\n        ...controllerProps,\n        id: view.id,\n        x: viewport.x,\n        y: viewport.y,\n        width: viewport.width,\n        height: viewport.height\n      };\n\n      if (controller) {\n        controller.setProps(controllerProps);\n      } else {\n        controller = this._createController(view, controllerProps);\n      }\n\n      return controller;\n    }\n\n    return null;\n  }\n\n  _rebuildViewports() {\n    const {\n      width,\n      height,\n      views\n    } = this;\n    const oldControllers = this.controllers;\n    this._viewports = [];\n    this.controllers = {};\n    let invalidateControllers = false;\n\n    for (let i = views.length; i--;) {\n      const view = views[i];\n      const viewState = this.getViewState(view);\n      const viewport = view.makeViewport({\n        width,\n        height,\n        viewState\n      });\n      let oldController = oldControllers[view.id];\n\n      if (view.controller && !oldController) {\n        invalidateControllers = true;\n      }\n\n      if ((invalidateControllers || !view.controller) && oldController) {\n        oldController.finalize();\n        oldController = null;\n      }\n\n      this.controllers[view.id] = this._updateController(view, viewState, viewport, oldController);\n\n      this._viewports.unshift(viewport);\n    }\n\n    for (const id in oldControllers) {\n      if (oldControllers[id] && !this.controllers[id]) {\n        oldControllers[id].finalize();\n      }\n    }\n\n    this._buildViewportMap();\n  }\n\n  _buildViewportMap() {\n    this._viewportMap = {};\n\n    this._viewports.forEach(viewport => {\n      if (viewport.id) {\n        this._viewportMap[viewport.id] = this._viewportMap[viewport.id] || viewport;\n      }\n    });\n  }\n\n  _diffViews(newViews, oldViews) {\n    if (newViews.length !== oldViews.length) {\n      return true;\n    }\n\n    return newViews.some((_, i) => !newViews[i].equals(oldViews[i]));\n  }\n\n}\n//# sourceMappingURL=view-manager.js.map","const PERCENT_OR_PIXELS_REGEX = /([0-9]+\\.?[0-9]*)(%|px)/;\nexport function parsePosition(value) {\n  switch (typeof value) {\n    case 'number':\n      return {\n        position: value,\n        relative: false\n      };\n\n    case 'string':\n      const match = value.match(PERCENT_OR_PIXELS_REGEX);\n\n      if (match && match.length >= 3) {\n        const relative = match[2] === '%';\n        const position = parseFloat(match[1]);\n        return {\n          position: relative ? position / 100 : position,\n          relative\n        };\n      }\n\n    default:\n      throw new Error(\"Could not parse position string \".concat(value));\n  }\n}\nexport function getPosition(position, extent) {\n  return position.relative ? Math.round(position.position * extent) : position.position;\n}\n//# sourceMappingURL=positions.js.map","export default function assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'deck.gl: assertion failed.');\n  }\n}\n//# sourceMappingURL=assert.js.map","import Viewport from '../viewports/viewport';\nimport { parsePosition, getPosition } from '../utils/positions';\nimport { deepEqual } from '../utils/deep-equal';\nimport assert from '../utils/assert';\nexport default class View {\n  constructor(props = {}) {\n    const {\n      id = null,\n      x = 0,\n      y = 0,\n      width = '100%',\n      height = '100%',\n      projectionMatrix = null,\n      fovy = 50,\n      near = 0.1,\n      far = 1000,\n      modelMatrix = null,\n      viewportInstance = null,\n      type = Viewport\n    } = props;\n    assert(!viewportInstance || viewportInstance instanceof Viewport);\n    this.viewportInstance = viewportInstance;\n    this.id = id || this.constructor.displayName || 'view';\n    this.type = type;\n    this.props = { ...props,\n      id: this.id,\n      projectionMatrix,\n      fovy,\n      near,\n      far,\n      modelMatrix\n    };\n\n    this._parseDimensions({\n      x,\n      y,\n      width,\n      height\n    });\n\n    this.equals = this.equals.bind(this);\n    Object.seal(this);\n  }\n\n  equals(view) {\n    if (this === view) {\n      return true;\n    }\n\n    if (this.viewportInstance) {\n      return view.viewportInstance && this.viewportInstance.equals(view.viewportInstance);\n    }\n\n    const viewChanged = deepEqual(this.props, view.props);\n    return viewChanged;\n  }\n\n  makeViewport({\n    width,\n    height,\n    viewState\n  }) {\n    if (this.viewportInstance) {\n      return this.viewportInstance;\n    }\n\n    viewState = this.filterViewState(viewState);\n    const viewportDimensions = this.getDimensions({\n      width,\n      height\n    });\n    return this._getViewport(viewState, viewportDimensions);\n  }\n\n  getViewStateId() {\n    switch (typeof this.props.viewState) {\n      case 'string':\n        return this.props.viewState;\n\n      case 'object':\n        return this.props.viewState && this.props.viewState.id;\n\n      default:\n        return this.id;\n    }\n  }\n\n  filterViewState(viewState) {\n    if (this.props.viewState && typeof this.props.viewState === 'object') {\n      if (!this.props.viewState.id) {\n        return this.props.viewState;\n      }\n\n      const newViewState = { ...viewState\n      };\n\n      for (const key in this.props.viewState) {\n        if (key !== 'id') {\n          newViewState[key] = this.props.viewState[key];\n        }\n      }\n\n      return newViewState;\n    }\n\n    return viewState;\n  }\n\n  getDimensions({\n    width,\n    height\n  }) {\n    return {\n      x: getPosition(this._x, width),\n      y: getPosition(this._y, height),\n      width: getPosition(this._width, width),\n      height: getPosition(this._height, height)\n    };\n  }\n\n  _getControllerProps(defaultOpts) {\n    let opts = this.props.controller;\n\n    if (!opts) {\n      return null;\n    }\n\n    if (opts === true) {\n      return defaultOpts;\n    }\n\n    if (typeof opts === 'function') {\n      opts = {\n        type: opts\n      };\n    }\n\n    return { ...defaultOpts,\n      ...opts\n    };\n  }\n\n  _getViewport(viewState, viewportDimensions) {\n    const {\n      type: ViewportType\n    } = this;\n    return new ViewportType({ ...viewState,\n      ...this.props,\n      ...viewportDimensions\n    });\n  }\n\n  _parseDimensions({\n    x,\n    y,\n    width,\n    height\n  }) {\n    this._x = parsePosition(x);\n    this._y = parsePosition(y);\n    this._width = parsePosition(width);\n    this._height = parsePosition(height);\n  }\n\n}\n//# sourceMappingURL=view.js.map","function noop() {}\n\nconst DEFAULT_SETTINGS = {\n  onStart: noop,\n  onUpdate: noop,\n  onInterrupt: noop,\n  onEnd: noop\n};\nexport default class Transition {\n  constructor(timeline) {\n    this._inProgress = false;\n    this._handle = null;\n    this.timeline = timeline;\n    this.settings = {};\n  }\n\n  get inProgress() {\n    return this._inProgress;\n  }\n\n  start(props) {\n    this.cancel();\n    this.settings = { ...DEFAULT_SETTINGS,\n      ...props\n    };\n    this._inProgress = true;\n    this.settings.onStart(this);\n  }\n\n  end() {\n    if (this._inProgress) {\n      this.timeline.removeChannel(this._handle);\n      this._handle = null;\n      this._inProgress = false;\n      this.settings.onEnd(this);\n    }\n  }\n\n  cancel() {\n    if (this._inProgress) {\n      this.settings.onInterrupt(this);\n      this.timeline.removeChannel(this._handle);\n      this._handle = null;\n      this._inProgress = false;\n    }\n  }\n\n  update() {\n    if (!this._inProgress) {\n      return false;\n    }\n\n    if (this._handle === null) {\n      const {\n        timeline,\n        settings\n      } = this;\n      this._handle = timeline.addChannel({\n        delay: timeline.getTime(),\n        duration: settings.duration\n      });\n    }\n\n    this.time = this.timeline.getTime(this._handle);\n\n    this._onUpdate();\n\n    this.settings.onUpdate(this);\n\n    if (this.timeline.isFinished(this._handle)) {\n      this.end();\n    }\n\n    return true;\n  }\n\n  _onUpdate() {}\n\n}\n//# sourceMappingURL=transition.js.map","import Transition from '../transitions/transition';\n\nconst noop = () => {};\n\nexport const TRANSITION_EVENTS = {\n  BREAK: 1,\n  SNAP_TO_END: 2,\n  IGNORE: 3\n};\nconst DEFAULT_PROPS = {\n  transitionEasing: t => t,\n  transitionInterruption: TRANSITION_EVENTS.BREAK,\n  onTransitionStart: noop,\n  onTransitionInterrupt: noop,\n  onTransitionEnd: noop\n};\nexport default class TransitionManager {\n  constructor(ControllerState, props = {}) {\n    this.ControllerState = ControllerState;\n    this.props = { ...DEFAULT_PROPS,\n      ...props\n    };\n    this.propsInTransition = null;\n    this.transition = new Transition(props.timeline);\n    this.onViewStateChange = props.onViewStateChange || noop;\n    this.onStateChange = props.onStateChange || noop;\n    this._onTransitionUpdate = this._onTransitionUpdate.bind(this);\n  }\n\n  finalize() {\n    this.transition.cancel();\n  }\n\n  getViewportInTransition() {\n    return this.propsInTransition;\n  }\n\n  processViewStateChange(nextProps) {\n    let transitionTriggered = false;\n    const currentProps = this.props;\n    nextProps = { ...DEFAULT_PROPS,\n      ...nextProps\n    };\n    this.props = nextProps;\n\n    if (this._shouldIgnoreViewportChange(currentProps, nextProps)) {\n      return transitionTriggered;\n    }\n\n    if (this._isTransitionEnabled(nextProps)) {\n      const {\n        interruption,\n        endProps\n      } = this.transition.settings;\n      const startProps = { ...currentProps,\n        ...(interruption === TRANSITION_EVENTS.SNAP_TO_END ? endProps : this.propsInTransition || currentProps)\n      };\n\n      this._triggerTransition(startProps, nextProps);\n\n      transitionTriggered = true;\n    } else {\n      this.transition.cancel();\n    }\n\n    return transitionTriggered;\n  }\n\n  updateTransition() {\n    this.transition.update();\n  }\n\n  _isTransitionEnabled(props) {\n    const {\n      transitionDuration,\n      transitionInterpolator\n    } = props;\n    return (transitionDuration > 0 || transitionDuration === 'auto') && Boolean(transitionInterpolator);\n  }\n\n  _isUpdateDueToCurrentTransition(props) {\n    if (this.transition.inProgress) {\n      return this.transition.settings.interpolator.arePropsEqual(props, this.propsInTransition);\n    }\n\n    return false;\n  }\n\n  _shouldIgnoreViewportChange(currentProps, nextProps) {\n    if (this.transition.inProgress) {\n      return this.transition.settings.interruption === TRANSITION_EVENTS.IGNORE || this._isUpdateDueToCurrentTransition(nextProps);\n    } else if (this._isTransitionEnabled(nextProps)) {\n      return nextProps.transitionInterpolator.arePropsEqual(currentProps, nextProps);\n    }\n\n    return true;\n  }\n\n  _triggerTransition(startProps, endProps) {\n    const startViewstate = new this.ControllerState(startProps);\n    const endViewStateProps = new this.ControllerState(endProps).shortestPathFrom(startViewstate);\n    const {\n      transitionInterpolator\n    } = endProps;\n    const duration = transitionInterpolator.getDuration ? transitionInterpolator.getDuration(startProps, endProps) : endProps.transitionDuration;\n\n    if (duration === 0) {\n      return;\n    }\n\n    const initialProps = endProps.transitionInterpolator.initializeProps(startProps, endViewStateProps);\n    this.propsInTransition = {};\n    this.duration = duration;\n    this.transition.start({\n      duration,\n      easing: endProps.transitionEasing,\n      interpolator: endProps.transitionInterpolator,\n      interruption: endProps.transitionInterruption,\n      startProps: initialProps.start,\n      endProps: initialProps.end,\n      onStart: endProps.onTransitionStart,\n      onUpdate: this._onTransitionUpdate,\n      onInterrupt: this._onTransitionEnd(endProps.onTransitionInterrupt),\n      onEnd: this._onTransitionEnd(endProps.onTransitionEnd)\n    });\n    this.onStateChange({\n      inTransition: true\n    });\n    this.updateTransition();\n  }\n\n  _onTransitionEnd(callback) {\n    return transition => {\n      this.propsInTransition = null;\n      this.onStateChange({\n        inTransition: false,\n        isZooming: false,\n        isPanning: false,\n        isRotating: false\n      });\n      callback(transition);\n    };\n  }\n\n  _onTransitionUpdate(transition) {\n    const {\n      time,\n      settings: {\n        interpolator,\n        startProps,\n        endProps,\n        duration,\n        easing\n      }\n    } = transition;\n    const t = easing(time / duration);\n    const viewport = interpolator.interpolateProps(startProps, endProps, t);\n    this.propsInTransition = new this.ControllerState({ ...this.props,\n      ...viewport\n    }).getViewportProps();\n    this.onViewStateChange({\n      viewState: this.propsInTransition,\n      oldViewState: this.props\n    });\n  }\n\n}\n//# sourceMappingURL=transition-manager.js.map","import TransitionInterpolator from './transition-interpolator';\nimport { lerp } from 'math.gl';\nconst DEFAULT_PROPS = ['longitude', 'latitude', 'zoom', 'bearing', 'pitch'];\nconst DEFAULT_REQUIRED_PROPS = ['longitude', 'latitude', 'zoom'];\nexport default class LinearInterpolator extends TransitionInterpolator {\n  constructor(opts = {}) {\n    const transitionProps = Array.isArray(opts) ? opts : opts.transitionProps;\n    super(transitionProps || {\n      compare: DEFAULT_PROPS,\n      extract: DEFAULT_PROPS,\n      required: DEFAULT_REQUIRED_PROPS\n    });\n    this.opts = opts;\n  }\n\n  initializeProps(startProps, endProps) {\n    const result = super.initializeProps(startProps, endProps);\n    const {\n      makeViewport,\n      around\n    } = this.opts;\n\n    if (makeViewport && around) {\n      const startViewport = makeViewport(startProps);\n      const endViewport = makeViewport(endProps);\n      const aroundPosition = startViewport.unproject(around);\n      result.start.around = around;\n      Object.assign(result.end, {\n        around: endViewport.project(aroundPosition),\n        aroundPosition,\n        width: endProps.width,\n        height: endProps.height\n      });\n    }\n\n    return result;\n  }\n\n  interpolateProps(startProps, endProps, t) {\n    const propsInTransition = {};\n\n    for (const key of this._propsToExtract) {\n      propsInTransition[key] = lerp(startProps[key] || 0, endProps[key] || 0, t);\n    }\n\n    if (endProps.aroundPosition) {\n      const viewport = this.opts.makeViewport({ ...endProps,\n        ...propsInTransition\n      });\n      Object.assign(propsInTransition, viewport.panByPosition(endProps.aroundPosition, lerp(startProps.around, endProps.around, t)));\n    }\n\n    return propsInTransition;\n  }\n\n}\n//# sourceMappingURL=linear-interpolator.js.map","import { equals } from 'math.gl';\nimport assert from '../utils/assert';\nexport default class TransitionInterpolator {\n  constructor(opts = {}) {\n    if (Array.isArray(opts)) {\n      opts = {\n        compare: opts,\n        extract: opts,\n        required: opts\n      };\n    }\n\n    const {\n      compare,\n      extract,\n      required\n    } = opts;\n    this._propsToCompare = compare;\n    this._propsToExtract = extract;\n    this._requiredProps = required;\n  }\n\n  arePropsEqual(currentProps, nextProps) {\n    for (const key of this._propsToCompare || Object.keys(nextProps)) {\n      if (!(key in currentProps) || !(key in nextProps) || !equals(currentProps[key], nextProps[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  initializeProps(startProps, endProps) {\n    let result;\n\n    if (this._propsToExtract) {\n      const startViewStateProps = {};\n      const endViewStateProps = {};\n\n      for (const key of this._propsToExtract) {\n        startViewStateProps[key] = startProps[key];\n        endViewStateProps[key] = endProps[key];\n      }\n\n      result = {\n        start: startViewStateProps,\n        end: endViewStateProps\n      };\n    } else {\n      result = {\n        start: startProps,\n        end: endProps\n      };\n    }\n\n    this._checkRequiredProps(result.start);\n\n    this._checkRequiredProps(result.end);\n\n    return result;\n  }\n\n  interpolateProps(startProps, endProps, t) {\n    return endProps;\n  }\n\n  getDuration(startProps, endProps) {\n    return endProps.transitionDuration;\n  }\n\n  _checkRequiredProps(props) {\n    if (!this._requiredProps) {\n      return;\n    }\n\n    this._requiredProps.forEach(propName => {\n      const value = props[propName];\n      assert(Number.isFinite(value) || Array.isArray(value), \"\".concat(propName, \" is required for transition\"));\n    });\n  }\n\n}\n//# sourceMappingURL=transition-interpolator.js.map","import TransitionManager, { TRANSITION_EVENTS } from './transition-manager';\nimport LinearInterpolator from '../transitions/linear-interpolator';\nconst NO_TRANSITION_PROPS = {\n  transitionDuration: 0\n};\nconst LINEAR_TRANSITION_PROPS = {\n  transitionDuration: 300,\n  transitionEasing: t => t,\n  transitionInterruption: TRANSITION_EVENTS.BREAK\n};\nconst DEFAULT_INERTIA = 300;\n\nconst INERTIA_EASING = t => 1 - (1 - t) * (1 - t);\n\nconst EVENT_TYPES = {\n  WHEEL: ['wheel'],\n  PAN: ['panstart', 'panmove', 'panend'],\n  PINCH: ['pinchstart', 'pinchmove', 'pinchend'],\n  TRIPLE_PAN: ['tripanstart', 'tripanmove', 'tripanend'],\n  DOUBLE_TAP: ['doubletap'],\n  KEYBOARD: ['keydown']\n};\nexport default class Controller {\n  constructor(ControllerState, options = {}) {\n    this.ControllerState = ControllerState;\n    this.controllerState = null;\n    this.controllerStateProps = null;\n    this.eventManager = null;\n    this.transitionManager = new TransitionManager(ControllerState, { ...options,\n      onViewStateChange: this._onTransition.bind(this),\n      onStateChange: this._setInteractionState.bind(this)\n    });\n    const linearTransitionProps = this.linearTransitionProps;\n    this._transition = linearTransitionProps && { ...LINEAR_TRANSITION_PROPS,\n      transitionInterpolator: new LinearInterpolator({\n        transitionProps: linearTransitionProps\n      })\n    };\n    this._events = null;\n    this._interactionState = {\n      isDragging: false\n    };\n    this._customEvents = [];\n    this.onViewStateChange = null;\n    this.onStateChange = null;\n    this.handleEvent = this.handleEvent.bind(this);\n    this.setProps(options);\n  }\n\n  get linearTransitionProps() {\n    return null;\n  }\n\n  set events(customEvents) {\n    this.toggleEvents(this._customEvents, false);\n    this.toggleEvents(customEvents, true);\n    this._customEvents = customEvents;\n    this.setProps(this.controllerStateProps);\n  }\n\n  finalize() {\n    for (const eventName in this._events) {\n      if (this._events[eventName]) {\n        this.eventManager.off(eventName, this.handleEvent);\n      }\n    }\n\n    this.transitionManager.finalize();\n  }\n\n  handleEvent(event) {\n    const {\n      ControllerState\n    } = this;\n    this.controllerState = new ControllerState({\n      makeViewport: this.makeViewport,\n      ...this.controllerStateProps,\n      ...this._state\n    });\n    const eventStartBlocked = this._eventStartBlocked;\n\n    switch (event.type) {\n      case 'panstart':\n        return eventStartBlocked ? false : this._onPanStart(event);\n\n      case 'panmove':\n        return this._onPan(event);\n\n      case 'panend':\n        return this._onPanEnd(event);\n\n      case 'pinchstart':\n        return eventStartBlocked ? false : this._onPinchStart(event);\n\n      case 'pinchmove':\n        return this._onPinch(event);\n\n      case 'pinchend':\n        return this._onPinchEnd(event);\n\n      case 'tripanstart':\n        return eventStartBlocked ? false : this._onTriplePanStart(event);\n\n      case 'tripanmove':\n        return this._onTriplePan(event);\n\n      case 'tripanend':\n        return this._onTriplePanEnd(event);\n\n      case 'doubletap':\n        return this._onDoubleTap(event);\n\n      case 'wheel':\n        return this._onWheel(event);\n\n      case 'keydown':\n        return this._onKeyDown(event);\n\n      default:\n        return false;\n    }\n  }\n\n  getCenter(event) {\n    const {\n      x,\n      y\n    } = this.controllerStateProps;\n    const {\n      offsetCenter\n    } = event;\n    return [offsetCenter.x - x, offsetCenter.y - y];\n  }\n\n  isPointInBounds(pos, event) {\n    const {\n      width,\n      height\n    } = this.controllerStateProps;\n\n    if (event && event.handled) {\n      return false;\n    }\n\n    const inside = pos[0] >= 0 && pos[0] <= width && pos[1] >= 0 && pos[1] <= height;\n\n    if (inside && event) {\n      event.stopPropagation();\n    }\n\n    return inside;\n  }\n\n  isFunctionKeyPressed(event) {\n    const {\n      srcEvent\n    } = event;\n    return Boolean(srcEvent.metaKey || srcEvent.altKey || srcEvent.ctrlKey || srcEvent.shiftKey);\n  }\n\n  isDragging() {\n    return this._interactionState.isDragging;\n  }\n\n  blockEvents(timeout) {\n    const timer = setTimeout(() => {\n      if (this._eventStartBlocked === timer) {\n        this._eventStartBlocked = null;\n      }\n    }, timeout);\n    this._eventStartBlocked = timer;\n  }\n\n  setProps(props) {\n    if ('onViewStateChange' in props) {\n      this.onViewStateChange = props.onViewStateChange;\n    }\n\n    if ('onStateChange' in props) {\n      this.onStateChange = props.onStateChange;\n    }\n\n    if ('makeViewport' in props) {\n      this.makeViewport = props.makeViewport;\n    }\n\n    if ('dragMode' in props) {\n      this.dragMode = props.dragMode;\n    }\n\n    this.controllerStateProps = props;\n\n    if ('eventManager' in props && this.eventManager !== props.eventManager) {\n      this.eventManager = props.eventManager;\n      this._events = {};\n      this.toggleEvents(this._customEvents, true);\n    }\n\n    if (!('transitionInterpolator' in props)) {\n      props.transitionInterpolator = this._getTransitionProps().transitionInterpolator;\n    }\n\n    this.transitionManager.processViewStateChange(props);\n    let {\n      inertia\n    } = props;\n\n    if (inertia === true) {\n      inertia = DEFAULT_INERTIA;\n    }\n\n    this.inertia = inertia;\n    const {\n      scrollZoom = true,\n      dragPan = true,\n      dragRotate = true,\n      doubleClickZoom = true,\n      touchZoom = true,\n      touchRotate = false,\n      keyboard = true\n    } = props;\n    const isInteractive = Boolean(this.onViewStateChange);\n    this.toggleEvents(EVENT_TYPES.WHEEL, isInteractive && scrollZoom);\n    this.toggleEvents(EVENT_TYPES.PAN, isInteractive && (dragPan || dragRotate));\n    this.toggleEvents(EVENT_TYPES.PINCH, isInteractive && (touchZoom || touchRotate));\n    this.toggleEvents(EVENT_TYPES.TRIPLE_PAN, isInteractive && touchRotate);\n    this.toggleEvents(EVENT_TYPES.DOUBLE_TAP, isInteractive && doubleClickZoom);\n    this.toggleEvents(EVENT_TYPES.KEYBOARD, isInteractive && keyboard);\n    this.scrollZoom = scrollZoom;\n    this.dragPan = dragPan;\n    this.dragRotate = dragRotate;\n    this.doubleClickZoom = doubleClickZoom;\n    this.touchZoom = touchZoom;\n    this.touchRotate = touchRotate;\n    this.keyboard = keyboard;\n  }\n\n  updateTransition() {\n    this.transitionManager.updateTransition();\n  }\n\n  toggleEvents(eventNames, enabled) {\n    if (this.eventManager) {\n      eventNames.forEach(eventName => {\n        if (this._events[eventName] !== enabled) {\n          this._events[eventName] = enabled;\n\n          if (enabled) {\n            this.eventManager.on(eventName, this.handleEvent);\n          } else {\n            this.eventManager.off(eventName, this.handleEvent);\n          }\n        }\n      });\n    }\n  }\n\n  updateViewport(newControllerState, extraProps = {}, interactionState = {}) {\n    const viewState = { ...newControllerState.getViewportProps(),\n      ...extraProps\n    };\n    const changed = this.controllerState !== newControllerState;\n    this._state = newControllerState.getState();\n\n    this._setInteractionState(interactionState);\n\n    if (changed) {\n      const oldViewState = this.controllerState ? this.controllerState.getViewportProps() : null;\n\n      if (this.onViewStateChange) {\n        this.onViewStateChange({\n          viewState,\n          interactionState: this._interactionState,\n          oldViewState\n        });\n      }\n    }\n  }\n\n  _onTransition(params) {\n    if (this.onViewStateChange) {\n      params.interactionState = this._interactionState;\n      this.onViewStateChange(params);\n    }\n  }\n\n  _setInteractionState(newStates) {\n    Object.assign(this._interactionState, newStates);\n\n    if (this.onStateChange) {\n      this.onStateChange(this._interactionState);\n    }\n  }\n\n  _onPanStart(event) {\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    let alternateMode = this.isFunctionKeyPressed(event) || event.rightButton;\n\n    if (this.invertPan || this.dragMode === 'pan') {\n      alternateMode = !alternateMode;\n    }\n\n    const newControllerState = this.controllerState[alternateMode ? 'panStart' : 'rotateStart']({\n      pos\n    });\n    this._panMove = alternateMode;\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true\n    });\n    return true;\n  }\n\n  _onPan(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    return this._panMove ? this._onPanMove(event) : this._onPanRotate(event);\n  }\n\n  _onPanEnd(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    return this._panMove ? this._onPanMoveEnd(event) : this._onPanRotateEnd(event);\n  }\n\n  _onPanMove(event) {\n    if (!this.dragPan) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n    const newControllerState = this.controllerState.pan({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isPanning: true\n    });\n    return true;\n  }\n\n  _onPanMoveEnd(event) {\n    const {\n      inertia\n    } = this;\n\n    if (this.dragPan && inertia && event.velocity) {\n      const pos = this.getCenter(event);\n      const endPos = [pos[0] + event.velocityX * inertia / 2, pos[1] + event.velocityY * inertia / 2];\n      const newControllerState = this.controllerState.pan({\n        pos: endPos\n      }).panEnd();\n      this.updateViewport(newControllerState, { ...this._getTransitionProps(),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isPanning: true\n      });\n    } else {\n      const newControllerState = this.controllerState.panEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isPanning: false\n      });\n    }\n\n    return true;\n  }\n\n  _onPanRotate(event) {\n    if (!this.dragRotate) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n    const newControllerState = this.controllerState.rotate({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isRotating: true\n    });\n    return true;\n  }\n\n  _onPanRotateEnd(event) {\n    const {\n      inertia\n    } = this;\n\n    if (this.dragRotate && inertia && event.velocity) {\n      const pos = this.getCenter(event);\n      const endPos = [pos[0] + event.velocityX * inertia / 2, pos[1] + event.velocityY * inertia / 2];\n      const newControllerState = this.controllerState.rotate({\n        pos: endPos\n      }).rotateEnd();\n      this.updateViewport(newControllerState, { ...this._getTransitionProps(),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isRotating: true\n      });\n    } else {\n      const newControllerState = this.controllerState.rotateEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isRotating: false\n      });\n    }\n\n    return true;\n  }\n\n  _onWheel(event) {\n    if (!this.scrollZoom) {\n      return false;\n    }\n\n    event.preventDefault();\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const {\n      speed = 0.01,\n      smooth = false\n    } = this.scrollZoom;\n    const {\n      delta\n    } = event;\n    let scale = 2 / (1 + Math.exp(-Math.abs(delta * speed)));\n\n    if (delta < 0 && scale !== 0) {\n      scale = 1 / scale;\n    }\n\n    const newControllerState = this.controllerState.zoom({\n      pos,\n      scale\n    });\n    this.updateViewport(newControllerState, { ...this._getTransitionProps({\n        around: pos\n      }),\n      transitionDuration: smooth ? 250 : 1\n    }, {\n      isZooming: true,\n      isPanning: true\n    });\n    return true;\n  }\n\n  _onTriplePanStart(event) {\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const newControllerState = this.controllerState.rotateStart({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true\n    });\n    return true;\n  }\n\n  _onTriplePan(event) {\n    if (!this.touchRotate) {\n      return false;\n    }\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n    pos[0] -= event.deltaX;\n    const newControllerState = this.controllerState.rotate({\n      pos\n    });\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isRotating: true\n    });\n    return true;\n  }\n\n  _onTriplePanEnd(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const {\n      inertia\n    } = this;\n\n    if (this.touchRotate && inertia && event.velocityY) {\n      const pos = this.getCenter(event);\n      const endPos = [pos[0], pos[1] += event.velocityY * inertia / 2];\n      const newControllerState = this.controllerState.rotate({\n        pos: endPos\n      });\n      this.updateViewport(newControllerState, { ...this._getTransitionProps(),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isRotating: true\n      });\n      this.blockEvents(inertia);\n    } else {\n      const newControllerState = this.controllerState.rotateEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isRotating: false\n      });\n    }\n\n    return true;\n  }\n\n  _onPinchStart(event) {\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const newControllerState = this.controllerState.zoomStart({\n      pos\n    }).rotateStart({\n      pos\n    });\n    this._startPinchRotation = event.rotation;\n    this._lastPinchEvent = event;\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true\n    });\n    return true;\n  }\n\n  _onPinch(event) {\n    if (!this.touchZoom && !this.touchRotate) {\n      return false;\n    }\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    let newControllerState = this.controllerState;\n\n    if (this.touchZoom) {\n      const {\n        scale\n      } = event;\n      const pos = this.getCenter(event);\n      newControllerState = newControllerState.zoom({\n        pos,\n        scale\n      });\n    }\n\n    if (this.touchRotate) {\n      const {\n        rotation\n      } = event;\n      newControllerState = newControllerState.rotate({\n        deltaAngleX: this._startPinchRotation - rotation\n      });\n    }\n\n    this.updateViewport(newControllerState, NO_TRANSITION_PROPS, {\n      isDragging: true,\n      isPanning: this.touchZoom,\n      isZooming: this.touchZoom,\n      isRotating: this.touchRotate\n    });\n    this._lastPinchEvent = event;\n    return true;\n  }\n\n  _onPinchEnd(event) {\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const {\n      inertia,\n      _lastPinchEvent\n    } = this;\n\n    if (this.touchZoom && inertia && _lastPinchEvent && event.scale !== _lastPinchEvent.scale) {\n      const pos = this.getCenter(event);\n      let newControllerState = this.controllerState.rotateEnd();\n      const z = Math.log2(event.scale);\n\n      const velocityZ = (z - Math.log2(_lastPinchEvent.scale)) / (event.deltaTime - _lastPinchEvent.deltaTime);\n\n      const endScale = Math.pow(2, z + velocityZ * inertia / 2);\n      newControllerState = newControllerState.zoom({\n        pos,\n        scale: endScale\n      }).zoomEnd();\n      this.updateViewport(newControllerState, { ...this._getTransitionProps({\n          around: pos\n        }),\n        transitionDuration: inertia,\n        transitionEasing: INERTIA_EASING\n      }, {\n        isDragging: false,\n        isPanning: this.touchZoom,\n        isZooming: this.touchZoom,\n        isRotating: false\n      });\n      this.blockEvents(inertia);\n    } else {\n      const newControllerState = this.controllerState.zoomEnd().rotateEnd();\n      this.updateViewport(newControllerState, null, {\n        isDragging: false,\n        isPanning: false,\n        isZooming: false,\n        isRotating: false\n      });\n    }\n\n    this._startPinchRotation = null;\n    this._lastPinchEvent = null;\n    return true;\n  }\n\n  _onDoubleTap(event) {\n    if (!this.doubleClickZoom) {\n      return false;\n    }\n\n    const pos = this.getCenter(event);\n\n    if (!this.isPointInBounds(pos, event)) {\n      return false;\n    }\n\n    const isZoomOut = this.isFunctionKeyPressed(event);\n    const newControllerState = this.controllerState.zoom({\n      pos,\n      scale: isZoomOut ? 0.5 : 2\n    });\n    this.updateViewport(newControllerState, this._getTransitionProps({\n      around: pos\n    }), {\n      isZooming: true,\n      isPanning: true\n    });\n    this.blockEvents(100);\n    return true;\n  }\n\n  _onKeyDown(event) {\n    if (!this.keyboard) {\n      return false;\n    }\n\n    const funcKey = this.isFunctionKeyPressed(event);\n    const {\n      zoomSpeed,\n      moveSpeed,\n      rotateSpeedX,\n      rotateSpeedY\n    } = this.keyboard;\n    const {\n      controllerState\n    } = this;\n    let newControllerState;\n    const interactionState = {};\n\n    switch (event.srcEvent.code) {\n      case 'Minus':\n        newControllerState = funcKey ? controllerState.zoomOut(zoomSpeed).zoomOut(zoomSpeed) : controllerState.zoomOut(zoomSpeed);\n        interactionState.isZooming = true;\n        break;\n\n      case 'Equal':\n        newControllerState = funcKey ? controllerState.zoomIn(zoomSpeed).zoomIn(zoomSpeed) : controllerState.zoomIn(zoomSpeed);\n        interactionState.isZooming = true;\n        break;\n\n      case 'ArrowLeft':\n        if (funcKey) {\n          newControllerState = controllerState.rotateLeft(rotateSpeedX);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveLeft(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      case 'ArrowRight':\n        if (funcKey) {\n          newControllerState = controllerState.rotateRight(rotateSpeedX);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveRight(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      case 'ArrowUp':\n        if (funcKey) {\n          newControllerState = controllerState.rotateUp(rotateSpeedY);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveUp(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      case 'ArrowDown':\n        if (funcKey) {\n          newControllerState = controllerState.rotateDown(rotateSpeedY);\n          interactionState.isRotating = true;\n        } else {\n          newControllerState = controllerState.moveDown(moveSpeed);\n          interactionState.isPanning = true;\n        }\n\n        break;\n\n      default:\n        return false;\n    }\n\n    this.updateViewport(newControllerState, this._getTransitionProps(), interactionState);\n    return true;\n  }\n\n  _getTransitionProps(opts) {\n    const {\n      _transition\n    } = this;\n\n    if (!_transition) {\n      return NO_TRANSITION_PROPS;\n    }\n\n    return opts ? { ..._transition,\n      transitionInterpolator: new LinearInterpolator({ ...opts,\n        transitionProps: this.linearTransitionProps,\n        makeViewport: this.controllerState.makeViewport\n      })\n    } : _transition;\n  }\n\n}\n//# sourceMappingURL=controller.js.map","export default class ViewState {\n  constructor(opts) {\n    this._viewportProps = this._applyConstraints(opts);\n  }\n\n  getViewportProps() {\n    return this._viewportProps;\n  }\n\n  getState() {\n    return this._state;\n  }\n\n  shortestPathFrom(viewState) {\n    return this._viewportProps;\n  }\n\n  _applyConstraints(props) {\n    return props;\n  }\n\n}\n//# sourceMappingURL=view-state.js.map","import { clamp } from 'math.gl';\nimport Controller from './controller';\nimport ViewState from './view-state';\nimport { normalizeViewportProps } from '@math.gl/web-mercator';\nimport assert from '../utils/assert';\nconst PITCH_MOUSE_THRESHOLD = 5;\nconst PITCH_ACCEL = 1.2;\nconst DEFAULT_STATE = {\n  pitch: 0,\n  bearing: 0,\n  altitude: 1.5,\n  minZoom: 0,\n  maxZoom: 20,\n  minPitch: 0,\n  maxPitch: 60\n};\nexport class MapState extends ViewState {\n  constructor({\n    makeViewport,\n    width,\n    height,\n    latitude,\n    longitude,\n    zoom,\n    bearing = DEFAULT_STATE.bearing,\n    pitch = DEFAULT_STATE.pitch,\n    altitude = DEFAULT_STATE.altitude,\n    maxZoom = DEFAULT_STATE.maxZoom,\n    minZoom = DEFAULT_STATE.minZoom,\n    maxPitch = DEFAULT_STATE.maxPitch,\n    minPitch = DEFAULT_STATE.minPitch,\n    startPanLngLat,\n    startZoomLngLat,\n    startRotatePos,\n    startBearing,\n    startPitch,\n    startZoom,\n    normalize\n  } = {}) {\n    assert(Number.isFinite(longitude));\n    assert(Number.isFinite(latitude));\n    assert(Number.isFinite(zoom));\n    super({\n      width,\n      height,\n      latitude,\n      longitude,\n      zoom,\n      bearing,\n      pitch,\n      altitude,\n      maxZoom,\n      minZoom,\n      maxPitch,\n      minPitch,\n      normalize\n    });\n    this._state = {\n      startPanLngLat,\n      startZoomLngLat,\n      startRotatePos,\n      startBearing,\n      startPitch,\n      startZoom\n    };\n    this.makeViewport = makeViewport;\n  }\n\n  panStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startPanLngLat: this._unproject(pos)\n    });\n  }\n\n  pan({\n    pos,\n    startPos\n  }) {\n    const startPanLngLat = this._state.startPanLngLat || this._unproject(startPos);\n\n    if (!startPanLngLat) {\n      return this;\n    }\n\n    const viewport = this.makeViewport(this._viewportProps);\n    const newProps = viewport.panByPosition(startPanLngLat, pos);\n    return this._getUpdatedState(newProps);\n  }\n\n  panEnd() {\n    return this._getUpdatedState({\n      startPanLngLat: null\n    });\n  }\n\n  rotateStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startRotatePos: pos,\n      startBearing: this._viewportProps.bearing,\n      startPitch: this._viewportProps.pitch\n    });\n  }\n\n  rotate({\n    pos,\n    deltaAngleX = 0,\n    deltaAngleY = 0\n  }) {\n    const {\n      startRotatePos,\n      startBearing,\n      startPitch\n    } = this._state;\n\n    if (!startRotatePos || !Number.isFinite(startBearing) || !Number.isFinite(startPitch)) {\n      return this;\n    }\n\n    let newRotation;\n\n    if (pos) {\n      newRotation = this._calculateNewPitchAndBearing({ ...this._getRotationParams(pos, startRotatePos),\n        startBearing,\n        startPitch\n      });\n    } else {\n      newRotation = {\n        bearing: startBearing + deltaAngleX,\n        pitch: startPitch + deltaAngleY\n      };\n    }\n\n    return this._getUpdatedState(newRotation);\n  }\n\n  rotateEnd() {\n    return this._getUpdatedState({\n      startBearing: null,\n      startPitch: null\n    });\n  }\n\n  zoomStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startZoomLngLat: this._unproject(pos),\n      startZoom: this._viewportProps.zoom\n    });\n  }\n\n  zoom({\n    pos,\n    startPos,\n    scale\n  }) {\n    let {\n      startZoom,\n      startZoomLngLat\n    } = this._state;\n\n    if (!Number.isFinite(startZoom)) {\n      startZoom = this._viewportProps.zoom;\n      startZoomLngLat = this._unproject(startPos) || this._unproject(pos);\n    }\n\n    const zoom = this._calculateNewZoom({\n      scale,\n      startZoom\n    });\n\n    const zoomedViewport = this.makeViewport({ ...this._viewportProps,\n      zoom\n    });\n    return this._getUpdatedState({\n      zoom,\n      ...zoomedViewport.panByPosition(startZoomLngLat, pos)\n    });\n  }\n\n  zoomEnd() {\n    return this._getUpdatedState({\n      startZoomLngLat: null,\n      startZoom: null\n    });\n  }\n\n  zoomIn(speed = 2) {\n    return this._zoomFromCenter(speed);\n  }\n\n  zoomOut(speed = 2) {\n    return this._zoomFromCenter(1 / speed);\n  }\n\n  moveLeft(speed = 100) {\n    return this._panFromCenter([speed, 0]);\n  }\n\n  moveRight(speed = 100) {\n    return this._panFromCenter([-speed, 0]);\n  }\n\n  moveUp(speed = 100) {\n    return this._panFromCenter([0, speed]);\n  }\n\n  moveDown(speed = 100) {\n    return this._panFromCenter([0, -speed]);\n  }\n\n  rotateLeft(speed = 15) {\n    return this._getUpdatedState({\n      bearing: this._viewportProps.bearing - speed\n    });\n  }\n\n  rotateRight(speed = 15) {\n    return this._getUpdatedState({\n      bearing: this._viewportProps.bearing + speed\n    });\n  }\n\n  rotateUp(speed = 10) {\n    return this._getUpdatedState({\n      pitch: this._viewportProps.pitch + speed\n    });\n  }\n\n  rotateDown(speed = 10) {\n    return this._getUpdatedState({\n      pitch: this._viewportProps.pitch - speed\n    });\n  }\n\n  shortestPathFrom(viewState) {\n    const fromProps = viewState.getViewportProps();\n    const props = { ...this._viewportProps\n    };\n    const {\n      bearing,\n      longitude\n    } = props;\n\n    if (Math.abs(bearing - fromProps.bearing) > 180) {\n      props.bearing = bearing < 0 ? bearing + 360 : bearing - 360;\n    }\n\n    if (Math.abs(longitude - fromProps.longitude) > 180) {\n      props.longitude = longitude < 0 ? longitude + 360 : longitude - 360;\n    }\n\n    return props;\n  }\n\n  _zoomFromCenter(scale) {\n    const {\n      width,\n      height\n    } = this._viewportProps;\n    return this.zoom({\n      pos: [width / 2, height / 2],\n      scale\n    });\n  }\n\n  _panFromCenter(offset) {\n    const {\n      width,\n      height\n    } = this._viewportProps;\n    return this.pan({\n      startPos: [width / 2, height / 2],\n      pos: [width / 2 + offset[0], height / 2 + offset[1]]\n    });\n  }\n\n  _getUpdatedState(newProps) {\n    return new this.constructor({\n      makeViewport: this.makeViewport,\n      ...this._viewportProps,\n      ...this._state,\n      ...newProps\n    });\n  }\n\n  _applyConstraints(props) {\n    const {\n      maxZoom,\n      minZoom,\n      zoom\n    } = props;\n    props.zoom = clamp(zoom, minZoom, maxZoom);\n    const {\n      maxPitch,\n      minPitch,\n      pitch\n    } = props;\n    props.pitch = clamp(pitch, minPitch, maxPitch);\n    const {\n      normalize = true\n    } = props;\n\n    if (normalize) {\n      Object.assign(props, normalizeViewportProps(props));\n    }\n\n    return props;\n  }\n\n  _unproject(pos) {\n    const viewport = this.makeViewport(this._viewportProps);\n    return pos && viewport.unproject(pos);\n  }\n\n  _calculateNewZoom({\n    scale,\n    startZoom\n  }) {\n    const {\n      maxZoom,\n      minZoom\n    } = this._viewportProps;\n    const zoom = startZoom + Math.log2(scale);\n    return clamp(zoom, minZoom, maxZoom);\n  }\n\n  _calculateNewPitchAndBearing({\n    deltaScaleX,\n    deltaScaleY,\n    startBearing,\n    startPitch\n  }) {\n    deltaScaleY = clamp(deltaScaleY, -1, 1);\n    const {\n      minPitch,\n      maxPitch\n    } = this._viewportProps;\n    const bearing = startBearing + 180 * deltaScaleX;\n    let pitch = startPitch;\n\n    if (deltaScaleY > 0) {\n      pitch = startPitch + deltaScaleY * (maxPitch - startPitch);\n    } else if (deltaScaleY < 0) {\n      pitch = startPitch - deltaScaleY * (minPitch - startPitch);\n    }\n\n    return {\n      pitch,\n      bearing\n    };\n  }\n\n  _getRotationParams(pos, startPos) {\n    const deltaX = pos[0] - startPos[0];\n    const deltaY = pos[1] - startPos[1];\n    const centerY = pos[1];\n    const startY = startPos[1];\n    const {\n      width,\n      height\n    } = this._viewportProps;\n    const deltaScaleX = deltaX / width;\n    let deltaScaleY = 0;\n\n    if (deltaY > 0) {\n      if (Math.abs(height - startY) > PITCH_MOUSE_THRESHOLD) {\n        deltaScaleY = deltaY / (startY - height) * PITCH_ACCEL;\n      }\n    } else if (deltaY < 0) {\n      if (startY > PITCH_MOUSE_THRESHOLD) {\n        deltaScaleY = 1 - centerY / startY;\n      }\n    }\n\n    deltaScaleY = Math.min(1, Math.max(-1, deltaScaleY));\n    return {\n      deltaScaleX,\n      deltaScaleY\n    };\n  }\n\n}\nexport default class MapController extends Controller {\n  constructor(props) {\n    props.dragMode = props.dragMode || 'pan';\n    super(MapState, props);\n  }\n\n  setProps(props) {\n    const oldProps = this.controllerStateProps;\n    super.setProps(props);\n    const dimensionChanged = !oldProps || oldProps.height !== props.height;\n\n    if (dimensionChanged) {\n      this.updateViewport(new this.ControllerState({\n        makeViewport: this.makeViewport,\n        ...this.controllerStateProps,\n        ...this._state\n      }));\n    }\n  }\n\n  get linearTransitionProps() {\n    return ['longitude', 'latitude', 'zoom', 'bearing', 'pitch'];\n  }\n\n}\n//# sourceMappingURL=map-controller.js.map","import View from './view';\nimport WebMercatorViewport from '../viewports/web-mercator-viewport';\nimport MapController from '../controllers/map-controller';\nexport default class MapView extends View {\n  constructor(props) {\n    super({ ...props,\n      type: WebMercatorViewport\n    });\n  }\n\n  get controller() {\n    return this._getControllerProps({\n      type: MapController\n    });\n  }\n\n}\nMapView.displayName = 'MapView';\n//# sourceMappingURL=map-view.js.map","import { deepEqual } from '../utils/deep-equal';\nimport { default as LightingEffect } from '../effects/lighting/lighting-effect';\nconst DEFAULT_LIGHTING_EFFECT = new LightingEffect();\nexport default class EffectManager {\n  constructor() {\n    this.effects = [];\n    this._internalEffects = [];\n    this._needsRedraw = 'Initial render';\n    this.setEffects();\n  }\n\n  setProps(props) {\n    if ('effects' in props) {\n      if (props.effects.length !== this.effects.length || !deepEqual(props.effects, this.effects)) {\n        this.setEffects(props.effects);\n        this._needsRedraw = 'effects changed';\n      }\n    }\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    return redraw;\n  }\n\n  getEffects() {\n    return this._internalEffects;\n  }\n\n  finalize() {\n    this.cleanup();\n  }\n\n  setEffects(effects = []) {\n    this.cleanup();\n    this.effects = effects;\n\n    this._createInternalEffects();\n  }\n\n  cleanup() {\n    for (const effect of this.effects) {\n      effect.cleanup();\n    }\n\n    for (const effect of this._internalEffects) {\n      effect.cleanup();\n    }\n\n    this.effects.length = 0;\n    this._internalEffects.length = 0;\n  }\n\n  _createInternalEffects() {\n    this._internalEffects = this.effects.slice();\n\n    if (!this.effects.some(effect => effect instanceof LightingEffect)) {\n      this._internalEffects.push(DEFAULT_LIGHTING_EFFECT);\n    }\n  }\n\n}\n//# sourceMappingURL=effect-manager.js.map","import LayersPass from './layers-pass';\nexport default class DrawLayersPass extends LayersPass {}\n//# sourceMappingURL=draw-layers-pass.js.map","import LayersPass from './layers-pass';\nimport { withParameters } from '@luma.gl/core';\nconst PICKING_PARAMETERS = {\n  blendFunc: [1, 0, 32771, 0],\n  blendEquation: 32774\n};\nexport default class PickLayersPass extends LayersPass {\n  render(props) {\n    if (props.pickingFBO) {\n      this.useAlpha = true;\n\n      this._drawPickingBuffer(props);\n    } else {\n      this.useAlpha = false;\n      super.render(props);\n    }\n  }\n\n  _drawPickingBuffer({\n    layers,\n    layerFilter,\n    views,\n    viewports,\n    onViewportActive,\n    pickingFBO,\n    deviceRect: {\n      x,\n      y,\n      width,\n      height\n    },\n    pass = 'picking',\n    redrawReason,\n    pickZ\n  }) {\n    const gl = this.gl;\n    this.pickZ = pickZ;\n    return withParameters(gl, {\n      scissorTest: true,\n      scissor: [x, y, width, height],\n      clearColor: [0, 0, 0, 0],\n      depthMask: true,\n      depthTest: true,\n      depthRange: [0, 1],\n      colorMask: [true, true, true, true],\n      ...PICKING_PARAMETERS,\n      blend: !pickZ\n    }, () => {\n      super.render({\n        target: pickingFBO,\n        layers,\n        layerFilter,\n        views,\n        viewports,\n        onViewportActive,\n        pass,\n        redrawReason\n      });\n    });\n  }\n\n  shouldDrawLayer(layer) {\n    return layer.props.pickable;\n  }\n\n  getModuleParameters() {\n    return {\n      pickingActive: 1,\n      pickingAttribute: this.pickZ,\n      lightSources: {}\n    };\n  }\n\n  getLayerParameters(layer, layerIndex) {\n    const pickParameters = this.pickZ ? {\n      blend: false\n    } : { ...PICKING_PARAMETERS,\n      blend: true,\n      blendColor: [0, 0, 0, this.useAlpha ? (layerIndex + 1) / 255 : 1]\n    };\n    return { ...layer.props.parameters,\n      ...pickParameters\n    };\n  }\n\n}\n//# sourceMappingURL=pick-layers-pass.js.map","import debug from '../debug';\nimport DrawLayersPass from '../passes/draw-layers-pass';\nimport PickLayersPass from '../passes/pick-layers-pass';\nimport { Framebuffer } from '@luma.gl/core';\nconst TRACE_RENDER_LAYERS = 'deckRenderer.renderLayers';\nexport default class DeckRenderer {\n  constructor(gl) {\n    this.gl = gl;\n    this.layerFilter = null;\n    this.drawPickingColors = false;\n    this.drawLayersPass = new DrawLayersPass(gl);\n    this.pickLayersPass = new PickLayersPass(gl);\n    this.renderCount = 0;\n    this._needsRedraw = 'Initial render';\n    this.renderBuffers = [];\n    this.lastPostProcessEffect = null;\n  }\n\n  setProps(props) {\n    if ('layerFilter' in props && this.layerFilter !== props.layerFilter) {\n      this.layerFilter = props.layerFilter;\n      this._needsRedraw = 'layerFilter changed';\n    }\n\n    if ('drawPickingColors' in props && this.drawPickingColors !== props.drawPickingColors) {\n      this.drawPickingColors = props.drawPickingColors;\n      this._needsRedraw = 'drawPickingColors changed';\n    }\n  }\n\n  renderLayers(opts) {\n    const layerPass = this.drawPickingColors ? this.pickLayersPass : this.drawLayersPass;\n    opts.layerFilter = this.layerFilter;\n    opts.effects = opts.effects || [];\n    opts.target = opts.target || Framebuffer.getDefaultFramebuffer(this.gl);\n\n    this._preRender(opts.effects, opts);\n\n    const outputBuffer = this.lastPostProcessEffect ? this.renderBuffers[0] : opts.target;\n    const renderStats = layerPass.render({ ...opts,\n      target: outputBuffer\n    });\n\n    this._postRender(opts.effects, opts);\n\n    this.renderCount++;\n    debug(TRACE_RENDER_LAYERS, this, renderStats, opts);\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    return redraw;\n  }\n\n  finalize() {\n    const {\n      renderBuffers\n    } = this;\n\n    for (const buffer of renderBuffers) {\n      buffer.delete();\n    }\n\n    renderBuffers.length = 0;\n  }\n\n  _preRender(effects, opts) {\n    let lastPostProcessEffect = null;\n\n    for (const effect of effects) {\n      effect.preRender(this.gl, opts);\n\n      if (effect.postRender) {\n        lastPostProcessEffect = effect;\n      }\n    }\n\n    if (lastPostProcessEffect) {\n      this._resizeRenderBuffers();\n    }\n\n    this.lastPostProcessEffect = lastPostProcessEffect;\n  }\n\n  _resizeRenderBuffers() {\n    const {\n      renderBuffers\n    } = this;\n\n    if (renderBuffers.length === 0) {\n      renderBuffers.push(new Framebuffer(this.gl), new Framebuffer(this.gl));\n    }\n\n    for (const buffer of renderBuffers) {\n      buffer.resize();\n    }\n  }\n\n  _postRender(effects, opts) {\n    const {\n      renderBuffers\n    } = this;\n    const params = {\n      inputBuffer: renderBuffers[0],\n      swapBuffer: renderBuffers[1],\n      target: null\n    };\n\n    for (const effect of effects) {\n      if (effect.postRender) {\n        if (effect === this.lastPostProcessEffect) {\n          params.target = opts.target;\n          effect.postRender(this.gl, params);\n          break;\n        }\n\n        const buffer = effect.postRender(this.gl, params);\n        params.inputBuffer = buffer;\n        params.swapBuffer = buffer === renderBuffers[0] ? renderBuffers[1] : renderBuffers[0];\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=deck-renderer.js.map","import log from '../../utils/log';\nconst NO_PICKED_OBJECT = {\n  pickedColor: null,\n  pickedLayer: null,\n  pickedObjectIndex: -1\n};\nexport function getClosestObject({\n  pickedColors,\n  layers,\n  deviceX,\n  deviceY,\n  deviceRadius,\n  deviceRect\n}) {\n  if (pickedColors) {\n    const {\n      x,\n      y,\n      width,\n      height\n    } = deviceRect;\n    let minSquareDistanceToCenter = deviceRadius * deviceRadius;\n    let closestPixelIndex = -1;\n    let i = 0;\n\n    for (let row = 0; row < height; row++) {\n      const dy = row + y - deviceY;\n      const dy2 = dy * dy;\n\n      if (dy2 > minSquareDistanceToCenter) {\n        i += 4 * width;\n      } else {\n        for (let col = 0; col < width; col++) {\n          const pickedLayerIndex = pickedColors[i + 3] - 1;\n\n          if (pickedLayerIndex >= 0) {\n            const dx = col + x - deviceX;\n            const d2 = dx * dx + dy2;\n\n            if (d2 <= minSquareDistanceToCenter) {\n              minSquareDistanceToCenter = d2;\n              closestPixelIndex = i;\n            }\n          }\n\n          i += 4;\n        }\n      }\n    }\n\n    if (closestPixelIndex >= 0) {\n      const pickedLayerIndex = pickedColors[closestPixelIndex + 3] - 1;\n      const pickedColor = pickedColors.slice(closestPixelIndex, closestPixelIndex + 4);\n      const pickedLayer = layers[pickedLayerIndex];\n\n      if (pickedLayer) {\n        const pickedObjectIndex = pickedLayer.decodePickingColor(pickedColor);\n        const dy = Math.floor(closestPixelIndex / 4 / width);\n        const dx = closestPixelIndex / 4 - dy * width;\n        return {\n          pickedColor,\n          pickedLayer,\n          pickedObjectIndex,\n          pickedX: x + dx,\n          pickedY: y + dy\n        };\n      }\n\n      log.error('Picked non-existent layer. Is picking buffer corrupt?')();\n    }\n  }\n\n  return NO_PICKED_OBJECT;\n}\nexport function getUniqueObjects({\n  pickedColors,\n  layers\n}) {\n  const uniqueColors = new Map();\n\n  if (pickedColors) {\n    for (let i = 0; i < pickedColors.length; i += 4) {\n      const pickedLayerIndex = pickedColors[i + 3] - 1;\n\n      if (pickedLayerIndex >= 0) {\n        const pickedColor = pickedColors.slice(i, i + 4);\n        const colorKey = pickedColor.join(',');\n\n        if (!uniqueColors.has(colorKey)) {\n          const pickedLayer = layers[pickedLayerIndex];\n\n          if (pickedLayer) {\n            uniqueColors.set(colorKey, {\n              pickedColor,\n              pickedLayer,\n              pickedObjectIndex: pickedLayer.decodePickingColor(pickedColor)\n            });\n          } else {\n            log.error('Picked non-existent layer. Is picking buffer corrupt?')();\n          }\n        }\n      }\n    }\n  }\n\n  return Array.from(uniqueColors.values());\n}\n//# sourceMappingURL=query-object.js.map","export function getEmptyPickingInfo({\n  pickInfo,\n  mode,\n  viewports,\n  layerFilter,\n  pixelRatio,\n  x,\n  y,\n  z\n}) {\n  const layer = pickInfo && pickInfo.pickedLayer;\n\n  const viewportFilter = layerFilter && layer && (v => layerFilter({\n    layer,\n    viewport: v,\n    isPicking: true,\n    renderPass: \"picking:\".concat(mode)\n  }));\n\n  const viewport = getViewportFromCoordinates(viewports, {\n    x,\n    y\n  }, viewportFilter);\n  const coordinate = viewport && viewport.unproject([x - viewport.x, y - viewport.y], {\n    targetZ: z\n  });\n  return {\n    color: null,\n    layer: null,\n    viewport,\n    index: -1,\n    picked: false,\n    x,\n    y,\n    pixel: [x, y],\n    coordinate,\n    devicePixel: pickInfo && [pickInfo.pickedX, pickInfo.pickedY],\n    pixelRatio\n  };\n}\nexport function processPickInfo(opts) {\n  const {\n    pickInfo,\n    lastPickedInfo,\n    mode,\n    layers\n  } = opts;\n  const {\n    pickedColor,\n    pickedLayer,\n    pickedObjectIndex\n  } = pickInfo;\n  const affectedLayers = pickedLayer ? [pickedLayer] : [];\n\n  if (mode === 'hover') {\n    const lastPickedObjectIndex = lastPickedInfo.index;\n    const lastPickedLayerId = lastPickedInfo.layerId;\n    const pickedLayerId = pickedLayer && pickedLayer.props.id;\n\n    if (pickedLayerId !== lastPickedLayerId || pickedObjectIndex !== lastPickedObjectIndex) {\n      if (pickedLayerId !== lastPickedLayerId) {\n        const lastPickedLayer = layers.find(layer => layer.props.id === lastPickedLayerId);\n\n        if (lastPickedLayer) {\n          affectedLayers.unshift(lastPickedLayer);\n        }\n      }\n\n      lastPickedInfo.layerId = pickedLayerId;\n      lastPickedInfo.index = pickedObjectIndex;\n      lastPickedInfo.info = null;\n    }\n  }\n\n  const baseInfo = getEmptyPickingInfo(opts);\n  const infos = new Map();\n  infos.set(null, baseInfo);\n  affectedLayers.forEach(layer => {\n    let info = { ...baseInfo\n    };\n\n    if (layer === pickedLayer) {\n      info.color = pickedColor;\n      info.index = pickedObjectIndex;\n      info.picked = true;\n    }\n\n    info = getLayerPickingInfo({\n      layer,\n      info,\n      mode\n    });\n\n    if (layer === pickedLayer && mode === 'hover') {\n      lastPickedInfo.info = info;\n    }\n\n    infos.set(info.layer.id, info);\n\n    if (mode === 'hover') {\n      info.layer.updateAutoHighlight(info);\n    }\n  });\n  return infos;\n}\nexport function getLayerPickingInfo({\n  layer,\n  info,\n  mode\n}) {\n  while (layer && info) {\n    const sourceLayer = info.layer || null;\n    info.sourceLayer = sourceLayer;\n    info.layer = layer;\n    info = layer.getPickingInfo({\n      info,\n      mode,\n      sourceLayer\n    });\n    layer = layer.parent;\n  }\n\n  return info;\n}\n\nfunction getViewportFromCoordinates(viewports, pixel, filter) {\n  for (let i = viewports.length - 1; i >= 0; i--) {\n    const viewport = viewports[i];\n\n    if (viewport.containsPixel(pixel) && (!filter || filter(viewport))) {\n      return viewport;\n    }\n  }\n\n  return viewports[0];\n}\n//# sourceMappingURL=pick-info.js.map","import { Framebuffer, Texture2D, isWebGL2, readPixelsToArray, cssToDeviceRatio, cssToDevicePixels } from '@luma.gl/core';\nimport log from '../utils/log';\nimport PickLayersPass from '../passes/pick-layers-pass';\nimport { getClosestObject, getUniqueObjects } from './picking/query-object';\nimport { processPickInfo, getLayerPickingInfo, getEmptyPickingInfo } from './picking/pick-info';\nexport default class DeckPicker {\n  constructor(gl) {\n    this.gl = gl;\n    this.pickingFBO = null;\n    this.pickLayersPass = new PickLayersPass(gl);\n    this.layerFilter = null;\n    this.lastPickedInfo = {\n      index: -1,\n      layerId: null,\n      info: null\n    };\n  }\n\n  setProps(props) {\n    if ('layerFilter' in props) {\n      this.layerFilter = props.layerFilter;\n    }\n\n    if ('_pickable' in props) {\n      this._pickable = props._pickable;\n    }\n  }\n\n  finalize() {\n    if (this.pickingFBO) {\n      this.pickingFBO.delete();\n    }\n\n    if (this.depthFBO) {\n      this.depthFBO.color.delete();\n      this.depthFBO.delete();\n    }\n  }\n\n  pickObject(opts) {\n    return this._pickClosestObject(opts);\n  }\n\n  pickObjects(opts) {\n    return this._pickVisibleObjects(opts);\n  }\n\n  getLastPickedObject({\n    x,\n    y,\n    layers,\n    viewports\n  }, lastPickedInfo = this.lastPickedInfo.info) {\n    const lastPickedLayerId = lastPickedInfo && lastPickedInfo.layer && lastPickedInfo.layer.id;\n    const lastPickedViewportId = lastPickedInfo && lastPickedInfo.viewport && lastPickedInfo.viewport.id;\n    const layer = lastPickedLayerId ? layers.find(l => l.id === lastPickedLayerId) : null;\n    const viewport = lastPickedViewportId && viewports.find(v => v.id === lastPickedViewportId) || viewports[0];\n    const coordinate = viewport && viewport.unproject([x - viewport.x, y - viewport.y]);\n    const info = {\n      x,\n      y,\n      viewport,\n      coordinate,\n      layer\n    };\n\n    if (layer) {\n      return { ...lastPickedInfo,\n        ...info\n      };\n    }\n\n    return Object.assign(info, {\n      color: null,\n      object: null,\n      index: -1\n    });\n  }\n\n  _resizeBuffer() {\n    const {\n      gl\n    } = this;\n\n    if (!this.pickingFBO) {\n      this.pickingFBO = new Framebuffer(gl);\n\n      if (Framebuffer.isSupported(gl, {\n        colorBufferFloat: true\n      })) {\n        this.depthFBO = new Framebuffer(gl);\n        this.depthFBO.attach({\n          [36064]: new Texture2D(gl, {\n            format: isWebGL2(gl) ? 34836 : 6408,\n            type: 5126\n          })\n        });\n      }\n    }\n\n    this.pickingFBO.resize({\n      width: gl.canvas.width,\n      height: gl.canvas.height\n    });\n\n    if (this.depthFBO) {\n      this.depthFBO.resize({\n        width: gl.canvas.width,\n        height: gl.canvas.height\n      });\n    }\n\n    return this.pickingFBO;\n  }\n\n  _getPickable(layers) {\n    if (this._pickable === false) {\n      return null;\n    }\n\n    const pickableLayers = layers.filter(layer => layer.isPickable() && !layer.isComposite);\n\n    if (pickableLayers.length > 255) {\n      log.warn('Too many pickable layers, only picking the first 255')();\n      return pickableLayers.slice(0, 255);\n    }\n\n    return pickableLayers.length ? pickableLayers : null;\n  }\n\n  _pickClosestObject({\n    layers,\n    views,\n    viewports,\n    x,\n    y,\n    radius = 0,\n    depth = 1,\n    mode = 'query',\n    unproject3D,\n    onViewportActive\n  }) {\n    layers = this._getPickable(layers);\n\n    if (!layers) {\n      return {\n        result: [],\n        emptyInfo: getEmptyPickingInfo({\n          viewports,\n          x,\n          y\n        })\n      };\n    }\n\n    this._resizeBuffer();\n\n    const pixelRatio = cssToDeviceRatio(this.gl);\n    const devicePixelRange = cssToDevicePixels(this.gl, [x, y], true);\n    const devicePixel = [devicePixelRange.x + Math.floor(devicePixelRange.width / 2), devicePixelRange.y + Math.floor(devicePixelRange.height / 2)];\n    const deviceRadius = Math.round(radius * pixelRatio);\n    const {\n      width,\n      height\n    } = this.pickingFBO;\n\n    const deviceRect = this._getPickingRect({\n      deviceX: devicePixel[0],\n      deviceY: devicePixel[1],\n      deviceRadius,\n      deviceWidth: width,\n      deviceHeight: height\n    });\n\n    let infos;\n    const result = [];\n    const affectedLayers = {};\n\n    for (let i = 0; i < depth; i++) {\n      const pickedColors = deviceRect && this._drawAndSample({\n        layers,\n        views,\n        viewports,\n        onViewportActive,\n        deviceRect,\n        pass: \"picking:\".concat(mode),\n        redrawReason: mode\n      });\n\n      const pickInfo = getClosestObject({\n        pickedColors,\n        layers,\n        deviceX: devicePixel[0],\n        deviceY: devicePixel[1],\n        deviceRadius,\n        deviceRect\n      });\n      let z;\n\n      if (pickInfo.pickedLayer && unproject3D && this.depthFBO) {\n        const zValues = this._drawAndSample({\n          layers: [pickInfo.pickedLayer],\n          views,\n          viewports,\n          onViewportActive,\n          deviceRect: {\n            x: pickInfo.pickedX,\n            y: pickInfo.pickedY,\n            width: 1,\n            height: 1\n          },\n          pass: \"picking:\".concat(mode),\n          redrawReason: 'pick-z',\n          pickZ: true\n        });\n\n        z = zValues[0] * viewports[0].distanceScales.metersPerUnit[2] + viewports[0].position[2];\n      }\n\n      if (pickInfo.pickedColor && i + 1 < depth) {\n        const layerId = pickInfo.pickedColor[3] - 1;\n        affectedLayers[layerId] = true;\n        layers[layerId].disablePickingIndex(pickInfo.pickedObjectIndex);\n      }\n\n      infos = processPickInfo({\n        pickInfo,\n        lastPickedInfo: this.lastPickedInfo,\n        mode,\n        layers,\n        layerFilter: this.layerFilter,\n        viewports,\n        x,\n        y,\n        z,\n        pixelRatio\n      });\n\n      for (const info of infos.values()) {\n        if (info.layer) {\n          result.push(info);\n        }\n      }\n\n      if (!pickInfo.pickedColor) {\n        break;\n      }\n    }\n\n    for (const layerId in affectedLayers) {\n      layers[layerId].restorePickingColors();\n    }\n\n    return {\n      result,\n      emptyInfo: infos && infos.get(null)\n    };\n  }\n\n  _pickVisibleObjects({\n    layers,\n    views,\n    viewports,\n    x,\n    y,\n    width = 1,\n    height = 1,\n    mode = 'query',\n    maxObjects = null,\n    onViewportActive\n  }) {\n    layers = this._getPickable(layers);\n\n    if (!layers) {\n      return [];\n    }\n\n    this._resizeBuffer();\n\n    const pixelRatio = cssToDeviceRatio(this.gl);\n    const leftTop = cssToDevicePixels(this.gl, [x, y], true);\n    const deviceLeft = leftTop.x;\n    const deviceTop = leftTop.y + leftTop.height;\n    const rightBottom = cssToDevicePixels(this.gl, [x + width, y + height], true);\n    const deviceRight = rightBottom.x + rightBottom.width;\n    const deviceBottom = rightBottom.y;\n    const deviceRect = {\n      x: deviceLeft,\n      y: deviceBottom,\n      width: deviceRight - deviceLeft,\n      height: deviceTop - deviceBottom\n    };\n\n    const pickedColors = this._drawAndSample({\n      layers,\n      views,\n      viewports,\n      onViewportActive,\n      deviceRect,\n      pass: \"picking:\".concat(mode),\n      redrawReason: mode\n    });\n\n    const pickInfos = getUniqueObjects({\n      pickedColors,\n      layers\n    });\n    const uniqueInfos = new Map();\n    const isMaxObjects = Number.isFinite(maxObjects);\n\n    for (let i = 0; i < pickInfos.length; i++) {\n      if (isMaxObjects && uniqueInfos.size >= maxObjects) {\n        break;\n      }\n\n      const pickInfo = pickInfos[i];\n      let info = {\n        color: pickInfo.pickedColor,\n        layer: null,\n        index: pickInfo.pickedObjectIndex,\n        picked: true,\n        x,\n        y,\n        width,\n        height,\n        pixelRatio\n      };\n      info = getLayerPickingInfo({\n        layer: pickInfo.pickedLayer,\n        info,\n        mode\n      });\n\n      if (!uniqueInfos.has(info.object)) {\n        uniqueInfos.set(info.object, info);\n      }\n    }\n\n    return Array.from(uniqueInfos.values());\n  }\n\n  _drawAndSample({\n    layers,\n    views,\n    viewports,\n    onViewportActive,\n    deviceRect,\n    pass,\n    redrawReason,\n    pickZ\n  }) {\n    if (layers.length < 1) {\n      return null;\n    }\n\n    const pickingFBO = pickZ ? this.depthFBO : this.pickingFBO;\n    this.pickLayersPass.render({\n      layers,\n      layerFilter: this.layerFilter,\n      views,\n      viewports,\n      onViewportActive,\n      pickingFBO,\n      deviceRect,\n      pass,\n      redrawReason,\n      pickZ\n    });\n    const {\n      x,\n      y,\n      width,\n      height\n    } = deviceRect;\n    const pickedColors = new (pickZ ? Float32Array : Uint8Array)(width * height * 4);\n    readPixelsToArray(pickingFBO, {\n      sourceX: x,\n      sourceY: y,\n      sourceWidth: width,\n      sourceHeight: height,\n      target: pickedColors\n    });\n    return pickedColors;\n  }\n\n  _getPickingRect({\n    deviceX,\n    deviceY,\n    deviceRadius,\n    deviceWidth,\n    deviceHeight\n  }) {\n    const x = Math.max(0, deviceX - deviceRadius);\n    const y = Math.max(0, deviceY - deviceRadius);\n    const width = Math.min(deviceWidth, deviceX + deviceRadius + 1) - x;\n    const height = Math.min(deviceHeight, deviceY + deviceRadius + 1) - y;\n\n    if (width <= 0 || height <= 0) {\n      return null;\n    }\n\n    return {\n      x,\n      y,\n      width,\n      height\n    };\n  }\n\n}\n//# sourceMappingURL=deck-picker.js.map","const defaultStyle = {\n  zIndex: 1,\n  position: 'absolute',\n  pointerEvents: 'none',\n  color: '#a0a7b4',\n  backgroundColor: '#29323c',\n  padding: '10px',\n  top: 0,\n  left: 0,\n  display: 'none'\n};\nexport default class Tooltip {\n  constructor(canvas) {\n    const canvasParent = canvas.parentElement;\n\n    if (canvasParent) {\n      this.el = document.createElement('div');\n      this.el.className = 'deck-tooltip';\n      Object.assign(this.el.style, defaultStyle);\n      canvasParent.appendChild(this.el);\n    }\n\n    this.isVisible = false;\n  }\n\n  setTooltip(displayInfo, x, y) {\n    const el = this.el;\n\n    if (typeof displayInfo === 'string') {\n      el.innerText = displayInfo;\n    } else if (!displayInfo) {\n      this.isVisible = false;\n      el.style.display = 'none';\n      return;\n    } else {\n      if ('text' in displayInfo) {\n        el.innerText = displayInfo.text;\n      }\n\n      if ('html' in displayInfo) {\n        el.innerHTML = displayInfo.html;\n      }\n\n      if ('className' in displayInfo) {\n        el.className = displayInfo.className;\n      }\n\n      Object.assign(el.style, displayInfo.style);\n    }\n\n    this.isVisible = true;\n    el.style.display = 'block';\n    el.style.transform = \"translate(\".concat(x, \"px, \").concat(y, \"px)\");\n  }\n\n  remove() {\n    if (this.el) {\n      this.el.remove();\n    }\n  }\n\n}\n//# sourceMappingURL=tooltip.js.map","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n","const INPUT_START = 1;\nconst INPUT_MOVE = 2;\nconst INPUT_END = 4;\nconst MOUSE_INPUT_MAP = {\n  mousedown: INPUT_START,\n  mousemove: INPUT_MOVE,\n  mouseup: INPUT_END\n};\n\nfunction some(array, predict) {\n  for (let i = 0; i < array.length; i++) {\n    if (predict(array[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function enhancePointerEventInput(PointerEventInput) {\n  const oldHandler = PointerEventInput.prototype.handler;\n\n  PointerEventInput.prototype.handler = function handler(ev) {\n    const store = this.store;\n\n    if (ev.button > 0 && ev.type === 'pointerdown') {\n      if (!some(store, e => e.pointerId === ev.pointerId)) {\n        store.push(ev);\n      }\n    }\n\n    oldHandler.call(this, ev);\n  };\n}\nexport function enhanceMouseInput(MouseInput) {\n  MouseInput.prototype.handler = function handler(ev) {\n    let eventType = MOUSE_INPUT_MAP[ev.type];\n\n    if (eventType & INPUT_START && ev.button >= 0) {\n      this.pressed = true;\n    }\n\n    if (eventType & INPUT_MOVE && ev.which === 0) {\n      eventType = INPUT_END;\n    }\n\n    if (!this.pressed) {\n      return;\n    }\n\n    if (eventType & INPUT_END) {\n      this.pressed = false;\n    }\n\n    this.callback(this.manager, eventType, {\n      pointers: [ev],\n      changedPointers: [ev],\n      pointerType: 'mouse',\n      srcEvent: ev\n    });\n  };\n}\n//# sourceMappingURL=hammer-overrides.js.map","import hammerjs from 'hammerjs';\nimport { enhancePointerEventInput, enhanceMouseInput } from './hammer-overrides';\nenhancePointerEventInput(hammerjs.PointerEventInput);\nenhanceMouseInput(hammerjs.MouseInput);\nexport const Manager = hammerjs.Manager;\nexport default hammerjs;\n//# sourceMappingURL=hammer.browser.js.map","import Hammer from './utils/hammer';\nexport const RECOGNIZERS = Hammer ? [[Hammer.Pan, {\n  event: 'tripan',\n  pointers: 3,\n  threshold: 0,\n  enable: false\n}], [Hammer.Rotate, {\n  enable: false\n}], [Hammer.Pinch, {\n  enable: false\n}], [Hammer.Swipe, {\n  enable: false\n}], [Hammer.Pan, {\n  threshold: 0,\n  enable: false\n}], [Hammer.Press, {\n  enable: false\n}], [Hammer.Tap, {\n  event: 'doubletap',\n  taps: 2,\n  enable: false\n}], [Hammer.Tap, {\n  event: 'anytap',\n  enable: false\n}], [Hammer.Tap, {\n  enable: false\n}]] : null;\nexport const RECOGNIZER_COMPATIBLE_MAP = {\n  tripan: ['rotate', 'pinch', 'pan'],\n  rotate: ['pinch'],\n  pinch: ['pan'],\n  pan: ['press', 'doubletap', 'anytap', 'tap'],\n  doubletap: ['anytap'],\n  anytap: ['tap']\n};\nexport const RECOGNIZER_FALLBACK_MAP = {\n  doubletap: ['tap']\n};\nexport const BASIC_EVENT_ALIASES = {\n  pointerdown: 'pointerdown',\n  pointermove: 'pointermove',\n  pointerup: 'pointerup',\n  touchstart: 'pointerdown',\n  touchmove: 'pointermove',\n  touchend: 'pointerup',\n  mousedown: 'pointerdown',\n  mousemove: 'pointermove',\n  mouseup: 'pointerup'\n};\nexport const INPUT_EVENT_TYPES = {\n  KEY_EVENTS: ['keydown', 'keyup'],\n  MOUSE_EVENTS: ['mousedown', 'mousemove', 'mouseup', 'mouseover', 'mouseout', 'mouseleave'],\n  WHEEL_EVENTS: ['wheel', 'mousewheel']\n};\nexport const EVENT_RECOGNIZER_MAP = {\n  tap: 'tap',\n  anytap: 'anytap',\n  doubletap: 'doubletap',\n  press: 'press',\n  pinch: 'pinch',\n  pinchin: 'pinch',\n  pinchout: 'pinch',\n  pinchstart: 'pinch',\n  pinchmove: 'pinch',\n  pinchend: 'pinch',\n  pinchcancel: 'pinch',\n  rotate: 'rotate',\n  rotatestart: 'rotate',\n  rotatemove: 'rotate',\n  rotateend: 'rotate',\n  rotatecancel: 'rotate',\n  tripan: 'tripan',\n  tripanstart: 'tripan',\n  tripanmove: 'tripan',\n  tripanup: 'tripan',\n  tripandown: 'tripan',\n  tripanleft: 'tripan',\n  tripanright: 'tripan',\n  tripanend: 'tripan',\n  tripancancel: 'tripan',\n  pan: 'pan',\n  panstart: 'pan',\n  panmove: 'pan',\n  panup: 'pan',\n  pandown: 'pan',\n  panleft: 'pan',\n  panright: 'pan',\n  panend: 'pan',\n  pancancel: 'pan',\n  swipe: 'swipe',\n  swipeleft: 'swipe',\n  swiperight: 'swipe',\n  swipeup: 'swipe',\n  swipedown: 'swipe'\n};\nexport const GESTURE_EVENT_ALIASES = {\n  click: 'tap',\n  anyclick: 'anytap',\n  dblclick: 'doubletap',\n  mousedown: 'pointerdown',\n  mousemove: 'pointermove',\n  mouseup: 'pointerup',\n  mouseover: 'pointerover',\n  mouseout: 'pointerout',\n  mouseleave: 'pointerleave'\n};\n//# sourceMappingURL=constants.js.map","export const userAgent = typeof navigator !== 'undefined' && navigator.userAgent ? navigator.userAgent.toLowerCase() : '';\nconst window_ = typeof window !== 'undefined' ? window : global;\nconst global_ = typeof global !== 'undefined' ? global : window;\nconst document_ = typeof document !== 'undefined' ? document : {};\nexport { window_ as window, global_ as global, document_ as document };\nlet passiveSupported = false;\n\ntry {\n  const options = {\n    get passive() {\n      passiveSupported = true;\n      return true;\n    }\n\n  };\n  window_.addEventListener('test', options, options);\n  window_.removeEventListener('test', options, options);\n} catch (err) {}\n\nexport { passiveSupported };\n//# sourceMappingURL=globals.js.map","import { INPUT_EVENT_TYPES } from '../constants';\nimport { window, userAgent, passiveSupported } from '../utils/globals';\nconst firefox = userAgent.indexOf('firefox') !== -1;\nconst {\n  WHEEL_EVENTS\n} = INPUT_EVENT_TYPES;\nconst EVENT_TYPE = 'wheel';\nconst WHEEL_DELTA_MAGIC_SCALER = 4.000244140625;\nconst WHEEL_DELTA_PER_LINE = 40;\nconst SHIFT_MULTIPLIER = 0.25;\nexport default class WheelInput {\n  constructor(element, callback, options = {}) {\n    this.element = element;\n    this.callback = callback;\n    this.options = Object.assign({\n      enable: true\n    }, options);\n    this.events = WHEEL_EVENTS.concat(options.events || []);\n    this.handleEvent = this.handleEvent.bind(this);\n    this.events.forEach(event => element.addEventListener(event, this.handleEvent, passiveSupported ? {\n      passive: false\n    } : false));\n  }\n\n  destroy() {\n    this.events.forEach(event => this.element.removeEventListener(event, this.handleEvent));\n  }\n\n  enableEventType(eventType, enabled) {\n    if (eventType === EVENT_TYPE) {\n      this.options.enable = enabled;\n    }\n  }\n\n  handleEvent(event) {\n    if (!this.options.enable) {\n      return;\n    }\n\n    let value = event.deltaY;\n\n    if (window.WheelEvent) {\n      if (firefox && event.deltaMode === window.WheelEvent.DOM_DELTA_PIXEL) {\n        value /= window.devicePixelRatio;\n      }\n\n      if (event.deltaMode === window.WheelEvent.DOM_DELTA_LINE) {\n        value *= WHEEL_DELTA_PER_LINE;\n      }\n    }\n\n    const wheelPosition = {\n      x: event.clientX,\n      y: event.clientY\n    };\n\n    if (value !== 0 && value % WHEEL_DELTA_MAGIC_SCALER === 0) {\n      value = Math.floor(value / WHEEL_DELTA_MAGIC_SCALER);\n    }\n\n    if (event.shiftKey && value) {\n      value = value * SHIFT_MULTIPLIER;\n    }\n\n    this._onWheel(event, -value, wheelPosition);\n  }\n\n  _onWheel(srcEvent, delta, position) {\n    this.callback({\n      type: EVENT_TYPE,\n      center: position,\n      delta,\n      srcEvent,\n      pointerType: 'mouse',\n      target: srcEvent.target\n    });\n  }\n\n}\n//# sourceMappingURL=wheel-input.js.map","import { INPUT_EVENT_TYPES } from '../constants';\nconst {\n  MOUSE_EVENTS\n} = INPUT_EVENT_TYPES;\nconst MOVE_EVENT_TYPE = 'pointermove';\nconst OVER_EVENT_TYPE = 'pointerover';\nconst OUT_EVENT_TYPE = 'pointerout';\nconst LEAVE_EVENT_TYPE = 'pointerleave';\nexport default class MoveInput {\n  constructor(element, callback, options = {}) {\n    this.element = element;\n    this.callback = callback;\n    this.pressed = false;\n    this.options = Object.assign({\n      enable: true\n    }, options);\n    this.enableMoveEvent = this.options.enable;\n    this.enableLeaveEvent = this.options.enable;\n    this.enableOutEvent = this.options.enable;\n    this.enableOverEvent = this.options.enable;\n    this.events = MOUSE_EVENTS.concat(options.events || []);\n    this.handleEvent = this.handleEvent.bind(this);\n    this.events.forEach(event => element.addEventListener(event, this.handleEvent));\n  }\n\n  destroy() {\n    this.events.forEach(event => this.element.removeEventListener(event, this.handleEvent));\n  }\n\n  enableEventType(eventType, enabled) {\n    if (eventType === MOVE_EVENT_TYPE) {\n      this.enableMoveEvent = enabled;\n    }\n\n    if (eventType === OVER_EVENT_TYPE) {\n      this.enableOverEvent = enabled;\n    }\n\n    if (eventType === OUT_EVENT_TYPE) {\n      this.enableOutEvent = enabled;\n    }\n\n    if (eventType === LEAVE_EVENT_TYPE) {\n      this.enableLeaveEvent = enabled;\n    }\n  }\n\n  handleEvent(event) {\n    this.handleOverEvent(event);\n    this.handleOutEvent(event);\n    this.handleLeaveEvent(event);\n    this.handleMoveEvent(event);\n  }\n\n  handleOverEvent(event) {\n    if (this.enableOverEvent) {\n      if (event.type === 'mouseover') {\n        this.callback({\n          type: OVER_EVENT_TYPE,\n          srcEvent: event,\n          pointerType: 'mouse',\n          target: event.target\n        });\n      }\n    }\n  }\n\n  handleOutEvent(event) {\n    if (this.enableOutEvent) {\n      if (event.type === 'mouseout') {\n        this.callback({\n          type: OUT_EVENT_TYPE,\n          srcEvent: event,\n          pointerType: 'mouse',\n          target: event.target\n        });\n      }\n    }\n  }\n\n  handleLeaveEvent(event) {\n    if (this.enableLeaveEvent) {\n      if (event.type === 'mouseleave') {\n        this.callback({\n          type: LEAVE_EVENT_TYPE,\n          srcEvent: event,\n          pointerType: 'mouse',\n          target: event.target\n        });\n      }\n    }\n  }\n\n  handleMoveEvent(event) {\n    if (this.enableMoveEvent) {\n      switch (event.type) {\n        case 'mousedown':\n          if (event.button >= 0) {\n            this.pressed = true;\n          }\n\n          break;\n\n        case 'mousemove':\n          if (event.which === 0) {\n            this.pressed = false;\n          }\n\n          if (!this.pressed) {\n            this.callback({\n              type: MOVE_EVENT_TYPE,\n              srcEvent: event,\n              pointerType: 'mouse',\n              target: event.target\n            });\n          }\n\n          break;\n\n        case 'mouseup':\n          this.pressed = false;\n          break;\n\n        default:\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=move-input.js.map","import { INPUT_EVENT_TYPES } from '../constants';\nconst {\n  KEY_EVENTS\n} = INPUT_EVENT_TYPES;\nconst DOWN_EVENT_TYPE = 'keydown';\nconst UP_EVENT_TYPE = 'keyup';\nexport default class KeyInput {\n  constructor(element, callback, options = {}) {\n    this.element = element;\n    this.callback = callback;\n    this.options = Object.assign({\n      enable: true\n    }, options);\n    this.enableDownEvent = this.options.enable;\n    this.enableUpEvent = this.options.enable;\n    this.events = KEY_EVENTS.concat(options.events || []);\n    this.handleEvent = this.handleEvent.bind(this);\n    element.tabIndex = options.tabIndex || 0;\n    element.style.outline = 'none';\n    this.events.forEach(event => element.addEventListener(event, this.handleEvent));\n  }\n\n  destroy() {\n    this.events.forEach(event => this.element.removeEventListener(event, this.handleEvent));\n  }\n\n  enableEventType(eventType, enabled) {\n    if (eventType === DOWN_EVENT_TYPE) {\n      this.enableDownEvent = enabled;\n    }\n\n    if (eventType === UP_EVENT_TYPE) {\n      this.enableUpEvent = enabled;\n    }\n  }\n\n  handleEvent(event) {\n    const targetElement = event.target || event.srcElement;\n\n    if (targetElement.tagName === 'INPUT' && targetElement.type === 'text' || targetElement.tagName === 'TEXTAREA') {\n      return;\n    }\n\n    if (this.enableDownEvent && event.type === 'keydown') {\n      this.callback({\n        type: DOWN_EVENT_TYPE,\n        srcEvent: event,\n        key: event.key,\n        target: event.target\n      });\n    }\n\n    if (this.enableUpEvent && event.type === 'keyup') {\n      this.callback({\n        type: UP_EVENT_TYPE,\n        srcEvent: event,\n        key: event.key,\n        target: event.target\n      });\n    }\n  }\n\n}\n//# sourceMappingURL=key-input.js.map","const EVENT_TYPE = 'contextmenu';\nexport default class ContextmenuInput {\n  constructor(element, callback, options = {}) {\n    this.element = element;\n    this.callback = callback;\n    this.options = Object.assign({\n      enable: true\n    }, options);\n    this.handleEvent = this.handleEvent.bind(this);\n    element.addEventListener('contextmenu', this.handleEvent);\n  }\n\n  destroy() {\n    this.element.removeEventListener('contextmenu', this.handleEvent);\n  }\n\n  enableEventType(eventType, enabled) {\n    if (eventType === EVENT_TYPE) {\n      this.options.enable = enabled;\n    }\n  }\n\n  handleEvent(event) {\n    if (!this.options.enable) {\n      return;\n    }\n\n    this.callback({\n      type: EVENT_TYPE,\n      center: {\n        x: event.clientX,\n        y: event.clientY\n      },\n      srcEvent: event,\n      pointerType: 'mouse',\n      target: event.target\n    });\n  }\n\n}\n//# sourceMappingURL=contextmenu-input.js.map","const DOWN_EVENT = 1;\nconst MOVE_EVENT = 2;\nconst UP_EVENT = 4;\nconst MOUSE_EVENTS = {\n  pointerdown: DOWN_EVENT,\n  pointermove: MOVE_EVENT,\n  pointerup: UP_EVENT,\n  mousedown: DOWN_EVENT,\n  mousemove: MOVE_EVENT,\n  mouseup: UP_EVENT\n};\nconst MOUSE_EVENT_WHICH_LEFT = 1;\nconst MOUSE_EVENT_WHICH_MIDDLE = 2;\nconst MOUSE_EVENT_WHICH_RIGHT = 3;\nconst MOUSE_EVENT_BUTTON_LEFT = 0;\nconst MOUSE_EVENT_BUTTON_MIDDLE = 1;\nconst MOUSE_EVENT_BUTTON_RIGHT = 2;\nconst MOUSE_EVENT_BUTTONS_LEFT_MASK = 1;\nconst MOUSE_EVENT_BUTTONS_RIGHT_MASK = 2;\nconst MOUSE_EVENT_BUTTONS_MIDDLE_MASK = 4;\nexport function whichButtons(event) {\n  const eventType = MOUSE_EVENTS[event.srcEvent.type];\n\n  if (!eventType) {\n    return null;\n  }\n\n  const {\n    buttons,\n    button,\n    which\n  } = event.srcEvent;\n  let leftButton = false;\n  let middleButton = false;\n  let rightButton = false;\n\n  if (eventType === UP_EVENT || eventType === MOVE_EVENT && !Number.isFinite(buttons)) {\n    leftButton = which === MOUSE_EVENT_WHICH_LEFT;\n    middleButton = which === MOUSE_EVENT_WHICH_MIDDLE;\n    rightButton = which === MOUSE_EVENT_WHICH_RIGHT;\n  } else if (eventType === MOVE_EVENT) {\n    leftButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_LEFT_MASK);\n    middleButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_MIDDLE_MASK);\n    rightButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_RIGHT_MASK);\n  } else if (eventType === DOWN_EVENT) {\n    leftButton = button === MOUSE_EVENT_BUTTON_LEFT;\n    middleButton = button === MOUSE_EVENT_BUTTON_MIDDLE;\n    rightButton = button === MOUSE_EVENT_BUTTON_RIGHT;\n  }\n\n  return {\n    leftButton,\n    middleButton,\n    rightButton\n  };\n}\nexport function getOffsetPosition(event, rootElement) {\n  const {\n    srcEvent\n  } = event;\n\n  if (!event.center && !Number.isFinite(srcEvent.clientX)) {\n    return null;\n  }\n\n  const center = event.center || {\n    x: srcEvent.clientX,\n    y: srcEvent.clientY\n  };\n  const rect = rootElement.getBoundingClientRect();\n  const scaleX = rect.width / rootElement.offsetWidth || 1;\n  const scaleY = rect.height / rootElement.offsetHeight || 1;\n  const offsetCenter = {\n    x: (center.x - rect.left - rootElement.clientLeft) / scaleX,\n    y: (center.y - rect.top - rootElement.clientTop) / scaleY\n  };\n  return {\n    center,\n    offsetCenter\n  };\n}\n//# sourceMappingURL=event-utils.js.map","import { whichButtons, getOffsetPosition } from './event-utils';\nconst DEFAULT_OPTIONS = {\n  srcElement: 'root',\n  priority: 0\n};\nexport default class EventRegistrar {\n  constructor(eventManager) {\n    this.eventManager = eventManager;\n    this.handlers = [];\n    this.handlersByElement = new Map();\n    this.handleEvent = this.handleEvent.bind(this);\n    this._active = false;\n  }\n\n  isEmpty() {\n    return !this._active;\n  }\n\n  add(type, handler, opts, once = false, passive = false) {\n    const {\n      handlers,\n      handlersByElement\n    } = this;\n\n    if (opts && (typeof opts !== 'object' || opts.addEventListener)) {\n      opts = {\n        srcElement: opts\n      };\n    }\n\n    opts = opts ? Object.assign({}, DEFAULT_OPTIONS, opts) : DEFAULT_OPTIONS;\n    let entries = handlersByElement.get(opts.srcElement);\n\n    if (!entries) {\n      entries = [];\n      handlersByElement.set(opts.srcElement, entries);\n    }\n\n    const entry = {\n      type,\n      handler,\n      srcElement: opts.srcElement,\n      priority: opts.priority\n    };\n\n    if (once) {\n      entry.once = true;\n    }\n\n    if (passive) {\n      entry.passive = true;\n    }\n\n    handlers.push(entry);\n    this._active = this._active || !entry.passive;\n    let insertPosition = entries.length - 1;\n\n    while (insertPosition >= 0) {\n      if (entries[insertPosition].priority >= entry.priority) {\n        break;\n      }\n\n      insertPosition--;\n    }\n\n    entries.splice(insertPosition + 1, 0, entry);\n  }\n\n  remove(type, handler) {\n    const {\n      handlers,\n      handlersByElement\n    } = this;\n\n    for (let i = handlers.length - 1; i >= 0; i--) {\n      const entry = handlers[i];\n\n      if (entry.type === type && entry.handler === handler) {\n        handlers.splice(i, 1);\n        const entries = handlersByElement.get(entry.srcElement);\n        entries.splice(entries.indexOf(entry), 1);\n\n        if (entries.length === 0) {\n          handlersByElement.delete(entry.srcElement);\n        }\n      }\n    }\n\n    this._active = handlers.some(entry => !entry.passive);\n  }\n\n  handleEvent(event) {\n    if (this.isEmpty()) {\n      return;\n    }\n\n    const mjolnirEvent = this._normalizeEvent(event);\n\n    let target = event.srcEvent.target;\n\n    while (target && target !== mjolnirEvent.rootElement) {\n      this._emit(mjolnirEvent, target);\n\n      if (mjolnirEvent.handled) {\n        return;\n      }\n\n      target = target.parentNode;\n    }\n\n    this._emit(mjolnirEvent, 'root');\n  }\n\n  _emit(event, srcElement) {\n    const entries = this.handlersByElement.get(srcElement);\n\n    if (entries) {\n      let immediatePropagationStopped = false;\n\n      const stopPropagation = () => {\n        event.handled = true;\n      };\n\n      const stopImmediatePropagation = () => {\n        event.handled = true;\n        immediatePropagationStopped = true;\n      };\n\n      const entriesToRemove = [];\n\n      for (let i = 0; i < entries.length; i++) {\n        const {\n          type,\n          handler,\n          once\n        } = entries[i];\n        handler(Object.assign({}, event, {\n          type,\n          stopPropagation,\n          stopImmediatePropagation\n        }));\n\n        if (once) {\n          entriesToRemove.push(entries[i]);\n        }\n\n        if (immediatePropagationStopped) {\n          break;\n        }\n      }\n\n      for (let i = 0; i < entriesToRemove.length; i++) {\n        const {\n          type,\n          handler\n        } = entriesToRemove[i];\n        this.remove(type, handler);\n      }\n    }\n  }\n\n  _normalizeEvent(event) {\n    const rootElement = this.eventManager.element;\n    return Object.assign({}, event, whichButtons(event), getOffsetPosition(event, rootElement), {\n      handled: false,\n      rootElement\n    });\n  }\n\n}\n//# sourceMappingURL=event-registrar.js.map","import { Manager } from './utils/hammer';\nimport WheelInput from './inputs/wheel-input';\nimport MoveInput from './inputs/move-input';\nimport KeyInput from './inputs/key-input';\nimport ContextmenuInput from './inputs/contextmenu-input';\nimport EventRegistrar from './utils/event-registrar';\nimport { BASIC_EVENT_ALIASES, EVENT_RECOGNIZER_MAP, GESTURE_EVENT_ALIASES, RECOGNIZERS, RECOGNIZER_COMPATIBLE_MAP, RECOGNIZER_FALLBACK_MAP } from './constants';\nconst DEFAULT_OPTIONS = {\n  events: null,\n  recognizers: null,\n  recognizerOptions: {},\n  Manager,\n  touchAction: 'none',\n  tabIndex: 0\n};\nexport default class EventManager {\n  constructor(element = null, options = {}) {\n    this.options = Object.assign({}, DEFAULT_OPTIONS, options);\n    this.events = new Map();\n    this._onBasicInput = this._onBasicInput.bind(this);\n    this._onOtherEvent = this._onOtherEvent.bind(this);\n    this.setElement(element);\n    const {\n      events\n    } = options;\n\n    if (events) {\n      this.on(events);\n    }\n  }\n\n  setElement(element) {\n    if (this.element) {\n      this.destroy();\n    }\n\n    this.element = element;\n\n    if (!element) {\n      return;\n    }\n\n    const {\n      options\n    } = this;\n    const ManagerClass = options.Manager;\n    this.manager = new ManagerClass(element, {\n      touchAction: options.touchAction,\n      recognizers: options.recognizers || RECOGNIZERS\n    }).on('hammer.input', this._onBasicInput);\n\n    if (!options.recognizers) {\n      Object.keys(RECOGNIZER_COMPATIBLE_MAP).forEach(name => {\n        const recognizer = this.manager.get(name);\n\n        if (recognizer) {\n          RECOGNIZER_COMPATIBLE_MAP[name].forEach(otherName => {\n            recognizer.recognizeWith(otherName);\n          });\n        }\n      });\n    }\n\n    for (const recognizerName in options.recognizerOptions) {\n      const recognizer = this.manager.get(recognizerName);\n\n      if (recognizer) {\n        const recognizerOption = options.recognizerOptions[recognizerName];\n        delete recognizerOption.enable;\n        recognizer.set(recognizerOption);\n      }\n    }\n\n    this.wheelInput = new WheelInput(element, this._onOtherEvent, {\n      enable: false\n    });\n    this.moveInput = new MoveInput(element, this._onOtherEvent, {\n      enable: false\n    });\n    this.keyInput = new KeyInput(element, this._onOtherEvent, {\n      enable: false,\n      tabIndex: options.tabIndex\n    });\n    this.contextmenuInput = new ContextmenuInput(element, this._onOtherEvent, {\n      enable: false\n    });\n\n    for (const [eventAlias, eventRegistrar] of this.events) {\n      if (!eventRegistrar.isEmpty()) {\n        this._toggleRecognizer(eventRegistrar.recognizerName, true);\n\n        this.manager.on(eventAlias, eventRegistrar.handleEvent);\n      }\n    }\n  }\n\n  destroy() {\n    if (this.element) {\n      this.wheelInput.destroy();\n      this.moveInput.destroy();\n      this.keyInput.destroy();\n      this.contextmenuInput.destroy();\n      this.manager.destroy();\n      this.wheelInput = null;\n      this.moveInput = null;\n      this.keyInput = null;\n      this.contextmenuInput = null;\n      this.manager = null;\n      this.element = null;\n    }\n  }\n\n  on(event, handler, opts) {\n    this._addEventHandler(event, handler, opts, false);\n  }\n\n  once(event, handler, opts) {\n    this._addEventHandler(event, handler, opts, true);\n  }\n\n  watch(event, handler, opts) {\n    this._addEventHandler(event, handler, opts, false, true);\n  }\n\n  off(event, handler) {\n    this._removeEventHandler(event, handler);\n  }\n\n  _toggleRecognizer(name, enabled) {\n    const {\n      manager\n    } = this;\n\n    if (!manager) {\n      return;\n    }\n\n    const recognizer = manager.get(name);\n\n    if (recognizer && recognizer.options.enable !== enabled) {\n      recognizer.set({\n        enable: enabled\n      });\n      const fallbackRecognizers = RECOGNIZER_FALLBACK_MAP[name];\n\n      if (fallbackRecognizers && !this.options.recognizers) {\n        fallbackRecognizers.forEach(otherName => {\n          const otherRecognizer = manager.get(otherName);\n\n          if (enabled) {\n            otherRecognizer.requireFailure(name);\n            recognizer.dropRequireFailure(otherName);\n          } else {\n            otherRecognizer.dropRequireFailure(name);\n          }\n        });\n      }\n    }\n\n    this.wheelInput.enableEventType(name, enabled);\n    this.moveInput.enableEventType(name, enabled);\n    this.keyInput.enableEventType(name, enabled);\n    this.contextmenuInput.enableEventType(name, enabled);\n  }\n\n  _addEventHandler(event, handler, opts, once, passive) {\n    if (typeof event !== 'string') {\n      opts = handler;\n\n      for (const eventName in event) {\n        this._addEventHandler(eventName, event[eventName], opts, once, passive);\n      }\n\n      return;\n    }\n\n    const {\n      manager,\n      events\n    } = this;\n    const eventAlias = GESTURE_EVENT_ALIASES[event] || event;\n    let eventRegistrar = events.get(eventAlias);\n\n    if (!eventRegistrar) {\n      eventRegistrar = new EventRegistrar(this);\n      events.set(eventAlias, eventRegistrar);\n      eventRegistrar.recognizerName = EVENT_RECOGNIZER_MAP[eventAlias] || eventAlias;\n\n      if (manager) {\n        manager.on(eventAlias, eventRegistrar.handleEvent);\n      }\n    }\n\n    eventRegistrar.add(event, handler, opts, once, passive);\n\n    if (!eventRegistrar.isEmpty()) {\n      this._toggleRecognizer(eventRegistrar.recognizerName, true);\n    }\n  }\n\n  _removeEventHandler(event, handler) {\n    if (typeof event !== 'string') {\n      for (const eventName in event) {\n        this._removeEventHandler(eventName, event[eventName]);\n      }\n\n      return;\n    }\n\n    const {\n      events\n    } = this;\n    const eventAlias = GESTURE_EVENT_ALIASES[event] || event;\n    const eventRegistrar = events.get(eventAlias);\n\n    if (!eventRegistrar) {\n      return;\n    }\n\n    eventRegistrar.remove(event, handler);\n\n    if (eventRegistrar.isEmpty()) {\n      const {\n        recognizerName\n      } = eventRegistrar;\n      let isRecognizerUsed = false;\n\n      for (const eh of events.values()) {\n        if (eh.recognizerName === recognizerName && !eh.isEmpty()) {\n          isRecognizerUsed = true;\n          break;\n        }\n      }\n\n      if (!isRecognizerUsed) {\n        this._toggleRecognizer(recognizerName, false);\n      }\n    }\n  }\n\n  _onBasicInput(event) {\n    const {\n      srcEvent\n    } = event;\n    const alias = BASIC_EVENT_ALIASES[srcEvent.type];\n\n    if (alias) {\n      this.manager.emit(alias, event);\n    }\n  }\n\n  _onOtherEvent(event) {\n    this.manager.emit(event.type, event);\n  }\n\n}\n//# sourceMappingURL=event-manager.js.map","import LayerManager from './layer-manager';\nimport ViewManager from './view-manager';\nimport MapView from '../views/map-view';\nimport EffectManager from './effect-manager';\nimport Effect from './effect';\nimport DeckRenderer from './deck-renderer';\nimport DeckPicker from './deck-picker';\nimport Tooltip from './tooltip';\nimport log from '../utils/log';\nimport { deepEqual } from '../utils/deep-equal';\nimport typedArrayManager from '../utils/typed-array-manager';\nimport deckGlobal from './init';\nimport { getBrowser } from 'probe.gl/env';\nimport { AnimationLoop, createGLContext, instrumentGLContext, setParameters, Timeline, lumaStats } from '@luma.gl/core';\nimport { Stats } from 'probe.gl';\nimport { EventManager } from 'mjolnir.js';\nimport assert from '../utils/assert';\nimport { EVENTS } from './constants';\n\nfunction noop() {}\n\nconst getCursor = ({\n  isDragging\n}) => isDragging ? 'grabbing' : 'grab';\n\nfunction getPropTypes(PropTypes) {\n  return {\n    id: PropTypes.string,\n    width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    layers: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n    layerFilter: PropTypes.func,\n    views: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n    viewState: PropTypes.object,\n    effects: PropTypes.arrayOf(PropTypes.instanceOf(Effect)),\n    controller: PropTypes.oneOfType([PropTypes.func, PropTypes.bool, PropTypes.object]),\n    gl: PropTypes.object,\n    glOptions: PropTypes.object,\n    parameters: PropTypes.object,\n    pickingRadius: PropTypes.number,\n    useDevicePixels: PropTypes.oneOfType([PropTypes.bool, PropTypes.number]),\n    touchAction: PropTypes.string,\n    eventRecognizerOptions: PropTypes.object,\n    onWebGLInitialized: PropTypes.func,\n    onResize: PropTypes.func,\n    onViewStateChange: PropTypes.func,\n    onInteractionStateChange: PropTypes.func,\n    onBeforeRender: PropTypes.func,\n    onAfterRender: PropTypes.func,\n    onLoad: PropTypes.func,\n    onError: PropTypes.func,\n    debug: PropTypes.bool,\n    drawPickingColors: PropTypes.bool,\n    _framebuffer: PropTypes.object,\n    _animate: PropTypes.bool,\n    _pickable: PropTypes.bool,\n    _typedArrayManagerProps: PropTypes.object\n  };\n}\n\nconst defaultProps = {\n  id: '',\n  width: '100%',\n  height: '100%',\n  pickingRadius: 0,\n  layerFilter: null,\n  glOptions: {},\n  gl: null,\n  layers: [],\n  effects: [],\n  views: null,\n  controller: null,\n  useDevicePixels: true,\n  touchAction: 'none',\n  eventRecognizerOptions: {},\n  _framebuffer: null,\n  _animate: false,\n  _pickable: true,\n  _typedArrayManagerProps: {},\n  onWebGLInitialized: noop,\n  onResize: noop,\n  onViewStateChange: noop,\n  onInteractionStateChange: noop,\n  onBeforeRender: noop,\n  onAfterRender: noop,\n  onLoad: noop,\n  onError: (error, layer) => log.error(error)(),\n  _onMetrics: null,\n  getCursor,\n  debug: false,\n  drawPickingColors: false\n};\nexport default class Deck {\n  constructor(props) {\n    props = { ...defaultProps,\n      ...props\n    };\n    this.props = {};\n    this.width = 0;\n    this.height = 0;\n    this.viewManager = null;\n    this.layerManager = null;\n    this.effectManager = null;\n    this.deckRenderer = null;\n    this.deckPicker = null;\n    this._needsRedraw = true;\n    this._pickRequest = {};\n    this._lastPointerDownInfo = null;\n    this.viewState = null;\n    this.interactiveState = {\n      isHovering: false,\n      isDragging: false\n    };\n    this._onEvent = this._onEvent.bind(this);\n    this._onPointerDown = this._onPointerDown.bind(this);\n    this._onPointerMove = this._onPointerMove.bind(this);\n\n    if (props.viewState && props.initialViewState) {\n      log.warn('View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.')();\n    }\n\n    if (getBrowser() === 'IE') {\n      log.warn('IE 11 support will be deprecated in v8.0')();\n    }\n\n    if (!props.gl) {\n      if (typeof document !== 'undefined') {\n        this.canvas = this._createCanvas(props);\n      }\n    }\n\n    this.animationLoop = this._createAnimationLoop(props);\n    this.stats = new Stats({\n      id: 'deck.gl'\n    });\n    this.metrics = {\n      fps: 0,\n      setPropsTime: 0,\n      updateAttributesTime: 0,\n      framesRedrawn: 0,\n      pickTime: 0,\n      pickCount: 0,\n      gpuTime: 0,\n      gpuTimePerFrame: 0,\n      cpuTime: 0,\n      cpuTimePerFrame: 0,\n      bufferMemory: 0,\n      textureMemory: 0,\n      renderbufferMemory: 0,\n      gpuMemory: 0\n    };\n    this._metricsCounter = 0;\n    this.setProps(props);\n\n    if (props._typedArrayManagerProps) {\n      typedArrayManager.setProps(props._typedArrayManagerProps);\n    }\n\n    this.animationLoop.start();\n  }\n\n  finalize() {\n    this.animationLoop.stop();\n    this.animationLoop = null;\n    this._lastPointerDownInfo = null;\n\n    if (this.layerManager) {\n      this.layerManager.finalize();\n      this.layerManager = null;\n      this.viewManager.finalize();\n      this.viewManager = null;\n      this.effectManager.finalize();\n      this.effectManager = null;\n      this.deckRenderer.finalize();\n      this.deckRenderer = null;\n      this.deckPicker.finalize();\n      this.deckPicker = null;\n      this.eventManager.destroy();\n      this.eventManager = null;\n      this.tooltip.remove();\n      this.tooltip = null;\n    }\n\n    if (!this.props.canvas && !this.props.gl && this.canvas) {\n      this.canvas.parentElement.removeChild(this.canvas);\n      this.canvas = null;\n    }\n  }\n\n  setProps(props) {\n    this.stats.get('setProps Time').timeStart();\n\n    if ('onLayerHover' in props) {\n      log.removed('onLayerHover', 'onHover')();\n    }\n\n    if ('onLayerClick' in props) {\n      log.removed('onLayerClick', 'onClick')();\n    }\n\n    if (props.initialViewState && !deepEqual(this.props.initialViewState, props.initialViewState)) {\n      this.viewState = props.initialViewState;\n    }\n\n    Object.assign(this.props, props);\n\n    this._setCanvasSize(this.props);\n\n    const resolvedProps = Object.create(this.props);\n    Object.assign(resolvedProps, {\n      views: this._getViews(),\n      width: this.width,\n      height: this.height,\n      viewState: this._getViewState()\n    });\n    this.animationLoop.setProps(resolvedProps);\n\n    if (this.layerManager) {\n      this.viewManager.setProps(resolvedProps);\n      this.layerManager.activateViewport(this.getViewports()[0]);\n      this.layerManager.setProps(resolvedProps);\n      this.effectManager.setProps(resolvedProps);\n      this.deckRenderer.setProps(resolvedProps);\n      this.deckPicker.setProps(resolvedProps);\n    }\n\n    this.stats.get('setProps Time').timeEnd();\n  }\n\n  needsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    if (this.props._animate) {\n      return 'Deck._animate';\n    }\n\n    let redraw = this._needsRedraw;\n\n    if (opts.clearRedrawFlags) {\n      this._needsRedraw = false;\n    }\n\n    const viewManagerNeedsRedraw = this.viewManager.needsRedraw(opts);\n    const layerManagerNeedsRedraw = this.layerManager.needsRedraw(opts);\n    const effectManagerNeedsRedraw = this.effectManager.needsRedraw(opts);\n    const deckRendererNeedsRedraw = this.deckRenderer.needsRedraw(opts);\n    redraw = redraw || viewManagerNeedsRedraw || layerManagerNeedsRedraw || effectManagerNeedsRedraw || deckRendererNeedsRedraw;\n    return redraw;\n  }\n\n  redraw(force) {\n    if (!this.layerManager) {\n      return;\n    }\n\n    const redrawReason = force || this.needsRedraw({\n      clearRedrawFlags: true\n    });\n\n    if (!redrawReason) {\n      return;\n    }\n\n    this.stats.get('Redraw Count').incrementCount();\n\n    if (this.props._customRender) {\n      this.props._customRender(redrawReason);\n    } else {\n      this._drawLayers(redrawReason);\n    }\n  }\n\n  getViews() {\n    return this.viewManager.views;\n  }\n\n  getViewports(rect) {\n    return this.viewManager.getViewports(rect);\n  }\n\n  pickObject(opts) {\n    const infos = this._pick('pickObject', 'pickObject Time', opts).result;\n\n    return infos.length ? infos[0] : null;\n  }\n\n  pickMultipleObjects(opts) {\n    opts.depth = opts.depth || 10;\n    return this._pick('pickObject', 'pickMultipleObjects Time', opts).result;\n  }\n\n  pickObjects(opts) {\n    return this._pick('pickObjects', 'pickObjects Time', opts);\n  }\n\n  _addResources(resources, forceUpdate = false) {\n    for (const id in resources) {\n      this.layerManager.resourceManager.add({\n        resourceId: id,\n        data: resources[id],\n        forceUpdate\n      });\n    }\n  }\n\n  _removeResources(resourceIds) {\n    for (const id of resourceIds) {\n      this.layerManager.resourceManager.remove(id);\n    }\n  }\n\n  _pick(method, statKey, opts) {\n    const {\n      stats\n    } = this;\n    stats.get('Pick Count').incrementCount();\n    stats.get(statKey).timeStart();\n    const infos = this.deckPicker[method]({\n      layers: this.layerManager.getLayers(opts),\n      views: this.viewManager.getViews(),\n      viewports: this.getViewports(opts),\n      onViewportActive: this.layerManager.activateViewport,\n      ...opts\n    });\n    stats.get(statKey).timeEnd();\n    return infos;\n  }\n\n  _createCanvas(props) {\n    let canvas = props.canvas;\n\n    if (typeof canvas === 'string') {\n      canvas = document.getElementById(canvas);\n      assert(canvas);\n    }\n\n    if (!canvas) {\n      canvas = document.createElement('canvas');\n      canvas.id = props.id || 'deckgl-overlay';\n      const parent = props.parent || document.body;\n      parent.appendChild(canvas);\n    }\n\n    Object.assign(canvas.style, props.style);\n    return canvas;\n  }\n\n  _setCanvasSize(props) {\n    if (!this.canvas) {\n      return;\n    }\n\n    let {\n      width,\n      height\n    } = props;\n\n    if (width || width === 0) {\n      width = Number.isFinite(width) ? \"\".concat(width, \"px\") : width;\n      this.canvas.style.width = width;\n    }\n\n    if (height || height === 0) {\n      height = Number.isFinite(height) ? \"\".concat(height, \"px\") : height;\n      this.canvas.style.position = 'absolute';\n      this.canvas.style.height = height;\n    }\n  }\n\n  _updateCanvasSize() {\n    if (this._checkForCanvasSizeChange()) {\n      const {\n        width,\n        height\n      } = this;\n      this.viewManager.setProps({\n        width,\n        height\n      });\n      this.props.onResize({\n        width: this.width,\n        height: this.height\n      });\n    }\n  }\n\n  _checkForCanvasSizeChange() {\n    const {\n      canvas\n    } = this;\n\n    if (!canvas) {\n      return false;\n    }\n\n    const newWidth = canvas.clientWidth || canvas.width;\n    const newHeight = canvas.clientHeight || canvas.height;\n\n    if (newWidth !== this.width || newHeight !== this.height) {\n      this.width = newWidth;\n      this.height = newHeight;\n      return true;\n    }\n\n    return false;\n  }\n\n  _createAnimationLoop(props) {\n    const {\n      width,\n      height,\n      gl,\n      glOptions,\n      debug,\n      onError,\n      onBeforeRender,\n      onAfterRender,\n      useDevicePixels,\n      autoResizeDrawingBuffer\n    } = props;\n    return new AnimationLoop({\n      width,\n      height,\n      useDevicePixels,\n      autoResizeDrawingBuffer,\n      autoResizeViewport: false,\n      gl,\n      onCreateContext: opts => createGLContext({ ...glOptions,\n        ...opts,\n        canvas: this.canvas,\n        debug,\n        onContextLost: () => this._onContextLost()\n      }),\n      onInitialize: context => this._setGLContext(context.gl),\n      onRender: this._onRenderFrame.bind(this),\n      onBeforeRender,\n      onAfterRender,\n      onError\n    });\n  }\n\n  _getViewState() {\n    return this.props.viewState || this.viewState;\n  }\n\n  _getViews() {\n    let views = this.props.views || [new MapView({\n      id: 'default-view'\n    })];\n    views = Array.isArray(views) ? views : [views];\n\n    if (views.length && this.props.controller) {\n      views[0].props.controller = this.props.controller;\n    }\n\n    return views;\n  }\n\n  _onContextLost() {\n    const {\n      onError\n    } = this.props;\n\n    if (this.animationLoop && onError) {\n      onError(new Error(\"WebGL context is lost\"));\n    }\n  }\n\n  _onPointerMove(event) {\n    const {\n      _pickRequest\n    } = this;\n\n    if (event.type === 'pointerleave') {\n      _pickRequest.x = -1;\n      _pickRequest.y = -1;\n      _pickRequest.radius = 0;\n    } else if (event.leftButton || event.rightButton) {\n      return;\n    } else {\n      const pos = event.offsetCenter;\n\n      if (!pos) {\n        return;\n      }\n\n      _pickRequest.x = pos.x;\n      _pickRequest.y = pos.y;\n      _pickRequest.radius = this.props.pickingRadius;\n    }\n\n    if (this.layerManager) {\n      this.layerManager.context.mousePosition = {\n        x: _pickRequest.x,\n        y: _pickRequest.y\n      };\n    }\n\n    _pickRequest.event = event;\n    _pickRequest.mode = 'hover';\n  }\n\n  _pickAndCallback() {\n    const {\n      _pickRequest\n    } = this;\n\n    if (_pickRequest.event) {\n      const {\n        result,\n        emptyInfo\n      } = this._pick('pickObject', 'pickObject Time', _pickRequest);\n\n      this.interactiveState.isHovering = result.length > 0;\n      let pickedInfo = emptyInfo;\n      let handled = false;\n\n      for (const info of result) {\n        pickedInfo = info;\n        handled = info.layer.onHover(info, _pickRequest.event);\n      }\n\n      if (!handled && this.props.onHover) {\n        this.props.onHover(pickedInfo, _pickRequest.event);\n      }\n\n      if (this.props.getTooltip) {\n        const displayInfo = this.props.getTooltip(pickedInfo);\n        this.tooltip.setTooltip(displayInfo, pickedInfo.x, pickedInfo.y);\n      }\n\n      _pickRequest.event = null;\n    }\n  }\n\n  _updateCursor() {\n    const container = this.props.parent || this.canvas;\n\n    if (container) {\n      container.style.cursor = this.props.getCursor(this.interactiveState);\n    }\n  }\n\n  _setGLContext(gl) {\n    if (this.layerManager) {\n      return;\n    }\n\n    if (!this.canvas) {\n      this.canvas = gl.canvas;\n      instrumentGLContext(gl, {\n        enable: true,\n        copyState: true\n      });\n    }\n\n    this.tooltip = new Tooltip(this.canvas);\n    setParameters(gl, {\n      blend: true,\n      blendFunc: [770, 771, 1, 771],\n      polygonOffsetFill: true,\n      depthTest: true,\n      depthFunc: 515\n    });\n    this.props.onWebGLInitialized(gl);\n    const timeline = new Timeline();\n    timeline.play();\n    this.animationLoop.attachTimeline(timeline);\n    this.eventManager = new EventManager(this.props.parent || gl.canvas, {\n      touchAction: this.props.touchAction,\n      recognizerOptions: this.props.eventRecognizerOptions,\n      events: {\n        pointerdown: this._onPointerDown,\n        pointermove: this._onPointerMove,\n        pointerleave: this._onPointerMove\n      }\n    });\n\n    for (const eventType in EVENTS) {\n      this.eventManager.on(eventType, this._onEvent);\n    }\n\n    this.viewManager = new ViewManager({\n      timeline,\n      eventManager: this.eventManager,\n      onViewStateChange: this._onViewStateChange.bind(this),\n      onInteractionStateChange: this._onInteractionStateChange.bind(this),\n      views: this._getViews(),\n      viewState: this._getViewState(),\n      width: this.width,\n      height: this.height\n    });\n    const viewport = this.viewManager.getViewports()[0];\n    this.layerManager = new LayerManager(gl, {\n      deck: this,\n      stats: this.stats,\n      viewport,\n      timeline\n    });\n    this.effectManager = new EffectManager();\n    this.deckRenderer = new DeckRenderer(gl);\n    this.deckPicker = new DeckPicker(gl);\n    this.setProps(this.props);\n\n    this._updateCanvasSize();\n\n    this.props.onLoad();\n  }\n\n  _drawLayers(redrawReason, renderOptions) {\n    const {\n      gl\n    } = this.layerManager.context;\n    setParameters(gl, this.props.parameters);\n    this.props.onBeforeRender({\n      gl\n    });\n    this.deckRenderer.renderLayers({\n      target: this.props._framebuffer,\n      layers: this.layerManager.getLayers(),\n      viewports: this.viewManager.getViewports(),\n      onViewportActive: this.layerManager.activateViewport,\n      views: this.viewManager.getViews(),\n      pass: 'screen',\n      redrawReason,\n      effects: this.effectManager.getEffects(),\n      ...renderOptions\n    });\n    this.props.onAfterRender({\n      gl\n    });\n  }\n\n  _onRenderFrame(animationProps) {\n    this._getFrameStats();\n\n    if (this._metricsCounter++ % 60 === 0) {\n      this._getMetrics();\n\n      this.stats.reset();\n      log.table(4, this.metrics)();\n\n      if (this.props._onMetrics) {\n        this.props._onMetrics(this.metrics);\n      }\n    }\n\n    this._updateCanvasSize();\n\n    this._updateCursor();\n\n    if (this.tooltip.isVisible && this.viewManager.needsRedraw()) {\n      this.tooltip.setTooltip(null);\n    }\n\n    this.layerManager.updateLayers();\n\n    this._pickAndCallback();\n\n    this.redraw(false);\n\n    if (this.viewManager) {\n      this.viewManager.updateViewStates();\n    }\n  }\n\n  _onViewStateChange(params) {\n    const viewState = this.props.onViewStateChange(params) || params.viewState;\n\n    if (this.viewState) {\n      this.viewState = { ...this.viewState,\n        [params.viewId]: viewState\n      };\n\n      if (!this.props.viewState) {\n        if (this.viewManager) {\n          this.viewManager.setProps({\n            viewState: this.viewState\n          });\n        }\n      }\n    }\n  }\n\n  _onInteractionStateChange(interactionState) {\n    this.interactiveState.isDragging = interactionState.isDragging;\n    this.props.onInteractionStateChange(interactionState);\n  }\n\n  _onEvent(event) {\n    const eventOptions = EVENTS[event.type];\n    const pos = event.offsetCenter;\n\n    if (!eventOptions || !pos) {\n      return;\n    }\n\n    const layers = this.layerManager.getLayers();\n    const info = this.deckPicker.getLastPickedObject({\n      x: pos.x,\n      y: pos.y,\n      layers,\n      viewports: this.getViewports(pos)\n    }, this._lastPointerDownInfo);\n    const {\n      layer\n    } = info;\n    const layerHandler = layer && (layer[eventOptions.handler] || layer.props[eventOptions.handler]);\n    const rootHandler = this.props[eventOptions.handler];\n    let handled = false;\n\n    if (layerHandler) {\n      handled = layerHandler.call(layer, info, event);\n    }\n\n    if (!handled && rootHandler) {\n      rootHandler(info, event);\n    }\n  }\n\n  _onPointerDown(event) {\n    const pos = event.offsetCenter;\n    this._lastPointerDownInfo = this.pickObject({\n      x: pos.x,\n      y: pos.y,\n      radius: this.props.pickingRadius\n    });\n  }\n\n  _getFrameStats() {\n    const {\n      stats\n    } = this;\n    stats.get('frameRate').timeEnd();\n    stats.get('frameRate').timeStart();\n    const animationLoopStats = this.animationLoop.stats;\n    stats.get('GPU Time').addTime(animationLoopStats.get('GPU Time').lastTiming);\n    stats.get('CPU Time').addTime(animationLoopStats.get('CPU Time').lastTiming);\n  }\n\n  _getMetrics() {\n    const {\n      metrics,\n      stats\n    } = this;\n    metrics.fps = stats.get('frameRate').getHz();\n    metrics.setPropsTime = stats.get('setProps Time').time;\n    metrics.updateAttributesTime = stats.get('Update Attributes').time;\n    metrics.framesRedrawn = stats.get('Redraw Count').count;\n    metrics.pickTime = stats.get('pickObject Time').time + stats.get('pickMultipleObjects Time').time + stats.get('pickObjects Time').time;\n    metrics.pickCount = stats.get('Pick Count').count;\n    metrics.gpuTime = stats.get('GPU Time').time;\n    metrics.cpuTime = stats.get('CPU Time').time;\n    metrics.gpuTimePerFrame = stats.get('GPU Time').getAverageTime();\n    metrics.cpuTimePerFrame = stats.get('CPU Time').getAverageTime();\n    const memoryStats = lumaStats.get('Memory Usage');\n    metrics.bufferMemory = memoryStats.get('Buffer Memory').count;\n    metrics.textureMemory = memoryStats.get('Texture Memory').count;\n    metrics.renderbufferMemory = memoryStats.get('Renderbuffer Memory').count;\n    metrics.gpuMemory = memoryStats.get('GPU Memory').count;\n  }\n\n}\nDeck.getPropTypes = getPropTypes;\nDeck.defaultProps = defaultProps;\nDeck.VERSION = deckGlobal.VERSION;\n//# sourceMappingURL=deck.js.map","export default class ShaderAttribute {\n  constructor(dataColumn, opts) {\n    this.opts = opts;\n    this.source = dataColumn;\n  }\n\n  get value() {\n    return this.source.value;\n  }\n\n  getValue() {\n    const buffer = this.source.getBuffer();\n    const accessor = this.getAccessor();\n\n    if (buffer) {\n      return [buffer, accessor];\n    }\n\n    const {\n      value\n    } = this.source;\n    const {\n      size\n    } = accessor;\n    let constantValue = value;\n\n    if (value && value.length !== size) {\n      constantValue = new Float32Array(size);\n      const index = accessor.elementOffset || 0;\n\n      for (let i = 0; i < size; ++i) {\n        constantValue[i] = value[index + i];\n      }\n    }\n\n    return constantValue;\n  }\n\n  getAccessor() {\n    return { ...this.source.getAccessor(),\n      ...this.opts\n    };\n  }\n\n}\n//# sourceMappingURL=shader-attribute.js.map","import { hasFeature, FEATURES, Buffer } from '@luma.gl/core';\nimport ShaderAttribute from './shader-attribute';\nimport { glArrayFromType } from './gl-utils';\nimport typedArrayManager from '../../utils/typed-array-manager';\nimport { toDoublePrecisionArray } from '../../utils/math-utils';\nimport log from '../../utils/log';\n\nfunction getStride(accessor) {\n  return accessor.stride || accessor.size * accessor.bytesPerElement;\n}\n\nfunction resolveShaderAttribute(baseAccessor, shaderAttributeOptions) {\n  if (shaderAttributeOptions.offset) {\n    log.removed('shaderAttribute.offset', 'vertexOffset, elementOffset')();\n  }\n\n  const stride = getStride(baseAccessor);\n  const vertexOffset = 'vertexOffset' in shaderAttributeOptions ? shaderAttributeOptions.vertexOffset : baseAccessor.vertexOffset || 0;\n  const elementOffset = shaderAttributeOptions.elementOffset || 0;\n  const offset = vertexOffset * stride + elementOffset * baseAccessor.bytesPerElement + (baseAccessor.offset || 0);\n  return { ...shaderAttributeOptions,\n    offset,\n    stride\n  };\n}\n\nfunction resolveDoublePrecisionShaderAttributes(baseAccessor, shaderAttributeOptions) {\n  const resolvedOptions = resolveShaderAttribute(baseAccessor, shaderAttributeOptions);\n  return {\n    high: resolvedOptions,\n    low: { ...resolvedOptions,\n      offset: resolvedOptions.offset + baseAccessor.size * 4\n    }\n  };\n}\n\nexport default class DataColumn {\n  constructor(gl, opts) {\n    this.gl = gl;\n    this.id = opts.id;\n    this.size = opts.size;\n    const logicalType = opts.logicalType || opts.type;\n    const doublePrecision = logicalType === 5130;\n    let {\n      defaultValue\n    } = opts;\n    defaultValue = Number.isFinite(defaultValue) ? [defaultValue] : defaultValue || new Array(this.size).fill(0);\n    opts.defaultValue = defaultValue;\n    let bufferType = logicalType;\n\n    if (doublePrecision) {\n      bufferType = 5126;\n    } else if (!bufferType && opts.isIndexed) {\n      bufferType = gl && hasFeature(gl, FEATURES.ELEMENT_INDEX_UINT32) ? 5125 : 5123;\n    } else if (!bufferType) {\n      bufferType = 5126;\n    }\n\n    opts.logicalType = logicalType;\n    opts.type = bufferType;\n    let defaultType = glArrayFromType(logicalType || bufferType || 5126);\n    this.shaderAttributes = {};\n    this.doublePrecision = doublePrecision;\n\n    if (doublePrecision && opts.fp64 === false) {\n      defaultType = Float32Array;\n    }\n\n    opts.bytesPerElement = defaultType.BYTES_PER_ELEMENT;\n    this.defaultType = defaultType;\n    this.value = null;\n    this.settings = opts;\n    this.state = {\n      externalBuffer: null,\n      bufferAccessor: opts,\n      allocatedValue: null,\n      constant: false\n    };\n    this._buffer = null;\n    this.setData(opts);\n  }\n\n  get buffer() {\n    if (!this._buffer) {\n      const {\n        isIndexed,\n        type\n      } = this.settings;\n      this._buffer = new Buffer(this.gl, {\n        id: this.id,\n        target: isIndexed ? 34963 : 34962,\n        accessor: {\n          type\n        }\n      });\n    }\n\n    return this._buffer;\n  }\n\n  get byteOffset() {\n    const accessor = this.getAccessor();\n\n    if (accessor.vertexOffset) {\n      return accessor.vertexOffset * getStride(accessor);\n    }\n\n    return 0;\n  }\n\n  delete() {\n    if (this._buffer) {\n      this._buffer.delete();\n\n      this._buffer = null;\n    }\n\n    typedArrayManager.release(this.state.allocatedValue);\n  }\n\n  getShaderAttributes(id, options) {\n    if (this.doublePrecision) {\n      const shaderAttributes = {};\n      const isBuffer64Bit = this.value instanceof Float64Array;\n      const doubleShaderAttributeDefs = resolveDoublePrecisionShaderAttributes(this.getAccessor(), options || {});\n      shaderAttributes[id] = new ShaderAttribute(this, doubleShaderAttributeDefs.high);\n      shaderAttributes[\"\".concat(id, \"64Low\")] = isBuffer64Bit ? new ShaderAttribute(this, doubleShaderAttributeDefs.low) : new Float32Array(this.size);\n      return shaderAttributes;\n    }\n\n    if (options) {\n      const shaderAttributeDef = resolveShaderAttribute(this.getAccessor(), options);\n      return {\n        [id]: new ShaderAttribute(this, shaderAttributeDef)\n      };\n    }\n\n    return {\n      [id]: this\n    };\n  }\n\n  getBuffer() {\n    if (this.state.constant) {\n      return null;\n    }\n\n    return this.state.externalBuffer || this._buffer;\n  }\n\n  getValue() {\n    if (this.state.constant) {\n      return this.value;\n    }\n\n    return [this.getBuffer(), this.getAccessor()];\n  }\n\n  getAccessor() {\n    return this.state.bufferAccessor;\n  }\n\n  setData(opts) {\n    const {\n      state\n    } = this;\n\n    if (ArrayBuffer.isView(opts)) {\n      opts = {\n        value: opts\n      };\n    } else if (opts instanceof Buffer) {\n      opts = {\n        buffer: opts\n      };\n    }\n\n    const accessor = { ...this.settings,\n      ...opts\n    };\n    state.bufferAccessor = accessor;\n\n    if (opts.constant) {\n      let value = opts.value;\n      value = this._normalizeValue(value, [], 0);\n\n      if (this.settings.normalized) {\n        value = this._normalizeConstant(value);\n      }\n\n      const hasChanged = !state.constant || !this._areValuesEqual(value, this.value);\n\n      if (!hasChanged) {\n        return false;\n      }\n\n      state.externalBuffer = null;\n      state.constant = true;\n      this.value = value;\n    } else if (opts.buffer) {\n      const buffer = opts.buffer;\n      state.externalBuffer = buffer;\n      state.constant = false;\n      this.value = opts.value;\n      const isBuffer64Bit = opts.value instanceof Float64Array;\n      accessor.type = opts.type || buffer.accessor.type;\n      accessor.bytesPerElement = buffer.accessor.BYTES_PER_ELEMENT * (isBuffer64Bit ? 2 : 1);\n      accessor.stride = getStride(accessor);\n    } else if (opts.value) {\n      this._checkExternalBuffer(opts);\n\n      let value = opts.value;\n      state.externalBuffer = null;\n      state.constant = false;\n      this.value = value;\n      accessor.bytesPerElement = value.BYTES_PER_ELEMENT;\n      accessor.stride = getStride(accessor);\n      const {\n        buffer,\n        byteOffset\n      } = this;\n\n      if (this.doublePrecision && value instanceof Float64Array) {\n        value = toDoublePrecisionArray(value, accessor);\n      }\n\n      const requiredBufferSize = value.byteLength + byteOffset + accessor.stride * 2;\n\n      if (buffer.byteLength < requiredBufferSize) {\n        buffer.reallocate(requiredBufferSize);\n      }\n\n      buffer.setAccessor(null);\n      buffer.subData({\n        data: value,\n        offset: byteOffset\n      });\n      accessor.type = opts.type || buffer.accessor.type;\n    }\n\n    return true;\n  }\n\n  updateSubBuffer(opts = {}) {\n    const {\n      value\n    } = this;\n    const {\n      startOffset = 0,\n      endOffset\n    } = opts;\n    this.buffer.subData({\n      data: this.doublePrecision && value instanceof Float64Array ? toDoublePrecisionArray(value, {\n        size: this.size,\n        startIndex: startOffset,\n        endIndex: endOffset\n      }) : value.subarray(startOffset, endOffset),\n      offset: startOffset * value.BYTES_PER_ELEMENT + this.byteOffset\n    });\n  }\n\n  allocate({\n    numInstances,\n    copy = false\n  }) {\n    const {\n      state\n    } = this;\n    const oldValue = state.allocatedValue;\n    const value = typedArrayManager.allocate(oldValue, numInstances + 1, {\n      size: this.size,\n      type: this.defaultType,\n      copy\n    });\n    this.value = value;\n    const {\n      buffer,\n      byteOffset\n    } = this;\n\n    if (buffer.byteLength < value.byteLength + byteOffset) {\n      buffer.reallocate(value.byteLength + byteOffset);\n\n      if (copy && oldValue) {\n        buffer.subData({\n          data: oldValue instanceof Float64Array ? toDoublePrecisionArray(oldValue, this) : oldValue,\n          offset: byteOffset\n        });\n      }\n    }\n\n    state.allocatedValue = value;\n    state.constant = false;\n    state.externalBuffer = null;\n    state.bufferAccessor = this.settings;\n    return true;\n  }\n\n  _checkExternalBuffer(opts) {\n    const {\n      value\n    } = opts;\n\n    if (!opts.constant && value) {\n      const ArrayType = this.defaultType;\n      let illegalArrayType = false;\n\n      if (this.doublePrecision) {\n        illegalArrayType = value.BYTES_PER_ELEMENT < 4;\n      }\n\n      if (illegalArrayType) {\n        throw new Error(\"Attribute \".concat(this.id, \" does not support \").concat(value.constructor.name));\n      }\n\n      if (!(value instanceof ArrayType) && this.settings.normalized && !('normalized' in opts)) {\n        log.warn(\"Attribute \".concat(this.id, \" is normalized\"))();\n      }\n    }\n  }\n\n  _normalizeConstant(value) {\n    switch (this.settings.type) {\n      case 5120:\n        return new Float32Array(value).map(x => (x + 128) / 255 * 2 - 1);\n\n      case 5122:\n        return new Float32Array(value).map(x => (x + 32768) / 65535 * 2 - 1);\n\n      case 5121:\n        return new Float32Array(value).map(x => x / 255);\n\n      case 5123:\n        return new Float32Array(value).map(x => x / 65535);\n\n      default:\n        return value;\n    }\n  }\n\n  _normalizeValue(value, out, start) {\n    const {\n      defaultValue,\n      size\n    } = this.settings;\n\n    if (Number.isFinite(value)) {\n      out[start] = value;\n      return out;\n    }\n\n    if (!value) {\n      out[start] = defaultValue[0];\n      return out;\n    }\n\n    switch (size) {\n      case 4:\n        out[start + 3] = Number.isFinite(value[3]) ? value[3] : defaultValue[3];\n\n      case 3:\n        out[start + 2] = Number.isFinite(value[2]) ? value[2] : defaultValue[2];\n\n      case 2:\n        out[start + 1] = Number.isFinite(value[1]) ? value[1] : defaultValue[1];\n\n      case 1:\n        out[start + 0] = Number.isFinite(value[0]) ? value[0] : defaultValue[0];\n        break;\n\n      default:\n        let i = size;\n\n        while (--i >= 0) {\n          out[start + i] = Number.isFinite(value[i]) ? value[i] : defaultValue[i];\n        }\n\n    }\n\n    return out;\n  }\n\n  _areValuesEqual(value1, value2) {\n    if (!value1 || !value2) {\n      return false;\n    }\n\n    const {\n      size\n    } = this;\n\n    for (let i = 0; i < size; i++) {\n      if (value1[i] !== value2[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n}\n//# sourceMappingURL=data-column.js.map","const EMPTY_ARRAY = [];\nconst placeholderArray = [];\nexport function createIterable(data, startRow = 0, endRow = Infinity) {\n  let iterable = EMPTY_ARRAY;\n  const objectInfo = {\n    index: -1,\n    data,\n    target: []\n  };\n\n  if (!data) {\n    iterable = EMPTY_ARRAY;\n  } else if (typeof data[Symbol.iterator] === 'function') {\n    iterable = data;\n  } else if (data.length > 0) {\n    placeholderArray.length = data.length;\n    iterable = placeholderArray;\n  }\n\n  if (startRow > 0 || Number.isFinite(endRow)) {\n    iterable = (Array.isArray(iterable) ? iterable : Array.from(iterable)).slice(startRow, endRow);\n    objectInfo.index = startRow - 1;\n  }\n\n  return {\n    iterable,\n    objectInfo\n  };\n}\nexport function isAsyncIterable(data) {\n  return data && data[Symbol.asyncIterator];\n}\nexport function getAccessorFromBuffer(typedArray, {\n  size,\n  stride,\n  offset,\n  startIndices,\n  nested\n}) {\n  const bytesPerElement = typedArray.BYTES_PER_ELEMENT;\n  const elementStride = stride ? stride / bytesPerElement : size;\n  const elementOffset = offset ? offset / bytesPerElement : 0;\n  const vertexCount = Math.floor((typedArray.length - elementOffset) / elementStride);\n  return (_, {\n    index,\n    target\n  }) => {\n    if (!startIndices) {\n      const sourceIndex = index * elementStride + elementOffset;\n\n      for (let j = 0; j < size; j++) {\n        target[j] = typedArray[sourceIndex + j];\n      }\n\n      return target;\n    }\n\n    const startIndex = startIndices[index];\n    const endIndex = startIndices[index + 1] || vertexCount;\n    let result;\n\n    if (nested) {\n      result = new Array(endIndex - startIndex);\n\n      for (let i = startIndex; i < endIndex; i++) {\n        const sourceIndex = i * elementStride + elementOffset;\n        target = new Array(size);\n\n        for (let j = 0; j < size; j++) {\n          target[j] = typedArray[sourceIndex + j];\n        }\n\n        result[i - startIndex] = target;\n      }\n    } else if (elementStride === size) {\n      result = typedArray.subarray(startIndex * size + elementOffset, endIndex * size + elementOffset);\n    } else {\n      result = new typedArray.constructor((endIndex - startIndex) * size);\n      let targetIndex = 0;\n\n      for (let i = startIndex; i < endIndex; i++) {\n        const sourceIndex = i * elementStride + elementOffset;\n\n        for (let j = 0; j < size; j++) {\n          result[targetIndex++] = typedArray[sourceIndex + j];\n        }\n      }\n    }\n\n    return result;\n  };\n}\n//# sourceMappingURL=iterable-utils.js.map","export const EMPTY = [];\nexport const FULL = [[0, Infinity]];\nexport function add(rangeList, range) {\n  if (rangeList === FULL) {\n    return rangeList;\n  }\n\n  if (range[0] < 0) {\n    range[0] = 0;\n  }\n\n  if (range[0] >= range[1]) {\n    return rangeList;\n  }\n\n  const newRangeList = [];\n  const len = rangeList.length;\n  let insertPosition = 0;\n\n  for (let i = 0; i < len; i++) {\n    const range0 = rangeList[i];\n\n    if (range0[1] < range[0]) {\n      newRangeList.push(range0);\n      insertPosition = i + 1;\n    } else if (range0[0] > range[1]) {\n      newRangeList.push(range0);\n    } else {\n      range = [Math.min(range0[0], range[0]), Math.max(range0[1], range[1])];\n    }\n  }\n\n  newRangeList.splice(insertPosition, 0, range);\n  return newRangeList;\n}\n//# sourceMappingURL=range.js.map","function padArrayChunk({\n  source,\n  target,\n  start = 0,\n  end,\n  size,\n  getData\n}) {\n  end = end || target.length;\n  const sourceLength = source.length;\n  const targetLength = end - start;\n\n  if (sourceLength > targetLength) {\n    target.set(source.subarray(0, targetLength), start);\n    return;\n  }\n\n  target.set(source, start);\n\n  if (!getData) {\n    return;\n  }\n\n  let i = sourceLength;\n\n  while (i < targetLength) {\n    const datum = getData(i, source);\n\n    for (let j = 0; j < size; j++) {\n      target[start + i] = datum[j] || 0;\n      i++;\n    }\n  }\n}\n\nexport function padArray({\n  source,\n  target,\n  size,\n  getData,\n  sourceStartIndices,\n  targetStartIndices\n}) {\n  if (!Array.isArray(targetStartIndices)) {\n    padArrayChunk({\n      source,\n      target,\n      size,\n      getData\n    });\n    return target;\n  }\n\n  let sourceIndex = 0;\n  let targetIndex = 0;\n\n  const getChunkData = getData && ((i, chunk) => getData(i + targetIndex, chunk));\n\n  const n = Math.min(sourceStartIndices.length, targetStartIndices.length);\n\n  for (let i = 1; i < n; i++) {\n    const nextSourceIndex = sourceStartIndices[i] * size;\n    const nextTargetIndex = targetStartIndices[i] * size;\n    padArrayChunk({\n      source: source.subarray(sourceIndex, nextSourceIndex),\n      target,\n      start: targetIndex,\n      end: nextTargetIndex,\n      size,\n      getData: getChunkData\n    });\n    sourceIndex = nextSourceIndex;\n    targetIndex = nextTargetIndex;\n  }\n\n  if (targetIndex < target.length) {\n    padArrayChunk({\n      source: [],\n      target,\n      start: targetIndex,\n      size,\n      getData: getChunkData\n    });\n  }\n\n  return target;\n}\n//# sourceMappingURL=array-utils.js.map","import { padArray } from '../../utils/array-utils';\nconst DEFAULT_TRANSITION_SETTINGS = {\n  interpolation: {\n    duration: 0,\n    easing: t => t\n  },\n  spring: {\n    stiffness: 0.05,\n    damping: 0.5\n  }\n};\nexport function normalizeTransitionSettings(userSettings, layerSettings) {\n  if (!userSettings) {\n    return null;\n  }\n\n  if (Number.isFinite(userSettings)) {\n    userSettings = {\n      duration: userSettings\n    };\n  }\n\n  userSettings.type = userSettings.type || 'interpolation';\n  return { ...DEFAULT_TRANSITION_SETTINGS[userSettings.type],\n    ...layerSettings,\n    ...userSettings\n  };\n}\nexport function getSourceBufferAttribute(gl, attribute) {\n  const buffer = attribute.getBuffer();\n\n  if (buffer) {\n    return [attribute.getBuffer(), {\n      divisor: 0,\n      size: attribute.size,\n      normalized: attribute.settings.normalized\n    }];\n  }\n\n  return attribute.value;\n}\nexport function getAttributeTypeFromSize(size) {\n  switch (size) {\n    case 1:\n      return 'float';\n\n    case 2:\n      return 'vec2';\n\n    case 3:\n      return 'vec3';\n\n    case 4:\n      return 'vec4';\n\n    default:\n      throw new Error(\"No defined attribute type for size \\\"\".concat(size, \"\\\"\"));\n  }\n}\nexport function cycleBuffers(buffers) {\n  buffers.push(buffers.shift());\n}\nexport function getAttributeBufferLength(attribute, numInstances) {\n  const {\n    doublePrecision,\n    settings,\n    value,\n    size\n  } = attribute;\n  const multiplier = doublePrecision && value instanceof Float64Array ? 2 : 1;\n  return (settings.noAlloc ? value.length : numInstances * size) * multiplier;\n}\nexport function padBuffer({\n  buffer,\n  numInstances,\n  attribute,\n  fromLength,\n  fromStartIndices,\n  getData = x => x\n}) {\n  const precisionMultiplier = attribute.doublePrecision && attribute.value instanceof Float64Array ? 2 : 1;\n  const size = attribute.size * precisionMultiplier;\n  const byteOffset = attribute.byteOffset;\n  const toStartIndices = attribute.startIndices;\n  const hasStartIndices = fromStartIndices && toStartIndices;\n  const toLength = getAttributeBufferLength(attribute, numInstances);\n  const isConstant = attribute.state.constant;\n\n  if (!hasStartIndices && fromLength >= toLength) {\n    return;\n  }\n\n  const toData = isConstant ? attribute.value : attribute.getBuffer().getData({\n    srcByteOffset: byteOffset\n  });\n\n  if (attribute.settings.normalized && !isConstant) {\n    const getter = getData;\n\n    getData = (value, chunk) => attribute._normalizeConstant(getter(value, chunk));\n  }\n\n  const getMissingData = isConstant ? (i, chunk) => getData(toData, chunk) : (i, chunk) => getData(toData.subarray(i, i + size), chunk);\n  const source = buffer.getData({\n    length: fromLength\n  });\n  const data = new Float32Array(toLength);\n  padArray({\n    source,\n    target: data,\n    sourceStartIndices: fromStartIndices,\n    targetStartIndices: toStartIndices,\n    size,\n    getData: getMissingData\n  });\n\n  if (buffer.byteLength < data.byteLength + byteOffset) {\n    buffer.reallocate(data.byteLength + byteOffset);\n  }\n\n  buffer.subData({\n    data,\n    offset: byteOffset\n  });\n}\n//# sourceMappingURL=attribute-transition-utils.js.map","import DataColumn from './data-column';\nimport assert from '../../utils/assert';\nimport { createIterable, getAccessorFromBuffer } from '../../utils/iterable-utils';\nimport { fillArray } from '../../utils/flatten';\nimport * as range from '../../utils/range';\nimport { normalizeTransitionSettings } from './attribute-transition-utils';\nexport default class Attribute extends DataColumn {\n  constructor(gl, opts = {}) {\n    super(gl, opts);\n    const {\n      transition = false,\n      noAlloc = false,\n      update = null,\n      accessor = null,\n      transform = null,\n      startIndices = null\n    } = opts;\n    Object.assign(this.settings, {\n      transition,\n      noAlloc,\n      update: update || accessor && this._autoUpdater,\n      accessor,\n      transform\n    });\n    Object.assign(this.state, {\n      lastExternalBuffer: null,\n      binaryValue: null,\n      binaryAccessor: null,\n      needsUpdate: true,\n      needsRedraw: false,\n      updateRanges: range.FULL,\n      startIndices\n    });\n    Object.seal(this.settings);\n    Object.seal(this.state);\n\n    this._validateAttributeUpdaters();\n  }\n\n  get startIndices() {\n    return this.state.startIndices;\n  }\n\n  set startIndices(layout) {\n    this.state.startIndices = layout;\n  }\n\n  needsUpdate() {\n    return this.state.needsUpdate;\n  }\n\n  needsRedraw({\n    clearChangedFlags = false\n  } = {}) {\n    const needsRedraw = this.state.needsRedraw;\n    this.state.needsRedraw = needsRedraw && !clearChangedFlags;\n    return needsRedraw;\n  }\n\n  getUpdateTriggers() {\n    const {\n      accessor\n    } = this.settings;\n    return [this.id].concat(typeof accessor !== 'function' && accessor || []);\n  }\n\n  supportsTransition() {\n    return Boolean(this.settings.transition);\n  }\n\n  getTransitionSetting(opts) {\n    if (!opts || !this.supportsTransition()) {\n      return null;\n    }\n\n    const {\n      accessor\n    } = this.settings;\n    const layerSettings = this.settings.transition;\n    const userSettings = Array.isArray(accessor) ? opts[accessor.find(a => opts[a])] : opts[accessor];\n    return normalizeTransitionSettings(userSettings, layerSettings);\n  }\n\n  setNeedsUpdate(reason = this.id, dataRange) {\n    this.state.needsUpdate = this.state.needsUpdate || reason;\n    this.setNeedsRedraw(reason);\n\n    if (dataRange) {\n      const {\n        startRow = 0,\n        endRow = Infinity\n      } = dataRange;\n      this.state.updateRanges = range.add(this.state.updateRanges, [startRow, endRow]);\n    } else {\n      this.state.updateRanges = range.FULL;\n    }\n  }\n\n  clearNeedsUpdate() {\n    this.state.needsUpdate = false;\n    this.state.updateRanges = range.EMPTY;\n  }\n\n  setNeedsRedraw(reason = this.id) {\n    this.state.needsRedraw = this.state.needsRedraw || reason;\n  }\n\n  update(opts) {\n    this.setData(opts);\n  }\n\n  allocate(numInstances) {\n    const {\n      state,\n      settings\n    } = this;\n\n    if (settings.noAlloc) {\n      return false;\n    }\n\n    if (settings.update) {\n      super.allocate({\n        numInstances,\n        copy: state.updateRanges !== range.FULL\n      });\n      return true;\n    }\n\n    return false;\n  }\n\n  updateBuffer({\n    numInstances,\n    data,\n    props,\n    context\n  }) {\n    if (!this.needsUpdate()) {\n      return false;\n    }\n\n    const {\n      state: {\n        updateRanges\n      },\n      settings: {\n        update,\n        noAlloc\n      }\n    } = this;\n    let updated = true;\n\n    if (update) {\n      for (const [startRow, endRow] of updateRanges) {\n        update.call(context, this, {\n          data,\n          startRow,\n          endRow,\n          props,\n          numInstances\n        });\n      }\n\n      if (!this.value) {} else if (this.constant || this.buffer.byteLength < this.value.byteLength + this.byteOffset) {\n        this.setData({\n          value: this.value,\n          constant: this.constant\n        });\n      } else {\n        for (const [startRow, endRow] of updateRanges) {\n          const startOffset = Number.isFinite(startRow) ? this.getVertexOffset(startRow) : 0;\n          const endOffset = Number.isFinite(endRow) ? this.getVertexOffset(endRow) : noAlloc || !Number.isFinite(numInstances) ? this.value.length : numInstances * this.size;\n          super.updateSubBuffer({\n            startOffset,\n            endOffset\n          });\n        }\n      }\n\n      this._checkAttributeArray();\n    } else {\n      updated = false;\n    }\n\n    this.clearNeedsUpdate();\n    this.setNeedsRedraw();\n    return updated;\n  }\n\n  setConstantValue(value) {\n    if (value === undefined || typeof value === 'function') {\n      return false;\n    }\n\n    const hasChanged = this.setData({\n      constant: true,\n      value\n    });\n\n    if (hasChanged) {\n      this.setNeedsRedraw();\n    }\n\n    this.clearNeedsUpdate();\n    return true;\n  }\n\n  setExternalBuffer(buffer) {\n    const {\n      state\n    } = this;\n\n    if (!buffer) {\n      state.lastExternalBuffer = null;\n      return false;\n    }\n\n    this.clearNeedsUpdate();\n\n    if (state.lastExternalBuffer === buffer) {\n      return true;\n    }\n\n    state.lastExternalBuffer = buffer;\n    this.setNeedsRedraw();\n    this.setData(buffer);\n    return true;\n  }\n\n  setBinaryValue(buffer, startIndices = null) {\n    const {\n      state,\n      settings\n    } = this;\n\n    if (!buffer) {\n      state.binaryValue = null;\n      state.binaryAccessor = null;\n      return false;\n    }\n\n    if (settings.noAlloc) {\n      return false;\n    }\n\n    if (state.binaryValue === buffer) {\n      this.clearNeedsUpdate();\n      return true;\n    }\n\n    state.binaryValue = buffer;\n    this.setNeedsRedraw();\n\n    if (ArrayBuffer.isView(buffer)) {\n      buffer = {\n        value: buffer\n      };\n    }\n\n    const needsUpdate = settings.transform || startIndices !== this.startIndices;\n\n    if (needsUpdate) {\n      assert(ArrayBuffer.isView(buffer.value), \"invalid \".concat(settings.accessor));\n      const needsNormalize = buffer.size && buffer.size !== this.size;\n      state.binaryAccessor = getAccessorFromBuffer(buffer.value, {\n        size: buffer.size || this.size,\n        stride: buffer.stride,\n        offset: buffer.offset,\n        startIndices,\n        nested: needsNormalize\n      });\n      return false;\n    }\n\n    this.clearNeedsUpdate();\n    this.setData(buffer);\n    return true;\n  }\n\n  getVertexOffset(row) {\n    const {\n      startIndices\n    } = this;\n    const vertexIndex = startIndices ? startIndices[row] : row;\n    return vertexIndex * this.size;\n  }\n\n  getShaderAttributes() {\n    const shaderAttributeDefs = this.settings.shaderAttributes || {\n      [this.id]: null\n    };\n    const shaderAttributes = {};\n\n    for (const shaderAttributeName in shaderAttributeDefs) {\n      Object.assign(shaderAttributes, super.getShaderAttributes(shaderAttributeName, shaderAttributeDefs[shaderAttributeName]));\n    }\n\n    return shaderAttributes;\n  }\n\n  _autoUpdater(attribute, {\n    data,\n    startRow,\n    endRow,\n    props,\n    numInstances\n  }) {\n    if (attribute.constant) {\n      return;\n    }\n\n    const {\n      settings,\n      state,\n      value,\n      size,\n      startIndices\n    } = attribute;\n    const {\n      accessor,\n      transform\n    } = settings;\n    const accessorFunc = state.binaryAccessor || (typeof accessor === 'function' ? accessor : props[accessor]);\n    assert(typeof accessorFunc === 'function', \"accessor \\\"\".concat(accessor, \"\\\" is not a function\"));\n    let i = attribute.getVertexOffset(startRow);\n    const {\n      iterable,\n      objectInfo\n    } = createIterable(data, startRow, endRow);\n\n    for (const object of iterable) {\n      objectInfo.index++;\n      let objectValue = accessorFunc(object, objectInfo);\n\n      if (transform) {\n        objectValue = transform.call(this, objectValue);\n      }\n\n      if (startIndices) {\n        const numVertices = (objectInfo.index < startIndices.length - 1 ? startIndices[objectInfo.index + 1] : numInstances) - startIndices[objectInfo.index];\n\n        if (objectValue && Array.isArray(objectValue[0])) {\n          let startIndex = i;\n\n          for (const item of objectValue) {\n            attribute._normalizeValue(item, value, startIndex);\n\n            startIndex += size;\n          }\n        } else if (objectValue && objectValue.length > size) {\n          value.set(objectValue, i);\n        } else {\n          attribute._normalizeValue(objectValue, objectInfo.target, 0);\n\n          fillArray({\n            target: value,\n            source: objectInfo.target,\n            start: i,\n            count: numVertices\n          });\n        }\n\n        i += numVertices * size;\n      } else {\n        attribute._normalizeValue(objectValue, value, i);\n\n        i += size;\n      }\n    }\n  }\n\n  _validateAttributeUpdaters() {\n    const {\n      settings\n    } = this;\n    const hasUpdater = settings.noAlloc || typeof settings.update === 'function';\n\n    if (!hasUpdater) {\n      throw new Error(\"Attribute \".concat(this.id, \" missing update or accessor\"));\n    }\n  }\n\n  _checkAttributeArray() {\n    const {\n      value\n    } = this;\n    const limit = Math.min(4, this.size);\n\n    if (value && value.length >= limit) {\n      let valid = true;\n\n      switch (limit) {\n        case 4:\n          valid = valid && Number.isFinite(value[3]);\n\n        case 3:\n          valid = valid && Number.isFinite(value[2]);\n\n        case 2:\n          valid = valid && Number.isFinite(value[1]);\n\n        case 1:\n          valid = valid && Number.isFinite(value[0]);\n          break;\n\n        default:\n          valid = false;\n      }\n\n      if (!valid) {\n        throw new Error(\"Illegal attribute generated for \".concat(this.id));\n      }\n    }\n  }\n\n}\n//# sourceMappingURL=attribute.js.map","export function glArrayFromType(glType) {\n  switch (glType) {\n    case 5126:\n      return Float32Array;\n\n    case 5130:\n      return Float64Array;\n\n    case 5123:\n    case 33635:\n    case 32819:\n    case 32820:\n      return Uint16Array;\n\n    case 5125:\n      return Uint32Array;\n\n    case 5121:\n      return Uint8ClampedArray;\n\n    case 5120:\n      return Int8Array;\n\n    case 5122:\n      return Int16Array;\n\n    case 5124:\n      return Int32Array;\n\n    default:\n      throw new Error('Unknown GL type');\n  }\n}\n//# sourceMappingURL=gl-utils.js.map","import { Buffer, Transform } from '@luma.gl/core';\nimport Attribute from '../lib/attribute/attribute';\nimport { padBuffer, getAttributeTypeFromSize, getSourceBufferAttribute, getAttributeBufferLength, cycleBuffers } from '../lib/attribute/attribute-transition-utils';\nimport Transition from './transition';\nexport default class GPUInterpolationTransition {\n  constructor({\n    gl,\n    attribute,\n    timeline\n  }) {\n    this.gl = gl;\n    this.type = 'interpolation';\n    this.transition = new Transition(timeline);\n    this.attribute = attribute;\n    this.attributeInTransition = new Attribute(gl, attribute.settings);\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = 0;\n    this.transform = getTransform(gl, attribute);\n    const bufferOpts = {\n      byteLength: 0,\n      usage: 35050\n    };\n    this.buffers = [new Buffer(gl, bufferOpts), new Buffer(gl, bufferOpts)];\n  }\n\n  get inProgress() {\n    return this.transition.inProgress;\n  }\n\n  start(transitionSettings, numInstances) {\n    if (transitionSettings.duration <= 0) {\n      this.transition.cancel();\n      return;\n    }\n\n    const {\n      gl,\n      buffers,\n      attribute\n    } = this;\n    cycleBuffers(buffers);\n    const padBufferOpts = {\n      numInstances,\n      attribute,\n      fromLength: this.currentLength,\n      fromStartIndices: this.currentStartIndices,\n      getData: transitionSettings.enter\n    };\n\n    for (const buffer of buffers) {\n      padBuffer({\n        buffer,\n        ...padBufferOpts\n      });\n    }\n\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = getAttributeBufferLength(attribute, numInstances);\n    this.attributeInTransition.update({\n      buffer: buffers[1],\n      value: attribute.value\n    });\n    this.transition.start(transitionSettings);\n    this.transform.update({\n      elementCount: Math.floor(this.currentLength / attribute.size),\n      sourceBuffers: {\n        aFrom: buffers[0],\n        aTo: getSourceBufferAttribute(gl, attribute)\n      },\n      feedbackBuffers: {\n        vCurrent: buffers[1]\n      }\n    });\n  }\n\n  update() {\n    const updated = this.transition.update();\n\n    if (updated) {\n      const {\n        time,\n        settings: {\n          duration,\n          easing\n        }\n      } = this.transition;\n      const t = easing(time / duration);\n      this.transform.run({\n        uniforms: {\n          time: t\n        }\n      });\n    }\n\n    return updated;\n  }\n\n  cancel() {\n    this.transition.cancel();\n    this.transform.delete();\n\n    while (this.buffers.length) {\n      this.buffers.pop().delete();\n    }\n  }\n\n}\nconst vs = \"\\n#define SHADER_NAME interpolation-transition-vertex-shader\\n\\nuniform float time;\\nattribute ATTRIBUTE_TYPE aFrom;\\nattribute ATTRIBUTE_TYPE aTo;\\nvarying ATTRIBUTE_TYPE vCurrent;\\n\\nvoid main(void) {\\n  vCurrent = mix(aFrom, aTo, time);\\n  gl_Position = vec4(0.0);\\n}\\n\";\n\nfunction getTransform(gl, attribute) {\n  const attributeType = getAttributeTypeFromSize(attribute.size);\n  return new Transform(gl, {\n    vs,\n    defines: {\n      ATTRIBUTE_TYPE: attributeType\n    },\n    varyings: ['vCurrent']\n  });\n}\n//# sourceMappingURL=gpu-interpolation-transition.js.map","import { Transform } from '@luma.gl/core';\nimport GPUInterpolationTransition from '../../transitions/gpu-interpolation-transition';\nimport GPUSpringTransition from '../../transitions/gpu-spring-transition';\nimport log from '../../utils/log';\nconst TRANSITION_TYPES = {\n  interpolation: GPUInterpolationTransition,\n  spring: GPUSpringTransition\n};\nexport default class AttributeTransitionManager {\n  constructor(gl, {\n    id,\n    timeline\n  }) {\n    this.id = id;\n    this.gl = gl;\n    this.timeline = timeline;\n    this.transitions = {};\n    this.needsRedraw = false;\n    this.numInstances = 1;\n    this.isSupported = Transform.isSupported(gl);\n  }\n\n  finalize() {\n    for (const attributeName in this.transitions) {\n      this._removeTransition(attributeName);\n    }\n  }\n\n  update({\n    attributes,\n    transitions,\n    numInstances\n  }) {\n    this.numInstances = numInstances || 1;\n\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      const settings = attribute.getTransitionSetting(transitions);\n      if (!settings) continue;\n\n      this._updateAttribute(attributeName, attribute, settings);\n    }\n\n    for (const attributeName in this.transitions) {\n      const attribute = attributes[attributeName];\n\n      if (!attribute || !attribute.getTransitionSetting(transitions)) {\n        this._removeTransition(attributeName);\n      }\n    }\n  }\n\n  hasAttribute(attributeName) {\n    const transition = this.transitions[attributeName];\n    return transition && transition.inProgress;\n  }\n\n  getAttributes() {\n    const animatedAttributes = {};\n\n    for (const attributeName in this.transitions) {\n      const transition = this.transitions[attributeName];\n\n      if (transition.inProgress) {\n        animatedAttributes[attributeName] = transition.attributeInTransition;\n      }\n    }\n\n    return animatedAttributes;\n  }\n\n  run() {\n    if (!this.isSupported || this.numInstances === 0) {\n      return false;\n    }\n\n    for (const attributeName in this.transitions) {\n      const updated = this.transitions[attributeName].update();\n\n      if (updated) {\n        this.needsRedraw = true;\n      }\n    }\n\n    const needsRedraw = this.needsRedraw;\n    this.needsRedraw = false;\n    return needsRedraw;\n  }\n\n  _removeTransition(attributeName) {\n    this.transitions[attributeName].cancel();\n    delete this.transitions[attributeName];\n  }\n\n  _updateAttribute(attributeName, attribute, settings) {\n    const transition = this.transitions[attributeName];\n    let isNew = !transition || transition.type !== settings.type;\n\n    if (isNew) {\n      if (!this.isSupported) {\n        log.warn(\"WebGL2 not supported by this browser. Transition for \".concat(attributeName, \" is disabled.\"))();\n        return;\n      }\n\n      if (transition) {\n        this._removeTransition(attributeName);\n      }\n\n      const TransitionType = TRANSITION_TYPES[settings.type];\n\n      if (TransitionType) {\n        this.transitions[attributeName] = new TransitionType({\n          attribute,\n          timeline: this.timeline,\n          gl: this.gl\n        });\n      } else {\n        log.error(\"unsupported transition type '\".concat(settings.type, \"'\"))();\n        isNew = false;\n      }\n    }\n\n    if (isNew || attribute.needsRedraw()) {\n      this.needsRedraw = true;\n      this.transitions[attributeName].start(settings, this.numInstances);\n    }\n  }\n\n}\n//# sourceMappingURL=attribute-transition-manager.js.map","import { Buffer, Transform, Framebuffer, Texture2D, readPixelsToArray } from '@luma.gl/core';\nimport { padBuffer, getAttributeTypeFromSize, getSourceBufferAttribute, getAttributeBufferLength, cycleBuffers } from '../lib/attribute/attribute-transition-utils';\nimport Attribute from '../lib/attribute/attribute';\nimport Transition from './transition';\nexport default class GPUSpringTransition {\n  constructor({\n    gl,\n    attribute,\n    timeline\n  }) {\n    this.gl = gl;\n    this.type = 'spring';\n    this.transition = new Transition(timeline);\n    this.attribute = attribute;\n    this.attributeInTransition = new Attribute(gl, { ...attribute.settings,\n      normalized: false\n    });\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = 0;\n    this.texture = getTexture(gl);\n    this.framebuffer = getFramebuffer(gl, this.texture);\n    this.transform = getTransform(gl, attribute, this.framebuffer);\n    const bufferOpts = {\n      byteLength: 0,\n      usage: 35050\n    };\n    this.buffers = [new Buffer(gl, bufferOpts), new Buffer(gl, bufferOpts), new Buffer(gl, bufferOpts)];\n  }\n\n  get inProgress() {\n    return this.transition.inProgress;\n  }\n\n  start(transitionSettings, numInstances) {\n    const {\n      gl,\n      buffers,\n      attribute\n    } = this;\n    const padBufferOpts = {\n      numInstances,\n      attribute,\n      fromLength: this.currentLength,\n      fromStartIndices: this.currentStartIndices,\n      getData: transitionSettings.enter\n    };\n\n    for (const buffer of buffers) {\n      padBuffer({\n        buffer,\n        ...padBufferOpts\n      });\n    }\n\n    this.currentStartIndices = attribute.startIndices;\n    this.currentLength = getAttributeBufferLength(attribute, numInstances);\n    this.attributeInTransition.update({\n      buffer: buffers[1],\n      value: attribute.value\n    });\n    this.transition.start(transitionSettings);\n    this.transform.update({\n      elementCount: Math.floor(this.currentLength / attribute.size),\n      sourceBuffers: {\n        aTo: getSourceBufferAttribute(gl, attribute)\n      }\n    });\n  }\n\n  update() {\n    const {\n      buffers,\n      transform,\n      framebuffer,\n      transition\n    } = this;\n    const updated = transition.update();\n\n    if (!updated) {\n      return false;\n    }\n\n    transform.update({\n      sourceBuffers: {\n        aPrev: buffers[0],\n        aCur: buffers[1]\n      },\n      feedbackBuffers: {\n        vNext: buffers[2]\n      }\n    });\n    transform.run({\n      framebuffer,\n      discard: false,\n      clearRenderTarget: true,\n      uniforms: {\n        stiffness: transition.settings.stiffness,\n        damping: transition.settings.damping\n      },\n      parameters: {\n        depthTest: false,\n        blend: true,\n        viewport: [0, 0, 1, 1],\n        blendFunc: [1, 1],\n        blendEquation: [32776, 32776]\n      }\n    });\n    cycleBuffers(buffers);\n    this.attributeInTransition.update({\n      buffer: buffers[1],\n      value: this.attribute.value\n    });\n    const isTransitioning = readPixelsToArray(framebuffer)[0] > 0;\n\n    if (!isTransitioning) {\n      transition.end();\n    }\n\n    return true;\n  }\n\n  cancel() {\n    this.transition.cancel();\n    this.transform.delete();\n\n    while (this.buffers.length) {\n      this.buffers.pop().delete();\n    }\n\n    this.texture.delete();\n    this.texture = null;\n    this.framebuffer.delete();\n    this.framebuffer = null;\n  }\n\n}\n\nfunction getTransform(gl, attribute, framebuffer) {\n  const attributeType = getAttributeTypeFromSize(attribute.size);\n  return new Transform(gl, {\n    framebuffer,\n    vs: \"\\n#define SHADER_NAME spring-transition-vertex-shader\\n\\n#define EPSILON 0.00001\\n\\nuniform float stiffness;\\nuniform float damping;\\nattribute ATTRIBUTE_TYPE aPrev;\\nattribute ATTRIBUTE_TYPE aCur;\\nattribute ATTRIBUTE_TYPE aTo;\\nvarying ATTRIBUTE_TYPE vNext;\\nvarying float vIsTransitioningFlag;\\n\\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\\n  ATTRIBUTE_TYPE velocity = cur - prev;\\n  ATTRIBUTE_TYPE delta = dest - cur;\\n  ATTRIBUTE_TYPE spring = delta * stiffness;\\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\\n  return spring + damper + velocity + cur;\\n}\\n\\nvoid main(void) {\\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\\n\\n  vNext = getNextValue(aCur, aPrev, aTo);\\n  gl_Position = vec4(0, 0, 0, 1);\\n  gl_PointSize = 100.0;\\n}\\n\",\n    fs: \"\\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\\n\\nvarying float vIsTransitioningFlag;\\n\\nvoid main(void) {\\n  if (vIsTransitioningFlag == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor = vec4(1.0);\\n}\",\n    defines: {\n      ATTRIBUTE_TYPE: attributeType\n    },\n    varyings: ['vNext']\n  });\n}\n\nfunction getTexture(gl) {\n  return new Texture2D(gl, {\n    data: new Uint8Array(4),\n    format: 6408,\n    type: 5121,\n    border: 0,\n    mipmaps: false,\n    dataFormat: 6408,\n    width: 1,\n    height: 1\n  });\n}\n\nfunction getFramebuffer(gl, texture) {\n  return new Framebuffer(gl, {\n    id: 'spring-transition-is-transitioning-framebuffer',\n    width: 1,\n    height: 1,\n    attachments: {\n      [36064]: texture\n    }\n  });\n}\n//# sourceMappingURL=gpu-spring-transition.js.map","import Attribute from './attribute';\nimport log from '../../utils/log';\nimport debug from '../../debug';\nimport AttributeTransitionManager from './attribute-transition-manager';\nconst TRACE_INVALIDATE = 'attributeManager.invalidate';\nconst TRACE_UPDATE_START = 'attributeManager.updateStart';\nconst TRACE_UPDATE_END = 'attributeManager.updateEnd';\nconst TRACE_ATTRIBUTE_UPDATE_START = 'attribute.updateStart';\nconst TRACE_ATTRIBUTE_ALLOCATE = 'attribute.allocate';\nconst TRACE_ATTRIBUTE_UPDATE_END = 'attribute.updateEnd';\nexport default class AttributeManager {\n  constructor(gl, {\n    id = 'attribute-manager',\n    stats,\n    timeline\n  } = {}) {\n    this.id = id;\n    this.gl = gl;\n    this.attributes = {};\n    this.updateTriggers = {};\n    this.accessors = {};\n    this.needsRedraw = true;\n    this.userData = {};\n    this.stats = stats;\n    this.attributeTransitionManager = new AttributeTransitionManager(gl, {\n      id: \"\".concat(id, \"-transitions\"),\n      timeline\n    });\n    Object.seal(this);\n  }\n\n  finalize() {\n    for (const attributeName in this.attributes) {\n      this.attributes[attributeName].delete();\n    }\n\n    this.attributeTransitionManager.finalize();\n  }\n\n  getNeedsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    const redraw = this.needsRedraw;\n    this.needsRedraw = this.needsRedraw && !opts.clearRedrawFlags;\n    return redraw && this.id;\n  }\n\n  setNeedsRedraw(redraw = true) {\n    this.needsRedraw = true;\n    return this;\n  }\n\n  add(attributes, updaters) {\n    this._add(attributes, updaters);\n  }\n\n  addInstanced(attributes, updaters) {\n    this._add(attributes, updaters, {\n      instanced: 1\n    });\n  }\n\n  remove(attributeNameArray) {\n    for (let i = 0; i < attributeNameArray.length; i++) {\n      const name = attributeNameArray[i];\n\n      if (this.attributes[name] !== undefined) {\n        this.attributes[name].delete();\n        delete this.attributes[name];\n      }\n    }\n  }\n\n  invalidate(triggerName, dataRange) {\n    const invalidatedAttributes = this._invalidateTrigger(triggerName, dataRange);\n\n    debug(TRACE_INVALIDATE, this, triggerName, invalidatedAttributes);\n  }\n\n  invalidateAll(dataRange) {\n    for (const attributeName in this.attributes) {\n      this.attributes[attributeName].setNeedsUpdate(attributeName, dataRange);\n    }\n\n    debug(TRACE_INVALIDATE, this, 'all');\n  }\n\n  update({\n    data,\n    numInstances,\n    startIndices = null,\n    transitions,\n    props = {},\n    buffers = {},\n    context = {}\n  } = {}) {\n    let updated = false;\n    debug(TRACE_UPDATE_START, this);\n\n    if (this.stats) {\n      this.stats.get('Update Attributes').timeStart();\n    }\n\n    for (const attributeName in this.attributes) {\n      const attribute = this.attributes[attributeName];\n      const accessorName = attribute.settings.accessor;\n      attribute.startIndices = startIndices;\n\n      if (props[attributeName]) {\n        log.removed(\"props.\".concat(attributeName), \"data.attributes.\".concat(attributeName))();\n      }\n\n      if (attribute.setExternalBuffer(buffers[attributeName])) {} else if (attribute.setBinaryValue(buffers[accessorName], data.startIndices)) {} else if (!buffers[accessorName] && attribute.setConstantValue(props[accessorName])) {} else if (attribute.needsUpdate()) {\n        updated = true;\n\n        this._updateAttribute({\n          attribute,\n          numInstances,\n          data,\n          props,\n          context\n        });\n      }\n\n      this.needsRedraw |= attribute.needsRedraw();\n    }\n\n    if (updated) {\n      debug(TRACE_UPDATE_END, this, numInstances);\n    }\n\n    if (this.stats) {\n      this.stats.get('Update Attributes').timeEnd();\n    }\n\n    this.attributeTransitionManager.update({\n      attributes: this.attributes,\n      numInstances,\n      transitions\n    });\n  }\n\n  updateTransition() {\n    const {\n      attributeTransitionManager\n    } = this;\n    const transitionUpdated = attributeTransitionManager.run();\n    this.needsRedraw = this.needsRedraw || transitionUpdated;\n    return transitionUpdated;\n  }\n\n  getAttributes() {\n    return this.attributes;\n  }\n\n  getChangedAttributes(opts = {\n    clearChangedFlags: false\n  }) {\n    const {\n      attributes,\n      attributeTransitionManager\n    } = this;\n    const changedAttributes = { ...attributeTransitionManager.getAttributes()\n    };\n\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n\n      if (attribute.needsRedraw(opts) && !attributeTransitionManager.hasAttribute(attributeName)) {\n        changedAttributes[attributeName] = attribute;\n      }\n    }\n\n    return changedAttributes;\n  }\n\n  getShaderAttributes(attributes, excludeAttributes = {}) {\n    if (!attributes) {\n      attributes = this.getAttributes();\n    }\n\n    const shaderAttributes = {};\n\n    for (const attributeName in attributes) {\n      if (!excludeAttributes[attributeName]) {\n        Object.assign(shaderAttributes, attributes[attributeName].getShaderAttributes());\n      }\n    }\n\n    return shaderAttributes;\n  }\n\n  getAccessors() {\n    return this.updateTriggers;\n  }\n\n  _add(attributes, updaters, extraProps = {}) {\n    if (updaters) {\n      log.warn('AttributeManager.add({updaters}) - updater map no longer supported')();\n    }\n\n    for (const attributeName in attributes) {\n      const attribute = attributes[attributeName];\n      this.attributes[attributeName] = this._createAttribute(attributeName, attribute, extraProps);\n    }\n\n    this._mapUpdateTriggersToAttributes();\n  }\n\n  _createAttribute(name, attribute, extraProps) {\n    const props = { ...attribute,\n      id: name,\n      constant: attribute.constant || false,\n      isIndexed: attribute.isIndexed || attribute.elements,\n      size: attribute.elements && 1 || attribute.size,\n      value: attribute.value || null,\n      divisor: attribute.instanced || extraProps.instanced ? 1 : attribute.divisor\n    };\n    return new Attribute(this.gl, props);\n  }\n\n  _mapUpdateTriggersToAttributes() {\n    const triggers = {};\n\n    for (const attributeName in this.attributes) {\n      const attribute = this.attributes[attributeName];\n      attribute.getUpdateTriggers().forEach(triggerName => {\n        if (!triggers[triggerName]) {\n          triggers[triggerName] = [];\n        }\n\n        triggers[triggerName].push(attributeName);\n      });\n    }\n\n    this.updateTriggers = triggers;\n  }\n\n  _invalidateTrigger(triggerName, dataRange) {\n    const {\n      attributes,\n      updateTriggers\n    } = this;\n    const invalidatedAttributes = updateTriggers[triggerName];\n\n    if (invalidatedAttributes) {\n      invalidatedAttributes.forEach(name => {\n        const attribute = attributes[name];\n\n        if (attribute) {\n          attribute.setNeedsUpdate(attribute.id, dataRange);\n        }\n      });\n    }\n\n    return invalidatedAttributes;\n  }\n\n  _updateAttribute(opts) {\n    const {\n      attribute,\n      numInstances\n    } = opts;\n    debug(TRACE_ATTRIBUTE_UPDATE_START, attribute);\n\n    if (attribute.allocate(numInstances)) {\n      debug(TRACE_ATTRIBUTE_ALLOCATE, attribute, numInstances);\n    }\n\n    const updated = attribute.updateBuffer(opts);\n\n    if (updated) {\n      this.needsRedraw = true;\n      debug(TRACE_ATTRIBUTE_UPDATE_END, attribute, numInstances);\n    }\n  }\n\n}\n//# sourceMappingURL=attribute-manager.js.map","import Transition from './transition';\nconst EPSILON = 1e-5;\n\nfunction updateSpringElement(prev, cur, dest, damping, stiffness) {\n  const velocity = cur - prev;\n  const delta = dest - cur;\n  const spring = delta * stiffness;\n  const damper = -velocity * damping;\n  return spring + damper + velocity + cur;\n}\n\nfunction updateSpring(prev, cur, dest, damping, stiffness) {\n  if (Array.isArray(dest)) {\n    const next = [];\n\n    for (let i = 0; i < dest.length; i++) {\n      next[i] = updateSpringElement(prev[i], cur[i], dest[i], damping, stiffness);\n    }\n\n    return next;\n  }\n\n  return updateSpringElement(prev, cur, dest, damping, stiffness);\n}\n\nfunction distance(value1, value2) {\n  if (Array.isArray(value1)) {\n    let distanceSquare = 0;\n\n    for (let i = 0; i < value1.length; i++) {\n      const d = value1[i] - value2[i];\n      distanceSquare += d * d;\n    }\n\n    return Math.sqrt(distanceSquare);\n  }\n\n  return Math.abs(value1 - value2);\n}\n\nexport default class CPUSpringTransition extends Transition {\n  get value() {\n    return this._currValue;\n  }\n\n  _onUpdate() {\n    const {\n      fromValue,\n      toValue,\n      damping,\n      stiffness\n    } = this.settings;\n    const {\n      _prevValue = fromValue,\n      _currValue = fromValue\n    } = this;\n    let nextValue = updateSpring(_prevValue, _currValue, toValue, damping, stiffness);\n    const delta = distance(nextValue, toValue);\n    const velocity = distance(nextValue, _currValue);\n\n    if (delta < EPSILON && velocity < EPSILON) {\n      nextValue = toValue;\n      this.end();\n    }\n\n    this._prevValue = _currValue;\n    this._currValue = nextValue;\n  }\n\n}\n//# sourceMappingURL=cpu-spring-transition.js.map","import { normalizeTransitionSettings } from './attribute/attribute-transition-utils';\nimport CPUInterpolationTransition from '../transitions/cpu-interpolation-transition';\nimport CPUSpringTransition from '../transitions/cpu-spring-transition';\nimport log from '../utils/log';\nconst TRANSITION_TYPES = {\n  interpolation: CPUInterpolationTransition,\n  spring: CPUSpringTransition\n};\nexport default class UniformTransitionManager {\n  constructor(timeline) {\n    this.transitions = new Map();\n    this.timeline = timeline;\n  }\n\n  get active() {\n    return this.transitions.size > 0;\n  }\n\n  add(key, fromValue, toValue, settings) {\n    const {\n      transitions\n    } = this;\n\n    if (transitions.has(key)) {\n      const transition = transitions.get(key);\n      const {\n        value = transition.settings.fromValue\n      } = transition;\n      fromValue = value;\n      this.remove(key);\n    }\n\n    settings = normalizeTransitionSettings(settings);\n\n    if (!settings) {\n      return;\n    }\n\n    const TransitionType = TRANSITION_TYPES[settings.type];\n\n    if (!TransitionType) {\n      log.error(\"unsupported transition type '\".concat(settings.type, \"'\"))();\n      return;\n    }\n\n    const transition = new TransitionType(this.timeline);\n    transition.start({ ...settings,\n      fromValue,\n      toValue\n    });\n    transitions.set(key, transition);\n  }\n\n  remove(key) {\n    const {\n      transitions\n    } = this;\n\n    if (transitions.has(key)) {\n      transitions.get(key).cancel();\n      transitions.delete(key);\n    }\n  }\n\n  update() {\n    const propsInTransition = {};\n\n    for (const [key, transition] of this.transitions) {\n      transition.update();\n      propsInTransition[key] = transition.value;\n\n      if (!transition.inProgress) {\n        this.remove(key);\n      }\n    }\n\n    return propsInTransition;\n  }\n\n  clear() {\n    for (const key of this.transitions.keys()) {\n      this.remove(key);\n    }\n  }\n\n}\n//# sourceMappingURL=uniform-transition-manager.js.map","import { lerp } from 'math.gl';\nimport Transition from './transition';\nexport default class CPUInterpolationTransition extends Transition {\n  get value() {\n    return this._value;\n  }\n\n  _onUpdate() {\n    const {\n      time,\n      settings: {\n        fromValue,\n        toValue,\n        duration,\n        easing\n      }\n    } = this;\n    const t = easing(time / duration);\n    this._value = lerp(fromValue, toValue, t);\n  }\n\n}\n//# sourceMappingURL=cpu-interpolation-transition.js.map","import { PROP_SYMBOLS } from './constants';\nconst {\n  COMPONENT\n} = PROP_SYMBOLS;\nexport function validateProps(props) {\n  const propTypes = getPropTypes(props);\n\n  for (const propName in propTypes) {\n    const propType = propTypes[propName];\n    const {\n      validate\n    } = propType;\n\n    if (validate && !validate(props[propName], propType)) {\n      throw new Error(\"Invalid prop \".concat(propName, \": \").concat(props[propName]));\n    }\n  }\n}\nexport function diffProps(props, oldProps) {\n  const propsChangedReason = compareProps({\n    newProps: props,\n    oldProps,\n    propTypes: getPropTypes(props),\n    ignoreProps: {\n      data: null,\n      updateTriggers: null,\n      extensions: null,\n      transitions: null\n    }\n  });\n  const dataChangedReason = diffDataProps(props, oldProps);\n  let updateTriggersChangedReason = false;\n\n  if (!dataChangedReason) {\n    updateTriggersChangedReason = diffUpdateTriggers(props, oldProps);\n  }\n\n  return {\n    dataChanged: dataChangedReason,\n    propsChanged: propsChangedReason,\n    updateTriggersChanged: updateTriggersChangedReason,\n    extensionsChanged: diffExtensions(props, oldProps),\n    transitionsChanged: diffTransitions(props, oldProps)\n  };\n}\n\nfunction diffTransitions(props, oldProps) {\n  if (!props.transitions) {\n    return null;\n  }\n\n  const result = {};\n  const propTypes = getPropTypes(props);\n\n  for (const key in props.transitions) {\n    const propType = propTypes[key];\n    const type = propType && propType.type;\n    const isTransitionable = type === 'number' || type === 'color' || type === 'array';\n\n    if (isTransitionable && comparePropValues(props[key], oldProps[key], propType)) {\n      result[key] = true;\n    }\n  }\n\n  return result;\n}\n\nexport function compareProps({\n  newProps,\n  oldProps,\n  ignoreProps = {},\n  propTypes = {},\n  triggerName = 'props'\n} = {}) {\n  if (oldProps === newProps) {\n    return null;\n  }\n\n  if (typeof newProps !== 'object' || newProps === null) {\n    return \"\".concat(triggerName, \" changed shallowly\");\n  }\n\n  if (typeof oldProps !== 'object' || oldProps === null) {\n    return \"\".concat(triggerName, \" changed shallowly\");\n  }\n\n  for (const key of Object.keys(newProps)) {\n    if (!(key in ignoreProps)) {\n      if (!(key in oldProps)) {\n        return \"\".concat(triggerName, \".\").concat(key, \" added\");\n      }\n\n      const changed = comparePropValues(newProps[key], oldProps[key], propTypes[key]);\n\n      if (changed) {\n        return \"\".concat(triggerName, \".\").concat(key, \" \").concat(changed);\n      }\n    }\n  }\n\n  for (const key of Object.keys(oldProps)) {\n    if (!(key in ignoreProps)) {\n      if (!(key in newProps)) {\n        return \"\".concat(triggerName, \".\").concat(key, \" dropped\");\n      }\n\n      if (!Object.hasOwnProperty.call(newProps, key)) {\n        const changed = comparePropValues(newProps[key], oldProps[key], propTypes[key]);\n\n        if (changed) {\n          return \"\".concat(triggerName, \".\").concat(key, \" \").concat(changed);\n        }\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction comparePropValues(newProp, oldProp, propType) {\n  let equal = propType && propType.equal;\n\n  if (equal && !equal(newProp, oldProp, propType)) {\n    return 'changed deeply';\n  }\n\n  if (!equal) {\n    equal = newProp && oldProp && newProp.equals;\n\n    if (equal && !equal.call(newProp, oldProp)) {\n      return 'changed deeply';\n    }\n  }\n\n  if (!equal && oldProp !== newProp) {\n    return 'changed shallowly';\n  }\n\n  return null;\n}\n\nfunction diffDataProps(props, oldProps) {\n  if (oldProps === null) {\n    return 'oldProps is null, initial diff';\n  }\n\n  let dataChanged = null;\n  const {\n    dataComparator,\n    _dataDiff\n  } = props;\n\n  if (dataComparator) {\n    if (!dataComparator(props.data, oldProps.data)) {\n      dataChanged = 'Data comparator detected a change';\n    }\n  } else if (props.data !== oldProps.data) {\n    dataChanged = 'A new data container was supplied';\n  }\n\n  if (dataChanged && _dataDiff) {\n    dataChanged = _dataDiff(props.data, oldProps.data) || dataChanged;\n  }\n\n  return dataChanged;\n}\n\nfunction diffUpdateTriggers(props, oldProps) {\n  if (oldProps === null) {\n    return 'oldProps is null, initial diff';\n  }\n\n  if ('all' in props.updateTriggers) {\n    const diffReason = diffUpdateTrigger(props, oldProps, 'all');\n\n    if (diffReason) {\n      return {\n        all: true\n      };\n    }\n  }\n\n  const triggerChanged = {};\n  let reason = false;\n\n  for (const triggerName in props.updateTriggers) {\n    if (triggerName !== 'all') {\n      const diffReason = diffUpdateTrigger(props, oldProps, triggerName);\n\n      if (diffReason) {\n        triggerChanged[triggerName] = true;\n        reason = triggerChanged;\n      }\n    }\n  }\n\n  return reason;\n}\n\nfunction diffExtensions(props, oldProps) {\n  if (oldProps === null) {\n    return 'oldProps is null, initial diff';\n  }\n\n  const oldExtensions = oldProps.extensions;\n  const {\n    extensions\n  } = props;\n\n  if (extensions === oldExtensions) {\n    return false;\n  }\n\n  if (extensions.length !== oldExtensions.length) {\n    return true;\n  }\n\n  for (let i = 0; i < extensions.length; i++) {\n    if (!extensions[i].equals(oldExtensions[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction diffUpdateTrigger(props, oldProps, triggerName) {\n  let newTriggers = props.updateTriggers[triggerName];\n  newTriggers = newTriggers === undefined || newTriggers === null ? {} : newTriggers;\n  let oldTriggers = oldProps.updateTriggers[triggerName];\n  oldTriggers = oldTriggers === undefined || oldTriggers === null ? {} : oldTriggers;\n  const diffReason = compareProps({\n    oldProps: oldTriggers,\n    newProps: newTriggers,\n    triggerName\n  });\n  return diffReason;\n}\n\nfunction getPropTypes(props) {\n  const layer = props[COMPONENT];\n  const LayerType = layer && layer.constructor;\n  return LayerType ? LayerType._propTypes : {};\n}\n//# sourceMappingURL=props.js.map","const ERR_NOT_OBJECT = 'count(): argument not an object';\nconst ERR_NOT_CONTAINER = 'count(): argument not a container';\nexport function count(container) {\n  if (!isObject(container)) {\n    throw new Error(ERR_NOT_OBJECT);\n  }\n\n  if (typeof container.count === 'function') {\n    return container.count();\n  }\n\n  if (Number.isFinite(container.size)) {\n    return container.size;\n  }\n\n  if (Number.isFinite(container.length)) {\n    return container.length;\n  }\n\n  if (isPlainObject(container)) {\n    return Object.keys(container).length;\n  }\n\n  throw new Error(ERR_NOT_CONTAINER);\n}\n\nfunction isPlainObject(value) {\n  return value !== null && typeof value === 'object' && value.constructor === Object;\n}\n\nfunction isObject(value) {\n  return value !== null && typeof value === 'object';\n}\n//# sourceMappingURL=count.js.map","export function mergeShaders(target, source) {\n  if (!source) {\n    return target;\n  }\n\n  const result = { ...target,\n    ...source\n  };\n\n  if ('defines' in source) {\n    result.defines = { ...target.defines,\n      ...source.defines\n    };\n  }\n\n  if ('modules' in source) {\n    result.modules = (target.modules || []).concat(source.modules);\n\n    if (source.modules.some(module => module.name === 'project64')) {\n      const index = result.modules.findIndex(module => module.name === 'project32');\n\n      if (index >= 0) {\n        result.modules.splice(index, 1);\n      }\n    }\n  }\n\n  if ('inject' in source) {\n    if (!target.inject) {\n      result.inject = source.inject;\n    } else {\n      const mergedInjection = { ...target.inject\n      };\n\n      for (const key in source.inject) {\n        mergedInjection[key] = (mergedInjection[key] || '') + source.inject[key];\n      }\n\n      result.inject = mergedInjection;\n    }\n  }\n\n  return result;\n}\n//# sourceMappingURL=shader.js.map","import { Texture2D } from '@luma.gl/core';\nconst DEFAULT_TEXTURE_PARAMETERS = {\n  [10241]: 9987,\n  [10240]: 9729,\n  [10242]: 33071,\n  [10243]: 33071\n};\nconst internalTextures = {};\nexport function createTexture(layer, image) {\n  const gl = layer.context && layer.context.gl;\n\n  if (!gl || !image) {\n    return null;\n  }\n\n  if (image instanceof Texture2D) {\n    return image;\n  } else if (image.constructor && image.constructor.name !== 'Object') {\n    image = {\n      data: image\n    };\n  }\n\n  let specialTextureParameters = null;\n\n  if (image.compressed) {\n    specialTextureParameters = {\n      [10241]: image.data.length > 1 ? 9985 : 9729\n    };\n  }\n\n  const texture = new Texture2D(gl, { ...image,\n    parameters: { ...DEFAULT_TEXTURE_PARAMETERS,\n      ...specialTextureParameters,\n      ...layer.props.textureParameters\n    }\n  });\n  internalTextures[texture.id] = true;\n  return texture;\n}\nexport function destroyTexture(texture) {\n  if (!texture || !(texture instanceof Texture2D)) {\n    return;\n  }\n\n  if (internalTextures[texture.id]) {\n    texture.delete();\n    delete internalTextures[texture.id];\n  }\n}\n//# sourceMappingURL=texture.js.map","import { createTexture, destroyTexture } from '../utils/texture';\nconst TYPE_DEFINITIONS = {\n  boolean: {\n    validate(value, propType) {\n      return true;\n    },\n\n    equal(value1, value2, propType) {\n      return Boolean(value1) === Boolean(value2);\n    }\n\n  },\n  number: {\n    validate(value, propType) {\n      return Number.isFinite(value) && (!('max' in propType) || value <= propType.max) && (!('min' in propType) || value >= propType.min);\n    }\n\n  },\n  color: {\n    validate(value, propType) {\n      return propType.optional && !value || isArray(value) && (value.length === 3 || value.length === 4);\n    },\n\n    equal(value1, value2, propType) {\n      return arrayEqual(value1, value2);\n    }\n\n  },\n  accessor: {\n    validate(value, propType) {\n      const valueType = getTypeOf(value);\n      return valueType === 'function' || valueType === getTypeOf(propType.value);\n    },\n\n    equal(value1, value2, propType) {\n      if (typeof value2 === 'function') {\n        return true;\n      }\n\n      return arrayEqual(value1, value2);\n    }\n\n  },\n  array: {\n    validate(value, propType) {\n      return propType.optional && !value || isArray(value);\n    },\n\n    equal(value1, value2, propType) {\n      return propType.compare ? arrayEqual(value1, value2) : value1 === value2;\n    }\n\n  },\n  function: {\n    validate(value, propType) {\n      return propType.optional && !value || typeof value === 'function';\n    },\n\n    equal(value1, value2, propType) {\n      return !propType.compare || value1 === value2;\n    }\n\n  },\n  data: {\n    transform: (value, propType, component) => {\n      const {\n        dataTransform\n      } = component ? component.props : {};\n      return dataTransform && value ? dataTransform(value) : value;\n    }\n  },\n  image: {\n    transform: (value, propType, component) => {\n      return createTexture(component, value);\n    },\n    release: value => {\n      destroyTexture(value);\n    }\n  }\n};\n\nfunction arrayEqual(array1, array2) {\n  if (array1 === array2) {\n    return true;\n  }\n\n  if (!isArray(array1) || !isArray(array2)) {\n    return false;\n  }\n\n  const len = array1.length;\n\n  if (len !== array2.length) {\n    return false;\n  }\n\n  for (let i = 0; i < len; i++) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function parsePropTypes(propDefs) {\n  const propTypes = {};\n  const defaultProps = {};\n  const deprecatedProps = {};\n\n  for (const [propName, propDef] of Object.entries(propDefs)) {\n    if (propDef && propDef.deprecatedFor) {\n      deprecatedProps[propName] = Array.isArray(propDef.deprecatedFor) ? propDef.deprecatedFor : [propDef.deprecatedFor];\n    } else {\n      const propType = parsePropType(propName, propDef);\n      propTypes[propName] = propType;\n      defaultProps[propName] = propType.value;\n    }\n  }\n\n  return {\n    propTypes,\n    defaultProps,\n    deprecatedProps\n  };\n}\n\nfunction parsePropType(name, propDef) {\n  switch (getTypeOf(propDef)) {\n    case 'object':\n      return normalizePropDefinition(name, propDef);\n\n    case 'array':\n      return normalizePropDefinition(name, {\n        type: 'array',\n        value: propDef,\n        compare: false\n      });\n\n    case 'boolean':\n      return normalizePropDefinition(name, {\n        type: 'boolean',\n        value: propDef\n      });\n\n    case 'number':\n      return normalizePropDefinition(name, {\n        type: 'number',\n        value: propDef\n      });\n\n    case 'function':\n      return normalizePropDefinition(name, {\n        type: 'function',\n        value: propDef,\n        compare: true\n      });\n\n    default:\n      return {\n        name,\n        type: 'unknown',\n        value: propDef\n      };\n  }\n}\n\nfunction normalizePropDefinition(name, propDef) {\n  if (!('type' in propDef)) {\n    if (!('value' in propDef)) {\n      return {\n        name,\n        type: 'object',\n        value: propDef\n      };\n    }\n\n    return {\n      name,\n      type: getTypeOf(propDef.value),\n      ...propDef\n    };\n  }\n\n  return {\n    name,\n    ...TYPE_DEFINITIONS[propDef.type],\n    ...propDef\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value) || ArrayBuffer.isView(value);\n}\n\nfunction getTypeOf(value) {\n  if (isArray(value)) {\n    return 'array';\n  }\n\n  if (value === null) {\n    return 'null';\n  }\n\n  return typeof value;\n}\n//# sourceMappingURL=prop-types.js.map","import log from '../utils/log';\nimport { isAsyncIterable } from '../utils/iterable-utils';\nimport { parsePropTypes } from './prop-types';\nimport { PROP_SYMBOLS } from './constants';\nconst {\n  COMPONENT,\n  ASYNC_ORIGINAL,\n  ASYNC_RESOLVED,\n  ASYNC_DEFAULTS\n} = PROP_SYMBOLS;\nexport function createProps() {\n  const component = this;\n  const propsPrototype = getPropsPrototype(component.constructor);\n  const propsInstance = Object.create(propsPrototype);\n  propsInstance[COMPONENT] = component;\n  propsInstance[ASYNC_ORIGINAL] = {};\n  propsInstance[ASYNC_RESOLVED] = {};\n\n  for (let i = 0; i < arguments.length; ++i) {\n    const props = arguments[i];\n\n    for (const key in props) {\n      propsInstance[key] = props[key];\n    }\n  }\n\n  Object.freeze(propsInstance);\n  return propsInstance;\n}\n\nfunction getPropsPrototype(componentClass) {\n  const defaultProps = getOwnProperty(componentClass, '_mergedDefaultProps');\n\n  if (!defaultProps) {\n    createPropsPrototypeAndTypes(componentClass);\n    return componentClass._mergedDefaultProps;\n  }\n\n  return defaultProps;\n}\n\nfunction createPropsPrototypeAndTypes(componentClass) {\n  const parent = componentClass.prototype;\n\n  if (!parent) {\n    return;\n  }\n\n  const parentClass = Object.getPrototypeOf(componentClass);\n  const parentDefaultProps = getPropsPrototype(parentClass);\n  const componentDefaultProps = getOwnProperty(componentClass, 'defaultProps') || {};\n  const componentPropDefs = parsePropTypes(componentDefaultProps);\n  const defaultProps = createPropsPrototype(componentPropDefs.defaultProps, parentDefaultProps, componentClass);\n  const propTypes = { ...parentClass._propTypes,\n    ...componentPropDefs.propTypes\n  };\n  addAsyncPropsToPropPrototype(defaultProps, propTypes);\n  const deprecatedProps = { ...parentClass._deprecatedProps,\n    ...componentPropDefs.deprecatedProps\n  };\n  addDeprecatedPropsToPropPrototype(defaultProps, deprecatedProps);\n  componentClass._mergedDefaultProps = defaultProps;\n  componentClass._propTypes = propTypes;\n  componentClass._deprecatedProps = deprecatedProps;\n}\n\nfunction createPropsPrototype(props, parentProps, componentClass) {\n  const defaultProps = Object.create(null);\n  Object.assign(defaultProps, parentProps, props);\n  const id = getComponentName(componentClass);\n  delete props.id;\n  Object.defineProperties(defaultProps, {\n    id: {\n      writable: true,\n      value: id\n    }\n  });\n  return defaultProps;\n}\n\nfunction addDeprecatedPropsToPropPrototype(defaultProps, deprecatedProps) {\n  for (const propName in deprecatedProps) {\n    Object.defineProperty(defaultProps, propName, {\n      enumerable: false,\n\n      set(newValue) {\n        const nameStr = \"\".concat(this.id, \": \").concat(propName);\n\n        for (const newPropName of deprecatedProps[propName]) {\n          if (!hasOwnProperty(this, newPropName)) {\n            this[newPropName] = newValue;\n          }\n        }\n\n        log.deprecated(nameStr, deprecatedProps[propName].join('/'))();\n      }\n\n    });\n  }\n}\n\nfunction addAsyncPropsToPropPrototype(defaultProps, propTypes) {\n  const defaultValues = {};\n  const descriptors = {};\n\n  for (const propName in propTypes) {\n    const propType = propTypes[propName];\n    const {\n      name,\n      value\n    } = propType;\n\n    if (propType.async) {\n      defaultValues[name] = value;\n      descriptors[name] = getDescriptorForAsyncProp(name, value);\n    }\n  }\n\n  defaultProps[ASYNC_DEFAULTS] = defaultValues;\n  defaultProps[ASYNC_ORIGINAL] = {};\n  Object.defineProperties(defaultProps, descriptors);\n}\n\nfunction getDescriptorForAsyncProp(name) {\n  return {\n    enumerable: true,\n\n    set(newValue) {\n      if (typeof newValue === 'string' || newValue instanceof Promise || isAsyncIterable(newValue)) {\n        this[ASYNC_ORIGINAL][name] = newValue;\n      } else {\n        this[ASYNC_RESOLVED][name] = newValue;\n      }\n    },\n\n    get() {\n      if (this[ASYNC_RESOLVED]) {\n        if (name in this[ASYNC_RESOLVED]) {\n          const value = this[ASYNC_RESOLVED][name];\n          return value || this[ASYNC_DEFAULTS][name];\n        }\n\n        if (name in this[ASYNC_ORIGINAL]) {\n          const state = this[COMPONENT] && this[COMPONENT].internalState;\n\n          if (state && state.hasAsyncProp(name)) {\n            return state.getAsyncProp(name) || this[ASYNC_DEFAULTS][name];\n          }\n        }\n      }\n\n      return this[ASYNC_DEFAULTS][name];\n    }\n\n  };\n}\n\nfunction hasOwnProperty(object, prop) {\n  return Object.prototype.hasOwnProperty.call(object, prop);\n}\n\nfunction getOwnProperty(object, prop) {\n  return hasOwnProperty(object, prop) && object[prop];\n}\n\nfunction getComponentName(componentClass) {\n  const componentName = getOwnProperty(componentClass, 'layerName') || getOwnProperty(componentClass, 'componentName');\n\n  if (!componentName) {\n    log.once(0, \"\".concat(componentClass.name, \".componentName not specified\"))();\n  }\n\n  return componentName || componentClass.name;\n}\n//# sourceMappingURL=create-props.js.map","import { isAsyncIterable } from '../utils/iterable-utils';\nimport { PROP_SYMBOLS } from './constants';\nconst {\n  ASYNC_ORIGINAL,\n  ASYNC_RESOLVED,\n  ASYNC_DEFAULTS\n} = PROP_SYMBOLS;\nconst EMPTY_PROPS = Object.freeze({});\nexport default class ComponentState {\n  constructor(component = null) {\n    this.component = component;\n    this.asyncProps = {};\n\n    this.onAsyncPropUpdated = () => {};\n\n    this.oldProps = EMPTY_PROPS;\n    this.oldAsyncProps = null;\n  }\n\n  finalize() {\n    for (const propName in this.asyncProps) {\n      const asyncProp = this.asyncProps[propName];\n\n      if (asyncProp.type && asyncProp.type.release) {\n        asyncProp.type.release(asyncProp.resolvedValue, asyncProp.type, this.component);\n      }\n    }\n  }\n\n  getOldProps() {\n    return this.oldAsyncProps || this.oldProps;\n  }\n\n  resetOldProps() {\n    this.oldAsyncProps = null;\n    this.oldProps = this.component.props;\n  }\n\n  freezeAsyncOldProps() {\n    if (!this.oldAsyncProps) {\n      this.oldProps = this.oldProps || this.component.props;\n      this.oldAsyncProps = Object.create(this.oldProps);\n\n      for (const propName in this.asyncProps) {\n        Object.defineProperty(this.oldAsyncProps, propName, {\n          enumerable: true,\n          value: this.oldProps[propName]\n        });\n      }\n    }\n  }\n\n  hasAsyncProp(propName) {\n    return propName in this.asyncProps;\n  }\n\n  getAsyncProp(propName) {\n    const asyncProp = this.asyncProps[propName];\n    return asyncProp && asyncProp.resolvedValue;\n  }\n\n  isAsyncPropLoading(propName) {\n    if (propName) {\n      const asyncProp = this.asyncProps[propName];\n      return Boolean(asyncProp && asyncProp.pendingLoadCount > 0 && asyncProp.pendingLoadCount !== asyncProp.resolvedLoadCount);\n    }\n\n    for (const key in this.asyncProps) {\n      if (this.isAsyncPropLoading(key)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  reloadAsyncProp(propName, value) {\n    this._watchPromise(propName, Promise.resolve(value));\n  }\n\n  setAsyncProps(props) {\n    const resolvedValues = props[ASYNC_RESOLVED] || {};\n    const originalValues = props[ASYNC_ORIGINAL] || props;\n    const defaultValues = props[ASYNC_DEFAULTS] || {};\n\n    for (const propName in resolvedValues) {\n      const value = resolvedValues[propName];\n\n      this._createAsyncPropData(propName, defaultValues[propName]);\n\n      this._updateAsyncProp(propName, value);\n\n      resolvedValues[propName] = this.getAsyncProp(propName);\n    }\n\n    for (const propName in originalValues) {\n      const value = originalValues[propName];\n\n      this._createAsyncPropData(propName, defaultValues[propName]);\n\n      this._updateAsyncProp(propName, value);\n    }\n  }\n\n  _updateAsyncProp(propName, value) {\n    if (!this._didAsyncInputValueChange(propName, value)) {\n      return;\n    }\n\n    if (typeof value === 'string') {\n      var _this$layer;\n\n      const fetch = (_this$layer = this.layer) === null || _this$layer === void 0 ? void 0 : _this$layer.props.fetch;\n      const url = value;\n\n      if (fetch) {\n        value = fetch(url, {\n          propName,\n          layer: this.layer\n        });\n      }\n    }\n\n    if (value instanceof Promise) {\n      this._watchPromise(propName, value);\n\n      return;\n    }\n\n    if (isAsyncIterable(value)) {\n      this._resolveAsyncIterable(propName, value);\n\n      return;\n    }\n\n    this._setPropValue(propName, value);\n  }\n\n  _didAsyncInputValueChange(propName, value) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (value === asyncProp.resolvedValue || value === asyncProp.lastValue) {\n      return false;\n    }\n\n    asyncProp.lastValue = value;\n    return true;\n  }\n\n  _setPropValue(propName, value) {\n    const asyncProp = this.asyncProps[propName];\n    value = this._postProcessValue(asyncProp, value);\n    asyncProp.resolvedValue = value;\n    asyncProp.pendingLoadCount++;\n    asyncProp.resolvedLoadCount = asyncProp.pendingLoadCount;\n  }\n\n  _setAsyncPropValue(propName, value, loadCount) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (asyncProp && loadCount >= asyncProp.resolvedLoadCount && value !== undefined) {\n      this.freezeAsyncOldProps();\n      asyncProp.resolvedValue = value;\n      asyncProp.resolvedLoadCount = loadCount;\n      this.onAsyncPropUpdated(propName, value);\n    }\n  }\n\n  _watchPromise(propName, promise) {\n    const asyncProp = this.asyncProps[propName];\n    asyncProp.pendingLoadCount++;\n    const loadCount = asyncProp.pendingLoadCount;\n    promise.then(data => {\n      var _this$layer2;\n\n      data = this._postProcessValue(asyncProp, data);\n\n      this._setAsyncPropValue(propName, data, loadCount);\n\n      const onDataLoad = (_this$layer2 = this.layer) === null || _this$layer2 === void 0 ? void 0 : _this$layer2.props.onDataLoad;\n\n      if (propName === 'data' && onDataLoad) {\n        onDataLoad(data, {\n          propName,\n          layer: this.layer\n        });\n      }\n    }).catch(error => {\n      var _this$layer3;\n\n      (_this$layer3 = this.layer) === null || _this$layer3 === void 0 ? void 0 : _this$layer3.raiseError(error, \"loading \".concat(propName, \" of \").concat(this.layer));\n    });\n  }\n\n  async _resolveAsyncIterable(propName, iterable) {\n    var _this$layer4;\n\n    if (propName !== 'data') {\n      this._setPropValue(propName, iterable);\n    }\n\n    const asyncProp = this.asyncProps[propName];\n    asyncProp.pendingLoadCount++;\n    const loadCount = asyncProp.pendingLoadCount;\n    let data = [];\n    let count = 0;\n\n    for await (const chunk of iterable) {\n      const {\n        dataTransform\n      } = this.component ? this.component.props : {};\n\n      if (dataTransform) {\n        data = dataTransform(chunk, data);\n      } else {\n        data = data.concat(chunk);\n      }\n\n      Object.defineProperty(data, '__diff', {\n        enumerable: false,\n        value: [{\n          startRow: count,\n          endRow: data.length\n        }]\n      });\n      count = data.length;\n\n      this._setAsyncPropValue(propName, data, loadCount);\n    }\n\n    const onDataLoad = (_this$layer4 = this.layer) === null || _this$layer4 === void 0 ? void 0 : _this$layer4.props.onDataLoad;\n\n    if (onDataLoad) {\n      onDataLoad(data, {\n        propName,\n        layer: this.layer\n      });\n    }\n  }\n\n  _postProcessValue(asyncProp, value) {\n    const propType = asyncProp.type;\n\n    if (propType) {\n      if (propType.release) {\n        propType.release(asyncProp.resolvedValue, propType, this.component);\n      }\n\n      if (propType.transform) {\n        return propType.transform(value, propType, this.component);\n      }\n    }\n\n    return value;\n  }\n\n  _createAsyncPropData(propName, defaultValue) {\n    const asyncProp = this.asyncProps[propName];\n\n    if (!asyncProp) {\n      const propTypes = this.component && this.component.constructor._propTypes;\n      this.asyncProps[propName] = {\n        type: propTypes && propTypes[propName],\n        lastValue: null,\n        resolvedValue: defaultValue,\n        pendingLoadCount: 0,\n        resolvedLoadCount: 0\n      };\n    }\n  }\n\n}\n//# sourceMappingURL=component-state.js.map","import { LIFECYCLE } from '../lifecycle/constants';\nimport { createProps } from './create-props';\nimport { PROP_SYMBOLS } from './constants';\nconst {\n  ASYNC_ORIGINAL,\n  ASYNC_RESOLVED,\n  ASYNC_DEFAULTS\n} = PROP_SYMBOLS;\nimport ComponentState from './component-state';\nconst defaultProps = {};\nlet counter = 0;\nexport default class Component {\n  constructor() {\n    this.props = createProps.apply(this, arguments);\n    this.id = this.props.id;\n    this.count = counter++;\n    this.lifecycle = LIFECYCLE.NO_STATE;\n    this.parent = null;\n    this.context = null;\n    this.state = null;\n    this.internalState = null;\n    Object.seal(this);\n  }\n\n  clone(newProps) {\n    const {\n      props\n    } = this;\n    const asyncProps = {};\n\n    for (const key in props[ASYNC_DEFAULTS]) {\n      if (key in props[ASYNC_RESOLVED]) {\n        asyncProps[key] = props[ASYNC_RESOLVED][key];\n      } else if (key in props[ASYNC_ORIGINAL]) {\n        asyncProps[key] = props[ASYNC_ORIGINAL][key];\n      }\n    }\n\n    return new this.constructor({ ...props,\n      ...asyncProps,\n      ...newProps\n    });\n  }\n\n  get stats() {\n    return this.internalState.stats;\n  }\n\n  _initState() {\n    this.internalState = new ComponentState({});\n  }\n\n}\nComponent.componentName = 'Component';\nComponent.defaultProps = defaultProps;\n//# sourceMappingURL=component.js.map","import ComponentState from '../lifecycle/component-state';\nexport default class LayerState extends ComponentState {\n  constructor({\n    attributeManager,\n    layer\n  }) {\n    super(layer);\n    this.attributeManager = attributeManager;\n    this.model = null;\n    this.needsRedraw = true;\n    this.subLayers = null;\n    this.usesPickingColorCache = false;\n  }\n\n  get layer() {\n    return this.component;\n  }\n\n  set layer(layer) {\n    this.component = layer;\n  }\n\n}\n//# sourceMappingURL=layer-state.js.map","import { COORDINATE_SYSTEM } from './constants';\nimport AttributeManager from './attribute/attribute-manager';\nimport UniformTransitionManager from './uniform-transition-manager';\nimport { diffProps, validateProps } from '../lifecycle/props';\nimport { count } from '../utils/count';\nimport log from '../utils/log';\nimport debug from '../debug';\nimport { withParameters, setParameters } from '@luma.gl/core';\nimport assert from '../utils/assert';\nimport memoize from '../utils/memoize';\nimport { mergeShaders } from '../utils/shader';\nimport { projectPosition, getWorldPosition } from '../shaderlib/project/project-functions';\nimport typedArrayManager from '../utils/typed-array-manager';\nimport Component from '../lifecycle/component';\nimport LayerState from './layer-state';\nimport { worldToPixels } from '@math.gl/web-mercator';\nimport { load } from '@loaders.gl/core';\nconst TRACE_CHANGE_FLAG = 'layer.changeFlag';\nconst TRACE_INITIALIZE = 'layer.initialize';\nconst TRACE_UPDATE = 'layer.update';\nconst TRACE_FINALIZE = 'layer.finalize';\nconst TRACE_MATCHED = 'layer.matched';\nconst MAX_PICKING_COLOR_CACHE_SIZE = 2 ** 24 - 1;\nconst EMPTY_ARRAY = Object.freeze([]);\nconst areViewportsEqual = memoize(({\n  oldViewport,\n  viewport\n}) => {\n  return oldViewport.equals(viewport);\n});\nlet pickingColorCache = new Uint8ClampedArray(0);\nconst defaultProps = {\n  data: {\n    type: 'data',\n    value: EMPTY_ARRAY,\n    async: true\n  },\n  dataComparator: null,\n  _dataDiff: {\n    type: 'function',\n    value: data => data && data.__diff,\n    compare: false,\n    optional: true\n  },\n  dataTransform: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDataLoad: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onError: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  fetch: {\n    type: 'function',\n    value: (url, {\n      propName,\n      layer,\n      loaders,\n      loadOptions,\n      signal\n    }) => {\n      const {\n        resourceManager\n      } = layer.context;\n      loadOptions = loadOptions || layer.getLoadOptions();\n      loaders = loaders || layer.props.loaders;\n\n      if (signal) {\n        var _loadOptions;\n\n        loadOptions = { ...loadOptions,\n          fetch: { ...((_loadOptions = loadOptions) === null || _loadOptions === void 0 ? void 0 : _loadOptions.fetch),\n            signal\n          }\n        };\n      }\n\n      let inResourceManager = resourceManager.contains(url);\n\n      if (!inResourceManager && !loadOptions) {\n        resourceManager.add({\n          resourceId: url,\n          data: load(url, loaders),\n          persistent: false\n        });\n        inResourceManager = true;\n      }\n\n      if (inResourceManager) {\n        return resourceManager.subscribe({\n          resourceId: url,\n          onChange: data => layer.internalState.reloadAsyncProp(propName, data),\n          consumerId: layer.id,\n          requestId: propName\n        });\n      }\n\n      return load(url, loaders, loadOptions);\n    },\n    compare: false\n  },\n  updateTriggers: {},\n  visible: true,\n  pickable: false,\n  opacity: {\n    type: 'number',\n    min: 0,\n    max: 1,\n    value: 1\n  },\n  onHover: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onClick: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDragStart: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDrag: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  onDragEnd: {\n    type: 'function',\n    value: null,\n    compare: false,\n    optional: true\n  },\n  coordinateSystem: COORDINATE_SYSTEM.DEFAULT,\n  coordinateOrigin: {\n    type: 'array',\n    value: [0, 0, 0],\n    compare: true\n  },\n  modelMatrix: {\n    type: 'array',\n    value: null,\n    compare: true,\n    optional: true\n  },\n  wrapLongitude: false,\n  positionFormat: 'XYZ',\n  colorFormat: 'RGBA',\n  parameters: {},\n  transitions: null,\n  extensions: [],\n  loaders: {\n    type: 'array',\n    value: [],\n    optional: true,\n    compare: true\n  },\n  getPolygonOffset: {\n    type: 'function',\n    value: ({\n      layerIndex\n    }) => [0, -layerIndex * 100],\n    compare: false\n  },\n  highlightedObjectIndex: -1,\n  autoHighlight: false,\n  highlightColor: {\n    type: 'accessor',\n    value: [0, 0, 128, 128]\n  }\n};\nexport default class Layer extends Component {\n  toString() {\n    const className = this.constructor.layerName || this.constructor.name;\n    return \"\".concat(className, \"({id: '\").concat(this.props.id, \"'})\");\n  }\n\n  raiseError(error, message) {\n    var _this$props$onError, _this$props;\n\n    if (message) {\n      error.message = \"\".concat(message, \": \").concat(error.message);\n    }\n\n    if (!((_this$props$onError = (_this$props = this.props).onError) === null || _this$props$onError === void 0 ? void 0 : _this$props$onError.call(_this$props, error))) {\n      var _this$context, _this$context$onError;\n\n      (_this$context = this.context) === null || _this$context === void 0 ? void 0 : (_this$context$onError = _this$context.onError) === null || _this$context$onError === void 0 ? void 0 : _this$context$onError.call(_this$context, error, this);\n    }\n  }\n\n  setState(updateObject) {\n    this.setChangeFlags({\n      stateChanged: true\n    });\n    Object.assign(this.state, updateObject);\n    this.setNeedsRedraw();\n  }\n\n  setNeedsRedraw(redraw = true) {\n    if (this.internalState) {\n      this.internalState.needsRedraw = redraw;\n    }\n  }\n\n  setNeedsUpdate() {\n    this.context.layerManager.setNeedsUpdate(String(this));\n    this.internalState.needsUpdate = true;\n  }\n\n  getNeedsRedraw(opts = {\n    clearRedrawFlags: false\n  }) {\n    return this._getNeedsRedraw(opts);\n  }\n\n  needsUpdate() {\n    return this.internalState.needsUpdate || this.hasUniformTransition() || this.shouldUpdateState(this._getUpdateParams());\n  }\n\n  hasUniformTransition() {\n    return this.internalState.uniformTransitions.active;\n  }\n\n  get isLoaded() {\n    return this.internalState && !this.internalState.isAsyncPropLoading();\n  }\n\n  get wrapLongitude() {\n    return this.props.wrapLongitude;\n  }\n\n  isPickable() {\n    return this.props.pickable && this.props.visible;\n  }\n\n  getModels() {\n    return this.state && (this.state.models || (this.state.model ? [this.state.model] : []));\n  }\n\n  getAttributeManager() {\n    return this.internalState && this.internalState.attributeManager;\n  }\n\n  getCurrentLayer() {\n    return this.internalState && this.internalState.layer;\n  }\n\n  getLoadOptions() {\n    return this.props.loadOptions;\n  }\n\n  project(xyz) {\n    const {\n      viewport\n    } = this.context;\n    const worldPosition = getWorldPosition(xyz, {\n      viewport,\n      modelMatrix: this.props.modelMatrix,\n      coordinateOrigin: this.props.coordinateOrigin,\n      coordinateSystem: this.props.coordinateSystem\n    });\n    const [x, y, z] = worldToPixels(worldPosition, viewport.pixelProjectionMatrix);\n    return xyz.length === 2 ? [x, y] : [x, y, z];\n  }\n\n  unproject(xy) {\n    const {\n      viewport\n    } = this.context;\n    return viewport.unproject(xy);\n  }\n\n  projectPosition(xyz) {\n    return projectPosition(xyz, {\n      viewport: this.context.viewport,\n      modelMatrix: this.props.modelMatrix,\n      coordinateOrigin: this.props.coordinateOrigin,\n      coordinateSystem: this.props.coordinateSystem\n    });\n  }\n\n  use64bitPositions() {\n    const {\n      coordinateSystem\n    } = this.props;\n    return coordinateSystem === COORDINATE_SYSTEM.DEFAULT || coordinateSystem === COORDINATE_SYSTEM.LNGLAT || coordinateSystem === COORDINATE_SYSTEM.CARTESIAN;\n  }\n\n  onHover(info, pickingEvent) {\n    if (this.props.onHover) {\n      return this.props.onHover(info, pickingEvent);\n    }\n\n    return false;\n  }\n\n  onClick(info, pickingEvent) {\n    if (this.props.onClick) {\n      return this.props.onClick(info, pickingEvent);\n    }\n\n    return false;\n  }\n\n  nullPickingColor() {\n    return [0, 0, 0];\n  }\n\n  encodePickingColor(i, target = []) {\n    target[0] = i + 1 & 255;\n    target[1] = i + 1 >> 8 & 255;\n    target[2] = i + 1 >> 8 >> 8 & 255;\n    return target;\n  }\n\n  decodePickingColor(color) {\n    assert(color instanceof Uint8Array);\n    const [i1, i2, i3] = color;\n    const index = i1 + i2 * 256 + i3 * 65536 - 1;\n    return index;\n  }\n\n  initializeState() {\n    throw new Error(\"Layer \".concat(this, \" has not defined initializeState\"));\n  }\n\n  getShaders(shaders) {\n    for (const extension of this.props.extensions) {\n      shaders = mergeShaders(shaders, extension.getShaders.call(this, extension));\n    }\n\n    return shaders;\n  }\n\n  shouldUpdateState({\n    oldProps,\n    props,\n    context,\n    changeFlags\n  }) {\n    return changeFlags.propsOrDataChanged;\n  }\n\n  updateState({\n    oldProps,\n    props,\n    context,\n    changeFlags\n  }) {\n    const attributeManager = this.getAttributeManager();\n\n    if (changeFlags.dataChanged && attributeManager) {\n      const {\n        dataChanged\n      } = changeFlags;\n\n      if (Array.isArray(dataChanged)) {\n        for (const dataRange of dataChanged) {\n          attributeManager.invalidateAll(dataRange);\n        }\n      } else {\n        attributeManager.invalidateAll();\n      }\n    }\n\n    const neededPickingBuffer = oldProps.highlightedObjectIndex >= 0 || oldProps.pickable;\n    const needPickingBuffer = props.highlightedObjectIndex >= 0 || props.pickable;\n\n    if (neededPickingBuffer !== needPickingBuffer && attributeManager) {\n      const {\n        pickingColors,\n        instancePickingColors\n      } = attributeManager.attributes;\n      const pickingColorsAttribute = pickingColors || instancePickingColors;\n\n      if (pickingColorsAttribute) {\n        if (needPickingBuffer && pickingColorsAttribute.constant) {\n          pickingColorsAttribute.constant = false;\n          attributeManager.invalidate(pickingColorsAttribute.id);\n        }\n\n        if (!pickingColorsAttribute.value && !needPickingBuffer) {\n          pickingColorsAttribute.constant = true;\n          pickingColorsAttribute.value = [0, 0, 0];\n        }\n      }\n    }\n  }\n\n  finalizeState() {\n    for (const model of this.getModels()) {\n      model.delete();\n    }\n\n    const attributeManager = this.getAttributeManager();\n\n    if (attributeManager) {\n      attributeManager.finalize();\n    }\n\n    this.context.resourceManager.unsubscribe({\n      consumerId: this.id\n    });\n    this.internalState.uniformTransitions.clear();\n    this.internalState.finalize();\n  }\n\n  draw(opts) {\n    for (const model of this.getModels()) {\n      model.draw(opts);\n    }\n  }\n\n  getPickingInfo({\n    info,\n    mode\n  }) {\n    const {\n      index\n    } = info;\n\n    if (index >= 0) {\n      if (Array.isArray(this.props.data)) {\n        info.object = this.props.data[index];\n      }\n    }\n\n    return info;\n  }\n\n  activateViewport(viewport) {\n    const oldViewport = this.internalState.viewport;\n    this.internalState.viewport = viewport;\n\n    if (!oldViewport || !areViewportsEqual({\n      oldViewport,\n      viewport\n    })) {\n      this.setChangeFlags({\n        viewportChanged: true\n      });\n\n      if (this.isComposite) {\n        if (this.needsUpdate()) {\n          this.setNeedsUpdate();\n        }\n      } else {\n        this._update();\n      }\n    }\n  }\n\n  invalidateAttribute(name = 'all', diffReason = '') {\n    const attributeManager = this.getAttributeManager();\n\n    if (!attributeManager) {\n      return;\n    }\n\n    if (name === 'all') {\n      attributeManager.invalidateAll();\n    } else {\n      attributeManager.invalidate(name);\n    }\n  }\n\n  updateAttributes(changedAttributes) {\n    for (const model of this.getModels()) {\n      this._setModelAttributes(model, changedAttributes);\n    }\n  }\n\n  _updateAttributes(props) {\n    const attributeManager = this.getAttributeManager();\n\n    if (!attributeManager) {\n      return;\n    }\n\n    const numInstances = this.getNumInstances(props);\n    const startIndices = this.getStartIndices(props);\n    attributeManager.update({\n      data: props.data,\n      numInstances,\n      startIndices,\n      props,\n      transitions: props.transitions,\n      buffers: props.data.attributes,\n      context: this,\n      ignoreUnknownAttributes: true\n    });\n    const changedAttributes = attributeManager.getChangedAttributes({\n      clearChangedFlags: true\n    });\n    this.updateAttributes(changedAttributes);\n  }\n\n  _updateAttributeTransition() {\n    const attributeManager = this.getAttributeManager();\n\n    if (attributeManager) {\n      attributeManager.updateTransition();\n    }\n  }\n\n  _updateUniformTransition() {\n    const {\n      uniformTransitions\n    } = this.internalState;\n\n    if (uniformTransitions.active) {\n      const propsInTransition = uniformTransitions.update();\n      const props = Object.create(this.props);\n\n      for (const key in propsInTransition) {\n        Object.defineProperty(props, key, {\n          value: propsInTransition[key]\n        });\n      }\n\n      return props;\n    }\n\n    return this.props;\n  }\n\n  calculateInstancePickingColors(attribute, {\n    numInstances\n  }) {\n    if (attribute.constant) {\n      return;\n    }\n\n    const cacheSize = Math.floor(pickingColorCache.length / 3);\n    this.internalState.usesPickingColorCache = true;\n\n    if (cacheSize < numInstances) {\n      if (numInstances > MAX_PICKING_COLOR_CACHE_SIZE) {\n        log.warn('Layer has too many data objects. Picking might not be able to distinguish all objects.')();\n      }\n\n      pickingColorCache = typedArrayManager.allocate(pickingColorCache, numInstances, {\n        size: 3,\n        copy: true,\n        maxCount: Math.max(numInstances, MAX_PICKING_COLOR_CACHE_SIZE)\n      });\n      const newCacheSize = Math.floor(pickingColorCache.length / 3);\n      const pickingColor = [];\n\n      for (let i = cacheSize; i < newCacheSize; i++) {\n        this.encodePickingColor(i, pickingColor);\n        pickingColorCache[i * 3 + 0] = pickingColor[0];\n        pickingColorCache[i * 3 + 1] = pickingColor[1];\n        pickingColorCache[i * 3 + 2] = pickingColor[2];\n      }\n    }\n\n    attribute.value = pickingColorCache.subarray(0, numInstances * 3);\n  }\n\n  _setModelAttributes(model, changedAttributes) {\n    const attributeManager = this.getAttributeManager();\n    const excludeAttributes = model.userData.excludeAttributes || {};\n    const shaderAttributes = attributeManager.getShaderAttributes(changedAttributes, excludeAttributes);\n    model.setAttributes(shaderAttributes);\n  }\n\n  disablePickingIndex(objectIndex) {\n    this._disablePickingIndex(objectIndex);\n  }\n\n  _disablePickingIndex(objectIndex) {\n    const {\n      pickingColors,\n      instancePickingColors\n    } = this.getAttributeManager().attributes;\n    const colors = pickingColors || instancePickingColors;\n    const start = colors.getVertexOffset(objectIndex);\n    const end = colors.getVertexOffset(objectIndex + 1);\n    colors.buffer.subData({\n      data: new Uint8Array(end - start),\n      offset: start\n    });\n  }\n\n  restorePickingColors() {\n    const {\n      pickingColors,\n      instancePickingColors\n    } = this.getAttributeManager().attributes;\n    const colors = pickingColors || instancePickingColors;\n\n    if (this.internalState.usesPickingColorCache && colors.value.buffer !== pickingColorCache.buffer) {\n      colors.value = pickingColorCache.subarray(0, colors.value.length);\n    }\n\n    colors.updateSubBuffer({\n      startOffset: 0\n    });\n  }\n\n  getNumInstances(props) {\n    props = props || this.props;\n\n    if (props.numInstances !== undefined) {\n      return props.numInstances;\n    }\n\n    if (this.state && this.state.numInstances !== undefined) {\n      return this.state.numInstances;\n    }\n\n    return count(props.data);\n  }\n\n  getStartIndices(props) {\n    props = props || this.props;\n\n    if (props.startIndices !== undefined) {\n      return props.startIndices;\n    }\n\n    if (this.state && this.state.startIndices) {\n      return this.state.startIndices;\n    }\n\n    return null;\n  }\n\n  _initialize() {\n    debug(TRACE_INITIALIZE, this);\n\n    this._initState();\n\n    this.initializeState(this.context);\n\n    for (const extension of this.props.extensions) {\n      extension.initializeState.call(this, this.context, extension);\n    }\n\n    this.setChangeFlags({\n      dataChanged: true,\n      propsChanged: true,\n      viewportChanged: true,\n      extensionsChanged: true\n    });\n\n    this._updateState();\n  }\n\n  _update() {\n    const stateNeedsUpdate = this.needsUpdate();\n    debug(TRACE_UPDATE, this, stateNeedsUpdate);\n\n    if (stateNeedsUpdate) {\n      this._updateState();\n    }\n  }\n\n  _updateState() {\n    const currentProps = this.props;\n    const currentViewport = this.context.viewport;\n\n    const propsInTransition = this._updateUniformTransition();\n\n    this.internalState.propsInTransition = propsInTransition;\n    this.context.viewport = this.internalState.viewport || currentViewport;\n    this.props = propsInTransition;\n\n    try {\n      const updateParams = this._getUpdateParams();\n\n      const oldModels = this.getModels();\n\n      if (this.context.gl) {\n        this.updateState(updateParams);\n      } else {\n        try {\n          this.updateState(updateParams);\n        } catch (error) {}\n      }\n\n      for (const extension of this.props.extensions) {\n        extension.updateState.call(this, updateParams, extension);\n      }\n\n      const modelChanged = this.getModels()[0] !== oldModels[0];\n\n      this._updateModules(updateParams, modelChanged);\n\n      if (this.isComposite) {\n        this._renderLayers(updateParams);\n      } else {\n        this.setNeedsRedraw();\n\n        this._updateAttributes(this.props);\n\n        if (this.state.model) {\n          this.state.model.setInstanceCount(this.getNumInstances());\n        }\n      }\n    } finally {\n      this.context.viewport = currentViewport;\n      this.props = currentProps;\n      this.clearChangeFlags();\n      this.internalState.needsUpdate = false;\n      this.internalState.resetOldProps();\n    }\n  }\n\n  _finalize() {\n    debug(TRACE_FINALIZE, this);\n    this.finalizeState(this.context);\n\n    for (const extension of this.props.extensions) {\n      extension.finalizeState.call(this, extension);\n    }\n  }\n\n  drawLayer({\n    moduleParameters = null,\n    uniforms = {},\n    parameters = {}\n  }) {\n    this._updateAttributeTransition();\n\n    const currentProps = this.props;\n    this.props = this.internalState.propsInTransition || currentProps;\n    const {\n      opacity\n    } = this.props;\n    uniforms.opacity = Math.pow(opacity, 1 / 2.2);\n\n    try {\n      if (moduleParameters) {\n        this.setModuleParameters(moduleParameters);\n      }\n\n      const {\n        getPolygonOffset\n      } = this.props;\n      const offsets = getPolygonOffset && getPolygonOffset(uniforms) || [0, 0];\n      setParameters(this.context.gl, {\n        polygonOffset: offsets\n      });\n      withParameters(this.context.gl, parameters, () => {\n        const opts = {\n          moduleParameters,\n          uniforms,\n          parameters,\n          context: this.context\n        };\n\n        for (const extension of this.props.extensions) {\n          extension.draw.call(this, opts, extension);\n        }\n\n        this.draw(opts);\n      });\n    } finally {\n      this.props = currentProps;\n    }\n  }\n\n  getChangeFlags() {\n    return this.internalState.changeFlags;\n  }\n\n  setChangeFlags(flags) {\n    const {\n      changeFlags\n    } = this.internalState;\n\n    for (const key in flags) {\n      if (flags[key]) {\n        let flagChanged = false;\n\n        switch (key) {\n          case 'dataChanged':\n            if (Array.isArray(changeFlags[key])) {\n              changeFlags[key] = Array.isArray(flags[key]) ? changeFlags[key].concat(flags[key]) : flags[key];\n              flagChanged = true;\n            }\n\n          default:\n            if (!changeFlags[key]) {\n              changeFlags[key] = flags[key];\n              flagChanged = true;\n            }\n\n        }\n\n        if (flagChanged) {\n          debug(TRACE_CHANGE_FLAG, this, key, flags);\n        }\n      }\n    }\n\n    const propsOrDataChanged = changeFlags.dataChanged || changeFlags.updateTriggersChanged || changeFlags.propsChanged || changeFlags.extensionsChanged;\n    changeFlags.propsOrDataChanged = propsOrDataChanged;\n    changeFlags.somethingChanged = propsOrDataChanged || flags.viewportChanged || flags.stateChanged;\n  }\n\n  clearChangeFlags() {\n    this.internalState.changeFlags = {\n      dataChanged: false,\n      propsChanged: false,\n      updateTriggersChanged: false,\n      viewportChanged: false,\n      stateChanged: false,\n      extensionsChanged: false,\n      propsOrDataChanged: false,\n      somethingChanged: false\n    };\n  }\n\n  diffProps(newProps, oldProps) {\n    const changeFlags = diffProps(newProps, oldProps);\n\n    if (changeFlags.updateTriggersChanged) {\n      for (const key in changeFlags.updateTriggersChanged) {\n        if (changeFlags.updateTriggersChanged[key]) {\n          this.invalidateAttribute(key);\n        }\n      }\n    }\n\n    if (changeFlags.transitionsChanged) {\n      for (const key in changeFlags.transitionsChanged) {\n        this.internalState.uniformTransitions.add(key, oldProps[key], newProps[key], newProps.transitions[key]);\n      }\n    }\n\n    return this.setChangeFlags(changeFlags);\n  }\n\n  validateProps() {\n    validateProps(this.props);\n  }\n\n  setModuleParameters(moduleParameters) {\n    for (const model of this.getModels()) {\n      model.updateModuleSettings(moduleParameters);\n    }\n  }\n\n  updateAutoHighlight(info) {\n    if (this.props.autoHighlight) {\n      this._updateAutoHighlight(info);\n    }\n  }\n\n  _updateAutoHighlight(info) {\n    const pickingModuleParameters = {\n      pickingSelectedColor: info.picked ? info.color : null\n    };\n    const {\n      highlightColor\n    } = this.props;\n\n    if (info.picked && typeof highlightColor === 'function') {\n      pickingModuleParameters.pickingHighlightColor = highlightColor(info);\n    }\n\n    this.setModuleParameters(pickingModuleParameters);\n    this.setNeedsRedraw();\n  }\n\n  _updateModules({\n    props,\n    oldProps\n  }, forceUpdate) {\n    const {\n      autoHighlight,\n      highlightedObjectIndex,\n      highlightColor\n    } = props;\n\n    if (forceUpdate || oldProps.autoHighlight !== autoHighlight || oldProps.highlightedObjectIndex !== highlightedObjectIndex || oldProps.highlightColor !== highlightColor) {\n      const parameters = {};\n\n      if (!autoHighlight) {\n        parameters.pickingSelectedColor = null;\n      }\n\n      if (Array.isArray(highlightColor)) {\n        parameters.pickingHighlightColor = highlightColor;\n      }\n\n      if (Number.isInteger(highlightedObjectIndex)) {\n        parameters.pickingSelectedColor = highlightedObjectIndex >= 0 ? this.encodePickingColor(highlightedObjectIndex) : null;\n      }\n\n      this.setModuleParameters(parameters);\n    }\n  }\n\n  _getUpdateParams() {\n    return {\n      props: this.props,\n      oldProps: this.internalState.getOldProps(),\n      context: this.context,\n      changeFlags: this.internalState.changeFlags\n    };\n  }\n\n  _getNeedsRedraw(opts) {\n    if (!this.internalState) {\n      return false;\n    }\n\n    let redraw = false;\n    redraw = redraw || this.internalState.needsRedraw && this.id;\n    this.internalState.needsRedraw = this.internalState.needsRedraw && !opts.clearRedrawFlags;\n    const attributeManager = this.getAttributeManager();\n    const attributeManagerNeedsRedraw = attributeManager && attributeManager.getNeedsRedraw(opts);\n    redraw = redraw || attributeManagerNeedsRedraw;\n    return redraw;\n  }\n\n  _getAttributeManager() {\n    return new AttributeManager(this.context.gl, {\n      id: this.props.id,\n      stats: this.context.stats,\n      timeline: this.context.timeline\n    });\n  }\n\n  _initState() {\n    assert(!this.internalState && !this.state);\n    assert(isFinite(this.props.coordinateSystem));\n\n    const attributeManager = this._getAttributeManager();\n\n    if (attributeManager) {\n      attributeManager.addInstanced({\n        instancePickingColors: {\n          type: 5121,\n          size: 3,\n          noAlloc: true,\n          update: this.calculateInstancePickingColors\n        }\n      });\n    }\n\n    this.internalState = new LayerState({\n      attributeManager,\n      layer: this\n    });\n    this.clearChangeFlags();\n    this.state = {};\n    Object.defineProperty(this.state, 'attributeManager', {\n      get: () => {\n        log.deprecated('layer.state.attributeManager', 'layer.getAttributeManager()');\n        return attributeManager;\n      }\n    });\n    this.internalState.layer = this;\n    this.internalState.uniformTransitions = new UniformTransitionManager(this.context.timeline);\n    this.internalState.onAsyncPropUpdated = this._onAsyncPropUpdated.bind(this);\n    this.internalState.setAsyncProps(this.props);\n  }\n\n  _transferState(oldLayer) {\n    debug(TRACE_MATCHED, this, this === oldLayer);\n    const {\n      state,\n      internalState\n    } = oldLayer;\n\n    if (this === oldLayer) {\n      return;\n    }\n\n    this.internalState = internalState;\n    this.internalState.layer = this;\n    this.state = state;\n    this.internalState.setAsyncProps(this.props);\n    this.diffProps(this.props, this.internalState.getOldProps());\n  }\n\n  _onAsyncPropUpdated() {\n    this.diffProps(this.props, this.internalState.getOldProps());\n    this.setNeedsUpdate();\n  }\n\n}\nLayer.layerName = 'Layer';\nLayer.defaultProps = defaultProps;\n//# sourceMappingURL=layer.js.map","import { clamp } from 'math.gl';\nimport Controller from './controller';\nimport ViewState from './view-state';\nimport { mod } from '../utils/math-utils';\nconst DEFAULT_STATE = {\n  rotationX: 0,\n  rotationOrbit: 0,\n  zoom: 0,\n  target: [0, 0, 0],\n  minRotationX: -90,\n  maxRotationX: 90,\n  minZoom: -Infinity,\n  maxZoom: Infinity\n};\nexport class OrbitState extends ViewState {\n  constructor({\n    makeViewport,\n    width,\n    height,\n    rotationX = DEFAULT_STATE.rotationX,\n    rotationOrbit = DEFAULT_STATE.rotationOrbit,\n    target = DEFAULT_STATE.target,\n    zoom = DEFAULT_STATE.zoom,\n    minRotationX = DEFAULT_STATE.minRotationX,\n    maxRotationX = DEFAULT_STATE.maxRotationX,\n    minZoom = DEFAULT_STATE.minZoom,\n    maxZoom = DEFAULT_STATE.maxZoom,\n    startPanPosition,\n    startRotatePos,\n    startRotationX,\n    startRotationOrbit,\n    startZoomPosition,\n    startZoom\n  }) {\n    super({\n      width,\n      height,\n      rotationX,\n      rotationOrbit,\n      target,\n      zoom,\n      minRotationX,\n      maxRotationX,\n      minZoom,\n      maxZoom\n    });\n    this._state = {\n      startPanPosition,\n      startRotatePos,\n      startRotationX,\n      startRotationOrbit,\n      startZoomPosition,\n      startZoom\n    };\n    this.makeViewport = makeViewport;\n  }\n\n  panStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startPanPosition: this._unproject(pos)\n    });\n  }\n\n  pan({\n    pos,\n    startPosition\n  }) {\n    const startPanPosition = this._state.startPanPosition || startPosition;\n\n    if (!startPanPosition) {\n      return this;\n    }\n\n    const viewport = this.makeViewport(this._viewportProps);\n    const newProps = viewport.panByPosition(startPanPosition, pos);\n    return this._getUpdatedState(newProps);\n  }\n\n  panEnd() {\n    return this._getUpdatedState({\n      startPanPosition: null\n    });\n  }\n\n  rotateStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startRotatePos: pos,\n      startRotationX: this._viewportProps.rotationX,\n      startRotationOrbit: this._viewportProps.rotationOrbit\n    });\n  }\n\n  rotate({\n    pos,\n    deltaAngleX = 0,\n    deltaAngleY = 0\n  }) {\n    const {\n      startRotatePos,\n      startRotationX,\n      startRotationOrbit\n    } = this._state;\n    const {\n      width,\n      height\n    } = this._viewportProps;\n\n    if (!startRotatePos || !Number.isFinite(startRotationX) || !Number.isFinite(startRotationOrbit)) {\n      return this;\n    }\n\n    let newRotation;\n\n    if (pos) {\n      let deltaScaleX = (pos[0] - startRotatePos[0]) / width;\n      const deltaScaleY = (pos[1] - startRotatePos[1]) / height;\n\n      if (startRotationX < -90 || startRotationX > 90) {\n        deltaScaleX *= -1;\n      }\n\n      newRotation = {\n        rotationX: startRotationX + deltaScaleY * 180,\n        rotationOrbit: startRotationOrbit + deltaScaleX * 180\n      };\n    } else {\n      newRotation = {\n        rotationX: startRotationX + deltaAngleY,\n        rotationOrbit: startRotationOrbit + deltaAngleX\n      };\n    }\n\n    return this._getUpdatedState(newRotation);\n  }\n\n  rotateEnd() {\n    return this._getUpdatedState({\n      startRotationX: null,\n      startRotationOrbit: null\n    });\n  }\n\n  shortestPathFrom(viewState) {\n    const fromProps = viewState.getViewportProps();\n    const props = { ...this._viewportProps\n    };\n    const {\n      rotationOrbit\n    } = props;\n\n    if (Math.abs(rotationOrbit - fromProps.rotationOrbit) > 180) {\n      props.rotationOrbit = rotationOrbit < 0 ? rotationOrbit + 360 : rotationOrbit - 360;\n    }\n\n    return props;\n  }\n\n  zoomStart({\n    pos\n  }) {\n    return this._getUpdatedState({\n      startZoomPosition: this._unproject(pos),\n      startZoom: this._viewportProps.zoom\n    });\n  }\n\n  zoom({\n    pos,\n    startPos,\n    scale\n  }) {\n    const {\n      zoom\n    } = this._viewportProps;\n    let {\n      startZoom,\n      startZoomPosition\n    } = this._state;\n\n    if (!Number.isFinite(startZoom)) {\n      startZoom = zoom;\n      startZoomPosition = this._unproject(startPos) || this._unproject(pos);\n    }\n\n    const newZoom = this._calculateNewZoom({\n      scale,\n      startZoom\n    });\n\n    const zoomedViewport = this.makeViewport({ ...this._viewportProps,\n      zoom: newZoom\n    });\n    return this._getUpdatedState({\n      zoom: newZoom,\n      ...zoomedViewport.panByPosition(startZoomPosition, pos)\n    });\n  }\n\n  zoomEnd() {\n    return this._getUpdatedState({\n      startZoomPosition: null,\n      startZoom: null\n    });\n  }\n\n  zoomIn(speed = 2) {\n    return this._getUpdatedState({\n      zoom: this._calculateNewZoom({\n        scale: speed\n      })\n    });\n  }\n\n  zoomOut(speed = 2) {\n    return this._getUpdatedState({\n      zoom: this._calculateNewZoom({\n        scale: 1 / speed\n      })\n    });\n  }\n\n  moveLeft(speed = 50) {\n    return this._panFromCenter([-speed, 0]);\n  }\n\n  moveRight(speed = 50) {\n    return this._panFromCenter([speed, 0]);\n  }\n\n  moveUp(speed = 50) {\n    return this._panFromCenter([0, -speed]);\n  }\n\n  moveDown(speed = 50) {\n    return this._panFromCenter([0, speed]);\n  }\n\n  rotateLeft(speed = 15) {\n    return this._getUpdatedState({\n      rotationOrbit: this._viewportProps.rotationOrbit - speed\n    });\n  }\n\n  rotateRight(speed = 15) {\n    return this._getUpdatedState({\n      rotationOrbit: this._viewportProps.rotationOrbit + speed\n    });\n  }\n\n  rotateUp(speed = 10) {\n    return this._getUpdatedState({\n      rotationX: this._viewportProps.rotationX - speed\n    });\n  }\n\n  rotateDown(speed = 10) {\n    return this._getUpdatedState({\n      rotationX: this._viewportProps.rotationX + speed\n    });\n  }\n\n  _unproject(pos) {\n    const viewport = this.makeViewport(this._viewportProps);\n    return pos && viewport.unproject(pos);\n  }\n\n  _calculateNewZoom({\n    scale,\n    startZoom\n  }) {\n    const {\n      maxZoom,\n      minZoom\n    } = this._viewportProps;\n\n    if (!Number.isFinite(startZoom)) {\n      startZoom = this._viewportProps.zoom;\n    }\n\n    const zoom = startZoom + Math.log2(scale);\n    return clamp(zoom, minZoom, maxZoom);\n  }\n\n  _panFromCenter(offset) {\n    const {\n      width,\n      height,\n      target\n    } = this._viewportProps;\n    return this.pan({\n      startPosition: target,\n      pos: [width / 2 + offset[0], height / 2 + offset[1]]\n    });\n  }\n\n  _getUpdatedState(newProps) {\n    return new OrbitState({ ...this._viewportProps,\n      ...this._state,\n      ...newProps\n    });\n  }\n\n  _applyConstraints(props) {\n    const {\n      maxZoom,\n      minZoom,\n      zoom,\n      maxRotationX,\n      minRotationX,\n      rotationOrbit\n    } = props;\n    props.zoom = clamp(zoom, minZoom, maxZoom);\n    props.rotationX = clamp(props.rotationX, minRotationX, maxRotationX);\n\n    if (rotationOrbit < -180 || rotationOrbit > 180) {\n      props.rotationOrbit = mod(rotationOrbit + 180, 360) - 180;\n    }\n\n    return props;\n  }\n\n}\nexport default class OrbitController extends Controller {\n  constructor(props) {\n    super(OrbitState, props);\n  }\n\n  get linearTransitionProps() {\n    return ['target', 'zoom', 'rotationX', 'rotationOrbit'];\n  }\n\n}\n//# sourceMappingURL=orbit-controller.js.map","import Controller from './controller';\nimport { OrbitState } from './orbit-controller';\nexport default class OrthographicController extends Controller {\n  constructor(props) {\n    props.dragMode = props.dragMode || 'pan';\n    super(OrbitState, props);\n  }\n\n  _onPanRotate(event) {\n    return false;\n  }\n\n  get linearTransitionProps() {\n    return ['target', 'zoom'];\n  }\n\n}\n//# sourceMappingURL=orthographic-controller.js.map","import View from './view';\nimport Viewport from '../viewports/viewport';\nimport { Matrix4 } from 'math.gl';\nimport { pixelsToWorld } from '@math.gl/web-mercator';\nimport * as vec2 from 'gl-matrix/vec2';\nimport OrthographicController from '../controllers/orthographic-controller';\nconst viewMatrix = new Matrix4().lookAt({\n  eye: [0, 0, 1]\n});\n\nfunction getProjectionMatrix({\n  width,\n  height,\n  near,\n  far\n}) {\n  width = width || 1;\n  height = height || 1;\n  return new Matrix4().ortho({\n    left: -width / 2,\n    right: width / 2,\n    bottom: -height / 2,\n    top: height / 2,\n    near,\n    far\n  });\n}\n\nclass OrthographicViewport extends Viewport {\n  constructor(props) {\n    const {\n      width,\n      height,\n      near = 0.1,\n      far = 1000,\n      zoom = 0,\n      target = [0, 0, 0],\n      flipY = true\n    } = props;\n    const scale = Math.pow(2, zoom);\n    super({ ...props,\n      longitude: null,\n      position: target,\n      viewMatrix: viewMatrix.clone().scale([scale, scale * (flipY ? -1 : 1), scale]),\n      projectionMatrix: getProjectionMatrix({\n        width,\n        height,\n        near,\n        far\n      }),\n      zoom\n    });\n  }\n\n  panByPosition(coords, pixel) {\n    const fromLocation = pixelsToWorld(pixel, this.pixelUnprojectionMatrix);\n    const translate = vec2.add([], coords, vec2.negate([], fromLocation));\n    const newCenter = vec2.add([], this.center, translate);\n    return {\n      target: newCenter\n    };\n  }\n\n}\n\nexport default class OrthographicView extends View {\n  constructor(props) {\n    super({ ...props,\n      type: OrthographicViewport\n    });\n  }\n\n  get controller() {\n    return this._getControllerProps({\n      type: OrthographicController\n    });\n  }\n\n}\nOrthographicView.displayName = 'OrthographicView';\n//# sourceMappingURL=orthographic-view.js.map","import { Layer, project32, picking } from '@deck.gl/core';\nimport { Model, Geometry } from '@luma.gl/core';\nimport vs from './scatterplot-layer-vertex.glsl';\nimport fs from './scatterplot-layer-fragment.glsl';\nconst DEFAULT_COLOR = [0, 0, 0, 255];\nconst defaultProps = {\n  radiusUnits: 'meters',\n  radiusScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  radiusMinPixels: {\n    type: 'number',\n    min: 0,\n    value: 0\n  },\n  radiusMaxPixels: {\n    type: 'number',\n    min: 0,\n    value: Number.MAX_SAFE_INTEGER\n  },\n  lineWidthUnits: 'meters',\n  lineWidthScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  lineWidthMinPixels: {\n    type: 'number',\n    min: 0,\n    value: 0\n  },\n  lineWidthMaxPixels: {\n    type: 'number',\n    min: 0,\n    value: Number.MAX_SAFE_INTEGER\n  },\n  stroked: false,\n  filled: true,\n  billboard: false,\n  antialiasing: true,\n  getPosition: {\n    type: 'accessor',\n    value: x => x.position\n  },\n  getRadius: {\n    type: 'accessor',\n    value: 1\n  },\n  getFillColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getLineColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getLineWidth: {\n    type: 'accessor',\n    value: 1\n  },\n  strokeWidth: {\n    deprecatedFor: 'getLineWidth'\n  },\n  outline: {\n    deprecatedFor: 'stroked'\n  },\n  getColor: {\n    deprecatedFor: ['getFillColor', 'getLineColor']\n  }\n};\nexport default class ScatterplotLayer extends Layer {\n  getShaders() {\n    return super.getShaders({\n      vs,\n      fs,\n      modules: [project32, picking]\n    });\n  }\n\n  initializeState() {\n    this.getAttributeManager().addInstanced({\n      instancePositions: {\n        size: 3,\n        type: 5130,\n        fp64: this.use64bitPositions(),\n        transition: true,\n        accessor: 'getPosition'\n      },\n      instanceRadius: {\n        size: 1,\n        transition: true,\n        accessor: 'getRadius',\n        defaultValue: 1\n      },\n      instanceFillColors: {\n        size: this.props.colorFormat.length,\n        transition: true,\n        normalized: true,\n        type: 5121,\n        accessor: 'getFillColor',\n        defaultValue: [0, 0, 0, 255]\n      },\n      instanceLineColors: {\n        size: this.props.colorFormat.length,\n        transition: true,\n        normalized: true,\n        type: 5121,\n        accessor: 'getLineColor',\n        defaultValue: [0, 0, 0, 255]\n      },\n      instanceLineWidths: {\n        size: 1,\n        transition: true,\n        accessor: 'getLineWidth',\n        defaultValue: 1\n      }\n    });\n  }\n\n  updateState({\n    props,\n    oldProps,\n    changeFlags\n  }) {\n    super.updateState({\n      props,\n      oldProps,\n      changeFlags\n    });\n\n    if (changeFlags.extensionsChanged) {\n      var _this$state$model;\n\n      const {\n        gl\n      } = this.context;\n      (_this$state$model = this.state.model) === null || _this$state$model === void 0 ? void 0 : _this$state$model.delete();\n      this.state.model = this._getModel(gl);\n      this.getAttributeManager().invalidateAll();\n    }\n  }\n\n  draw({\n    uniforms\n  }) {\n    const {\n      viewport\n    } = this.context;\n    const {\n      radiusUnits,\n      radiusScale,\n      radiusMinPixels,\n      radiusMaxPixels,\n      stroked,\n      filled,\n      billboard,\n      antialiasing,\n      lineWidthUnits,\n      lineWidthScale,\n      lineWidthMinPixels,\n      lineWidthMaxPixels\n    } = this.props;\n    const pointRadiusMultiplier = radiusUnits === 'pixels' ? viewport.metersPerPixel : 1;\n    const lineWidthMultiplier = lineWidthUnits === 'pixels' ? viewport.metersPerPixel : 1;\n    this.state.model.setUniforms(uniforms).setUniforms({\n      stroked: stroked ? 1 : 0,\n      filled,\n      billboard,\n      antialiasing,\n      radiusScale: radiusScale * pointRadiusMultiplier,\n      radiusMinPixels,\n      radiusMaxPixels,\n      lineWidthScale: lineWidthScale * lineWidthMultiplier,\n      lineWidthMinPixels,\n      lineWidthMaxPixels\n    }).draw();\n  }\n\n  _getModel(gl) {\n    const positions = [-1, -1, 0, 1, -1, 0, 1, 1, 0, -1, 1, 0];\n    return new Model(gl, { ...this.getShaders(),\n      id: this.props.id,\n      geometry: new Geometry({\n        drawMode: 6,\n        vertexCount: 4,\n        attributes: {\n          positions: {\n            size: 3,\n            value: new Float32Array(positions)\n          }\n        }\n      }),\n      isInstanced: true\n    });\n  }\n\n}\nScatterplotLayer.layerName = 'ScatterplotLayer';\nScatterplotLayer.defaultProps = defaultProps;\n//# sourceMappingURL=scatterplot-layer.js.map","export default \"#define SHADER_NAME scatterplot-layer-vertex-shader\\n\\nattribute vec3 positions;\\n\\nattribute vec3 instancePositions;\\nattribute vec3 instancePositions64Low;\\nattribute float instanceRadius;\\nattribute float instanceLineWidths;\\nattribute vec4 instanceFillColors;\\nattribute vec4 instanceLineColors;\\nattribute vec3 instancePickingColors;\\n\\nuniform float opacity;\\nuniform float radiusScale;\\nuniform float radiusMinPixels;\\nuniform float radiusMaxPixels;\\nuniform float lineWidthScale;\\nuniform float lineWidthMinPixels;\\nuniform float lineWidthMaxPixels;\\nuniform float stroked;\\nuniform bool filled;\\nuniform bool billboard;\\n\\nvarying vec4 vFillColor;\\nvarying vec4 vLineColor;\\nvarying vec2 unitPosition;\\nvarying float innerUnitRadius;\\nvarying float outerRadiusPixels;\\n\\nvoid main(void) {\\n  geometry.worldPosition = instancePositions;\\n  outerRadiusPixels = clamp(\\n    project_size_to_pixel(radiusScale * instanceRadius),\\n    radiusMinPixels, radiusMaxPixels\\n  );\\n  float lineWidthPixels = clamp(\\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\\n    lineWidthMinPixels, lineWidthMaxPixels\\n  );\\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\\n  unitPosition = positions.xy;\\n  geometry.uv = unitPosition;\\n  geometry.pickingColor = instancePickingColors;\\n\\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\\n  \\n  if (billboard) {\\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\\n    vec3 offset = positions * outerRadiusPixels;\\n    DECKGL_FILTER_SIZE(offset, geometry);\\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\\n  } else {\\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\\n    DECKGL_FILTER_SIZE(offset, geometry);\\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\\n  }\\n\\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\\n}\\n\";\n//# sourceMappingURL=scatterplot-layer-vertex.glsl.js.map","export default \"#define SHADER_NAME scatterplot-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform bool filled;\\nuniform float stroked;\\nuniform bool antialiasing;\\n\\nvarying vec4 vFillColor;\\nvarying vec4 vLineColor;\\nvarying vec2 unitPosition;\\nvarying float innerUnitRadius;\\nvarying float outerRadiusPixels;\\n\\nvoid main(void) {\\n  geometry.uv = unitPosition;\\n\\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\\n  float inCircle = antialiasing ? \\n    smoothedge(distToCenter, outerRadiusPixels) : \\n    step(distToCenter, outerRadiusPixels);\\n\\n  if (inCircle == 0.0) {\\n    discard;\\n  }\\n\\n  if (stroked > 0.5) {\\n    float isLine = antialiasing ? \\n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\\n\\n    if (filled) {\\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\\n    } else {\\n      if (isLine == 0.0) {\\n        discard;\\n      }\\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\\n    }\\n  } else if (filled) {\\n    gl_FragColor = vFillColor;\\n  } else {\\n    discard;\\n  }\\n\\n  gl_FragColor.a *= inCircle;\\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\\n}\\n\";\n//# sourceMappingURL=scatterplot-layer-fragment.glsl.js.map","export function push(target, source) {\n  const size = source.length;\n  const startIndex = target.length;\n\n  if (startIndex > 0) {\n    let isDuplicate = true;\n\n    for (let i = 0; i < size; i++) {\n      if (target[startIndex - size + i] !== source[i]) {\n        isDuplicate = false;\n        break;\n      }\n    }\n\n    if (isDuplicate) {\n      return false;\n    }\n  }\n\n  for (let i = 0; i < size; i++) {\n    target[startIndex + i] = source[i];\n  }\n\n  return true;\n}\nexport function copy(target, source) {\n  const size = source.length;\n\n  for (let i = 0; i < size; i++) {\n    target[i] = source[i];\n  }\n}\nexport function getPointAtIndex(positions, index, size, offset, out = []) {\n  const startI = offset + index * size;\n\n  for (let i = 0; i < size; i++) {\n    out[i] = positions[startI + i];\n  }\n\n  return out;\n}\n//# sourceMappingURL=utils.js.map","import { push, copy, getPointAtIndex } from './utils';\nexport function clipPolyline(positions, bbox, options = {}) {\n  const {\n    size = 2,\n    startIndex = 0,\n    endIndex = positions.length\n  } = options;\n  const numPoints = (endIndex - startIndex) / size;\n  const result = [];\n  let part = [];\n  let a;\n  let b;\n  let codeA = -1;\n  let codeB;\n  let lastCode;\n\n  for (let i = 1; i < numPoints; i++) {\n    a = getPointAtIndex(positions, i - 1, size, startIndex, a);\n    b = getPointAtIndex(positions, i, size, startIndex, b);\n\n    if (codeA < 0) {\n      codeA = bitCode(a, bbox);\n    }\n\n    codeB = lastCode = bitCode(b, bbox);\n\n    while (true) {\n      if (!(codeA | codeB)) {\n        push(part, a);\n\n        if (codeB !== lastCode) {\n          push(part, b);\n\n          if (i < numPoints - 1) {\n            result.push(part);\n            part = [];\n          }\n        } else if (i === numPoints - 1) {\n          push(part, b);\n        }\n\n        break;\n      } else if (codeA & codeB) {\n        break;\n      } else if (codeA) {\n        intersect(a, b, codeA, bbox, a);\n        codeA = bitCode(a, bbox);\n      } else {\n        intersect(a, b, codeB, bbox, b);\n        codeB = bitCode(b, bbox);\n      }\n    }\n\n    codeA = lastCode;\n  }\n\n  if (part.length) result.push(part);\n  return result;\n}\nexport function clipPolygon(positions, bbox, options = {}) {\n  const {\n    size = 2,\n    endIndex = positions.length\n  } = options;\n  let {\n    startIndex = 0\n  } = options;\n  let numPoints = (endIndex - startIndex) / size;\n  let result;\n  let p;\n  let prev;\n  let inside;\n  let prevInside;\n\n  for (let edge = 1; edge <= 8; edge *= 2) {\n    result = [];\n    prev = getPointAtIndex(positions, numPoints - 1, size, startIndex, prev);\n    prevInside = !(bitCode(prev, bbox) & edge);\n\n    for (let i = 0; i < numPoints; i++) {\n      p = getPointAtIndex(positions, i, size, startIndex, p);\n      inside = !(bitCode(p, bbox) & edge);\n      if (inside !== prevInside) push(result, intersect(prev, p, edge, bbox));\n      if (inside) push(result, p);\n      copy(prev, p);\n      prevInside = inside;\n    }\n\n    positions = result;\n    startIndex = 0;\n    numPoints = result.length / size;\n    if (!numPoints) break;\n  }\n\n  return result;\n}\nexport function intersect(a, b, edge, bbox, out = []) {\n  let t;\n  let snap;\n\n  if (edge & 8) {\n    t = (bbox[3] - a[1]) / (b[1] - a[1]);\n    snap = 3;\n  } else if (edge & 4) {\n    t = (bbox[1] - a[1]) / (b[1] - a[1]);\n    snap = 1;\n  } else if (edge & 2) {\n    t = (bbox[2] - a[0]) / (b[0] - a[0]);\n    snap = 2;\n  } else if (edge & 1) {\n    t = (bbox[0] - a[0]) / (b[0] - a[0]);\n    snap = 0;\n  } else {\n    return null;\n  }\n\n  for (let i = 0; i < a.length; i++) {\n    out[i] = (snap & 1) === i ? bbox[snap] : t * (b[i] - a[i]) + a[i];\n  }\n\n  return out;\n}\nexport function bitCode(p, bbox) {\n  let code = 0;\n  if (p[0] < bbox[0]) code |= 1;else if (p[0] > bbox[2]) code |= 2;\n  if (p[1] < bbox[1]) code |= 4;else if (p[1] > bbox[3]) code |= 8;\n  return code;\n}\n//# sourceMappingURL=lineclip.js.map","import { bitCode, intersect } from './lineclip';\nimport { getPointAtIndex, copy, push } from './utils';\nexport function cutPolylineByGrid(positions, options = {}) {\n  const {\n    size = 2,\n    broken = false,\n    gridResolution = 10,\n    gridOffset = [0, 0],\n    startIndex = 0,\n    endIndex = positions.length\n  } = options;\n  const numPoints = (endIndex - startIndex) / size;\n  let part = [];\n  const result = [part];\n  const a = getPointAtIndex(positions, 0, size, startIndex);\n  let b;\n  let codeB;\n  const cell = getGridCell(a, gridResolution, gridOffset, []);\n  const scratchPoint = [];\n  push(part, a);\n\n  for (let i = 1; i < numPoints; i++) {\n    b = getPointAtIndex(positions, i, size, startIndex, b);\n    codeB = bitCode(b, cell);\n\n    while (codeB) {\n      intersect(a, b, codeB, cell, scratchPoint);\n      const codeAlt = bitCode(scratchPoint, cell);\n\n      if (codeAlt) {\n        intersect(a, scratchPoint, codeAlt, cell, scratchPoint);\n        codeB = codeAlt;\n      }\n\n      push(part, scratchPoint);\n      copy(a, scratchPoint);\n      moveToNeighborCell(cell, gridResolution, codeB);\n\n      if (broken && part.length > size) {\n        part = [];\n        result.push(part);\n        push(part, a);\n      }\n\n      codeB = bitCode(b, cell);\n    }\n\n    push(part, b);\n    copy(a, b);\n  }\n\n  return broken ? result : result[0];\n}\nconst TYPE_INSIDE = 0;\nconst TYPE_BORDER = 1;\n\nfunction concatInPlace(arr1, arr2) {\n  for (let i = 0; i < arr2.length; i++) {\n    arr1.push(arr2[i]);\n  }\n\n  return arr1;\n}\n\nexport function cutPolygonByGrid(positions, holeIndices, options = {}) {\n  if (!positions.length) {\n    return [];\n  }\n\n  const {\n    size = 2,\n    gridResolution = 10,\n    gridOffset = [0, 0],\n    edgeTypes = false\n  } = options;\n  const result = [];\n  const queue = [{\n    pos: positions,\n    types: edgeTypes && new Array(positions.length / size).fill(TYPE_BORDER),\n    holes: holeIndices || []\n  }];\n  const bbox = [[], []];\n  let cell = [];\n\n  while (queue.length) {\n    const {\n      pos,\n      types,\n      holes\n    } = queue.shift();\n    getBoundingBox(pos, size, holes[0] || pos.length, bbox);\n    cell = getGridCell(bbox[0], gridResolution, gridOffset, cell);\n    const code = bitCode(bbox[1], cell);\n\n    if (code) {\n      let parts = bisectPolygon(pos, types, size, 0, holes[0] || pos.length, cell, code);\n      const polygonLow = {\n        pos: parts[0].pos,\n        types: parts[0].types,\n        holes: []\n      };\n      const polygonHigh = {\n        pos: parts[1].pos,\n        types: parts[1].types,\n        holes: []\n      };\n      queue.push(polygonLow, polygonHigh);\n\n      for (let i = 0; i < holes.length; i++) {\n        parts = bisectPolygon(pos, types, size, holes[i], holes[i + 1] || pos.length, cell, code);\n\n        if (parts[0]) {\n          polygonLow.holes.push(polygonLow.pos.length);\n          polygonLow.pos = concatInPlace(polygonLow.pos, parts[0].pos);\n\n          if (edgeTypes) {\n            polygonLow.types = concatInPlace(polygonLow.types, parts[0].types);\n          }\n        }\n\n        if (parts[1]) {\n          polygonHigh.holes.push(polygonHigh.pos.length);\n          polygonHigh.pos = concatInPlace(polygonHigh.pos, parts[1].pos);\n\n          if (edgeTypes) {\n            polygonHigh.types = concatInPlace(polygonHigh.types, parts[1].types);\n          }\n        }\n      }\n    } else {\n      const polygon = {\n        positions: pos\n      };\n\n      if (edgeTypes) {\n        polygon.edgeTypes = types;\n      }\n\n      if (holes.length) {\n        polygon.holeIndices = holes;\n      }\n\n      result.push(polygon);\n    }\n  }\n\n  return result;\n}\n\nfunction bisectPolygon(positions, edgeTypes, size, startIndex, endIndex, bbox, edge) {\n  const numPoints = (endIndex - startIndex) / size;\n  const resultLow = [];\n  const resultHigh = [];\n  const typesLow = [];\n  const typesHigh = [];\n  const scratchPoint = [];\n  let p;\n  let side;\n  let type;\n  const prev = getPointAtIndex(positions, numPoints - 1, size, startIndex);\n  let prevSide = Math.sign(edge & 8 ? prev[1] - bbox[3] : prev[0] - bbox[2]);\n  let prevType = edgeTypes && edgeTypes[numPoints - 1];\n  let lowPointCount = 0;\n  let highPointCount = 0;\n\n  for (let i = 0; i < numPoints; i++) {\n    p = getPointAtIndex(positions, i, size, startIndex, p);\n    side = Math.sign(edge & 8 ? p[1] - bbox[3] : p[0] - bbox[2]);\n    type = edgeTypes && edgeTypes[startIndex / size + i];\n\n    if (side && prevSide && prevSide !== side) {\n      intersect(prev, p, edge, bbox, scratchPoint);\n      push(resultLow, scratchPoint) && typesLow.push(prevType);\n      push(resultHigh, scratchPoint) && typesHigh.push(prevType);\n    }\n\n    if (side <= 0) {\n      push(resultLow, p) && typesLow.push(type);\n      lowPointCount -= side;\n    } else if (typesLow.length) {\n      typesLow[typesLow.length - 1] = TYPE_INSIDE;\n    }\n\n    if (side >= 0) {\n      push(resultHigh, p) && typesHigh.push(type);\n      highPointCount += side;\n    } else if (typesHigh.length) {\n      typesHigh[typesHigh.length - 1] = TYPE_INSIDE;\n    }\n\n    copy(prev, p);\n    prevSide = side;\n    prevType = type;\n  }\n\n  return [lowPointCount ? {\n    pos: resultLow,\n    types: edgeTypes && typesLow\n  } : null, highPointCount ? {\n    pos: resultHigh,\n    types: edgeTypes && typesHigh\n  } : null];\n}\n\nfunction getGridCell(p, gridResolution, gridOffset, out) {\n  const left = Math.floor((p[0] - gridOffset[0]) / gridResolution) * gridResolution + gridOffset[0];\n  const bottom = Math.floor((p[1] - gridOffset[1]) / gridResolution) * gridResolution + gridOffset[1];\n  out[0] = left;\n  out[1] = bottom;\n  out[2] = left + gridResolution;\n  out[3] = bottom + gridResolution;\n  return out;\n}\n\nfunction moveToNeighborCell(cell, gridResolution, edge) {\n  if (edge & 8) {\n    cell[1] += gridResolution;\n    cell[3] += gridResolution;\n  } else if (edge & 4) {\n    cell[1] -= gridResolution;\n    cell[3] -= gridResolution;\n  } else if (edge & 2) {\n    cell[0] += gridResolution;\n    cell[2] += gridResolution;\n  } else if (edge & 1) {\n    cell[0] -= gridResolution;\n    cell[2] -= gridResolution;\n  }\n}\n\nfunction getBoundingBox(positions, size, endIndex, out) {\n  let minX = Infinity;\n  let maxX = -Infinity;\n  let minY = Infinity;\n  let maxY = -Infinity;\n\n  for (let i = 0; i < endIndex; i += size) {\n    const x = positions[i];\n    const y = positions[i + 1];\n    minX = x < minX ? x : minX;\n    maxX = x > maxX ? x : maxX;\n    minY = y < minY ? y : minY;\n    maxY = y > maxY ? y : maxY;\n  }\n\n  out[0][0] = minX;\n  out[0][1] = minY;\n  out[1][0] = maxX;\n  out[1][1] = maxY;\n  return out;\n}\n//# sourceMappingURL=cut-by-grid.js.map","import { cutPolylineByGrid, cutPolygonByGrid } from './cut-by-grid';\nimport { getPointAtIndex, push } from './utils';\nconst DEFAULT_MAX_LATITUDE = 85.051129;\nexport function cutPolylineByMercatorBounds(positions, options = {}) {\n  const {\n    size = 2,\n    startIndex = 0,\n    endIndex = positions.length,\n    normalize = true\n  } = options;\n  const newPositions = positions.slice(startIndex, endIndex);\n  wrapLongitudesForShortestPath(newPositions, size, 0, endIndex - startIndex);\n  const parts = cutPolylineByGrid(newPositions, {\n    size,\n    broken: true,\n    gridResolution: 360,\n    gridOffset: [-180, -180]\n  });\n\n  if (normalize) {\n    for (const part of parts) {\n      shiftLongitudesIntoRange(part, size);\n    }\n  }\n\n  return parts;\n}\nexport function cutPolygonByMercatorBounds(positions, holeIndices, options = {}) {\n  const {\n    size = 2,\n    normalize = true,\n    edgeTypes = false\n  } = options;\n  holeIndices = holeIndices || [];\n  const newPositions = [];\n  const newHoleIndices = [];\n  let srcStartIndex = 0;\n  let targetIndex = 0;\n\n  for (let ringIndex = 0; ringIndex <= holeIndices.length; ringIndex++) {\n    const srcEndIndex = holeIndices[ringIndex] || positions.length;\n    const targetStartIndex = targetIndex;\n    const splitIndex = findSplitIndex(positions, size, srcStartIndex, srcEndIndex);\n\n    for (let i = splitIndex; i < srcEndIndex; i++) {\n      newPositions[targetIndex++] = positions[i];\n    }\n\n    for (let i = srcStartIndex; i < splitIndex; i++) {\n      newPositions[targetIndex++] = positions[i];\n    }\n\n    wrapLongitudesForShortestPath(newPositions, size, targetStartIndex, targetIndex);\n    insertPoleVertices(newPositions, size, targetStartIndex, targetIndex, options.maxLatitude);\n    srcStartIndex = srcEndIndex;\n    newHoleIndices[ringIndex] = targetIndex;\n  }\n\n  newHoleIndices.pop();\n  const parts = cutPolygonByGrid(newPositions, newHoleIndices, {\n    size,\n    gridResolution: 360,\n    gridOffset: [-180, -180],\n    edgeTypes\n  });\n\n  if (normalize) {\n    for (const part of parts) {\n      shiftLongitudesIntoRange(part.positions, size);\n    }\n  }\n\n  return parts;\n}\n\nfunction findSplitIndex(positions, size, startIndex, endIndex) {\n  let maxLat = -1;\n  let pointIndex = -1;\n\n  for (let i = startIndex + 1; i < endIndex; i += size) {\n    const lat = Math.abs(positions[i]);\n\n    if (lat > maxLat) {\n      maxLat = lat;\n      pointIndex = i - 1;\n    }\n  }\n\n  return pointIndex;\n}\n\nfunction insertPoleVertices(positions, size, startIndex, endIndex, maxLatitude = DEFAULT_MAX_LATITUDE) {\n  const firstLng = positions[startIndex];\n  const lastLng = positions[endIndex - size];\n\n  if (Math.abs(firstLng - lastLng) > 180) {\n    const p = getPointAtIndex(positions, 0, size, startIndex);\n    p[0] += Math.round((lastLng - firstLng) / 360) * 360;\n    push(positions, p);\n    p[1] = Math.sign(p[1]) * maxLatitude;\n    push(positions, p);\n    p[0] = firstLng;\n    push(positions, p);\n  }\n}\n\nfunction wrapLongitudesForShortestPath(positions, size, startIndex, endIndex) {\n  let prevLng = positions[0];\n  let lng;\n\n  for (let i = startIndex; i < endIndex; i += size) {\n    lng = positions[i];\n    const delta = lng - prevLng;\n\n    if (delta > 180 || delta < -180) {\n      lng -= Math.round(delta / 360) * 360;\n    }\n\n    positions[i] = prevLng = lng;\n  }\n}\n\nfunction shiftLongitudesIntoRange(positions, size) {\n  let refLng;\n  const pointCount = positions.length / size;\n\n  for (let i = 0; i < pointCount; i++) {\n    refLng = positions[i * size];\n\n    if ((refLng + 180) % 360 !== 0) {\n      break;\n    }\n  }\n\n  const delta = -Math.round(refLng / 360) * 360;\n\n  if (delta === 0) {\n    return;\n  }\n\n  for (let i = 0; i < pointCount; i++) {\n    positions[i * size] += delta;\n  }\n}\n//# sourceMappingURL=cut-by-mercator-bounds.js.map","import { Tesselator } from '@deck.gl/core';\nimport { normalizePath } from './path';\nconst START_CAP = 1;\nconst END_CAP = 2;\nconst INVALID = 4;\nexport default class PathTesselator extends Tesselator {\n  constructor(opts) {\n    super({ ...opts,\n      attributes: {\n        positions: {\n          size: 3,\n          padding: 18,\n          initialize: true,\n          type: opts.fp64 ? Float64Array : Float32Array\n        },\n        segmentTypes: {\n          size: 1,\n          type: Uint8ClampedArray\n        }\n      }\n    });\n  }\n\n  getGeometryFromBuffer(buffer) {\n    if (this.normalize) {\n      return super.getGeometryFromBuffer(buffer);\n    }\n\n    return () => null;\n  }\n\n  normalizeGeometry(path) {\n    if (this.normalize) {\n      return normalizePath(path, this.positionSize, this.opts.resolution, this.opts.wrapLongitude);\n    }\n\n    return path;\n  }\n\n  get(attributeName) {\n    return this.attributes[attributeName];\n  }\n\n  getGeometrySize(path) {\n    if (Array.isArray(path[0])) {\n      let size = 0;\n\n      for (const subPath of path) {\n        size += this.getGeometrySize(subPath);\n      }\n\n      return size;\n    }\n\n    const numPoints = this.getPathLength(path);\n\n    if (numPoints < 2) {\n      return 0;\n    }\n\n    if (this.isClosed(path)) {\n      return numPoints < 3 ? 0 : numPoints + 2;\n    }\n\n    return numPoints;\n  }\n\n  updateGeometryAttributes(path, context) {\n    if (context.geometrySize === 0) {\n      return;\n    }\n\n    if (path && Array.isArray(path[0])) {\n      for (const subPath of path) {\n        const geometrySize = this.getGeometrySize(subPath);\n        context.geometrySize = geometrySize;\n        this.updateGeometryAttributes(subPath, context);\n        context.vertexStart += geometrySize;\n      }\n    } else {\n      this._updateSegmentTypes(path, context);\n\n      this._updatePositions(path, context);\n    }\n  }\n\n  _updateSegmentTypes(path, context) {\n    const {\n      segmentTypes\n    } = this.attributes;\n    const isPathClosed = this.isClosed(path);\n    const {\n      vertexStart,\n      geometrySize\n    } = context;\n    segmentTypes.fill(0, vertexStart, vertexStart + geometrySize);\n\n    if (isPathClosed) {\n      segmentTypes[vertexStart] = INVALID;\n      segmentTypes[vertexStart + geometrySize - 2] = INVALID;\n    } else {\n      segmentTypes[vertexStart] += START_CAP;\n      segmentTypes[vertexStart + geometrySize - 2] += END_CAP;\n    }\n\n    segmentTypes[vertexStart + geometrySize - 1] = INVALID;\n  }\n\n  _updatePositions(path, context) {\n    const {\n      positions\n    } = this.attributes;\n\n    if (!positions) {\n      return;\n    }\n\n    const {\n      vertexStart,\n      geometrySize\n    } = context;\n    const p = new Array(3);\n\n    for (let i = vertexStart, ptIndex = 0; ptIndex < geometrySize; i++, ptIndex++) {\n      this.getPointOnPath(path, ptIndex, p);\n      positions[i * 3] = p[0];\n      positions[i * 3 + 1] = p[1];\n      positions[i * 3 + 2] = p[2];\n    }\n  }\n\n  getPathLength(path) {\n    return path.length / this.positionSize;\n  }\n\n  getPointOnPath(path, index, target = []) {\n    const {\n      positionSize\n    } = this;\n\n    if (index * positionSize >= path.length) {\n      index += 1 - path.length / positionSize;\n    }\n\n    const i = index * positionSize;\n    target[0] = path[i];\n    target[1] = path[i + 1];\n    target[2] = positionSize === 3 && path[i + 2] || 0;\n    return target;\n  }\n\n  isClosed(path) {\n    if (!this.normalize) {\n      return this.opts.loop;\n    }\n\n    const {\n      positionSize\n    } = this;\n    const lastPointIndex = path.length - positionSize;\n    return path[0] === path[lastPointIndex] && path[1] === path[lastPointIndex + 1] && (positionSize === 2 || path[2] === path[lastPointIndex + 2]);\n  }\n\n}\n//# sourceMappingURL=path-tesselator.js.map","import { createIterable, getAccessorFromBuffer } from './iterable-utils';\nimport defaultTypedArrayManager from './typed-array-manager';\nimport assert from './assert';\nimport { Buffer } from '@luma.gl/core';\nexport default class Tesselator {\n  constructor(opts = {}) {\n    const {\n      attributes = {}\n    } = opts;\n    this.typedArrayManager = defaultTypedArrayManager;\n    this.indexStarts = null;\n    this.vertexStarts = null;\n    this.vertexCount = 0;\n    this.instanceCount = 0;\n    this.attributes = {};\n    this._attributeDefs = attributes;\n    this.opts = opts;\n    this.updateGeometry(opts);\n    Object.seal(this);\n  }\n\n  updateGeometry(opts) {\n    Object.assign(this.opts, opts);\n    const {\n      data,\n      buffers = {},\n      getGeometry,\n      geometryBuffer,\n      positionFormat,\n      dataChanged,\n      normalize = true\n    } = this.opts;\n    this.data = data;\n    this.getGeometry = getGeometry;\n    this.positionSize = geometryBuffer && geometryBuffer.size || (positionFormat === 'XY' ? 2 : 3);\n    this.buffers = buffers;\n    this.normalize = normalize;\n\n    if (geometryBuffer) {\n      assert(data.startIndices);\n      this.getGeometry = this.getGeometryFromBuffer(geometryBuffer);\n\n      if (!normalize) {\n        buffers.positions = geometryBuffer;\n      }\n    }\n\n    this.geometryBuffer = buffers.positions;\n\n    if (Array.isArray(dataChanged)) {\n      for (const dataRange of dataChanged) {\n        this._rebuildGeometry(dataRange);\n      }\n    } else {\n      this._rebuildGeometry();\n    }\n  }\n\n  updatePartialGeometry({\n    startRow,\n    endRow\n  }) {\n    this._rebuildGeometry({\n      startRow,\n      endRow\n    });\n  }\n\n  normalizeGeometry(geometry) {\n    return geometry;\n  }\n\n  updateGeometryAttributes(geometry, startIndex, size) {\n    throw new Error('Not implemented');\n  }\n\n  getGeometrySize(geometry) {\n    throw new Error('Not implemented');\n  }\n\n  getGeometryFromBuffer(geometryBuffer) {\n    const value = geometryBuffer.value || geometryBuffer;\n    assert(ArrayBuffer.isView(value));\n    return getAccessorFromBuffer(value, {\n      size: this.positionSize,\n      offset: geometryBuffer.offset,\n      stride: geometryBuffer.stride,\n      startIndices: this.data.startIndices\n    });\n  }\n\n  _allocate(instanceCount, copy) {\n    const {\n      attributes,\n      buffers,\n      _attributeDefs,\n      typedArrayManager\n    } = this;\n\n    for (const name in _attributeDefs) {\n      if (name in buffers) {\n        typedArrayManager.release(attributes[name]);\n        attributes[name] = null;\n      } else {\n        const def = _attributeDefs[name];\n        def.copy = copy;\n        attributes[name] = typedArrayManager.allocate(attributes[name], instanceCount, def);\n      }\n    }\n  }\n\n  _forEachGeometry(visitor, startRow, endRow) {\n    const {\n      data,\n      getGeometry\n    } = this;\n    const {\n      iterable,\n      objectInfo\n    } = createIterable(data, startRow, endRow);\n\n    for (const object of iterable) {\n      objectInfo.index++;\n      const geometry = getGeometry(object, objectInfo);\n      visitor(geometry, objectInfo.index);\n    }\n  }\n\n  _rebuildGeometry(dataRange) {\n    if (!this.data || !this.getGeometry) {\n      return;\n    }\n\n    let {\n      indexStarts,\n      vertexStarts,\n      instanceCount\n    } = this;\n    const {\n      data,\n      geometryBuffer\n    } = this;\n    const {\n      startRow = 0,\n      endRow = Infinity\n    } = dataRange || {};\n    const normalizedData = {};\n\n    if (!dataRange) {\n      indexStarts = [0];\n      vertexStarts = [0];\n    }\n\n    if (this.normalize || !geometryBuffer) {\n      this._forEachGeometry((geometry, dataIndex) => {\n        geometry = this.normalizeGeometry(geometry);\n        normalizedData[dataIndex] = geometry;\n        vertexStarts[dataIndex + 1] = vertexStarts[dataIndex] + this.getGeometrySize(geometry);\n      }, startRow, endRow);\n\n      instanceCount = vertexStarts[vertexStarts.length - 1];\n    } else if (geometryBuffer.buffer instanceof Buffer) {\n      const byteStride = geometryBuffer.stride || this.positionSize * 4;\n      vertexStarts = data.startIndices;\n      instanceCount = vertexStarts[data.length] || geometryBuffer.buffer.byteLength / byteStride;\n    } else {\n      const bufferValue = geometryBuffer.value || geometryBuffer;\n      const elementStride = geometryBuffer.stride / bufferValue.BYTES_PER_ELEMENT || this.positionSize;\n      vertexStarts = data.startIndices;\n      instanceCount = vertexStarts[data.length] || bufferValue.length / elementStride;\n    }\n\n    this._allocate(instanceCount, Boolean(dataRange));\n\n    this.indexStarts = indexStarts;\n    this.vertexStarts = vertexStarts;\n    this.instanceCount = instanceCount;\n    const context = {};\n\n    this._forEachGeometry((geometry, dataIndex) => {\n      geometry = normalizedData[dataIndex] || geometry;\n      context.vertexStart = vertexStarts[dataIndex];\n      context.indexStart = indexStarts[dataIndex];\n      const vertexEnd = dataIndex < vertexStarts.length - 1 ? vertexStarts[dataIndex + 1] : instanceCount;\n      context.geometrySize = vertexEnd - vertexStarts[dataIndex];\n      context.geometryIndex = dataIndex;\n      this.updateGeometryAttributes(geometry, context);\n    }, startRow, endRow);\n\n    this.vertexCount = indexStarts[indexStarts.length - 1];\n  }\n\n}\n//# sourceMappingURL=tesselator.js.map","import { cutPolylineByGrid, cutPolylineByMercatorBounds } from '@math.gl/polygon';\nexport function normalizePath(path, size, gridResolution, wrapLongitude) {\n  let flatPath = path;\n\n  if (Array.isArray(path[0])) {\n    const length = path.length * size;\n    flatPath = new Array(length);\n\n    for (let i = 0; i < path.length; i++) {\n      for (let j = 0; j < size; j++) {\n        flatPath[i * size + j] = path[i][j] || 0;\n      }\n    }\n  }\n\n  if (gridResolution) {\n    return cutPolylineByGrid(flatPath, {\n      size,\n      gridResolution\n    });\n  }\n\n  if (wrapLongitude) {\n    return cutPolylineByMercatorBounds(flatPath, {\n      size\n    });\n  }\n\n  return flatPath;\n}\n//# sourceMappingURL=path.js.map","import { Layer, project32, picking, log } from '@deck.gl/core';\nimport { Model, Geometry } from '@luma.gl/core';\nimport PathTesselator from './path-tesselator';\nimport vs from './path-layer-vertex.glsl';\nimport fs from './path-layer-fragment.glsl';\nconst DEFAULT_COLOR = [0, 0, 0, 255];\nconst defaultProps = {\n  widthUnits: 'meters',\n  widthScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  widthMinPixels: {\n    type: 'number',\n    min: 0,\n    value: 0\n  },\n  widthMaxPixels: {\n    type: 'number',\n    min: 0,\n    value: Number.MAX_SAFE_INTEGER\n  },\n  jointRounded: false,\n  capRounded: false,\n  miterLimit: {\n    type: 'number',\n    min: 0,\n    value: 4\n  },\n  billboard: false,\n  _pathType: null,\n  getPath: {\n    type: 'accessor',\n    value: object => object.path\n  },\n  getColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getWidth: {\n    type: 'accessor',\n    value: 1\n  },\n  rounded: {\n    deprecatedFor: ['jointRounded', 'capRounded']\n  }\n};\nconst ATTRIBUTE_TRANSITION = {\n  enter: (value, chunk) => {\n    return chunk.length ? chunk.subarray(chunk.length - value.length) : value;\n  }\n};\nexport default class PathLayer extends Layer {\n  getShaders() {\n    return super.getShaders({\n      vs,\n      fs,\n      modules: [project32, picking]\n    });\n  }\n\n  get wrapLongitude() {\n    return false;\n  }\n\n  initializeState() {\n    const noAlloc = true;\n    const attributeManager = this.getAttributeManager();\n    attributeManager.addInstanced({\n      positions: {\n        size: 3,\n        vertexOffset: 1,\n        type: 5130,\n        fp64: this.use64bitPositions(),\n        transition: ATTRIBUTE_TRANSITION,\n        accessor: 'getPath',\n        update: this.calculatePositions,\n        noAlloc,\n        shaderAttributes: {\n          instanceLeftPositions: {\n            vertexOffset: 0\n          },\n          instanceStartPositions: {\n            vertexOffset: 1\n          },\n          instanceEndPositions: {\n            vertexOffset: 2\n          },\n          instanceRightPositions: {\n            vertexOffset: 3\n          }\n        }\n      },\n      instanceTypes: {\n        size: 1,\n        type: 5121,\n        update: this.calculateSegmentTypes,\n        noAlloc\n      },\n      instanceStrokeWidths: {\n        size: 1,\n        accessor: 'getWidth',\n        transition: ATTRIBUTE_TRANSITION,\n        defaultValue: 1\n      },\n      instanceColors: {\n        size: this.props.colorFormat.length,\n        type: 5121,\n        normalized: true,\n        accessor: 'getColor',\n        transition: ATTRIBUTE_TRANSITION,\n        defaultValue: DEFAULT_COLOR\n      },\n      instancePickingColors: {\n        size: 3,\n        type: 5121,\n        accessor: (object, {\n          index,\n          target: value\n        }) => this.encodePickingColor(object && object.__source ? object.__source.index : index, value)\n      }\n    });\n    this.setState({\n      pathTesselator: new PathTesselator({\n        fp64: this.use64bitPositions()\n      })\n    });\n\n    if (this.props.getDashArray && !this.props.extensions.length) {\n      log.removed('getDashArray', 'PathStyleExtension')();\n    }\n  }\n\n  updateState({\n    oldProps,\n    props,\n    changeFlags\n  }) {\n    super.updateState({\n      props,\n      oldProps,\n      changeFlags\n    });\n    const attributeManager = this.getAttributeManager();\n    const geometryChanged = changeFlags.dataChanged || changeFlags.updateTriggersChanged && (changeFlags.updateTriggersChanged.all || changeFlags.updateTriggersChanged.getPath);\n\n    if (geometryChanged) {\n      const {\n        pathTesselator\n      } = this.state;\n      const buffers = props.data.attributes || {};\n      pathTesselator.updateGeometry({\n        data: props.data,\n        geometryBuffer: buffers.getPath,\n        buffers,\n        normalize: !props._pathType,\n        loop: props._pathType === 'loop',\n        getGeometry: props.getPath,\n        positionFormat: props.positionFormat,\n        wrapLongitude: props.wrapLongitude,\n        resolution: this.context.viewport.resolution,\n        dataChanged: changeFlags.dataChanged\n      });\n      this.setState({\n        numInstances: pathTesselator.instanceCount,\n        startIndices: pathTesselator.vertexStarts\n      });\n\n      if (!changeFlags.dataChanged) {\n        attributeManager.invalidateAll();\n      }\n    }\n\n    if (changeFlags.extensionsChanged) {\n      var _this$state$model;\n\n      const {\n        gl\n      } = this.context;\n      (_this$state$model = this.state.model) === null || _this$state$model === void 0 ? void 0 : _this$state$model.delete();\n      this.state.model = this._getModel(gl);\n      attributeManager.invalidateAll();\n    }\n  }\n\n  getPickingInfo(params) {\n    const info = super.getPickingInfo(params);\n    const {\n      index\n    } = info;\n    const {\n      data\n    } = this.props;\n\n    if (data[0] && data[0].__source) {\n      info.object = data.find(d => d.__source.index === index);\n    }\n\n    return info;\n  }\n\n  disablePickingIndex(objectIndex) {\n    const {\n      data\n    } = this.props;\n\n    if (data[0] && data[0].__source) {\n      for (let i = 0; i < data.length; i++) {\n        if (data[i].__source.index === objectIndex) {\n          this._disablePickingIndex(i);\n        }\n      }\n    } else {\n      this._disablePickingIndex(objectIndex);\n    }\n  }\n\n  draw({\n    uniforms\n  }) {\n    const {\n      viewport\n    } = this.context;\n    const {\n      jointRounded,\n      capRounded,\n      billboard,\n      miterLimit,\n      widthUnits,\n      widthScale,\n      widthMinPixels,\n      widthMaxPixels\n    } = this.props;\n    const widthMultiplier = widthUnits === 'pixels' ? viewport.metersPerPixel : 1;\n    this.state.model.setUniforms(uniforms).setUniforms({\n      jointType: Number(jointRounded),\n      capType: Number(capRounded),\n      billboard,\n      widthScale: widthScale * widthMultiplier,\n      miterLimit,\n      widthMinPixels,\n      widthMaxPixels\n    }).draw();\n  }\n\n  _getModel(gl) {\n    const SEGMENT_INDICES = [0, 1, 2, 1, 4, 2, 1, 3, 4, 3, 5, 4];\n    const SEGMENT_POSITIONS = [0, 0, 0, -1, 0, 1, 1, -1, 1, 1, 1, 0];\n    return new Model(gl, { ...this.getShaders(),\n      id: this.props.id,\n      geometry: new Geometry({\n        drawMode: 4,\n        attributes: {\n          indices: new Uint16Array(SEGMENT_INDICES),\n          positions: {\n            value: new Float32Array(SEGMENT_POSITIONS),\n            size: 2\n          }\n        }\n      }),\n      isInstanced: true\n    });\n  }\n\n  calculatePositions(attribute) {\n    const {\n      pathTesselator\n    } = this.state;\n    attribute.startIndices = pathTesselator.vertexStarts;\n    attribute.value = pathTesselator.get('positions');\n  }\n\n  calculateSegmentTypes(attribute) {\n    const {\n      pathTesselator\n    } = this.state;\n    attribute.startIndices = pathTesselator.vertexStarts;\n    attribute.value = pathTesselator.get('segmentTypes');\n  }\n\n}\nPathLayer.layerName = 'PathLayer';\nPathLayer.defaultProps = defaultProps;\n//# sourceMappingURL=path-layer.js.map","export default \"#define SHADER_NAME path-layer-vertex-shader\\n\\nattribute vec2 positions;\\n\\nattribute float instanceTypes;\\nattribute vec3 instanceStartPositions;\\nattribute vec3 instanceEndPositions;\\nattribute vec3 instanceLeftPositions;\\nattribute vec3 instanceRightPositions;\\nattribute vec3 instanceLeftPositions64Low;\\nattribute vec3 instanceStartPositions64Low;\\nattribute vec3 instanceEndPositions64Low;\\nattribute vec3 instanceRightPositions64Low;\\nattribute float instanceStrokeWidths;\\nattribute vec4 instanceColors;\\nattribute vec3 instancePickingColors;\\n\\nuniform float widthScale;\\nuniform float widthMinPixels;\\nuniform float widthMaxPixels;\\nuniform float jointType;\\nuniform float capType;\\nuniform float miterLimit;\\nuniform bool billboard;\\n\\nuniform float opacity;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\nvarying float vJointType;\\n\\nconst float EPSILON = 0.001;\\nconst vec3 ZERO_OFFSET = vec3(0.0);\\n\\nfloat flipIfTrue(bool flag) {\\n  return -(float(flag) * 2. - 1.);\\n}\\nvec3 lineJoin(\\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\\n  vec2 width\\n) {\\n  bool isEnd = positions.x > 0.0;\\n  float sideOfPath = positions.y;\\n  float isJoint = float(sideOfPath == 0.0);\\n\\n  vec3 deltaA3 = (currPoint - prevPoint);\\n  vec3 deltaB3 = (nextPoint - currPoint);\\n\\n  mat3 rotationMatrix;\\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\\n  if (needsRotation) {\\n    deltaA3 = deltaA3 * rotationMatrix;\\n    deltaB3 = deltaB3 * rotationMatrix;\\n  }\\n  vec2 deltaA = deltaA3.xy / width;\\n  vec2 deltaB = deltaB3.xy / width;\\n\\n  float lenA = length(deltaA);\\n  float lenB = length(deltaB);\\n\\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\\n\\n  vec2 perpA = vec2(-dirA.y, dirA.x);\\n  vec2 perpB = vec2(-dirB.y, dirB.x);\\n  vec2 tangent = dirA + dirB;\\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\\n  vec2 dir = isEnd ? dirA : dirB;\\n  vec2 perp = isEnd ? perpA : perpB;\\n  float L = isEnd ? lenA : lenB;\\n  float sinHalfA = abs(dot(miterVec, perp));\\n  float cosHalfA = abs(dot(dirA, miterVec));\\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\\n  float cornerPosition = sideOfPath * turnDirection;\\n\\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\\n  miterSize = mix(\\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\\n    miterSize,\\n    step(0.0, cornerPosition)\\n  );\\n\\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\\n    * (sideOfPath + isJoint * turnDirection);\\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\\n  bool isCap = isStartCap || isEndCap;\\n  if (isCap) {\\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\\n    vJointType = capType;\\n  } else {\\n    vJointType = jointType;\\n  }\\n  vPathLength = L;\\n  vCornerOffset = offsetVec;\\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\\n  vMiterLength = isCap ? isJoint : vMiterLength;\\n\\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\\n  vPathPosition = vec2(\\n    dot(offsetFromStartOfPath, perp),\\n    dot(offsetFromStartOfPath, dir)\\n  );\\n  geometry.uv = vPathPosition;\\n\\n  float isValid = step(instanceTypes, 3.5);\\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\\n\\n  if (needsRotation) {\\n    offset = rotationMatrix * offset;\\n  }\\n  return currPoint + offset;\\n}\\nvoid clipLine(inout vec4 position, vec4 refPosition) {\\n  if (position.w < EPSILON) {\\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\\n    position = refPosition + (position - refPosition) * r;\\n  }\\n}\\n\\nvoid main() {\\n  geometry.worldPosition = instanceStartPositions;\\n  geometry.worldPositionAlt = instanceEndPositions;\\n  geometry.pickingColor = instancePickingColors;\\n\\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\\n    widthMinPixels, widthMaxPixels) / 2.0);\\n  vec3 width;\\n\\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\\n\\n  float isEnd = positions.x;\\n\\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\\n\\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\\n\\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\\n\\n  if (billboard) {\\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\\n\\n    clipLine(prevPositionScreen, currPositionScreen);\\n    clipLine(nextPositionScreen, currPositionScreen);\\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\\n\\n    width = vec3(widthPixels, 0.0);\\n    DECKGL_FILTER_SIZE(width, geometry);\\n\\n    vec3 pos = lineJoin(\\n      prevPositionScreen.xyz / prevPositionScreen.w,\\n      currPositionScreen.xyz / currPositionScreen.w,\\n      nextPositionScreen.xyz / nextPositionScreen.w,\\n      project_pixel_size_to_clipspace(width.xy)\\n    );\\n\\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\\n  } else {\\n    prevPosition = project_position(prevPosition, prevPosition64Low);\\n    currPosition = project_position(currPosition, currPosition64Low);\\n    nextPosition = project_position(nextPosition, nextPosition64Low);\\n\\n    width = vec3(project_pixel_size(widthPixels), 0.0);\\n    DECKGL_FILTER_SIZE(width, geometry);\\n\\n    vec4 pos = vec4(\\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\\n      1.0);\\n    geometry.position = pos;\\n    gl_Position = project_common_position_to_clipspace(pos);\\n  }\\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\\n  DECKGL_FILTER_COLOR(vColor, geometry);\\n}\\n\";\n//# sourceMappingURL=path-layer-vertex.glsl.js.map","export default \"#define SHADER_NAME path-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform float miterLimit;\\n\\nvarying vec4 vColor;\\nvarying vec2 vCornerOffset;\\nvarying float vMiterLength;\\nvarying vec2 vPathPosition;\\nvarying float vPathLength;\\nvarying float vJointType;\\n\\nvoid main(void) {\\n  geometry.uv = vPathPosition;\\n\\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\\n      discard;\\n    }\\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\\n      discard;\\n    }\\n  }\\n  gl_FragColor = vColor;\\n\\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\\n}\\n\";\n//# sourceMappingURL=path-layer-fragment.glsl.js.map","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"16\"\n  height=\"16\"\n  viewBox=\"0 0 16 16\"\n>\n  <path\n    d=\"M1.5 1a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4A1.5 1.5 0 0 1 1.5 0h4a.5.5 0 0 1 0 1h-4zM10 .5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 16 1.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zM.5 10a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 0 14.5v-4a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v4a1.5 1.5 0 0 1-1.5 1.5h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5z\"\n  />\n</svg>\n\n<style>\n  svg {\n    fill: var(--secondary-color);\n  }\n</style>\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"24\"\n  height=\"24\"\n  viewBox=\"0 0 16 16\"\n>\n  <path\n    d=\"M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z\"\n  />\n</svg>\n\n<style>\n  svg {\n    fill: var(--secondary-color);\n  }\n</style>\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"24\"\n  height=\"24\"\n  viewBox=\"0 0 16 16\"\n>\n  <path\n    d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"\n  />\n</svg>\n\n<style>\n  svg {\n    fill: var(--secondary-color);\n  }\n</style>\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"24\"\n  height=\"24\"\n  viewBox=\"0 0 16 16\"\n>\n  <path\n    d=\"M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z\"\n  />\n</svg>\n\n<style>\n  svg {\n    fill: var(--secondary-color);\n  }\n</style>\n","<script>\n  import { instance, solution, state, time } from \"../../stores\";\n\n  import ResetZoomIcon from \"../icons/ResetZoomIcon.svelte\";\n  import StartIcon from \"../icons/StartIcon.svelte\";\n  import ResetIcon from \"../icons/ResetIcon.svelte\";\n  import PauseIcon from \"../icons/PauseIcon.svelte\";\n\n  export let resetZoomHandler;\n\n  let startButtonDisabled = true;\n  let pauseButtonDisabled = true;\n  let resetButtonDisabled = true;\n  let resetZoomButtonDisabled = true;\n\n  let startTime;\n  let pauseTime;\n  let timer;\n\n  let timeLabel = 0.0;\n  let costLabel = undefined;\n\n  function startTimer() {\n    if (startTime === undefined) {\n      startTime = new Date();\n    }\n    if (pauseTime !== undefined) {\n      const elapsed = new Date() - pauseTime;\n      startTime = new Date(startTime.getTime() + elapsed);\n      pauseTime = undefined;\n    }\n    timer = setInterval(() => {\n      const elapsed = (new Date() - startTime) / 1000;\n      $time = elapsed;\n    }, 50);\n  }\n\n  function stopTimer() {\n    pauseTime = new Date();\n    clearInterval(timer);\n  }\n\n  $: {\n    if ($state.running || !$state.loaded) {\n      startButtonDisabled = true;\n    } else {\n      startButtonDisabled = false;\n    }\n\n    if ($state.running) {\n      pauseButtonDisabled = false;\n    } else {\n      pauseButtonDisabled = true;\n    }\n  }\n\n  $: {\n    if ($solution.routes.length === 0) {\n      resetButtonDisabled = true;\n    } else {\n      resetButtonDisabled = false;\n      updateCostLabel();\n    }\n  }\n\n  $: {\n    if ($state.loaded) {\n      resetZoomButtonDisabled = false;\n    } else {\n      resetZoomButtonDisabled = true;\n    }\n  }\n\n  $: {\n    if ($time !== undefined) {\n      updateTimeLabel();\n    }\n  }\n\n  function updateTimeLabel() {\n    timeLabel = $time.toFixed(1);\n  }\n\n  function updateCostLabel() {\n    if ($solution.cost) {\n      const bks = $instance.bks;\n      const gap = (($solution.cost - bks) / bks) * 100;\n      costLabel = `${$solution.cost} (${gap.toFixed(2)}% from BKS)`;\n    } else {\n      costLabel = undefined;\n    }\n  }\n\n  function startPauseClicked() {\n    $state.running = !$state.running;\n    if ($state.running) {\n      startTimer();\n    } else {\n      stopTimer();\n    }\n  }\n\n  export function reset() {\n    stopTimer();\n    startButtonDisabled = true;\n    pauseButtonDisabled = true;\n    resetButtonDisabled = true;\n    startTime = undefined;\n    pauseTime = undefined;\n    updateCostLabel();\n    updateTimeLabel();\n  }\n\n  function dispatchReset() {\n    $state.reset = true;\n  }\n</script>\n\n<div class=\"map-panel panel-top-right\">\n  <button\n    class=\"btn btn-light\"\n    on:click={resetZoomHandler}\n    class:disabled={resetZoomButtonDisabled}\n  >\n    <ResetZoomIcon />\n  </button>\n</div>\n\n<div class=\"map-panel panel-top-left\">\n  <button\n    class=\"btn btn-light small-btn\"\n    class:disabled={startButtonDisabled}\n    on:click={startPauseClicked}\n  >\n    <StartIcon />\n  </button>\n  <button\n    class=\"btn btn-light small-btn\"\n    class:disabled={pauseButtonDisabled}\n    on:click={startPauseClicked}\n  >\n    <PauseIcon />\n  </button>\n  <button\n    class=\"btn btn-light small-btn\"\n    class:disabled={resetButtonDisabled}\n    on:click={dispatchReset}\n  >\n    <ResetIcon />\n  </button>\n  <p class=\"timer\">Time: {timeLabel}s</p>\n  <p class=\"cost\">Cost: {costLabel ? costLabel : \"----- (--% from BKS)\"}</p>\n</div>\n\n<style>\n  .map-panel {\n    position: absolute;\n    margin: 10px;\n  }\n  .panel-top-right {\n    top: 0px;\n    right: 0px;\n  }\n\n  .panel-top-left {\n    top: 0px;\n    left: 0px;\n    display: flex;\n    align-items: center;\n    flex-wrap: wrap;\n  }\n\n  .panel-top-left button:not(:first-child) {\n    margin-left: 10px;\n  }\n\n  button {\n    padding: 8px;\n    display: flex;\n    align-items: center;\n  }\n\n  .small-btn {\n    padding: 4px 4px;\n  }\n\n  p {\n    color: var(--text-color);\n    padding: 0 10px 2px;\n    margin-bottom: 0;\n    font-size: 1.2rem;\n  }\n\n  .timer {\n    padding-left: 20px;\n  }\n\n  @media only screen and (max-width: 768px) {\n    p {\n      font-size: 16px;\n      padding: 10px 5px 12px;\n    }\n\n    .timer {\n      padding-left: 10px;\n    }\n  }\n</style>\n","<script>\n  import { onMount } from \"svelte\";\n\n  import { Deck, OrthographicView } from \"@deck.gl/core\";\n  import { PathLayer, ScatterplotLayer } from \"@deck.gl/layers\";\n\n  import { instance, solution } from \"../../stores\";\n  import MapPanel from \"./MapPanel.svelte\";\n\n  let mapPanel;\n\n  let deck;\n  let mapCanvas;\n  let mapWidth;\n  let mapHeight;\n  let mapPadding = 50;\n  let panelHeight = 50;\n  let zoom = 0;\n  let depot;\n  let nodes = [];\n  let depotLines = [];\n  let routes = [];\n  let depotLayer;\n  let nodeLayer;\n  let routeLayer;\n  let depotLinesLayer;\n\n  export function reset() {\n    mapPanel.reset();\n  }\n\n  let bounds = {\n    minX: undefined,\n    maxX: undefined,\n    minY: undefined,\n    maxY: undefined,\n    update: function (x, y) {\n      this.minX = this.minX === undefined ? x : Math.min(this.minX, x);\n      this.minY = this.minY === undefined ? y : Math.min(this.minY, y);\n      this.maxX = this.maxX === undefined ? x : Math.max(this.maxX, x);\n      this.maxY = this.maxY === undefined ? y : Math.max(this.maxY, y);\n    },\n    getCenter: function () {\n      return [\n        (this.maxX - this.minX) / 2 + this.minX,\n        (this.maxY - this.minY) / 2 + this.minY + panelHeight,\n      ];\n    },\n    width: function () {\n      return this.maxX - this.minX;\n    },\n    height: function () {\n      return this.maxY - this.minY;\n    },\n  };\n\n  function calculateZoom() {\n    let scale = Math.min(\n      (mapWidth - mapPadding) / bounds.width(),\n      (mapHeight - panelHeight - mapPadding) / bounds.height()\n    );\n    zoom = Math.log2(scale);\n  }\n\n  // Reactive update when instance changes\n  $: {\n    nodes = $instance.nodes.map((node) => {\n      bounds.update(node.x, node.y);\n      return node;\n    });\n    if (nodes.length > 0) {\n      depot = nodes[0];\n      nodes = nodes.slice(1);\n    }\n\n    createDepotLayer();\n    createNodeLayer();\n    resetZoom();\n    redraw();\n  }\n\n  // Reactive update when solution changes\n\n  $: {\n    depotLines = [];\n    routes = $solution.routes.map((route) => {\n      // Create route\n      let routePositions = [];\n      route.forEach((nodeIndex) => {\n        const node = nodes[nodeIndex - 1];\n        routePositions.push([node.x, node.y]);\n      });\n\n      // Create depotLines\n      if (route.length > 0) {\n        const firstNode = nodes[route[0] - 1];\n        const lastNode = nodes[route[route.length - 1] - 1];\n        depotLines.push([\n          [depot.x, depot.y],\n          [firstNode.x, firstNode.y],\n        ]);\n        depotLines.push([\n          [lastNode.x, lastNode.y],\n          [depot.x, depot.y],\n        ]);\n      }\n      return routePositions;\n    });\n    createDepotLinesLayer();\n    createRouteLayer();\n    redraw();\n  }\n\n  let INITIAL_VIEW_STATE = {\n    target: [0, 0],\n    minZoom: -20,\n    maxZoom: 20,\n    zoom,\n  };\n\n  function resetZoom() {\n    calculateZoom();\n    if (deck) {\n      deck.setProps({\n        initialViewState: {\n          ...INITIAL_VIEW_STATE,\n          zoom,\n          target: bounds.getCenter(),\n        },\n      });\n    }\n  }\n\n  function onChange({ viewState }) {\n    deck.setProps({\n      initialViewState: viewState,\n    });\n    return viewState;\n  }\n\n  function createNodeLayer() {\n    nodeLayer = new ScatterplotLayer({\n      id: \"nodeLayer\",\n      data: nodes,\n      radiusMinPixels: 2,\n      radiusMaxPixels: 64,\n      getFillColor: [250, 250, 250],\n      getPosition: (d) => [d.x, d.y],\n      getRadius: 5,\n      pickable: true,\n    });\n  }\n\n  function createRouteLayer() {\n    routeLayer = new PathLayer({\n      id: \"routeLayer\",\n      data: routes,\n      jointRounded: true,\n      getPath: (d) => d,\n      getColor: [200, 200, 200],\n      getWidth: 3,\n      widthMinPixels: 2,\n      widthMaxPixels: 32,\n    });\n  }\n\n  function createDepotLayer() {\n    depotLayer = new ScatterplotLayer({\n      id: \"depotLayer\",\n      data: depot === undefined ? [] : [depot],\n      radiusMinPixels: 4,\n      radiusMaxPixels: 128,\n      getFillColor: [255, 0, 0],\n      getPosition: (d) => [d.x, d.y],\n      getRadius: 8,\n      pickable: true,\n    });\n  }\n\n  function createDepotLinesLayer() {\n    depotLinesLayer = new PathLayer({\n      id: \"depotLinesLayer\",\n      data: depotLines,\n      jointRounded: true,\n      getPath: (d) => d,\n      getColor: [200, 200, 200, 64],\n      getWidth: 3,\n      widthMinPixels: 2,\n      widthMaxPixels: 32,\n    });\n  }\n\n  function setupDeck() {\n    deck = new Deck({\n      canvas: mapCanvas,\n      views: new OrthographicView({\n        flipY: false,\n      }),\n      onViewStateChange: onChange,\n      initialViewState: INITIAL_VIEW_STATE,\n      controller: true,\n      layers: [depotLinesLayer, routeLayer, nodeLayer, depotLayer],\n      getTooltip: ({ object }) =>\n        object && {\n          html: `\n            <p style=\"margin-bottom: 0px;\">Node: ${object.id}</p>\n            <p style=\"margin-bottom: 0px;\">Demand: ${object.demand}</p>\n            <p style=\"margin-bottom: 0px;\">Position: (${object.x}, ${object.y})</p>\n          `,\n          style: {\n            backgroundColor: \"#f0f6fc\",\n            fontSize: \"1em\",\n            color: \"#161b22\",\n            borderRadius: \"5px\",\n          },\n        },\n    });\n    window.map = deck;\n  }\n\n  function redraw() {\n    if (deck) {\n      deck.setProps({\n        layers: [depotLinesLayer, routeLayer, nodeLayer, depotLayer],\n      });\n    }\n  }\n\n  onMount(async () => {\n    setupDeck();\n  });\n</script>\n\n<div>\n  <div\n    bind:clientWidth={mapWidth}\n    bind:clientHeight={mapHeight}\n    id=\"map-container\"\n  >\n    <canvas bind:this={mapCanvas} />\n    <MapPanel bind:this={mapPanel} resetZoomHandler={resetZoom} />\n  </div>\n</div>\n\n<style>\n  #map-container {\n    position: relative;\n    margin: 0 auto;\n    width: 100%;\n    height: 80vh;\n    border-radius: 10px;\n    background-color: var(--secondary-color);\n  }\n</style>\n","<nav>\n  <img src=\"./icons/truck-icon.png\" width=\"30\" height=\"30\" alt=\"\" />\n  <h1>HybridCVRP</h1>\n  <img src=\"./icons/truck-icon.png\" width=\"30\" height=\"30\" alt=\"\" />\n</nav>\n\n<style>\n  nav {\n    background-color: var(--secondary-color);\n    color: var(--text-color);\n    padding: 10px 20px 15px;\n    display: flex;\n    align-items: center;\n  }\n\n  nav h1 {\n    display: inline;\n    margin: 0px 10px;\n  }\n\n  nav img:nth-child(3) {\n    transform: rotateY(180deg);\n  }\n</style>\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"24\"\n  height=\"24\"\n  viewBox=\"0 0 16 16\"\n>\n  <path\n    d=\"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z\"\n  />\n  <path\n    d=\"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z\"\n  />\n</svg>\n\n<style>\n  svg {\n    fill: var(--secondary-color);\n  }\n</style>\n","// Polyfill for replaceAll\nif (!String.prototype.replaceAll) {\n  String.prototype.replaceAll = function (str, newStr) {\n\n    // If a regex pattern\n    if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {\n      return this.replace(str, newStr);\n    }\n\n    // If a string\n    return this.replace(new RegExp(str, 'g'), newStr);\n\n  };\n}\n\n\nfunction parseInstance(text) {\n\n  function parseProperty(line) {\n    const values = line.split(\":\")\n    return {\n      \"key\": values[0].trim().toLowerCase(),\n      \"value\": values[1].trim(),\n    }\n  }\n\n  function parseNode(line) {\n    const values = line.split(\" \")\n    return {\n      \"id\": parseInt(values[0].trim()),\n      \"x\": parseInt(values[1].trim()),\n      \"y\": parseInt(values[2].trim()),\n    }\n  }\n\n  function parseDemand(line) {\n    const values = line.split(\" \")\n    return parseInt(values[1].trim());\n  }\n\n  let lines = text.replaceAll(\"\\t\", \" \").split(\"\\r\\n\");\n  let lineNumber = 0;\n  let instance = {\n    \"property\": {},\n    \"nodes\": [],\n  }\n\n  while (lineNumber < lines.length) {\n    if (lines[lineNumber].includes(\":\")) {\n      const prop = parseProperty(lines[lineNumber]);\n      if (prop.key == \"dimension\" || prop.key == \"capacity\") {\n        prop.value = parseInt(prop.value);\n      }\n      instance.property[prop.key] = prop.value;\n      lineNumber++;\n    } else if (lines[lineNumber].startsWith(\"NODE_COORD_SECTION\")) {\n      lineNumber++;\n      for (let i = 0; i < instance.property.dimension; i++) {\n        instance.nodes.push(parseNode(lines[lineNumber]));\n        lineNumber++;\n      }\n    } else if (lines[lineNumber].startsWith(\"DEMAND_SECTION\")) {\n      lineNumber++;\n      for (let i = 0; i < instance.property.dimension; i++) {\n        instance.nodes[i][\"demand\"] = parseDemand(lines[lineNumber]);\n        lineNumber++;\n      }\n    } else {\n      lineNumber++\n    }\n  }\n  return instance;\n}\n\nexport async function fetchInstance(instanceName) {\n\n  if (instances.includes(instanceName)) {\n    let filename = `${instanceName}.vrp`;\n\n    let instance = await fetch(`instances/${filename}`)\n      .then(response => response.text())\n      .then(text => parseInstance(text));\n    instance.bks = BKS[instanceName];\n    return instance;\n  }\n}\n\nfunction parseSolution(text) {\n  let lines = text.replaceAll(\"\\t\", \" \").split(\"\\n\");\n  let solution = {\n    routes: [],\n    cost: undefined,\n  }\n\n  lines.forEach(line => {\n    if (line.startsWith(\"Route\")) {\n      let route = [];\n      const stops = line.split(\":\");\n      stops[1].trim().split(\" \").forEach(stop => {\n        route.push(parseInt(stop));\n      });\n      solution.routes.push(route);\n    } else if (line.startsWith(\"Cost\")) {\n      solution.cost = parseInt(line.split(\" \")[1]);\n    }\n  });\n\n  return solution;\n}\n\nexport function fetchSolution(instance) {\n\n  if (instances.includes(instance)) {\n    let filename = `${instance}.sol`;\n\n    return fetch(`instances/${filename}`)\n      .then(response => response.text())\n      .then(text => parseSolution(text));\n  }\n}\n\nexport const instances = [\n  \"X-n101-k25\",\n  \"X-n106-k14\",\n  \"X-n110-k13\",\n  \"X-n115-k10\",\n  \"X-n120-k6\",\n  \"X-n125-k30\",\n  \"X-n129-k18\",\n  \"X-n134-k13\",\n  \"X-n139-k10\",\n  \"X-n143-k7\",\n  \"X-n148-k46\",\n  \"X-n153-k22\",\n  \"X-n157-k13\",\n  \"X-n162-k11\",\n  \"X-n167-k10\",\n  \"X-n172-k51\",\n  \"X-n176-k26\",\n  \"X-n181-k23\",\n  \"X-n186-k15\",\n  \"X-n190-k8\",\n  \"X-n195-k51\",\n  \"X-n200-k36\",\n  \"X-n204-k19\",\n  \"X-n209-k16\",\n  \"X-n214-k11\",\n  \"X-n219-k73\",\n  \"X-n223-k34\",\n  \"X-n228-k23\",\n  \"X-n233-k16\",\n  \"X-n237-k14\",\n  \"X-n242-k48\",\n  \"X-n247-k50\",\n  \"X-n251-k28\",\n  \"X-n256-k16\",\n  \"X-n261-k13\",\n  \"X-n266-k58\",\n  \"X-n270-k35\",\n  \"X-n275-k28\",\n  \"X-n280-k17\",\n  \"X-n284-k15\",\n  \"X-n289-k60\",\n  \"X-n294-k50\",\n  \"X-n298-k31\",\n  \"X-n303-k21\",\n  \"X-n308-k13\",\n  \"X-n313-k71\",\n  \"X-n317-k53\",\n  \"X-n322-k28\",\n  \"X-n327-k20\",\n  \"X-n331-k15\",\n  \"X-n336-k84\",\n  \"X-n344-k43\",\n  \"X-n351-k40\",\n  \"X-n359-k29\",\n  \"X-n367-k17\",\n  \"X-n376-k94\",\n  \"X-n384-k52\",\n  \"X-n393-k38\",\n  \"X-n401-k29\",\n  \"X-n411-k19\",\n  \"X-n420-k130\",\n  \"X-n429-k61\",\n  \"X-n439-k37\",\n  \"X-n449-k29\",\n  \"X-n459-k26\",\n  \"X-n469-k138\",\n  \"X-n480-k70\",\n  \"X-n491-k59\",\n  \"X-n502-k39\",\n  \"X-n513-k21\",\n  \"X-n524-k153\",\n  \"X-n536-k96\",\n  \"X-n548-k50\",\n  \"X-n561-k42\",\n  \"X-n573-k30\",\n  \"X-n586-k159\",\n  \"X-n599-k92\",\n  \"X-n613-k62\",\n  \"X-n627-k43\",\n  \"X-n641-k35\",\n  \"X-n655-k131\",\n  \"X-n670-k130\",\n  \"X-n685-k75\",\n  \"X-n701-k44\",\n  \"X-n716-k35\",\n  \"X-n733-k159\",\n  \"X-n749-k98\",\n  \"X-n766-k71\",\n  \"X-n783-k48\",\n  \"X-n801-k40\",\n  \"X-n819-k171\",\n  \"X-n837-k142\",\n  \"X-n856-k95\",\n  \"X-n876-k59\",\n  \"X-n895-k37\",\n  \"X-n916-k207\",\n  \"X-n936-k151\",\n  \"X-n957-k87\",\n  \"X-n979-k58\",\n  \"X-n1001-k43\",\n];\n\nconst BKS = {\n  \"X-n101-k25\": 27591,\n  \"X-n106-k14\": 26362,\n  \"X-n110-k13\": 14971,\n  \"X-n115-k10\": 12747,\n  \"X-n120-k6\": 13332,\n  \"X-n125-k30\": 55539,\n  \"X-n129-k18\": 28940,\n  \"X-n134-k13\": 10916,\n  \"X-n139-k10\": 13590,\n  \"X-n143-k7\": 15700,\n  \"X-n148-k46\": 43448,\n  \"X-n153-k22\": 21220,\n  \"X-n157-k13\": 16876,\n  \"X-n162-k11\": 14138,\n  \"X-n167-k10\": 20557,\n  \"X-n172-k51\": 45607,\n  \"X-n176-k26\": 47812,\n  \"X-n181-k23\": 25569,\n  \"X-n186-k15\": 24145,\n  \"X-n190-k8\": 16980,\n  \"X-n195-k51\": 44225,\n  \"X-n200-k36\": 58578,\n  \"X-n204-k19\": 19565,\n  \"X-n209-k16\": 30656,\n  \"X-n214-k11\": 10856,\n  \"X-n219-k73\": 117595,\n  \"X-n223-k34\": 40437,\n  \"X-n228-k23\": 25742,\n  \"X-n233-k16\": 19230,\n  \"X-n237-k14\": 27042,\n  \"X-n242-k48\": 82751,\n  \"X-n247-k50\": 37274,\n  \"X-n251-k28\": 38684,\n  \"X-n256-k16\": 18839,\n  \"X-n261-k13\": 26558,\n  \"X-n266-k58\": 75478,\n  \"X-n270-k35\": 35291,\n  \"X-n275-k28\": 21245,\n  \"X-n280-k17\": 33503,\n  \"X-n284-k15\": 20215,\n  \"X-n289-k60\": 95151,\n  \"X-n294-k50\": 47161,\n  \"X-n298-k31\": 34231,\n  \"X-n303-k21\": 21736,\n  \"X-n308-k13\": 25859,\n  \"X-n313-k71\": 94043,\n  \"X-n317-k53\": 78355,\n  \"X-n322-k28\": 29834,\n  \"X-n327-k20\": 27532,\n  \"X-n331-k15\": 31102,\n  \"X-n336-k84\": 139111,\n  \"X-n344-k43\": 42050,\n  \"X-n351-k40\": 25896,\n  \"X-n359-k29\": 51505,\n  \"X-n367-k17\": 22814,\n  \"X-n376-k94\": 147713,\n  \"X-n384-k52\": 65928,\n  \"X-n393-k38\": 38260,\n  \"X-n401-k29\": 66154,\n  \"X-n411-k19\": 19712,\n  \"X-n420-k130\": 107798,\n  \"X-n429-k61\": 65449,\n  \"X-n439-k37\": 36391,\n  \"X-n449-k29\": 55233,\n  \"X-n459-k26\": 24139,\n  \"X-n469-k138\": 221824,\n  \"X-n480-k70\": 89449,\n  \"X-n491-k59\": 66483,\n  \"X-n502-k39\": 69226,\n  \"X-n513-k21\": 24201,\n  \"X-n524-k153\": 154593,\n  \"X-n536-k96\": 94846,\n  \"X-n548-k50\": 86700,\n  \"X-n561-k42\": 42717,\n  \"X-n573-k30\": 50673,\n  \"X-n586-k159\": 190316,\n  \"X-n599-k92\": 108451,\n  \"X-n613-k62\": 59535,\n  \"X-n627-k43\": 62164,\n  \"X-n641-k35\": 63682,\n  \"X-n655-k131\": 106780,\n  \"X-n670-k130\": 146332,\n  \"X-n685-k75\": 68205,\n  \"X-n701-k44\": 81923,\n  \"X-n716-k35\": 43373,\n  \"X-n733-k159\": 136187,\n  \"X-n749-k98\": 77269,\n  \"X-n766-k71\": 114417,\n  \"X-n783-k48\": 72386,\n  \"X-n801-k40\": 73305,\n  \"X-n819-k171\": 158121,\n  \"X-n837-k142\": 193737,\n  \"X-n856-k95\": 88965,\n  \"X-n876-k59\": 99299,\n  \"X-n895-k37\": 53860,\n  \"X-n916-k207\": 329179,\n  \"X-n936-k151\": 132715,\n  \"X-n957-k87\": 85465,\n  \"X-n979-k58\": 118976,\n  \"X-n1001-k43\": 72355,\n};","<script>\n  import { instances, fetchInstance, fetchSolution } from \"../instances\";\n  import { instance, solution, state, time } from \"../stores\";\n\n  let selectedInstanceName;\n\n  export async function loadInstance() {\n    const fetchedInstance = await fetchInstance(selectedInstanceName);\n    state.set({\n      loaded: false,\n      reset: true,\n    });\n    instance.set(fetchedInstance);\n  }\n</script>\n\n<select\n  bind:value={selectedInstanceName}\n  on:change={loadInstance}\n  class=\"form-select\"\n  id=\"problemInstance\"\n>\n  <option selected disabled>Please select instance</option>\n  {#each instances as instance}\n    <option value={instance}>{instance}</option>\n  {/each}\n</select>\n\n<style>\n  select {\n    flex-grow: 1;\n  }\n  .form-select {\n    width: auto;\n    margin-right: 10px;\n  }\n</style>\n","<script>\n  import { config, state } from \"../stores\";\n\n  let show = false;\n  let currentConfig = { ...$config };\n  let isInvalid = {};\n\n  export function toggle() {\n    show = !show;\n  }\n\n  export function hide() {\n    show = false;\n  }\n\n  function onSave() {\n    // Check if all config values are valid\n    let invalid = false;\n    for (const prop in isInvalid) {\n      if (isInvalid[prop]) {\n        invalid = true;\n      }\n    }\n\n    if (!invalid) {\n      $config = { ...currentConfig };\n      hide();\n      dispatchReset();\n    }\n  }\n\n  function dispatchReset() {\n    state.set({\n      ...$state,\n      updateConfig: true,\n      reset: true,\n    });\n  }\n\n  function onCancel() {\n    // Reset current config\n    currentConfig = { ...$config };\n    hide();\n  }\n\n  $: {\n    // Validate initialIndividuals\n    isInvalid.initialIndividuals =\n      typeof currentConfig.initialIndividuals != \"number\" ||\n      !Number.isInteger(currentConfig.initialIndividuals) ||\n      currentConfig.initialIndividuals <= 0;\n\n    // Validate minimumPopulationSize\n    isInvalid.minimumPopulationSize =\n      typeof currentConfig.minimumPopulationSize != \"number\" ||\n      !Number.isInteger(currentConfig.minimumPopulationSize) ||\n      currentConfig.minimumPopulationSize <= 0;\n\n    // Validate generationSize\n    isInvalid.generationSize =\n      typeof currentConfig.generationSize != \"number\" ||\n      !Number.isInteger(currentConfig.generationSize) ||\n      currentConfig.generationSize <= 0;\n\n    // Validate localSearchGranularity\n    isInvalid.localSearchGranularity =\n      typeof currentConfig.localSearchGranularity != \"number\" ||\n      !Number.isInteger(currentConfig.localSearchGranularity) ||\n      currentConfig.localSearchGranularity <= 0;\n\n    // Validate numberOfElites\n    isInvalid.numberOfElites =\n      typeof currentConfig.numberOfElites != \"number\" ||\n      !Number.isInteger(currentConfig.numberOfElites) ||\n      currentConfig.numberOfElites <= 0;\n\n    // Validate feasibilityProportionTarget\n    isInvalid.feasibilityProportionTarget =\n      typeof currentConfig.feasibilityProportionTarget != \"number\" ||\n      currentConfig.feasibilityProportionTarget < 0.0 ||\n      currentConfig.feasibilityProportionTarget > 1.0;\n\n    // Validate RRStartTemp\n    isInvalid.RRStartTemp =\n      typeof currentConfig.RRStartTemp != \"number\" ||\n      currentConfig.RRStartTemp < 1.0;\n\n    // Validate RRGamma\n    isInvalid.RRGamma =\n      typeof currentConfig.RRGamma != \"number\" || currentConfig.RRGamma < 0.0;\n\n    // Validate eliteStartTemp\n    isInvalid.eliteStartTemp =\n      typeof currentConfig.eliteStartTemp != \"number\" ||\n      currentConfig.eliteStartTemp < 1.0;\n\n    // Validate eliteGamma\n    isInvalid.eliteGamma =\n      typeof currentConfig.eliteGamma != \"number\" ||\n      currentConfig.eliteGamma < 0.0;\n  }\n</script>\n\n<div class=\"collapse content\" class:show>\n  <h3>Config</h3>\n  <form>\n    <div class=\"form-row row\">\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"initial-individual-input\">\n          Initial Individuals\n        </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"initial-individuals-input\"\n          bind:value={currentConfig.initialIndividuals}\n          class:is-invalid={isInvalid.initialIndividuals}\n        />\n        <div class=\"invalid-feedback\">Value must be positive integer.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"minimum-population-size-input\"\n          >Minimum Population Size</label\n        >\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"minimum-population-size-input\"\n          bind:value={currentConfig.minimumPopulationSize}\n          class:is-invalid={isInvalid.minimumPopulationSize}\n        />\n        <div class=\"invalid-feedback\">Value must be positive integer.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"generation-size-input\">\n          Generation Size\n        </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"generation-size-input\"\n          bind:value={currentConfig.generationSize}\n          class:is-invalid={isInvalid.generationSize}\n        />\n        <div class=\"invalid-feedback\">Value must be positive integer.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"local-search-granularity-input\">\n          Local Search Granularity\n        </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"local-search-granularity-input\"\n          bind:value={currentConfig.localSearchGranularity}\n          class:is-invalid={isInvalid.localSearchGranularity}\n        />\n        <div class=\"invalid-feedback\">Value must be positive integer.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"number-elites-input\">\n          Number of Elites\n        </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"number-of-elites-input\"\n          bind:value={currentConfig.numberOfElites}\n          class:is-invalid={isInvalid.numberOfElites}\n        />\n        <div class=\"invalid-feedback\">Value must be positive integer.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"feasibility-proportion-target-input\">\n          Feasibility Proportion Target\n        </label>\n        <input\n          type=\"number\"\n          step=\"0.01\"\n          max=\"1.0\"\n          min=\"0.0\"\n          class=\"form-control\"\n          id=\"feasibility-proportion-target-input\"\n          bind:value={currentConfig.feasibilityProportionTarget}\n          class:is-invalid={isInvalid.feasibilityProportionTarget}\n        />\n        <div class=\"invalid-feedback\">\n          Value must be float between 0.0 and 1.0.\n        </div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"rr-start-temp-input\">\n          R&R Start Temperature\n        </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"rr-start-temp-input\"\n          bind:value={currentConfig.RRStartTemp}\n          class:is-invalid={isInvalid.RRStartTemp}\n        />\n        <div class=\"invalid-feedback\">Value must be number >= 1.0.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"rr-gamma-input\"> R&R Gamma </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          step=\"0.1\"\n          min=\"0.0\"\n          id=\"rr-gamma-input\"\n          bind:value={currentConfig.RRGamma}\n          class:is-invalid={isInvalid.RRGamma}\n        />\n        <div class=\"invalid-feedback\">Value must be non-negative number.</div>\n      </div>\n      <div class=\"form-group extra-top-margin\">\n        <div class=\"form-check form-switch\">\n          <label class=\"form-check-label\" for=\"elite-education-input\"\n            >Elite Education</label\n          >\n          <input\n            class=\"form-check-input\"\n            type=\"checkbox\"\n            id=\"elite-education-input\"\n            bind:checked={currentConfig.eliteEducation}\n          />\n        </div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"elite-start-temp-input\">\n          Elite Education Start Temperature\n        </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"elite-start-temp-input\"\n          bind:value={currentConfig.eliteStartTemp}\n          class:is-invalid={isInvalid.eliteStartTemp}\n        />\n        <div class=\"invalid-feedback\">Value must be number >= 1.0.</div>\n      </div>\n      <div class=\"form-group col-md-6\">\n        <label class=\"form-label\" for=\"elite-gamma-input\">Elite Gamma </label>\n        <input\n          type=\"number\"\n          class=\"form-control\"\n          id=\"elite-gamma-input\"\n          bind:value={currentConfig.eliteGamma}\n          class:is-invalid={isInvalid.eliteGamma}\n        />\n        <div class=\"invalid-feedback\">Value must be non-negative number.</div>\n      </div>\n    </div>\n    <div class=\"form-buttons\">\n      <button type=\"button\" class=\"btn btn-light\" on:click={onCancel}\n        >Cancel\n      </button>\n      <button type=\"button\" class=\"btn btn-light\" on:click={onSave}>Save</button\n      >\n    </div>\n  </form>\n</div>\n\n<style>\n  .form-group label {\n    color: var(--text-color);\n    padding-top: 10px;\n  }\n\n  h3 {\n    color: var(--text-color);\n    margin-bottom: 0;\n  }\n\n  .collapse.content {\n    margin-top: 10px;\n  }\n\n  .form-buttons {\n    width: 100%;\n    display: flex;\n    justify-content: flex-end;\n  }\n\n  .form-buttons button {\n    margin-top: 20px;\n    margin-left: 10px;\n  }\n\n  .form-check-input {\n    margin-top: 16px;\n    margin-left: 5px;\n    float: none;\n  }\n  .form-check {\n    padding-left: 0;\n  }\n\n  .extra-top-margin {\n    margin-top: 20px;\n  }\n</style>\n","<script>\n  import { config, instance, solution, state, time } from \"../stores\";\n\n  import Map from \"./components/map/Map.svelte\";\n  import Navbar from \"./components/Navbar.svelte\";\n  import GearIcon from \"./components/icons/GearIcon.svelte\";\n  import InstanceSelector from \"./components/InstanceSelector.svelte\";\n  import ConfigForm from \"./components/ConfigForm.svelte\";\n\n  import { onMount } from \"svelte\";\n\n  let worker;\n  let configForm;\n  let map;\n\n  onMount(() => {\n    worker = new Worker(\"./worker.js\");\n    worker.onmessage = function (msg) {\n      if (msg.data.type === \"LOAD_COMPLETE\") {\n        $state.loaded = true;\n      } else if (msg.data.type === \"ITERATION_COMPLETE\") {\n        const value = msg.data.value;\n        if (value !== null) {\n          $solution = value;\n        }\n        if ($state.running) {\n          worker.postMessage({ type: \"ITERATE\" });\n        }\n      } else if (msg.data.type === \"CONFIG_UPDATED\") {\n      }\n    };\n    worker.postMessage({ type: \"UPDATE_CONFIG\", value: $config });\n  });\n\n  $: {\n    if (worker && $instance.nodes.length > 0) {\n      worker.postMessage({ type: \"LOAD_INSTANCE\", value: $instance });\n    }\n  }\n\n  $: {\n    if (worker && $state.running) {\n      worker.postMessage({ type: \"ITERATE\" });\n    }\n  }\n\n  // Reset\n  $: {\n    if (worker && $state.reset) {\n      solution.set({\n        routes: [],\n        cost: null,\n      });\n      state.set({\n        ...$state,\n        reset: false,\n        running: false,\n        loaded: false,\n      });\n      time.set(0.0);\n      configForm.hide();\n      map.reset();\n      $instance = $instance;\n    }\n  }\n\n  $: {\n    if (worker && $state.updateConfig) {\n      state.set({\n        ...$state,\n        updateConfig: false,\n        running: false,\n      });\n      worker.postMessage({ type: \"UPDATE_CONFIG\", value: $config });\n    }\n  }\n</script>\n\n<main>\n  <Navbar />\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-lg-6\">\n        <div class=\"content\">\n          <div class=\"flex-row\">\n            <InstanceSelector />\n            <button\n              class=\"btn btn-light small-btn\"\n              type=\"button\"\n              on:click={configForm.toggle}\n            >\n              <GearIcon />\n            </button>\n          </div>\n          <ConfigForm bind:this={configForm} />\n        </div>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"content\">\n        <Map bind:this={map} />\n      </div>\n    </div>\n  </div>\n</main>\n\n<style>\n  .container {\n    margin-top: 10px;\n  }\n  @media (min-width: 576px) {\n    .container {\n      margin-top: 20px;\n    }\n  }\n\n  .col-lg-6 {\n    padding: 0;\n  }\n\n  button {\n    padding: 6px;\n    display: flex;\n    align-items: center;\n  }\n  .flex-row {\n    display: flex;\n    align-items: flex-end;\n    flex-direction: row;\n    flex-wrap: wrap;\n  }\n</style>\n","import App from './App.svelte';\n\nconst init = async () => {\n  new App({\n    target: document.body\n  });\n};\n\ninit();"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","component_subscribe","component","store","callback","$$","on_destroy","push","callbacks","unsub","subscribe","unsubscribe","set_store_value","ret","value","set","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","element","name","document","createElement","svg_element","createElementNS","text","data","createTextNode","space","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","to_number","set_data","wholeText","set_input_value","input","select_option","select","i","length","option","__value","selected","crossorigin","current_component","is_crossorigin","undefined","window","parent","error","toggle_class","toggle","classList","set_current_component","onMount","Error","get_current_component","on_mount","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","flushing","seen_callbacks","Set","flush","update","pop","has","add","clear","fragment","before_update","dirty","p","ctx","after_update","outroing","transition_in","block","local","delete","transition_out","o","outros","c","d","create_component","mount_component","customElement","m","new_on_destroy","map","filter","destroy_component","detaching","make_dirty","then","fill","init","instance","create_fragment","not_equal","props","append_styles","parent_component","bound","on_disconnect","context","Map","skip_bound","root","ready","rest","hydrate","nodes","Array","from","childNodes","children","l","intro","SvelteComponent","$destroy","this","$on","type","index","indexOf","splice","$set","$$props","obj","$$set","keys","subscriber_queue","writable","start","stop","subscribers","new_value","run_queue","subscriber","invalidate","size","property","solution","routes","cost","config","initialIndividuals","minimumPopulationSize","generationSize","localSearchGranularity","numberOfElites","feasibilityProportionTarget","RRGamma","RRStartTemp","eliteStartTemp","eliteGamma","eliteEducation","time","state","loaded","running","reset","updateConfig","assert","condition","message","globals","self","global","global_","isBrowser","process","String","browser","matches","version","exec","parseFloat","isMobile","orientation","_defineProperty","key","defineProperty","enumerable","configurable","WorkerJob","constructor","jobName","workerThread","isRunning","_resolve","_reject","result","reject","postMessage","payload","source","done","workerURLCache","getLoadableWorkerURL","url","workerURL","get","startsWith","getLoadableWorkerURLFromSource","workerUrl","getLoadableWorkerURLFromURL","workerSource","blob","Blob","URL","createObjectURL","getTransferList","object","recursive","transfers","transfersSet","isTransferable","buffer","ArrayBuffer","isView","MessagePort","ImageBitmap","OffscreenCanvas","NOOP","WorkerThread","isSupported","Worker","onMessage","onError","console","log","worker","_createBrowserWorker","destroy","terminate","terminated","Boolean","transferList","_getErrorFromErrorEvent","lineno","colno","_loadableURL","onmessage","onerror","onmessageerror","WorkerPool","setProps","idleQueue","isDestroyed","maxConcurrency","maxMobileConcurrency","reuseWorkers","onDebug","startJob","job","startPromise","onStart","jobQueue","_startQueuedJob","_getAvailableWorker","queuedJob","shift","backlog","returnWorkerToQueue","count","_getMaxConcurrency","toLowerCase","DEFAULT_PROPS","WorkerFarm","getWorkerFarm","_workerFarm","workerPools","workerPool","values","_getWorkerPoolProps","getWorkerPool","async","parseWithWorker","loader","parseOnMainThread","id","workerOptions","workerFile","_workerType","module","versionTag","getWorkerURL","JSON","parse","stringify","bind","warn","toArrayBuffer","TextEncoder","encode","_toArrayBuffer","concatenateArrayBuffersAsync","asyncIterator","arrayBuffers","chunk","sources","sourceArrays","source2","Uint8Array","byteLength","reduce","typedArray","offset","sourceArray","concatenateArrayBuffers","getHiResTimestamp","timestamp","performance","now","hrtime","timeParts","Date","Stat","sampleSize","setSampleSize","samples","incrementCount","addCount","decrementCount","subtractCount","_count","_samples","_checkSampling","addTime","_time","lastTiming","timeStart","_startTime","_timerPending","timeEnd","getSampleAverageCount","lastSampleCount","getSampleAverageTime","lastSampleTime","getSampleHz","getAverageCount","getAverageTime","getHz","Stats","stats","_initializeStats","seal","_getOrCreate","getTable","table","stat","average","hz","fileAliases","isFunction","x","isObject","isPureObject","isResponse","Response","arrayBuffer","json","isBlob","isReadableStream","ReadableStream","tee","cancel","getReader","isReadableDOMStream","read","pipe","isBoolean","readable","isReadableNodeStream","DATA_URL_PATTERN","MIME_TYPE_PATTERN","parseMIMEType","mimeString","parseMIMETypeFromURL","QUERY_STRING_PATTERN","getResourceUrlAndType","resource","stripQueryString","headers","replace","makeResponse","contentLength","getResourceContentLength","initialDataUrl","INITIAL_DATA_LENGTH","slice","blobSlice","reader","FileReader","onload","_event$target","readAsDataURL","binary","bytes","fromCharCode","btoa","arrayBufferToBase64","getInitialDataUrl","response","fetchFile","filename","alias","replacement","resolvePath","fetchOptions","fetch","isElectron","mockUserAgent","versions","electron","realUserAgent","navigator","userAgent","window_","process_","VERSION","__VERSION__","checkIfBrowser","LocalStorage","defaultSettings","storage","setItem","removeItem","e","getStorage","assign","_loadConfiguration","getConfiguration","setConfiguration","configuration","updateConfiguration","serialized","serializedConfiguration","getItem","formatImage","image","scale","maxWidth","imageUrl","src","width","Math","min","height","style","concat","floor","join","COLOR","BLACK","RED","GREEN","YELLOW","BLUE","MAGENTA","CYAN","WHITE","BRIGHT_BLACK","BRIGHT_RED","BRIGHT_GREEN","BRIGHT_YELLOW","BRIGHT_BLUE","BRIGHT_MAGENTA","BRIGHT_CYAN","BRIGHT_WHITE","getColor","color","toUpperCase","originalConsole","debug","info","DEFAULT_SETTINGS","enabled","level","cache","ONCE","once","getTableHeader","title","Log","_startTs","_deltaTs","LOG_THROTTLE_TIMEOUT","_storage","userData","timeStamp","predefined","proto","getPrototypeOf","propNames","getOwnPropertyNames","find","autobind","newLevel","setLevel","getLevel","isEnabled","getTotal","Number","toPrecision","getDelta","priority","newPriority","getPriority","enable","_getLogFunction","arguments","deprecated","oldUsage","newUsage","removed","probe","logLevel","columns","tag","_shouldLog","img","Image","args","nodeName","toDataURL","logImageInBrowser","asciify","require","fit","round","logImageInNode","settings","setting","group","opts","collapsed","normalizeArguments","method","groupCollapsed","groupEnd","withGroup","func","trace","normalizeLogLevel","total","delta","string","padLength","max","repeat","leftPad","ms","formatted","toFixed","formatTime","background","decorateMessage","resolvedLevel","isFinite","unshift","messageType","probeLog","NullLog","DEFAULT_LOADER_OPTIONS","mimeType","nothrow","CDN","limit","_limitMB","batchSize","batchDebounceMs","metadata","transforms","REMOVED_LOADER_OPTIONS","throws","dataType","uri","body","mode","credentials","redirect","referrer","referrerPolicy","integrity","keepalive","signal","getGlobalLoaderState","loaders","_state","getGlobalLoaderOptions","globalOptions","normalizeOptions","validateOptionsObject","idOptions","loaderOptions","deprecatedOptions","validateOptions","isArray","mergedOptions","baseUri","addUrlOptions","mergeNestedFields","normalizeOptionsInternal","getFetchFunction","defaultOptions","loaderName","prefix","isSubOptions","isBaseUriOption","isWorkerUrlOption","suggestion","findSimilarOption","optionKey","lowerCaseOptionKey","bestSuggestion","lowerCaseKey","isLoaderObject","_loader","extensions","normalizeLoader","_loader2","_loader3","parseTextSync","parseText","getGlobalLoaderRegistry","loaderRegistry","EXT_PATTERN","selectLoaderSync","validHTTPResponse","candidateLoaders","ignoreRegisteredLoaders","normalizeLoaders","testUrl","findLoaderByMIMEType","match","extension","loaderExtension","findLoaderByExtension","findLoaderByUrl","testDataAgainstText","testDataAgainstBinary","byteOffset","findLoaderByInitialBytes","fallbackMimeType","selectLoaderInternal","getNoValidLoaderMessage","status","getMagicString","getFirstCharacters","mimeTypes","includes","testText","tests","some","test","arrayBuffer1","arrayBuffer2","array1","array2","compareArrayBuffers","testBinary","dataView","DataView","magic","getUint8","DEFAULT_CHUNK_SIZE","makeStreamIterator","stream","nextBatchPromise","currentBatchPromise","_streamReadAhead","releaseLock","makeBrowserStreamIterator","makeNodeStreamIterator","makeIterator","chunkSize","textEncoder","chunkLength","makeStringIterator","chunkByteLength","makeArrayBufferIterator","end","makeBlobIterator","ERR_DATA","getArrayBufferOrStringFromData","isArrayBuffer","isBuffer","TextDecoder","decode","getArrayBufferOrStringFromDataSync","ok","contentType","statusText","getResponseError","checkResponse","Symbol","iterator","isAsyncIterable","contextLoaders","getLoadersFromContext","selectLoader","previousContext","resolvedContext","getLoaderContext","coreVersion","workerVersion","validateWorkerVersion","canParseWithWorker","parseSync","parseWithLoader","load","_parseImageNode","IMAGE_SUPPORTED","IMAGE_BITMAP_SUPPORTED","NODE_IMAGE_SUPPORTED","DATA_SUPPORTED","getImageType","format","getImageTypeOrNull","SVG_DATA_URL_PATTERN","SVG_URL_PATTERN","isSVG","getBlob","parseToImage","blobOrDataUrl","xmlText","getBlobOrSVGDataUrl","webkitURL","objectUrl","err","loadToImage","revokeObjectURL","EMPTY_OBJECT","imagebitmapOptionsSupported","parseToImageBitmap","imagebitmapOptions","imagebitmap","isEmptyObject","createImageBitmap","safeCreateImageBitmap","BIG_ENDIAN","LITTLE_ENDIAN","getBinaryImageMetadata","binaryData","toDataView","getUint32","getPngMetadata","getUint16","tableMarkers","sofMarkers","getJpegMarkers","marker","getJpegMetadata","getGifMetadata","getBmpMetadata","ImageLoader","imageType","getDefaultImageType","isImageTypeSupported","getLoadableImageType","parseToNodeImage","canvas","getContext","drawImage","getImageData","__esModule","default","exports","_typeof","prototype","_typeof2","_interopRequireDefault","require$$0","self_","document_","console_","_isElectron","require$$1","_globals","_isBrowser","navigator_","isMSIE","isTrident","chrome","safari","mozInnerScreenX","isBrowserMainThread","_getBrowser","_interopRequireWildcard","require$$2","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","hasOwnProperty","call","desc","loggers","eventType","deckLog","firstChar","lastChar","existingVersion","deck","_registerLoggers","handlers","normalizedLoader","registeredLoader","registerLoaders","jsonLoader","premultiplyAlpha","isWebGL","gl","WebGLRenderingContext","WebGL2RenderingContext","_version","isWebGL2","assertWebGLContext","assertWebGL2Context","glErrorShadow","synthesizeGLError","opt_msg","msg","WebGLVertexArrayObjectOES","ext","isAlive","hasBeenBound","elementArrayBuffer","attribs","maxVertexAttribs","n","attrib","VertexAttrib","maxAttrib","normalized","stride","cached","recache","OESVertexArrayObject","f","getError","apply","parseInt","wrapGLError","original","getParameter","enableVertexAttribArray","disableVertexAttribArray","bindBuffer","getVertexAttrib","vertexAttribPointer","pname","VERTEX_ARRAY_BINDING_OES","currentVertexArrayObject","defaultVertexArrayObject","vao","currentArrayBuffer","indx","instrumentExtension","reset_","vertexArrayObjects","ii","bindVertexArrayOES","createVertexArrayOES","arrayObject","deleteVertexArrayOES","isVertexArrayOES","oldVAO","newVAO","currentBinding","oldAttrib","bufferChanged","OES_element_index","WEBGL_draw_buffers","WEBGL_debug_renderer_info","getWebGL2ValueOrZero","WEBGL_PARAMETERS","getExtension","GPU_DISJOINT_EXT","UNMASKED_VENDOR_WEBGL","UNMASKED_RENDERER_WEBGL","luma","MAX_TEXTURE_MAX_ANISOTROPY_EXT","MAX_COLOR_ATTACHMENTS_WEBGL","MAX_DRAW_BUFFERS_WEBGL","ANGLE_instanced_arrays","WEBGL2_CONTEXT_POLYFILLS","OES_vertex_array_object","meta","suffix","createVertexArray","deleteVertexArray","bindVertexArray","isVertexArray","vertexAttribDivisor","location","divisor","drawElementsInstanced","drawArraysInstanced","drawBuffers","EXT_disjoint_timer_query","createQuery","deleteQuery","beginQuery","endQuery","getQuery","handle","getQueryObject","getQueryParameter","WEBGL2_CONTEXT_OVERRIDES","readBuffer","originalFunc","attachment","webgl2","getExtensionData","getProgramParameter","program","getInternalformatParameter","Int32Array","getTexParameter","TEXTURE_MAX_ANISOTROPY_EXT","originalGetParameter","hint","polyfillExtension","target2","defaults","extKey","polyfill","polyfillContext","polyfilled","original_getSupportedExtensions","getSupportedExtensions","list","original_getExtension","__OESVertexArrayObject","polyfillVertexArrayObject","EXTENSIONS","initializeExtensions","polyfills","installPolyfills","installOverrides","GL_PARAMETER_DEFAULTS","Float32Array","disable","pixelStorei","array","GL_PARAMETER_SETTERS","blendColor","clearColor","colorMask","cullFace","clearDepth","depthFunc","depthRange","depthMask","bindFramebuffer","frontFace","lineWidth","scissor","clearStencil","stencilMaskSeparate","viewport","framebuffer","blend","blendEquation","blendEquationSeparate","blendFunc","blendFuncSeparate","cull","depthTest","dither","derivativeHint","mipmapHint","polygonOffsetFill","polygonOffset","sampleCoverage","scissorTest","stencilTest","stencilMask","mask","backMask","stencilFunc","ref","backFunc","backRef","stencilFuncSeparate","stencilOp","sfail","dpfail","dppass","backSfail","backDpfail","backDppass","stencilOpSeparate","getValue","glEnum","GL_COMPOSITE_PARAMETER_SETTERS","stencilFuncFront","stencilFuncBack","stencilOpFront","stencilOpBack","GL_HOOKED_SETTERS","capability","r","g","modeRGB","modeAlpha","dst","srcRGB","dstRGB","srcAlpha","dstAlpha","depth","s","zNear","zFar","face","factor","units","invert","y","fail","zfail","zpass","GL_PARAMETER_GETTERS","isObjectEmpty","deepArrayEqual","isArrayX","isArrayY","installGetterOverride","functionName","originalGetterFunc","params","installSetterSpy","setter","originalSetterFunc","valueChanged","oldValue","_updateCache","GLState","copyState","stateStack","parameters","getter","parameterKeys","getParameters","oldValues","setParameters","trackContextState","originalUseProgram","useProgram","installProgramSpy","popContextState","compositeSetters","glConstant","compositeSetter","withParameters","nocatch","pushContextState","cssToDeviceRatio","clientWidth","canvasSizeInfo","drawingBufferWidth","cssToDevicePixels","cssPixel","yInvert","pixel","ratio","scaleX","scaleY","t","xHigh","yHigh","scalePixels","drawingBufferHeight","getIsBrowser","isPage","CONTEXT_DEFAULTS","webgl1","throwOnError","manageState","createGLContext","errorMessage","onCreateError","statusMessage","onContextLost","onContextRestored","createBrowserContext","targetCanvas","readyState","getElementById","firstChild","getCanvas","instrumentGLContext","webGL","vendorMasked","rendererMasked","vendorUnmasked","rendererUnmasked","vendor","renderer","shadingLanguageVersion","getContextDebugInfo","driver","logInfo","_instrumented","getVersion","makeDebugContext","resizeGLContext","devicePixelRatio","clientHeight","cachedSize","clampedPixelRatio","canvasWidth","canvasHeight","setDevicePixelRatio","useDevicePixels","windowRatio","getDevicePixelRatio","resize","lumaStats","cancelAnimationFrame","timerId","clearTimeout","modules","nodeIO","getGLTypeFromTypedArray","arrayOrType","Uint16Array","Uint32Array","Uint8ClampedArray","Int8Array","Int16Array","getTypedArrayFromGLType","glType","clamped","newWidth","newHeight","newData","uidCounters","uid","isPowerOfTwo","isEmpty","formatValue","v","isInteger","maxElts","terminator","formatArrayValue","abs","stubRemovedMethods","className","methodNames","upgradeMessage","methodName","checkProps","propChecks","removedProps","deprecatedProps","replacedProps","propName","replacementProp","newProps","getKeyValue","number","isNaN","getKey","ERR_RESOURCE_METHOD_UNDEFINED","Resource","gl2","_bound","_handle","_createHandle","_addStats","toString","deleteChildren","_deleteHandle","_removeStats","child","funcOrHandle","_bindHandle","unbind","parameter","PARAMETERS","isWebgl2","webgl1Default","webgl2Default","_getParameter","setParameter","_setParameter","initialize","_getOptsFromHandle","_context","_trackAllocatedMemory","_trackDeallocatedMemory","DEFAULT_ACCESSOR_VALUES","integer","PROP_CHECKS","instanced","isInstanced","Accessor","getBytesPerElement","accessor","BYTES_PER_ELEMENT","getBytesPerVertex","accessors","_assign","freeze","BYTES_PER_VERTEX","DEPRECATED_PROPS","PROP_CHECKS_INITIALIZE","PROP_CHECKS_SET_PROPS","Buffer","super","getElementCount","getVertexCount","usage","debugData","setAccessor","_setData","_setByteLength","reallocate","bytesUsed","setData","subData","srcOffset","bufferSubData","_inferType","copyData","sourceBuffer","readOffset","writeOffset","copyBufferSubData","getData","dstData","srcByteOffset","dstOffset","ArrayType","sourceAvailableElementCount","_getAvailableElementCount","dstElementOffset","dstAvailableElementCount","dstElementCount","copyElementCount","getBufferSubData","bindBufferRange","bindBufferBase","getDebugData","changed","invalidateDebugData","_getTarget","bufferData","sourceElementOffset","createBuffer","deleteBuffer","getBufferParameter","setByteLength","updateAccessor","TEXTURE_FORMATS","dataFormat","types","DATA_FORMAT_CHANNELS","TYPE_SIZES","NPOT_MIN_FILTERS","WebGLBuffer","Texture","linearFiltering","supported","gl1","isFormatSupported","isLinearFilteringSupported","textureUnit","border","mipmaps","resolvedImageData","pixels","isVideo","HTMLVideoElement","HAVE_METADATA","_video","recreate","pixelStore","compressed","_deduceParameters","activeTexture","bindTexture","_isNPOT","_updateForNPOT","setImageData","generateMipmap","video","lastTime","HAVE_CURRENT_DATA","currentTime","setSubImageData","_getDataType","texImage2D","levelIndex","levelData","entries","compressedTexImage2D","channels","channelSize","ndarray","shape","compressedTexSubImage2D","texSubImage2D","copyFramebuffer","getActiveUnit","textureFormat","_deduceImageSize","ImageData","HTMLImageElement","naturalWidth","naturalHeight","HTMLCanvasElement","videoWidth","videoHeight","createTexture","deleteTexture","param","_getNPOTParam","texParameterf","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","Texture2D","crossOrigin","FACES","TextureCube","setCubeMapImageData","subImage","mipmapLevel","_subImage","imageDataMap","resolvedFaces","all","facePixels","lodLevel","setImageDataForFace","imageData","Texture3D","unpackFlipY","texImage3D","EXT_FLOAT_WEBGL2","bpp","Renderbuffer","formats","RENDERBUFFER_FORMATS","getSamplesForFormat","bindRenderbuffer","renderbufferStorageMultisample","renderbufferStorage","createRenderbuffer","deleteRenderbuffer","_syncHandle","getRenderbufferParameter","ERR_ARGUMENTS","stencil","clearFlags","readPixelsToArray","sourceX","sourceY","sourceFormat","sourceAttachment","sourceWidth","sourceHeight","sourceType","deleteFramebuffer","Framebuffer","toFramebuffer","getFramebuffer","attachments","pixelArray","components","glFormatToComponents","getPixelArray","prevHandle","readPixels","copyToDataUrl","targetMaxHeight","MAX_SAFE_INTEGER","bytesPerPixel","temp","bytesPerRow","topOffset","bottomOffset","subarray","copyWithin","flipRows","createImageData","putImageData","FEATURES","FEATURES$1_TIMER_QUERY","FEATURES$1_ELEMENT_INDEX_UINT32","testTexture","testFb","check","getStatus","hasFeatures","features","every","feature","isFeatureSupported","cap","caps","WEBGL_FEATURES","featureDefinition","queryFeature","ERR_MULTIPLE_RENDERTARGETS","colorBufferFloat","colorBufferHalfFloat","getDefaultFramebuffer","defaultFramebuffer","MAX_COLOR_ATTACHMENTS","MAX_DRAW_BUFFERS","ownResources","texture","_createDefaultAttachments","clearAttachments","checkStatus","resizeAttachments","attach","_setReadBuffer","_setDrawBuffers","attachmentPoint","newAttachments","descriptor","_attachRenderbuffer","renderbuffer","layer","_attachTexture","_unattach","STATUS","_getFrameBufferStatus","checkFramebufferStatus","drawBuffer","clearBufferiv","clearBufferuiv","clearBufferfv","clearBufferfi","clearBuffer","readPixelsToBuffer","copyToImage","copyToTexture","blit","invalidateFramebuffer","getAttachmentParameter","_getAttachmentParameterFallback","getFramebufferAttachmentParameter","getAttachmentParameters","ATTACHMENT_PARAMETERS","attachmentName","show","open","defaultAttachments","oldAttachment","framebufferRenderbuffer","framebufferTexture2D","framebufferTextureLayer","mapIndexToCubeMapFace","drawBuffersWEBGL","getFeatures","WEBGL2","EXT_sRGB","createFramebuffer","getShaderName","shader","defaultName","parseGLSLCompilerError","errLog","shaderType","shaderName","errorStrings","split","errors","warnings","shaderDescription","getShaderTypeName","errorString","segments","line","lines","delim","maxDigits","lineNumber","digits","padLeft","addLineNumbers","formatErrors","column","substring","trim","getShaderVersion","words","Shader","getTypeName","_compile","getShaderParameter","getName","getSource","getShaderSource","getTranslatedSource","getTranslatedShaderSource","shaderSource","compileShader","infoLog","getShaderInfoLog","deleteShader","VertexShader","createShader","FragmentShader","UNIFORM_SETTERS","getArraySetter","toFloatArray","setVectorUniform","toIntArray","setMatrixUniform","getSamplerSetter","toUIntArray","FLOAT_ARRAY","INT_ARRAY","UINT_ARRAY","toTypedArray","uniformLength","Type","getUniformSetter","parseUniformName","checkUniformValue","checkLength","checkUniformArray","copyUniform","uniforms","dest","len","uniform1i","toArray","uniformSetter","cacheLength","arrayValue","GL_FLOAT","GL_INT","GL_UNSIGNED_INT","COMPOSITE_GL_TYPES","decomposeCompositeGLType","compositeGLType","typeAndSize","getCompositeGLType","compType","compComponents","ProgramConfiguration","attributeInfos","attributeInfosByName","attributeInfosByLocation","varyingInfos","varyingInfosByName","_readAttributesFromProgram","_readVaryingsFromProgram","getAttributeInfo","locationOrName","getAttributeLocation","attributeInfo","getAttributeAccessor","getVaryingInfo","getVaryingIndex","varying","getVaryingAccessor","getActiveAttrib","getAttribLocation","_addAttribute","sort","getTransformFeedbackVarying","_addVarying","compositeType","_inferProperties","GL_SEPARATE_ATTRIBS","V6_DEPRECATED_METHODS","Program","_isCached","_setId","hash","vs","fs","varyings","bufferMode","_textureUniforms","transformFeedbackVaryings","_compileAndLink","_readUniformLocationsFromLinkedProgram","setUniforms","draw","logPriority","drawMode","vertexCount","isIndexed","indexType","instanceCount","vertexArray","transformFeedback","samplers","fb","_areTexturesRenderable","bindForDraw","primitiveMode","getPrimitiveDrawMode","begin","_bindTextures","drawRangeElements","drawElements","drawArrays","uniformMap","uniformName","checkUniformValues","_uniformSetters","uniform","textureUpdate","textureIndex","_textureIndexCounter","texturesRenderable","createProgram","deleteProgram","_getOptionsFromHandle","shaderHandles","getAttachedShaders","shaderHandle","programName","_getName","attachShader","linkProgram","getProgramInfoLog","validateProgram","_uniformCount","getActiveUniform","getUniformLocation","getActiveUniforms","uniformIndices","getUniformBlockIndex","blockName","getActiveUniformBlockParameter","blockIndex","uniformBlockBinding","blockBinding","Query","hasTimerQuery","_queryPending","_pollingPromise","beginTimeElapsedQuery","beginOcclusionQuery","conservative","beginTransformFeedbackQuery","isResultAvailable","resultAvailable","isTimerDisjoint","getResult","getTimerMilliseconds","createPoll","POSITIVE_INFINITY","counter","poll","requestAnimationFrame","TransformFeedback","buffers","unused","bindOnUse","_unbindBuffers","setBuffers","bufferName","setBuffer","bufferOrParams","_getVaryingIndex","byteSize","_getBufferParams","_bindBuffer","bindTransformFeedback","_bindBuffers","beginTransformFeedback","endTransformFeedback","_getVaryingInfo","bufferIndex","createTransformFeedback","deleteTransformFeedback","getScratchArray","VertexArrayObject","constantAttributeZero","getBrowser","getDefaultArray","defaultVertexArray","isDefaultArray","getMaxAttributes","MAX_ATTRIBUTES","setConstant","_setConstantFloatArray","_setConstantIntArray","_setConstantUintArray","bufferValue","setElementBuffer","elementBuffer","vertexAttribIPointer","getConstantBuffer","elementCount","constantValue","_normalizeConstantArrayValue","updateNeeded","_compareConstantArrayValues","copied","fillArray","v1","v2","vertexAttrib1fv","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttribI1iv","vertexAttribI2iv","vertexAttribI3iv","vertexAttribI4iv","vertexAttribI1uiv","vertexAttribI2uiv","vertexAttribI3uiv","vertexAttribI4uiv","elements","getVertexAttribOffset","MULTI_LOCATION_ATTRIBUTE_REGEXP","DEPRECATIONS_V6","VertexArray","elementsAccessor","drawParams","attributes","vertexArrayObject","setAttributes","clearDrawParams","getDrawParams","_updateDrawParams","_setAttribute","appAccessor","_resolveLocationAndAccessor","unbindBuffers","bindBuffers","_setConstantAttributes","valueAccessor","INVALID_RESULT","_getAttributeIndex","accessInfo","_getAttributeInfo","currentAccessor","attributeName","multiLocation","locationOffset","constant","_setConstantAttributeZero","_setConstantAttribute","indexCount","Infinity","_updateDrawParamsForLocation","indexOffset","setElements","getDebugTableForUniforms","header","undefinedOnly","PROJECT_MODULE_UNIFORM_REGEXP","uniformLocations","uniformNames","addUniformToTable","unusedCount","unusedTable","isDefined","isUniformDefined","getDebugTableRow","verts","getGLSLDeclaration","typeAndName","statIdCounter","AnimationLoop","onCreateContext","onAddHTML","onInitialize","onRender","onFinalize","glOptions","autoResizeViewport","autoResizeDrawingBuffer","useDevicePixelRatio","needsRedraw","timeline","cpuTime","gpuTime","frameRate","_initialized","_running","_animationFrameId","_nextFramePromise","_resolveNextFrame","_cpuStartTime","_pageLoadPromise","_onMousemove","_onMouseleave","_setDisplay","setNeedsRedraw","reason","_getPageLoadPromise","_createWebGLContext","_createFramebuffer","_startEventHandling","_initializeCallbackData","_updateCallbackData","_resizeCanvasDrawingBuffer","_resizeViewport","_gpuTimeQuery","animationProps","appContext","_addCallbackData","_startLoop","catch","redraw","isContextLost","_beginTimers","_setupFrame","_renderFrame","_clearNeedsRedraw","offScreen","commit","_endTimers","_finalizeCallbackData","attachTimeline","detachTimeline","waitForRender","getHTMLControlValue","defaultValue","setViewParameters","renderFrame","_requestAnimationFrame","display","animationLoop","renderFrameCallback","setTimeout","_resizeFramebuffer","startTime","engineTime","tick","tock","_timeline","_loop","_animationLoop","_mousePosition","aspect","_getSizeAndAspect","getTime","_offScreen","_createInfoDiv","wrapperDiv","position","div","left","bottom","html","innerHTML","offsetX","offsetY","VERTEX_SHADER","FRAGMENT_SHADER","TYPE_DEFINITIONS","validate","propType","parsePropType","propDef","getTypeOf","ShaderModule","dependencies","getUniforms","deprecations","defines","inject","vertexShader","fragmentShader","getModuleUniforms","_parseDeprecationDefinitions","injections","hook","injection","stage","order","normalizeInjections","propDefs","propTypes","parsePropTypes","getModuleSource","moduleSource","_defaultGetUniforms","getDefines","checkDeprecations","def","regex","old","new","RegExp","private","resolveModules","moduleMap","moduleDepth","getDependencyGraph","getShaderDependencies","instantiateModules","seen","GLSL_FRAG_DATA","GLSL_FRAG_DEPTH","GLSL_DERIVATIVES","GLSL_TEXTURE_LOD","compiledGlslExtensions","canCompileGLGSExtension","isOldIE","extensionName","behavior","canCompile","getFeature","MODULE_INJECTORS","VERTEX_SHADER$1","FRAGMENT_SHADER$1","DECLARATION_INJECT_MARKER","REGEX_START_OF_MAIN","REGEX_END_OF_MAIN","fragments","injectShader","injectStandardStubs","isVertex","fragmentData","fragmentString","combineInjects","injects","testVariable","qualifier","ES300_REPLACEMENTS","ES300_VERTEX_REPLACEMENTS","ES300_FRAGMENT_REPLACEMENTS","ES100_REPLACEMENTS","ES100_VERTEX_REPLACEMENTS","ES100_FRAGMENT_REPLACEMENTS","ES100_FRAGMENT_OUTPUT_NAME","ES300_FRAGMENT_OUTPUT_REGEX","transpileShader","targetGLSLVersion","convertShader","outputMatch","outputName","convertFragmentShaderTo300","convertFragmentShaderTo100","replacements","pattern","INJECT_SHADER_DECLARATIONS","SHADER_TYPE","assembleShader","hookFunctions","transpileToGLSL100","prologue","sourceLines","glslVersion","versionLine","coreSource","allDefines","assembledSource","getShaderType","gpuVendor","identifyGPUVendor","getContextInfo","getPlatformShaderDefines","isFragment","versionDefines","getVersionDefines","sourceText","define","getApplicationDefines","hookFunctionMap","signature","normalizeHookFunctions","hookInjections","declInjections","mainInjections","injectionType","hookName","hookFunction","footer","getHookFunctions","assembleGetUniforms","moduleUniforms","FS_GLES","FS300","getQualifierDetails","qualifiers","definition","getPassthroughFS","inputType","output","outputValue","variable","convertToVec4","fp32","precision","EPSILON","clone","clamp","lerp","ai","equals","epsilon","oldEpsilon","printTypes","printDegrees","printRowMajor","MathArray","cls","ExtendableBuiltin","Reflect","construct","setPrototypeOf","__proto__","_extendableBuiltin","ELEMENTS","copy","arrayOrObject","fromObject","fromArray","to","toObject","toTarget","toFloat32Array","formatString","exactEquals","negate","vector","minVector","maxVector","vectors","subtract","multiply","sub","setScalar","addScalar","subScalar","multiplyScalar","scalar","divideScalar","clampScalar","multiplyByScalar","valid","checkNumber","checkVector","callerName","validateVector","Vector","sqrt","lengthSquared","magnitude","magnitudeSquared","distance","mathArray","distanceSquared","dist","dot","product","normalize","divide","lengthSq","distanceTo","distanceToSquared","getComponent","setComponent","addVectors","subVectors","multiplyVectors","addScaledVector","out","ARRAY_TYPE","ax","ay","vec3_transformMat4AsVector","z","w","transformMat4","hypot","glMatrix.ARRAY_TYPE","mul","vec","ORIGIN","constants","Vector3","ZERO","angle","az","bx","by","bz","mag","cosine","acos","cross","vec3.cross","rotateX","radians","origin","rad","cos","sin","vec3.rotateX","rotateY","vec3.rotateY","rotateZ","vec3.rotateZ","transform","matrix4","transformAsPoint","vec3.transformMat4","transformAsVector","transformByMatrix3","matrix3","vec3.transformMat3","transformByMatrix2","matrix2","vec3_transformMat2","transformByQuaternion","quaternion","q","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","vec3.transformQuat","Matrix","RANK","row","col","getElementIndex","getElement","setElement","getColumn","columnIndex","firstIndex","setColumn","columnVector","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","b0","b1","b2","b3","translate","perspective","fovy","near","far","nf","tan","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a14","a15","b4","b5","b6","b7","b8","b9","b12","b13","b14","b15","glMatrix.EPSILON","IDENTITY","INDICES","COL0ROW0","COL0ROW1","COL0ROW2","COL0ROW3","COL1ROW0","COL1ROW1","COL1ROW2","COL1ROW3","COL2ROW0","COL2ROW1","COL2ROW2","COL2ROW3","COL3ROW0","COL3ROW1","COL3ROW2","COL3ROW3","Matrix4","identity","m00","m10","m20","m30","m01","m11","m21","m31","m02","m12","m22","m32","m03","m13","m23","m33","setRowMajor","toRowMajor","fromQuaternion","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","mat4.fromQuat","frustum","right","top","_computeInfinitePerspectiveOffCenter","rl","tb","mat4.frustum","column0Row0","column1Row1","column2Row0","column2Row1","column3Row2","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","mat4.lookAt","ortho","lr","bt","mat4.ortho","orthographic","PI","focalDistance","halfY","fov","mat4.perspective","determinant","getScale","getTranslation","getRotation","scaleResult","inverseScale0","inverseScale1","inverseScale2","getRotationMatrix3","transpose","mat4.transpose","mat4.invert","multiplyLeft","mat4.multiply","multiplyRight","mat4.rotateX","mat4.rotateY","mat4.rotateZ","rotateXYZ","rx","ry","rz","rotateAxis","axis","b20","b21","b22","mat4.rotate","mat4.scale","mat4.translate","vec4.transformMat4","vec2.transformMat4","vec2_transformMat4AsVector","makeRotationX","makeTranslation","transformPoint","transformVector","transformDirection","DEFAULT_MODULE_OPTIONS","pickingSelectedColor","pickingHighlightColor","pickingActive","pickingAttribute","picking","selectedColor","picking_uSelectedColorValid","picking_uSelectedColor","picking_uHighlightColor","picking_uActive","picking_uAttribute","ProgramManager","getDefaultProgramManager","defaultProgramManager","_programCache","_getUniforms","_registeredModules","_hookFunctions","_defaultModules","_hashes","_hashCounter","stateHash","_useCounts","addDefaultModule","removeDefaultModule","moduleName","addShaderHook","_getModuleList","vsHash","_getHash","fsHash","moduleHashes","varyingHashes","defineKeys","injectKeys","defineHashes","injectHashes","assembled","assembleShaders","release","appModules","GLTF_TO_LUMA_ATTRIBUTE_MAP","POSITION","NORMAL","COLOR_0","TEXCOORD_0","TEXCOORD_1","TEXCOORD_2","mapAttributeName","attributeMap","inferAttributeAccessor","category","DRAW_PARAMS","Model","lastLogTime","animated","programManager","_programManagerState","_managedProgram","programProps","_programDirty","_attributes","pickable","_checkProgram","moduleSettings","geometryBuffers","_setModelProps","geometry","_deleteGeometryBuffers","getDrawMode","getInstanceCount","getAttributes","getProgram","setProgram","setDrawMode","setVertexCount","setInstanceCount","setGeometry","indices","remappedName","getBuffersFromGeometry","normalizedAttributes","updateModuleSettings","_logDrawCallStart","vertexArrayInstanced","onBeforeRender","onAfterRender","didDraw","_logDrawCallEnd","discard","feedbackBuffers","unbindModels","_setFeedbackBuffers","model","render","_feedbackBuffers","_setAnimationProps","logDrawTimeout","attributeTable","ELEMENT_ARRAY_BUFFER","attributeLocation","rowHeader","getDebugTableForVertexArray","uniformTable","missingTable","missingCount","configTable","glslDeclaration","varyingInfo","getDebugTableForProgramConfiguration","BufferTransform","currentIndex","feedbackMap","bindings","resources","_initialize","setupResources","binding","_setupTransformFeedback","updateModelProps","getDrawOptions","sourceBuffers","swap","_getNextIndex","_setupBuffers","getBuffer","varyingName","_getFeedbackBuffers","sourceName","feedbackName","bufferOrRef","_createNewBuffer","_updateBindings","_updateBinding","_swapBuffers","nextIndex","srcName","dstName","SAMPLER_UNIFORM_PREFIX","SIZE_UNIFORM_PREFIX","VS_POS_VARIABLE","updateForTextures","sourceTextureMap","targetTextureVarying","targetTexture","sourceCount","targetTextureType","samplerTextureMap","updatedVs","finalInject","vsLines","updateVsLines","updated","textureMap","attributeData","getAttributeDefinition","updatedLine","samplerName","sizeName","uniformDeclerations","textureName","getSamplerDeclerations","typeToChannelSuffix","sampleInstruction","processAttributeDefinition","qualaiferDetails","getVaryingType","uniformDeclaration","posInstructions","SRC_TEX_PARAMETER_OVERRIDES","TextureTransform","_swapTexture","updatedModelProps","_processVertexShader","sourceTextures","hasSourceTextures","hasTargetTexture","transform_elementID","elementIDBuffer","sampler","_setSourceTextureParameters","sizeUniforms","getSizeUniforms","_setupTextures","getTargetTexture","packed","channelCount","typeToChannelCount","packedPixels","packCount","j","ownTexture","_targetTextureVarying","_createTargetTexture","textureOrReference","refTexture","_targetRefTexName","_createNewTexture","_sourceTextures","_targetTexture","_updateElementIDBuffer","elementIds","_","_swapTextures","overrides","TextureType","cloneTextureFrom","combinedInject","_fs","transformModule","Transform","bufferTransform","textureTransform","clearRenderTarget","updatedOpts","_updateDrawOptions","swapped","resourceTransforms","resourceTransform","_buildResourceTransforms","_updateModelProps","updatedProps","canCreateBufferTransform","canCreateTextureTransform","DRAW_MODE","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN","Geometry","_setAttributes","_calculateVertexCount","_print","channelHandles","animationHandles","Timeline","animations","playing","lastEngineTime","addChannel","delay","duration","rate","channel","_setChannelTime","removeChannel","animationHandle","animation","detachAnimation","isFinished","setTime","animationData","play","pause","attachAnimation","channelHandle","offsetTime","COORDINATE_SYSTEM","DEFAULT","LNGLAT","METER_OFFSETS","LNGLAT_OFFSETS","CARTESIAN","PROJECTION_MODE","WEB_MERCATOR","GLOBE","WEB_MERCATOR_AUTO_OFFSET","EVENTS","click","panstart","panmove","panend","COORDINATE_SYSTEM_GLSL_CONSTANTS","PROJECTION_MODE_GLSL_CONSTANTS","isEqual","memoize","compute","cachedResult","cachedArgs","ZERO_VECTOR","VECTOR_TO_POINT_MATRIX","IDENTITY_MATRIX","DEFAULT_PIXELS_PER_UNIT2","DEFAULT_COORDINATE_ORIGIN","getMemoizedViewportUniforms","coordinateSystem","coordinateOrigin","projectionCenter","viewProjectionMatrix","cameraPosCommon","shaderCoordinateOrigin","geospatialOrigin","viewMatrixUncentered","projectionMatrix","viewMatrix","cameraPosition","offsetMode","getOffsetOrigin","positionCommonSpace","projectPosition","calculateMatrixAndOffset","distanceScales","getDistanceScales","viewportSize","project_uCoordinateSystem","project_uProjectionMode","projectionMode","project_uCoordinateOrigin","project_uCenter","project_uViewportSize","project_uDevicePixelRatio","project_uFocalDistance","project_uCommonUnitsPerMeter","unitsPerMeter","project_uCommonUnitsPerWorldUnit","project_uCommonUnitsPerWorldUnit2","project_uScale","project_uViewProjectionMatrix","project_uCameraPosition","distanceScalesAtOrigin","unitsPerMeter2","unitsPerDegree","unitsPerDegree2","isGeospatial","fround","longitude","latitude","unprojectPosition","INITIAL_MODULE_OPTIONS","projectShader","modelMatrix","autoWrapLongitude","project_uWrapLongitude","project_uModelMatrix","getUniformsFromViewport","project","matrix","vec4.scale","mod","modulus","log2","LOG2E","PI_4","DEGREES_TO_RADIANS","RADIANS_TO_DEGREES","TILE_SIZE","EARTH_CIRCUMFERENCE","lngLatToWorld","lng","lat","phi2","worldToLngLat","lambda2","atan","exp","getMeterZoom","latCosine","scaleToZoom","highPrecision","unitsPerDegreeX","unitsPerDegreeY","altUnitsPerMeter","worldSize","metersPerUnit","degreesPerUnit","latCosine2","unitsPerDegreeY2","altUnitsPerDegree2","altUnitsPerMeter2","addMetersToLngLat","lngLatZ","xyz","worldspace","newLngLat","newZ","getViewMatrix","pitch","bearing","altitude","vm","vec3.negate","getProjectionParameters","altitudeToFovy","nearZMultiplier","farZMultiplier","halfFov","fovyToAltitude","pitchRadians","topHalfSurfaceDistance","worldToPixels","pixelProjectionMatrix","pixelsToWorld","pixelUnprojectionMatrix","targetZ","coord0","coord1","vec2.lerp","fitBounds","bounds","minExtent","maxZoom","padding","west","south","east","north","WebMercatorViewport","zoom","nw","se","targetSize","centerLngLat","unproject","getBounds","unprojectOps","bottomLeft","bottomRight","topLeft","topRight","unprojectOnFarPlane","pow","zoomToScale","vec3.add","vec3.mul","getProjectionMatrix","meterOffset","_initMatrices","vpm","mInverse","mat4.equals","coord","targetZWorld","X","Y","Z","projectFlat","lngLat","unprojectFlat","xy","getMapCenterByLngLatPosition","pos","fromLocation","vec2.add","vec2.negate","getLocationAtPoint","corners","getBoundingRegion","MAX_LATITUDE","MIN_LATITUDE","getMemoizedViewportCenterPosition","getMemoizedViewProjectionMatrices","shadowMatrices","projectionMatrices","farZ","screenToCommonSpace","shadowMatrix","positions","corner","DEFAULT_SHADOW_COLOR","drawToShadowMap","shadowMaps","shadowEnabled","shadow_uDrawShadowMap","shadow_uUseShadowMap","shadow_uColor","shadowColor","shadow_uLightId","shadowLightId","shadow_uLightCount","projectCenters","viewProjectionMatrices","viewProjectionMatrixCentered","dummyShadowMap","createShadowUniforms","DEFAULT_MODULES","SHADER_HOOKS","createProgramManager","shaderModule","shaderHook","DEFAULT_LIGHT_COLOR","DEFAULT_LIGHT_INTENSITY","idCount","AmbientLight","intensity","DEFAULT_LIGHT_DIRECTION","DirectionalLight","direction","_shadow","shadow","getProjectedLight","Effect","preRender","getModuleParameters","cleanup","LayersPass","_drawLayers","viewports","views","onViewportActive","clearCanvas","pass","clearGLCanvas","renderStats","viewportOrDescriptor","view","drawLayerParams","_getDrawLayerParams","subViewports","subViewport","_drawLayersInViewport","layers","layerFilter","effects","moduleParameters","indexResolver","layerIndexResolver","drawContext","isPicking","renderPass","layerIndex","shouldDrawLayer","_shouldDrawLayer","layerParam","layerRenderIndex","_getModuleParameters","layerParameters","getLayerParameters","glViewport","dimensions","pixelRatio","getGLViewport","clearOpts","renderStatus","totalCount","visibleCount","compositeCount","pickableCount","isComposite","drawLayer","raiseError","visible","filterSubLayer","activateViewport","wrapLongitude","mousePosition","effect","startIndex","layerIndices","resolvers","resolveLayerIndex","isDrawn","indexOverride","_offset","layerId","parentId","resolver","ShadowPass","shadowMap","depthBuffer","fbo","DEFAULT_AMBIENT_LIGHT_PROPS","DEFAULT_DIRECTIONAL_LIGHT_PROPS","LightingEffect","ambientLight","directionalLights","pointLights","shadowPasses","lightSource","_applyDefaultLights","light","_createLightMatrix","_createShadowPasses","lightSources","directionalLight","pointLight","shadowPass","lightMatrices","_pool","overAlloc","poolSize","allocate","maxCount","newSize","maxSize","newArray","_allocate","_release","sizeToAllocate","ceil","pool","findIndex","scratchVector","getFrustumPlane","L","normal","scratchArray","toDoublePrecisionArray","endIndex","typedArrayManager","sourceIndex","targetIndex","DEFAULT_DISTANCE_SCALES","Viewport","displayName","_frustumPlanes","_initViewMatrix","_initProjectionMatrix","_initPixelMatrices","metersPerPixel","unprojectOption","containsPixel","getFrustumPlanes","planes","panByPosition","coords","getCameraPosition","getCameraDirection","cameraDirection","getCameraUp","cameraUp","_createProjectionMatrix","fovyRadians","_getCenterInWorld","commonPosition","viewMatrixInverse","viewportMatrix","worldOffset","_subViewports","minOffset","maxOffset","offsetViewport","newCenter","lngLatZToWorldPosition","getWorldPosition","fromCoordinateSystem","fromCoordinateOrigin","normalizedParams","normalizeParameters","worldPosition","vec3.sub","LIFECYCLE","PROP_SYMBOLS","COMPONENT","for","ASYNC_DEFAULTS","ASYNC_ORIGINAL","ASYNC_RESOLVED","flatten","flattenArray","_loadCount","_subscribers","consumer","inUse","isLoaded","_error","_content","forceUpdate","_data","loadCount","onChange","ResourceManager","protocol","resourceManager","_resources","_consumers","_pruneRequest","contains","resourceId","persistent","res","remove","consumerId","requestId","request","prune","_track","_prune","finalize","consumers","INITIAL_CONTEXT","layerManager","shaderCache","pickingFBO","LayerManager","lastRenderedLayers","_nextLayers","_needsRedraw","_needsUpdate","_debug","_finalizeLayer","clearRedrawFlags","layerNeedsRedraw","getNeedsRedraw","needsUpdate","setNeedsUpdate","getLayers","layerIds","setLayers","newLayers","_updateLayers","updateLayers","_handleError","oldLayers","oldLayerMap","oldLayer","generatedLayers","_updateSublayersRecursively","_finalizeOldLayers","hasUniformTransition","newLayer","sublayers","validateProps","_transferLayerState","_updateLayer","_initializeLayer","getSubLayers","lifecycle","_transferState","_update","_finalize","deepEqual","aValue","bValue","ViewManager","viewState","controllers","_viewports","_viewportMap","_isUpdating","_eventManager","eventManager","_eventCallbacks","onViewStateChange","onInteractionStateChange","updateViewStates","viewId","controller","updateTransition","getViewports","rect","getViews","viewMap","getView","viewOrViewId","getViewState","getViewStateId","filterViewState","getViewport","_setViews","_setViewState","_setSize","_rebuildViewports","_diffViews","_onViewStateChange","_createController","Controller","onStateChange","makeViewport","_getViewport","_updateController","controllerProps","oldControllers","invalidateControllers","oldController","_buildViewportMap","newViews","oldViews","PERCENT_OR_PIXELS_REGEX","parsePosition","relative","getPosition","extent","View","viewportInstance","_parseDimensions","viewportDimensions","getDimensions","newViewState","_x","_y","_width","_height","_getControllerProps","defaultOpts","ViewportType","onUpdate","onInterrupt","onEnd","Transition","_inProgress","inProgress","_onUpdate","TRANSITION_EVENTS","transitionEasing","transitionInterruption","onTransitionStart","onTransitionInterrupt","onTransitionEnd","TransitionManager","ControllerState","propsInTransition","transition","_onTransitionUpdate","getViewportInTransition","processViewStateChange","nextProps","transitionTriggered","currentProps","_shouldIgnoreViewportChange","_isTransitionEnabled","interruption","endProps","startProps","_triggerTransition","transitionDuration","transitionInterpolator","_isUpdateDueToCurrentTransition","interpolator","arePropsEqual","startViewstate","endViewStateProps","shortestPathFrom","getDuration","initialProps","initializeProps","easing","_onTransitionEnd","inTransition","isZooming","isPanning","isRotating","interpolateProps","getViewportProps","oldViewState","DEFAULT_REQUIRED_PROPS","LinearInterpolator","compare","extract","required","_propsToCompare","_propsToExtract","_requiredProps","startViewStateProps","_checkRequiredProps","transitionProps","around","startViewport","endViewport","aroundPosition","NO_TRANSITION_PROPS","LINEAR_TRANSITION_PROPS","INERTIA_EASING","EVENT_TYPES","controllerState","controllerStateProps","transitionManager","_onTransition","_setInteractionState","linearTransitionProps","_transition","_events","_interactionState","isDragging","_customEvents","handleEvent","events","customEvents","toggleEvents","eventName","off","eventStartBlocked","_eventStartBlocked","_onPanStart","_onPan","_onPanEnd","_onPinchStart","_onPinch","_onPinchEnd","_onTriplePanStart","_onTriplePan","_onTriplePanEnd","_onDoubleTap","_onWheel","_onKeyDown","getCenter","offsetCenter","isPointInBounds","handled","inside","stopPropagation","isFunctionKeyPressed","srcEvent","metaKey","altKey","ctrlKey","shiftKey","blockEvents","timeout","timer","dragMode","_getTransitionProps","inertia","scrollZoom","dragPan","dragRotate","doubleClickZoom","touchZoom","touchRotate","keyboard","isInteractive","eventNames","on","updateViewport","newControllerState","extraProps","interactionState","getState","newStates","alternateMode","rightButton","invertPan","_panMove","_onPanMove","_onPanRotate","_onPanMoveEnd","_onPanRotateEnd","pan","velocity","endPos","velocityX","velocityY","panEnd","rotate","rotateEnd","preventDefault","speed","smooth","rotateStart","deltaX","zoomStart","_startPinchRotation","rotation","_lastPinchEvent","deltaAngleX","velocityZ","deltaTime","endScale","zoomEnd","isZoomOut","funcKey","zoomSpeed","moveSpeed","rotateSpeedX","rotateSpeedY","code","zoomOut","zoomIn","rotateLeft","moveLeft","rotateRight","moveRight","rotateUp","moveUp","rotateDown","moveDown","ViewState","_viewportProps","_applyConstraints","DEFAULT_STATE","MapState","minZoom","maxPitch","minPitch","startPanLngLat","startZoomLngLat","startRotatePos","startBearing","startPitch","startZoom","panStart","_getUpdatedState","_unproject","startPos","deltaAngleY","newRotation","_calculateNewPitchAndBearing","_getRotationParams","_calculateNewZoom","zoomedViewport","_zoomFromCenter","_panFromCenter","fromProps","flatViewport","topY","bottomY","shiftY","normalizeViewportProps","deltaScaleX","deltaScaleY","deltaY","centerY","startY","MapController","oldProps","MapView","DEFAULT_LIGHTING_EFFECT","EffectManager","_internalEffects","setEffects","getEffects","_createInternalEffects","DrawLayersPass","PICKING_PARAMETERS","PickLayersPass","useAlpha","_drawPickingBuffer","deviceRect","redrawReason","pickZ","pickParameters","DeckRenderer","drawPickingColors","drawLayersPass","pickLayersPass","renderCount","renderBuffers","lastPostProcessEffect","renderLayers","layerPass","_preRender","outputBuffer","_postRender","postRender","_resizeRenderBuffers","inputBuffer","swapBuffer","NO_PICKED_OBJECT","pickedColor","pickedLayer","pickedObjectIndex","getClosestObject","pickedColors","deviceX","deviceY","deviceRadius","minSquareDistanceToCenter","closestPixelIndex","dy","dy2","dx","d2","pickedLayerIndex","decodePickingColor","pickedX","pickedY","getEmptyPickingInfo","pickInfo","getViewportFromCoordinates","coordinate","picked","devicePixel","processPickInfo","lastPickedInfo","affectedLayers","lastPickedObjectIndex","lastPickedLayerId","pickedLayerId","lastPickedLayer","baseInfo","infos","getLayerPickingInfo","updateAutoHighlight","sourceLayer","getPickingInfo","DeckPicker","_pickable","depthFBO","pickObject","_pickClosestObject","pickObjects","_pickVisibleObjects","getLastPickedObject","lastPickedViewportId","_resizeBuffer","_getPickable","pickableLayers","isPickable","radius","unproject3D","emptyInfo","devicePixelRange","_getPickingRect","deviceWidth","deviceHeight","_drawAndSample","disablePickingIndex","restorePickingColors","maxObjects","leftTop","deviceLeft","deviceTop","rightBottom","deviceRight","deviceBottom","pickInfos","uniqueColors","colorKey","getUniqueObjects","uniqueInfos","isMaxObjects","defaultStyle","zIndex","pointerEvents","backgroundColor","Tooltip","canvasParent","parentElement","el","isVisible","setTooltip","displayInfo","innerText","exportName","VENDOR_PREFIXES","TEST_ELEMENT","setTimeoutContext","bindFn","invokeArrayArg","arg","each","deprecate","deprecationMessage","stack","TypeError","nextKey","extend","merge","inherit","base","properties","childP","baseP","_super","boolOrFn","val","ifUndefined","val1","val2","addEventListeners","splitStr","removeEventListeners","hasParent","inStr","str","inArray","findByKey","uniqueArray","results","prefixed","prop","camelProp","_uniqueId","getWindowForElement","doc","ownerDocument","defaultView","parentWindow","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","INPUT_TYPE_TOUCH","INPUT_TYPE_MOUSE","DIRECTION_VERTICAL","DIRECTION_UP","PROPS_XY","PROPS_CLIENT_XY","Input","manager","inputTarget","domHandler","ev","inputHandler","pointersLen","pointers","changedPointersLen","changedPointers","isFirst","isFinal","session","pointersLength","firstInput","simpleCloneInputData","firstMultiple","getAngle","getDistance","offsetDelta","prevDelta","prevInput","computeDeltaXY","offsetDirection","getDirection","overallVelocity","getVelocity","overallVelocityX","overallVelocityY","maxPointers","last","lastInterval","computeIntervalInputData","computeInputData","emit","recognize","clientX","clientY","p1","p2","atan2","evEl","evTarget","evWin","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","MouseInput","pressed","button","which","pointerType","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","PointerEventInput","MSPointerEvent","PointerEvent","removePointer","eventTypeNormalized","isTouch","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","started","normalizeSingleTouches","touches","changedTouches","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","TouchInput","targetIds","getTouches","allTouches","identifier","targetTouches","changedTargetTouches","touch","TouchMouseInput","mouse","primaryTouch","lastTouches","recordTouches","eventData","setLastTouch","lastTouch","lts","isSyntheticEvent","inputEvent","inputData","isMouse","sourceCapabilities","firesTouchEvents","PREFIXED_TOUCH_ACTION","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MAP","touchMap","cssSupports","CSS","supports","getTouchActionProps","TouchAction","actions","touchAction","recognizers","recognizer","getTouchAction","hasPanX","hasPanY","cleanTouchActions","preventDefaults","prevented","hasNone","isTapPointer","isTapMovement","isTapTouchTime","DIRECTION_LEFT","preventSrc","STATE_FAILED","Recognizer","simultaneous","requireFail","stateStr","directionStr","getRecognizerByNameIfManager","otherRecognizer","AttrRecognizer","PanRecognizer","pX","pY","PinchRecognizer","PressRecognizer","_timer","_input","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","Hammer","preset","Manager","recognizeWith","dropRecognizeWith","requireFailure","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","inputDataClone","attrTest","optionPointers","isRecognized","isValid","threshold","DIRECTION_HORIZONTAL","directionTest","hasMoved","inOut","validPointers","validMovement","validTime","taps","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","domEvents","inputClass","cssProps","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","oldCssProps","toggleCssProps","item","force","stopped","curRecognizer","existing","gestureEvent","createEvent","initEvent","gesture","dispatchEvent","triggerDomEvent","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","DIRECTION_NONE","DIRECTION_RIGHT","DIRECTION_DOWN","DIRECTION_ALL","Tap","Pan","Swipe","Pinch","Rotate","Press","oldHandler","predict","enhancePointerEventInput","hammerjs","RECOGNIZERS","RECOGNIZER_COMPATIBLE_MAP","tripan","pinch","doubletap","anytap","RECOGNIZER_FALLBACK_MAP","BASIC_EVENT_ALIASES","INPUT_EVENT_TYPES","KEY_EVENTS","MOUSE_EVENTS","WHEEL_EVENTS","EVENT_RECOGNIZER_MAP","tap","press","pinchin","pinchout","pinchstart","pinchmove","pinchend","pinchcancel","rotatestart","rotatemove","rotateend","rotatecancel","tripanstart","tripanmove","tripanup","tripandown","tripanleft","tripanright","tripanend","tripancancel","panup","pandown","panleft","panright","pancancel","swipe","swipeleft","swiperight","swipeup","swipedown","GESTURE_EVENT_ALIASES","anyclick","dblclick","mouseover","mouseout","mouseleave","passiveSupported","passive","firefox","EVENT_TYPE","WHEEL_DELTA_MAGIC_SCALER","WheelInput","enableEventType","WheelEvent","deltaMode","DOM_DELTA_PIXEL","DOM_DELTA_LINE","wheelPosition","MOVE_EVENT_TYPE","OVER_EVENT_TYPE","OUT_EVENT_TYPE","LEAVE_EVENT_TYPE","MoveInput","enableMoveEvent","enableLeaveEvent","enableOutEvent","enableOverEvent","handleOverEvent","handleOutEvent","handleLeaveEvent","handleMoveEvent","DOWN_EVENT_TYPE","UP_EVENT_TYPE","KeyInput","enableDownEvent","enableUpEvent","tabIndex","outline","targetElement","srcElement","tagName","ContextmenuInput","DEFAULT_OPTIONS","EventRegistrar","handlersByElement","_active","entry","insertPosition","mjolnirEvent","_normalizeEvent","rootElement","_emit","immediatePropagationStopped","stopImmediatePropagation","entriesToRemove","buttons","leftButton","middleButton","whichButtons","getBoundingClientRect","offsetWidth","offsetHeight","clientLeft","clientTop","getOffsetPosition","recognizerOptions","EventManager","_onBasicInput","_onOtherEvent","ManagerClass","otherName","recognizerName","recognizerOption","wheelInput","moveInput","keyInput","contextmenuInput","eventAlias","eventRegistrar","_toggleRecognizer","_addEventHandler","watch","_removeEventHandler","fallbackRecognizers","isRecognizerUsed","eh","defaultProps","pickingRadius","eventRecognizerOptions","_framebuffer","_animate","_typedArrayManagerProps","onWebGLInitialized","onResize","onLoad","_onMetrics","getCursor","Deck","viewManager","effectManager","deckRenderer","deckPicker","_pickRequest","_lastPointerDownInfo","interactiveState","isHovering","_onEvent","_onPointerDown","_onPointerMove","initialViewState","_createCanvas","_createAnimationLoop","metrics","fps","setPropsTime","updateAttributesTime","framesRedrawn","pickTime","pickCount","gpuTimePerFrame","cpuTimePerFrame","bufferMemory","textureMemory","renderbufferMemory","gpuMemory","_metricsCounter","tooltip","_setCanvasSize","resolvedProps","_getViews","_getViewState","viewManagerNeedsRedraw","layerManagerNeedsRedraw","effectManagerNeedsRedraw","deckRendererNeedsRedraw","_customRender","_pick","pickMultipleObjects","_addResources","_removeResources","resourceIds","statKey","_updateCanvasSize","_checkForCanvasSizeChange","_onContextLost","_setGLContext","_onRenderFrame","_pickAndCallback","pickedInfo","onHover","getTooltip","_updateCursor","container","cursor","pointerleave","_onInteractionStateChange","renderOptions","_getFrameStats","_getMetrics","eventOptions","layerHandler","rootHandler","animationLoopStats","memoryStats","getPropTypes","PropTypes","oneOfType","arrayOf","instanceOf","bool","deckGlobal","ShaderAttribute","dataColumn","getAccessor","elementOffset","getStride","bytesPerElement","resolveShaderAttribute","baseAccessor","shaderAttributeOptions","vertexOffset","EMPTY_ARRAY","placeholderArray","createIterable","startRow","endRow","iterable","objectInfo","getAccessorFromBuffer","startIndices","nested","elementStride","EMPTY","FULL","padArrayChunk","sourceLength","targetLength","datum","DEFAULT_TRANSITION_SETTINGS","interpolation","spring","stiffness","damping","normalizeTransitionSettings","userSettings","layerSettings","getSourceBufferAttribute","getAttributeTypeFromSize","cycleBuffers","getAttributeBufferLength","numInstances","doublePrecision","multiplier","Float64Array","noAlloc","padBuffer","fromLength","fromStartIndices","precisionMultiplier","toStartIndices","hasStartIndices","toLength","isConstant","toData","_normalizeConstant","getMissingData","sourceStartIndices","targetStartIndices","getChunkData","nextSourceIndex","nextTargetIndex","padArray","Attribute","logicalType","bufferType","hasFeature","defaultType","glArrayFromType","shaderAttributes","fp64","externalBuffer","bufferAccessor","allocatedValue","_buffer","getShaderAttributes","isBuffer64Bit","doubleShaderAttributeDefs","resolvedOptions","high","low","resolveDoublePrecisionShaderAttributes","shaderAttributeDef","_normalizeValue","_areValuesEqual","_checkExternalBuffer","requiredBufferSize","updateSubBuffer","startOffset","endOffset","illegalArrayType","value1","value2","_autoUpdater","lastExternalBuffer","binaryValue","binaryAccessor","updateRanges","range.FULL","_validateAttributeUpdaters","layout","clearChangedFlags","getUpdateTriggers","supportsTransition","getTransitionSetting","dataRange","rangeList","range","newRangeList","range0","range.add","clearNeedsUpdate","range.EMPTY","updateBuffer","getVertexOffset","_checkAttributeArray","setConstantValue","setExternalBuffer","setBinaryValue","needsNormalize","shaderAttributeDefs","shaderAttributeName","accessorFunc","objectValue","numVertices","TRANSITION_TYPES","attributeInTransition","currentStartIndices","currentLength","attributeType","ATTRIBUTE_TYPE","getTransform","bufferOpts","transitionSettings","padBufferOpts","enter","aFrom","aTo","vCurrent","getTexture","aPrev","aCur","vNext","AttributeTransitionManager","transitions","_removeTransition","_updateAttribute","hasAttribute","animatedAttributes","isNew","TransitionType","TRACE_INVALIDATE","AttributeManager","updateTriggers","attributeTransitionManager","updaters","_add","addInstanced","attributeNameArray","triggerName","invalidatedAttributes","_invalidateTrigger","invalidateAll","accessorName","transitionUpdated","getChangedAttributes","changedAttributes","excludeAttributes","getAccessors","_createAttribute","_mapUpdateTriggersToAttributes","triggers","updateSpringElement","prev","cur","distanceSquare","_value","fromValue","toValue","_currValue","_prevValue","nextValue","next","updateSpring","UniformTransitionManager","active","diffProps","propsChangedReason","compareProps","ignoreProps","dataChangedReason","dataChanged","dataComparator","_dataDiff","diffDataProps","updateTriggersChangedReason","diffUpdateTrigger","triggerChanged","diffUpdateTriggers","propsChanged","updateTriggersChanged","extensionsChanged","diffExtensions","transitionsChanged","diffTransitions","comparePropValues","newProp","oldProp","equal","oldExtensions","newTriggers","oldTriggers","LayerType","_propTypes","isPlainObject","mergeShaders","mergedInjection","DEFAULT_TEXTURE_PARAMETERS","internalTextures","boolean","optional","arrayEqual","valueType","function","dataTransform","specialTextureParameters","textureParameters","normalizePropDefinition","createProps","propsPrototype","getPropsPrototype","propsInstance","componentClass","getOwnProperty","parentClass","parentDefaultProps","componentPropDefs","deprecatedFor","parentProps","componentName","getComponentName","defineProperties","createPropsPrototype","defaultValues","descriptors","getDescriptorForAsyncProp","addAsyncPropsToPropPrototype","_deprecatedProps","newValue","nameStr","newPropName","addDeprecatedPropsToPropPrototype","_mergedDefaultProps","createPropsPrototypeAndTypes","internalState","hasAsyncProp","getAsyncProp","EMPTY_PROPS","ComponentState","asyncProps","onAsyncPropUpdated","oldAsyncProps","asyncProp","resolvedValue","getOldProps","resetOldProps","freezeAsyncOldProps","isAsyncPropLoading","pendingLoadCount","resolvedLoadCount","reloadAsyncProp","_watchPromise","setAsyncProps","resolvedValues","originalValues","_createAsyncPropData","_updateAsyncProp","_didAsyncInputValueChange","_this$layer","_resolveAsyncIterable","_setPropValue","lastValue","_postProcessValue","_setAsyncPropValue","promise","_this$layer2","onDataLoad","_this$layer3","_this$layer4","Component","_initState","LayerState","attributeManager","subLayers","usesPickingColorCache","MAX_PICKING_COLOR_CACHE_SIZE","areViewportsEqual","oldViewport","pickingColorCache","__diff","loadOptions","_loadOptions","getLoadOptions","inResourceManager","opacity","onClick","onDragStart","onDrag","onDragEnd","positionFormat","colorFormat","getPolygonOffset","highlightedObjectIndex","autoHighlight","highlightColor","Layer","layerName","_this$props$onError","_this$props","_this$context","_this$context$onError","setState","updateObject","setChangeFlags","stateChanged","_getNeedsRedraw","shouldUpdateState","_getUpdateParams","uniformTransitions","getModels","models","getAttributeManager","getCurrentLayer","use64bitPositions","pickingEvent","nullPickingColor","encodePickingColor","i1","i2","i3","initializeState","getShaders","shaders","changeFlags","propsOrDataChanged","updateState","neededPickingBuffer","needPickingBuffer","pickingColors","instancePickingColors","pickingColorsAttribute","finalizeState","viewportChanged","invalidateAttribute","diffReason","updateAttributes","_setModelAttributes","_updateAttributes","getNumInstances","getStartIndices","ignoreUnknownAttributes","_updateAttributeTransition","_updateUniformTransition","calculateInstancePickingColors","cacheSize","newCacheSize","pickingColor","objectIndex","_disablePickingIndex","colors","_updateState","stateNeedsUpdate","currentViewport","updateParams","oldModels","modelChanged","_updateModules","_renderLayers","clearChangeFlags","setModuleParameters","offsets","getChangeFlags","flags","flagChanged","somethingChanged","_updateAutoHighlight","pickingModuleParameters","attributeManagerNeedsRedraw","_getAttributeManager","_onAsyncPropUpdated","OrbitState","rotationX","rotationOrbit","minRotationX","maxRotationX","startPanPosition","startRotationX","startRotationOrbit","startZoomPosition","startPosition","newZoom","OrthographicController","OrthographicViewport","flipY","OrthographicView","DEFAULT_COLOR","radiusUnits","radiusScale","radiusMinPixels","radiusMaxPixels","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","stroked","filled","billboard","antialiasing","getRadius","getFillColor","getLineColor","getLineWidth","strokeWidth","ScatterplotLayer","project32","instancePositions","instanceRadius","instanceFillColors","instanceLineColors","instanceLineWidths","_this$state$model","_getModel","pointRadiusMultiplier","lineWidthMultiplier","isDuplicate","getPointAtIndex","startI","intersect","edge","bbox","snap","bitCode","cutPolylineByGrid","broken","gridResolution","gridOffset","numPoints","part","codeB","cell","getGridCell","scratchPoint","codeAlt","moveToNeighborCell","cutPolylineByMercatorBounds","newPositions","prevLng","wrapLongitudesForShortestPath","parts","shiftLongitudesIntoRange","refLng","pointCount","PathTesselator","defaultTypedArrayManager","indexStarts","vertexStarts","_attributeDefs","updateGeometry","getGeometry","geometryBuffer","positionSize","getGeometryFromBuffer","_rebuildGeometry","updatePartialGeometry","normalizeGeometry","updateGeometryAttributes","getGeometrySize","_forEachGeometry","visitor","normalizedData","dataIndex","byteStride","vertexStart","indexStart","vertexEnd","geometrySize","geometryIndex","segmentTypes","path","flatPath","normalizePath","resolution","subPath","getPathLength","isClosed","_updateSegmentTypes","_updatePositions","isPathClosed","ptIndex","getPointOnPath","loop","lastPointIndex","widthUnits","widthScale","widthMinPixels","widthMaxPixels","jointRounded","capRounded","miterLimit","_pathType","getPath","getWidth","rounded","ATTRIBUTE_TRANSITION","PathLayer","calculatePositions","instanceLeftPositions","instanceStartPositions","instanceEndPositions","instanceRightPositions","instanceTypes","calculateSegmentTypes","instanceStrokeWidths","instanceColors","__source","pathTesselator","getDashArray","widthMultiplier","jointType","capType","pauseTime","costLabel","resetZoomHandler","startButtonDisabled","pauseButtonDisabled","resetButtonDisabled","resetZoomButtonDisabled","timeLabel","stopTimer","clearInterval","updateTimeLabel","$time","updateCostLabel","$solution","bks","$instance","gap","$state","elapsed","setInterval","startTimer","getComputedStyle","iframe","contentWindow","mapPanel","mapCanvas","mapWidth","mapHeight","depot","depotLayer","nodeLayer","routeLayer","depotLinesLayer","depotLines","minX","maxX","minY","maxY","INITIAL_VIEW_STATE","resetZoom","calculateZoom","demand","fontSize","borderRadius","route","routePositions","nodeIndex","firstNode","lastNode","fetchInstance","instanceName","instances","parseProperty","parseNode","parseDemand","replaceAll","dimension","parseInstance","BKS","newStr","iterations","selectedInstanceName","fetchedInstance","selected_option","querySelector","currentConfig","$config","isInvalid","hide","invalid","configForm","App"],"mappings":"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ACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,cACA,aACA,aACA,aACA,aACA,cACA,aACA,aACA,aACA,aACA,cACA,aACA,aACA,aACA,aACA,cACA,aACA,aACA,aACA,aACA,cACA,cACA,aACA,aACA,aACA,cACA,aACA,aACA,aACA,aACA,cACA,cACA,aACA,aACA,aACA,cACA,cACA,aACA,aACA,eAGIO,GAAM,CACV,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,YAAa,MACb,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,YAAa,MACb,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,YAAa,MACb,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,OACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,OACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,OACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,aAAc,MACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,aAAc,OACd,aAAc,MACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,cAAe,OACf,aAAc,MACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,aAAc,MACd,aAAc,OACd,aAAc,MACd,aAAc,MACd,cAAe,OACf,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"}